<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Analyzing CVE Lifecycle and Relationships with Exploits, Patches, CWEs, and CPEs"><meta name=author content="Eid ALBADDAH"><link href=https://doc.ifthreat.com/analysis/current/chapter-5-enhanced/ rel=canonical><link href=../chapter-4-enhanced/ rel=prev><link href=../cpe-cve-old-vs-new/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.16"><title>Chapter 5 - Lifecycle Analysis - CVE Lifecycle Analysis Research Hub</title><link rel=stylesheet href=../../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../stylesheets/extra.css><link rel=stylesheet href=https://cdn.tailwindcss.com><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#chapter-5-lifecycle-analysis-enhanced-multi-vendor class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="CVE Lifecycle Analysis Research Hub" class="md-header__button md-logo" aria-label="CVE Lifecycle Analysis Research Hub" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 12h7c-.53 4.11-3.28 7.78-7 8.92zH5V6.3l7-3.11M12 1 3 5v6c0 5.55 3.84 10.73 9 12 5.16-1.27 9-6.45 9-12V5z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> CVE Lifecycle Analysis Research Hub </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Chapter 5 - Lifecycle Analysis </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=deep-amber data-md-color-accent=amber aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=deep-amber data-md-color-accent=amber aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../data/ class=md-tabs__link> Data & Schema </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../ class=md-tabs__link> Analysis & Visualizations </a> </li> <li class=md-tabs__item> <a href=../../../research/ class=md-tabs__link> Research Ideas & Exploration </a> </li> <li class=md-tabs__item> <a href=../../../publications/ class=md-tabs__link> Conference Papers </a> </li> <li class=md-tabs__item> <a href=../../../methodology/ class=md-tabs__link> Methodology </a> </li> <li class=md-tabs__item> <a href=../../../future/ class=md-tabs__link> Future Work </a> </li> <li class=md-tabs__item> <a href=../../../resources/ class=md-tabs__link> Resources </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="CVE Lifecycle Analysis Research Hub" class="md-nav__button md-logo" aria-label="CVE Lifecycle Analysis Research Hub" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 12h7c-.53 4.11-3.28 7.78-7 8.92zH5V6.3l7-3.11M12 1 3 5v6c0 5.55 3.84 10.73 9 12 5.16-1.27 9-6.45 9-12V5z"/></svg> </a> CVE Lifecycle Analysis Research Hub </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../data/ class=md-nav__link> <span class=md-ellipsis> Data & Schema </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> Analysis & Visualizations </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Analysis & Visualizations </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <div class="md-nav__link md-nav__container"> <a href=../../transfer-report/ class="md-nav__link "> <span class=md-ellipsis> Transfer Report </span> </a> <label class="md-nav__link " for=__nav_3_2 id=__nav_3_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Transfer Report </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transfer-report/transfer-report-pdf/ class=md-nav__link> <span class=md-ellipsis> Transfer Report (PDF) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Current Research </span> </a> <label class="md-nav__link " for=__nav_3_3 id=__nav_3_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Current Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../chapter-4-enhanced/ class=md-nav__link> <span class=md-ellipsis> Chapter 4 - CVE Analysis </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Chapter 5 - Lifecycle Analysis </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Chapter 5 - Lifecycle Analysis </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#data-preparation-notes class=md-nav__link> <span class=md-ellipsis> Data Preparation Notes: </span> </a> </li> <li class=md-nav__item> <a href=#lifecycle-analysis class=md-nav__link> <span class=md-ellipsis> Lifecycle Analysis </span> </a> <nav class=md-nav aria-label="Lifecycle Analysis"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ch5_fig_51_distribution-of-vulnerability-lifecycle-events-2016-2025-for-microsoft class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.1_Distribution of Vulnerability Lifecycle Events (2016-2025) for Microsoft </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_51_multi_vendor_distribution-of-vulnerability-lifecycle-events-2016-2025-for-all-vendors class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.1_Multi_Vendor_Distribution of Vulnerability Lifecycle Events (2016-2025) for All Vendors </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_52_distribution-of-exploit-publication-timing-relative-to-cve-reservation-1999-2025 class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.2_Distribution of exploit publication timing relative to CVE reservation (1999-2025) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_53_cve-exploitation-race-pattern-1999-2025 class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.3_CVE exploitation race pattern (1999-2025) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_54_distribution-of-microsoft-specific-exploit-timing-relative-to-cve-reservation-1999-2025 class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.4_Distribution of Microsoft-specific exploit timing relative to CVE reservation (1999-2025) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_55_microsoft-patched-vulnerabilities-by-year-2016-2025 class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.5_Microsoft Patched Vulnerabilities by Year (2016-2025) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_55_multi_vendor_patched-vulnerabilities-by-year-2016-2025 class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.5_Multi_Vendor_Patched Vulnerabilities by Year (2016-2025) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_56_time-to-patch-by-vulnerability-severity class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.6_Time to Patch by Vulnerability Severity </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_56_multi-vendor-time-to-patch-by-vulnerability-severity class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.6_Multi-vendor Time to Patch by Vulnerability Severity </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_57_distribution-of-differences-in-days-between-exploit-adding-date-and-cve-creation-date-for-microsoft-products class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.7_Distribution of differences in days between Exploit Adding date and CVE Creation date for Microsoft products </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_571_distribution-of-differences-in-days-between-exploit-adding-date-and-cve-creation-date-all-cves-with-patch-and-exploit class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.7.1_Distribution of differences in days between Exploit Adding date and CVE Creation date (All CVEs with patch and exploit) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_572_distribution-of-differences-in-days-between-cve-creation-date-and-patch-date-for-microsoft-products class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.7.2_Distribution of differences in days between CVE Creation date and Patch date for Microsoft products </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_573_distribution-of-differences-in-days-between-cve-creation-date-and-patch-date-all-cves-with-patch-and-exploit class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.7.3_Distribution of differences in days between CVE Creation date and Patch date (All CVEs with patch and exploit) </span> </a> </li> <li class=md-nav__item> <a href=#figlifecycle_exp_minus_creation-distribution-of-differences-in-days-between-exploit-adding-date-and-cve-creation-date-including-third-party-applications class=md-nav__link> <span class=md-ellipsis> fig:lifecycle_exp_minus_creation: Distribution of differences in days between Exploit Adding date and CVE Creation date (including third-party applications) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_59_distribution-of-differences-in-days-between-patch-availability-and-exploit-adding-dates-for-microsoft-products class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.9_Distribution of differences in days between Patch Availability and Exploit Adding dates for Microsoft products </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_510_distribution-of-differences-in-days-between-patch-availability-and-exploit-adding-dates-all-cves-with-patch-and-exploit class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.10_Distribution of differences in days between Patch Availability and Exploit Adding dates (All CVEs with patch and exploit) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_511_gap-between-exploit-and-patch-dates-for-microsoft-related-cves-2016-2025 class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.11_Gap between exploit and patch dates for Microsoft-related CVEs (2016-2025) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_511_gap-between-exploit-and-patch-dates-for-all-vendors-cves-2016-2025 class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.11_Gap between exploit and patch dates for All Vendors CVEs (2016-2025) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_tab_51_lifecycle-events-differences-by-severity-days class=md-nav__link> <span class=md-ellipsis> Ch5_Tab_5.1_Lifecycle Events Differences by Severity (Days) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_tab_51_multi_vendor_lifecycle-events-differences-by-severity-days class=md-nav__link> <span class=md-ellipsis> Ch5_Tab_5.1_Multi_Vendor_Lifecycle Events Differences by Severity (Days) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_512_yearly-trend-of-mean-and-median-time-differences-for-critical-severity-across-all-events class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.12_Yearly trend of mean and median time differences for Critical severity across all events </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_512_multi-vendors_yearly-trend-of-mean-and-median-time-differences-for-critical-severity-across-all-events class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.12_Multi-vendors_Yearly trend of mean and median time differences for Critical severity across all events </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_513_yearly-trend-of-mean-and-median-time-differences-for-high-severity-across-all-events class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.13_Yearly trend of mean and median time differences for High severity across all events </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_514_yearly-trend-of-mean-and-median-time-differences-for-medium-severity-across-all-events class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.14_Yearly trend of mean and median time differences for Medium severity across all events </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_515_yearly-trend-of-mean-and-median-time-differences-for-low-severity-across-all-events class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.15_Yearly trend of mean and median time differences for Low severity across all events </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_516_three-way-comparison-median-patching-times-in-days-for-all-microsoft-patched-cves-non-exploited-patched-cves-and-exploited-patched-cves-by-severity-level class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.16_Three-Way Comparison: Median Patching Times (in days) for All Microsoft Patched CVEs, Non-Exploited Patched CVEs, and Exploited Patched CVEs by Severity Level </span> </a> </li> <li class=md-nav__item> <a href=#ch5_fig_516_multi-vendor_three-way-comparison-median-patching-times-in-days-for-all-microsoft-patched-cves-non-exploited-patched-cves-and-exploited-patched-cves-by-severity-level class=md-nav__link> <span class=md-ellipsis> Ch5_Fig_5.16_Multi-vendor_Three-Way Comparison: Median Patching Times (in days) for All Microsoft Patched CVEs, Non-Exploited Patched CVEs, and Exploited Patched CVEs by Severity Level </span> </a> </li> <li class=md-nav__item> <a href=#ch5_tab_52_cve-with-more-than-1000-days-between-exploitation-and-cve-creation-datemicrosoft class=md-nav__link> <span class=md-ellipsis> Ch5_Tab_5.2_CVE with more than 1000 days between Exploitation and CVE Creation Date(Microsoft) </span> </a> </li> <li class=md-nav__item> <a href=#ch5_tab_53_cves-with-more-than-1000-days-between-patching-and-exploitation-dateall-vendors class=md-nav__link> <span class=md-ellipsis> Ch5_Tab_5.3_CVEs with more than 1000 days between Patching and Exploitation Date(All vendors) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../cpe-cve-old-vs-new/ class=md-nav__link> <span class=md-ellipsis> CVE-CPE Differences Analysis </span> </a> </li> <li class=md-nav__item> <a href=../cwe-cve-old-vs-new/ class=md-nav__link> <span class=md-ellipsis> CVE-CWE Differences Analysis </span> </a> </li> <li class=md-nav__item> <a href=../exploit-discrepancies-comprehensive/ class=md-nav__link> <span class=md-ellipsis> Exploit Discrepancies Analysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../superset-playground/ class=md-nav__link> <span class=md-ellipsis> Superset Analytics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../research/ class=md-nav__link> <span class=md-ellipsis> Research Ideas & Exploration </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../publications/ class=md-nav__link> <span class=md-ellipsis> Conference Papers </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../methodology/ class=md-nav__link> <span class=md-ellipsis> Methodology </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../future/ class=md-nav__link> <span class=md-ellipsis> Future Work </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../resources/ class=md-nav__link> <span class=md-ellipsis> Resources </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=chapter-5-lifecycle-analysis-enhanced-multi-vendor>Chapter 5: Lifecycle Analysis (Enhanced Multi-Vendor)<a class=headerlink href=#chapter-5-lifecycle-analysis-enhanced-multi-vendor title="Permanent link">&para;</a></h1> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>This chapter presents enhanced vulnerability lifecycle analysis building upon the transfer report foundation, now incorporating multi-vendor data and advanced statistical modeling techniques including survival analysis and temporal pattern recognition.</p> <h2 id=data-preparation-notes><strong>Data Preparation Notes:</strong><a class=headerlink href=#data-preparation-notes title="Permanent link">&para;</a></h2> <ul> <li><strong>Date Filtering</strong>: All queries implicitly filter date_published or release_date up to '2025-05-13'. You can adjust this date in Superset's time filter or directly in the SQL. </li> <li><strong>Unnesting/Splitting</strong>: For columns like cpes, vendors, and cwe_ids which are comma-separated strings, STRING_SPLIT_BY_REGEX is used to convert them into arrays, followed by UNNEST to expand them into separate rows for aggregation. </li> <li><strong>Patch Data Unification</strong>: For analyses requiring comprehensive patch data across vendors, a UNION ALL approach is used to combine msrc_patches, redhat_patches, cisco_patches, github_advisories, and morefixes_fixes. </li> <li><strong>Red Hat Filtering</strong>: Remember to apply the specified Red Hat product filtering (product_name or product_id containing rh, red hat, red-hat, rhel, enterprise linux, baseos, appstream, openshift) for official Red Hat products. This is included in the Red Hat specific queries. </li> <li><strong>GitHub Advisories</strong>: github_advisories is included where patched = 1 or patch_available = 1. </li> <li><strong>MoreFixes</strong>: morefixes_fixes is joined with morefixes_commits to get the author_date as the patch date. </li> </ul> <style>
    /* Styling for the lazy-load button */
    .superset-embed-wrapper {
        position: relative;
        width: 100%;
        height: 100%; /* Or whatever height you need */
        border: 2px solid #ddd;
        border-radius: 8px;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #f9f9f9;
        flex-direction: column;
        gap: 1em;
    }

    .superset-embed-wrapper iframe {
        width: 100%;
        height: 100%;
        border: none;
        display: none; /* Initially hide the iframe */
    }

    .load-dashboard-button {
        padding: 12px 24px;
        font-size: 1.2em;
        font-weight: bold;
        color: #fff;
        background-color: #007bff;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .load-dashboard-button:hover {
        background-color: #0056b3;
        transform: scale(1.05);
    }
</style> <div class=superset-embed-wrapper id=dashboard-wrapper> <button class=load-dashboard-button onclick=loadDashboard()>Load CVE Life-cycle Analysis Dashboard</button> <iframe width=100% height=1080px seamless frameborder=0 scrolling=yes data-src="https://analytic.ifthreat.com/superset/dashboard/chapter-5/?standalone=1&height=1080&show_filters=1" loading=lazy> </iframe> </div> <p class=chart-caption style="margin-top: 10px;">📊 Chapter 5: Complete CVE Life Cycle Analysis Dashboard - Interactive Multi-Vendor Analysis</p> <script>
    function loadDashboard() {
        const wrapper = document.getElementById('dashboard-wrapper');
        const iframe = wrapper.querySelector('iframe');
        const button = wrapper.querySelector('.load-dashboard-button');

        // Set the iframe's src from the data-src attribute
        iframe.src = iframe.dataset.src;

        // Show the iframe and hide the button
        iframe.style.display = 'block';
        button.style.display = 'none';

        // Optional: Hide the button's parent wrapper if desired
        wrapper.classList.remove('superset-embed-wrapper');
        wrapper.style.border = 'none';
        wrapper.style.backgroundColor = 'transparent';
    }
</script> <h2 id=lifecycle-analysis><strong>Lifecycle Analysis</strong><a class=headerlink href=#lifecycle-analysis title="Permanent link">&para;</a></h2> <h3 id=ch5_fig_51_distribution-of-vulnerability-lifecycle-events-2016-2025-for-microsoft><strong>Ch5_Fig_5.1_Distribution of Vulnerability Lifecycle Events (2016-2025) for Microsoft</strong><a class=headerlink href=#ch5_fig_51_distribution-of-vulnerability-lifecycle-events-2016-2025-for-microsoft title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: What is the temporal distribution of key vulnerability lifecycle events (disclosure, exploit, patch) for Microsoft? </li> <li> <p><strong>SQL Query</strong>:<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=k>WITH</span><span class=w> </span><span class=n>microsoft_cves</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>    </span><span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>UNNEST</span><span class=p>(</span><span class=n>STRING_SPLIT</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>cpes</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cpe_unnest</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>)</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>SPLIT_PART</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;:&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>))</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;microsoft&#39;</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=p>),</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=n>lifecycle_events</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=w>        </span><span class=s1>&#39;CVE Reserved&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_count</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_cves</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>date_added</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=w>        </span><span class=s1>&#39;Exploit Added&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_count</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_cves</span><span class=p>)</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_added</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_added</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a><span class=w>        </span><span class=s1>&#39;Patch Released&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_count</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_cves</span><span class=p>)</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a><span class=p>)</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a><span class=w>    </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a><span class=w>    </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a><span class=w>    </span><span class=n>event_count</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a><span class=k>FROM</span><span class=w> </span><span class=n>lifecycle_events</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>event_type</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Line Chart </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: year </li> <li><strong>Y-axis</strong>: event_count </li> <li><strong>Group By</strong>: event_type </li> <li><strong>Time Range</strong>: Custom, 2016-01-01 to 2025-05-13</li> </ul> <h3 id=ch5_fig_51_multi_vendor_distribution-of-vulnerability-lifecycle-events-2016-2025-for-all-vendors><strong>Ch5_Fig_5.1_Multi_Vendor_Distribution of Vulnerability Lifecycle Events (2016-2025) for All Vendors</strong><a class=headerlink href=#ch5_fig_51_multi_vendor_distribution-of-vulnerability-lifecycle-events-2016-2025-for-all-vendors title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: What is the temporal distribution of key vulnerability lifecycle events (disclosure, exploit, patch) for All vendors? </li> </ul> <div class="language-sql highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=k>WITH</span><span class=w> </span><span class=n>vendor_cves</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>SPLIT_PART</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;:&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>))</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;microsoft&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Microsoft&#39;</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>SPLIT_PART</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;:&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>))</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;cisco&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Cisco&#39;</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>SPLIT_PART</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;:&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>))</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;redhat&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;red_hat&#39;</span><span class=p>)</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;RedHat&#39;</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=w>    </span><span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>UNNEST</span><span class=p>(</span><span class=n>STRING_SPLIT</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>cpes</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cpe_unnest</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>)</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>SPLIT_PART</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;:&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>))</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;microsoft&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;cisco&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;redhat&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;red_hat&#39;</span><span class=p>)</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=p>),</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=n>multi_vendor_lifecycle_events</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>vc</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=w>        </span><span class=n>vc</span><span class=p>.</span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=w>        </span><span class=s1>&#39;CVE Reserved&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>vc</span><span class=p>.</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_count</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>vendor_cves</span><span class=w> </span><span class=n>vc</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=w>        </span><span class=n>vc</span><span class=p>.</span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a><span class=w>        </span><span class=s1>&#39;Exploit Published&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_count</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>vendor_cves</span><span class=w> </span><span class=n>vc</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vc</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span><span class=w> </span>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a><span class=w>        </span><span class=s1>&#39;Microsoft&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a><span class=w>        </span><span class=s1>&#39;Patch Released&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_count</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>vendor_cves</span><span class=w> </span><span class=n>vc</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vc</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>vc</span><span class=p>.</span><span class=n>vendor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Microsoft&#39;</span>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span><span class=w> </span>
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-1-51><a id=__codelineno-1-51 name=__codelineno-1-51 href=#__codelineno-1-51></a>
</span><span id=__span-1-52><a id=__codelineno-1-52 name=__codelineno-1-52 href=#__codelineno-1-52></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-1-53><a id=__codelineno-1-53 name=__codelineno-1-53 href=#__codelineno-1-53></a>
</span><span id=__span-1-54><a id=__codelineno-1-54 name=__codelineno-1-54 href=#__codelineno-1-54></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-1-55><a id=__codelineno-1-55 name=__codelineno-1-55 href=#__codelineno-1-55></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-1-56><a id=__codelineno-1-56 name=__codelineno-1-56 href=#__codelineno-1-56></a><span class=w>        </span><span class=s1>&#39;Cisco&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-1-57><a id=__codelineno-1-57 name=__codelineno-1-57 href=#__codelineno-1-57></a><span class=w>        </span><span class=s1>&#39;Patch Released&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-1-58><a id=__codelineno-1-58 name=__codelineno-1-58 href=#__codelineno-1-58></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_count</span>
</span><span id=__span-1-59><a id=__codelineno-1-59 name=__codelineno-1-59 href=#__codelineno-1-59></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span>
</span><span id=__span-1-60><a id=__codelineno-1-60 name=__codelineno-1-60 href=#__codelineno-1-60></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>vendor_cves</span><span class=w> </span><span class=n>vc</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vc</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>vc</span><span class=p>.</span><span class=n>vendor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Cisco&#39;</span>
</span><span id=__span-1-61><a id=__codelineno-1-61 name=__codelineno-1-61 href=#__codelineno-1-61></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span><span class=w> </span>
</span><span id=__span-1-62><a id=__codelineno-1-62 name=__codelineno-1-62 href=#__codelineno-1-62></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-1-63><a id=__codelineno-1-63 name=__codelineno-1-63 href=#__codelineno-1-63></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-1-64><a id=__codelineno-1-64 name=__codelineno-1-64 href=#__codelineno-1-64></a>
</span><span id=__span-1-65><a id=__codelineno-1-65 name=__codelineno-1-65 href=#__codelineno-1-65></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-1-66><a id=__codelineno-1-66 name=__codelineno-1-66 href=#__codelineno-1-66></a>
</span><span id=__span-1-67><a id=__codelineno-1-67 name=__codelineno-1-67 href=#__codelineno-1-67></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-1-68><a id=__codelineno-1-68 name=__codelineno-1-68 href=#__codelineno-1-68></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-1-69><a id=__codelineno-1-69 name=__codelineno-1-69 href=#__codelineno-1-69></a><span class=w>        </span><span class=s1>&#39;RedHat&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-1-70><a id=__codelineno-1-70 name=__codelineno-1-70 href=#__codelineno-1-70></a><span class=w>        </span><span class=s1>&#39;Patch Released&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-1-71><a id=__codelineno-1-71 name=__codelineno-1-71 href=#__codelineno-1-71></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_count</span>
</span><span id=__span-1-72><a id=__codelineno-1-72 name=__codelineno-1-72 href=#__codelineno-1-72></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span>
</span><span id=__span-1-73><a id=__codelineno-1-73 name=__codelineno-1-73 href=#__codelineno-1-73></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>vendor_cves</span><span class=w> </span><span class=n>vc</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vc</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>vc</span><span class=p>.</span><span class=n>vendor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;RedHat&#39;</span>
</span><span id=__span-1-74><a id=__codelineno-1-74 name=__codelineno-1-74 href=#__codelineno-1-74></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span><span class=w> </span>
</span><span id=__span-1-75><a id=__codelineno-1-75 name=__codelineno-1-75 href=#__codelineno-1-75></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-1-76><a id=__codelineno-1-76 name=__codelineno-1-76 href=#__codelineno-1-76></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-1-77><a id=__codelineno-1-77 name=__codelineno-1-77 href=#__codelineno-1-77></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rh%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-78><a id=__codelineno-1-78 name=__codelineno-1-78 href=#__codelineno-1-78></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-79><a id=__codelineno-1-79 name=__codelineno-1-79 href=#__codelineno-1-79></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red-hat%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-80><a id=__codelineno-1-80 name=__codelineno-1-80 href=#__codelineno-1-80></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-81><a id=__codelineno-1-81 name=__codelineno-1-81 href=#__codelineno-1-81></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-82><a id=__codelineno-1-82 name=__codelineno-1-82 href=#__codelineno-1-82></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%baseos%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-83><a id=__codelineno-1-83 name=__codelineno-1-83 href=#__codelineno-1-83></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%appstream%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-84><a id=__codelineno-1-84 name=__codelineno-1-84 href=#__codelineno-1-84></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%openshift%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-85><a id=__codelineno-1-85 name=__codelineno-1-85 href=#__codelineno-1-85></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rh%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-86><a id=__codelineno-1-86 name=__codelineno-1-86 href=#__codelineno-1-86></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-87><a id=__codelineno-1-87 name=__codelineno-1-87 href=#__codelineno-1-87></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red-hat%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-88><a id=__codelineno-1-88 name=__codelineno-1-88 href=#__codelineno-1-88></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-89><a id=__codelineno-1-89 name=__codelineno-1-89 href=#__codelineno-1-89></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-90><a id=__codelineno-1-90 name=__codelineno-1-90 href=#__codelineno-1-90></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%baseos%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-91><a id=__codelineno-1-91 name=__codelineno-1-91 href=#__codelineno-1-91></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%appstream%&#39;</span><span class=w> </span><span class=k>OR</span>
</span><span id=__span-1-92><a id=__codelineno-1-92 name=__codelineno-1-92 href=#__codelineno-1-92></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%openshift%&#39;</span>
</span><span id=__span-1-93><a id=__codelineno-1-93 name=__codelineno-1-93 href=#__codelineno-1-93></a><span class=w>        </span><span class=p>)</span>
</span><span id=__span-1-94><a id=__codelineno-1-94 name=__codelineno-1-94 href=#__codelineno-1-94></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-1-95><a id=__codelineno-1-95 name=__codelineno-1-95 href=#__codelineno-1-95></a><span class=p>)</span>
</span><span id=__span-1-96><a id=__codelineno-1-96 name=__codelineno-1-96 href=#__codelineno-1-96></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-1-97><a id=__codelineno-1-97 name=__codelineno-1-97 href=#__codelineno-1-97></a><span class=w>    </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-1-98><a id=__codelineno-1-98 name=__codelineno-1-98 href=#__codelineno-1-98></a><span class=w>    </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-1-99><a id=__codelineno-1-99 name=__codelineno-1-99 href=#__codelineno-1-99></a><span class=w>    </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-1-100><a id=__codelineno-1-100 name=__codelineno-1-100 href=#__codelineno-1-100></a><span class=w>    </span><span class=n>event_count</span>
</span><span id=__span-1-101><a id=__codelineno-1-101 name=__codelineno-1-101 href=#__codelineno-1-101></a><span class=k>FROM</span><span class=w> </span><span class=n>multi_vendor_lifecycle_events</span>
</span><span id=__span-1-102><a id=__codelineno-1-102 name=__codelineno-1-102 href=#__codelineno-1-102></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span><span class=w> </span><span class=n>event_type</span><span class=p>;</span>
</span></code></pre></div> <h3 id=ch5_fig_52_distribution-of-exploit-publication-timing-relative-to-cve-reservation-1999-2025><strong>Ch5_Fig_5.2_Distribution of exploit publication timing relative to CVE reservation (1999-2025)</strong><a class=headerlink href=#ch5_fig_52_distribution-of-exploit-publication-timing-relative-to-cve-reservation-1999-2025 title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: How has the timing of exploit publication relative to CVE disclosure evolved over the years? </li> <li> <p><strong>SQL Query</strong>:<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>WITH</span><span class=w> </span><span class=n>cve_exploit_timing</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Pre-CVE Exploit&#39;</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Zero-Day Exploit&#39;</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Post-CVE Exploit&#39;</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_timing_category</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;1999-01-01&#39;</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=p>)</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=w>    </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=w>    </span><span class=n>exploit_timing_category</span><span class=p>,</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=k>FROM</span><span class=w> </span><span class=n>cve_exploit_timing</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>exploit_timing_category</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>exploit_timing_category</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Stacked Bar Chart </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: year </li> <li><strong>Y-axis</strong>: cve_count </li> <li><strong>Stack By</strong>: exploit_timing_category </li> <li><strong>Time Range</strong>: Custom, e.g., 1999-01-01 to 2025-05-13</li> </ul> <h3 id=ch5_fig_53_cve-exploitation-race-pattern-1999-2025><strong>Ch5_Fig_5.3_CVE exploitation race pattern (1999-2025)</strong><a class=headerlink href=#ch5_fig_53_cve-exploitation-race-pattern-1999-2025 title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: What is the overall trend in the "race" between CVE disclosure and exploit publication? </li> <li> <p><strong>SQL Query</strong>: (This query calculates percentages for a stacked percentage line chart.)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>WITH</span><span class=w> </span><span class=n>exploit_timing_percentages</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Pre-CVE Exploit&#39;</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Zero-Day Exploit&#39;</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Post-CVE Exploit&#39;</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_timing_category</span><span class=p>,</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;1999-01-01&#39;</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>exploit_timing_category</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class=p>),</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class=n>yearly_totals</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a><span class=w>        </span><span class=k>SUM</span><span class=p>(</span><span class=n>cve_count</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_cves_per_year</span>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>exploit_timing_percentages</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a><span class=p>)</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a><span class=w>    </span><span class=n>etp</span><span class=p>.</span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class=w>    </span><span class=n>etp</span><span class=p>.</span><span class=n>exploit_timing_category</span><span class=p>,</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a><span class=w>    </span><span class=n>etp</span><span class=p>.</span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a><span class=w>    </span><span class=n>ROUND</span><span class=p>(</span><span class=n>etp</span><span class=p>.</span><span class=n>cve_count</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>100</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>yt</span><span class=p>.</span><span class=n>total_cves_per_year</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>percentage</span>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a><span class=k>FROM</span><span class=w> </span><span class=n>exploit_timing_percentages</span><span class=w> </span><span class=n>etp</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a><span class=k>JOIN</span><span class=w> </span><span class=n>yearly_totals</span><span class=w> </span><span class=n>yt</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>etp</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>yt</span><span class=p>.</span><span class=k>year</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>etp</span><span class=p>.</span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>percentage</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Stacked Percentage Line Chart </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: year </li> <li><strong>Y-axis</strong>: percentage </li> <li><strong>Stack By</strong>: exploit_timing_category </li> <li><strong>Time Range</strong>: Custom, e.g., 1999-01-01 to 2025-05-13 </li> <li><strong>Chart Options</strong>: Set Y-axis to percentage format.</li> </ul> <h3 id=ch5_fig_54_distribution-of-microsoft-specific-exploit-timing-relative-to-cve-reservation-1999-2025><strong>Ch5_Fig_5.4_Distribution of Microsoft-specific exploit timing relative to CVE reservation (1999-2025)</strong><a class=headerlink href=#ch5_fig_54_distribution-of-microsoft-specific-exploit-timing-relative-to-cve-reservation-1999-2025 title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: How has the timing of exploit publication for Microsoft vulnerabilities evolved relative to their disclosure? </li> <li> <p><strong>SQL Query</strong>:<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>WITH</span><span class=w> </span><span class=n>microsoft_cves</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>    </span><span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>UNNEST</span><span class=p>(</span><span class=n>STRING_SPLIT</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>cpes</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cpe_unnest</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>)</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>SPLIT_PART</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;:&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>))</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;microsoft&#39;</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;1999-01-01&#39;</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=p>),</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=n>microsoft_exploit_timing</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Pre-CVE Exploit&#39;</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Zero-Day Exploit&#39;</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Post-CVE Exploit&#39;</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_timing_category</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_cves</span><span class=p>)</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a><span class=p>)</span>
</span><span id=__span-4-29><a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-4-30><a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a><span class=w>    </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-4-31><a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a><span class=w>    </span><span class=n>exploit_timing_category</span><span class=p>,</span>
</span><span id=__span-4-32><a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a><span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span>
</span><span id=__span-4-33><a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_exploit_timing</span>
</span><span id=__span-4-34><a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>exploit_timing_category</span>
</span><span id=__span-4-35><a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>exploit_timing_category</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Stacked Bar Chart </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: year </li> <li><strong>Y-axis</strong>: cve_count </li> <li><strong>Stack By</strong>: exploit_timing_category </li> <li><strong>Time Range</strong>: Custom, e.g., 1999-01-01 to 2025-05-13</li> </ul> <h3 id=ch5_fig_55_microsoft-patched-vulnerabilities-by-year-2016-2025><strong>Ch5_Fig_5.5_Microsoft Patched Vulnerabilities by Year (2016-2025)</strong><a class=headerlink href=#ch5_fig_55_microsoft-patched-vulnerabilities-by-year-2016-2025 title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: How has the volume of patches released by Microsoft changed annually? </li> <li> <p><strong>SQL Query</strong>:<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>    </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>initial_release_date</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patched_cve_count</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=k>WHERE</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span><span class=w> </span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Bar Chart </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: year </li> <li><strong>Y-axis</strong>: patched_cve_count </li> <li><strong>Time Range</strong>: Custom, 2016-01-01 to 2025-05-13</li> </ul> <h3 id=ch5_fig_55_multi_vendor_patched-vulnerabilities-by-year-2016-2025><strong>Ch5_Fig_5.5_Multi_Vendor_Patched Vulnerabilities by Year (2016-2025)</strong><a class=headerlink href=#ch5_fig_55_multi_vendor_patched-vulnerabilities-by-year-2016-2025 title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: How has the volume of patches released by all vendors changed annually?</li> <li><strong>SQL Query</strong>: <div class="language-sql highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=k>WITH</span><span class=w> </span><span class=n>unified_patches</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>        </span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>        </span><span class=s1>&#39;Microsoft&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span><span class=w> </span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=w>        </span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>        </span><span class=s1>&#39;RedHat&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a><span class=w>        </span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a><span class=w>        </span><span class=s1>&#39;Cisco&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-6-33><a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a><span class=p>)</span>
</span><span id=__span-6-34><a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-6-35><a id=__codelineno-6-35 name=__codelineno-6-35 href=#__codelineno-6-35></a><span class=w>    </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>patch_date</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-6-36><a id=__codelineno-6-36 name=__codelineno-6-36 href=#__codelineno-6-36></a><span class=w>    </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-6-37><a id=__codelineno-6-37 name=__codelineno-6-37 href=#__codelineno-6-37></a><span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patched_cve_count</span>
</span><span id=__span-6-38><a id=__codelineno-6-38 name=__codelineno-6-38 href=#__codelineno-6-38></a><span class=k>FROM</span><span class=w> </span><span class=n>unified_patches</span>
</span><span id=__span-6-39><a id=__codelineno-6-39 name=__codelineno-6-39 href=#__codelineno-6-39></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>vendor</span>
</span><span id=__span-6-40><a id=__codelineno-6-40 name=__codelineno-6-40 href=#__codelineno-6-40></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>vendor</span><span class=p>;</span>
</span></code></pre></div></li> </ul> <h3 id=ch5_fig_56_time-to-patch-by-vulnerability-severity><strong>Ch5_Fig_5.6_Time to Patch by Vulnerability Severity</strong><a class=headerlink href=#ch5_fig_56_time-to-patch-by-vulnerability-severity title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: How does the time it takes to release a patch vary by the vulnerability's severity? </li> <li> <p><strong>SQL Query</strong>: (This query uses msrc_patches for Microsoft-specific data as per the original figure. You could adapt it to use unified_patches for an overall view.)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>WITH</span><span class=w> </span><span class=n>microsoft_patch_timing</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>,</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=p>,</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;CRITICAL&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=p>)</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=p>)</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=w>    </span><span class=n>cvss_v3_severity</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=w>    </span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_days_to_patch</span><span class=p>,</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_patch_timing</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=k>WHERE</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span><span class=w>  </span><span class=c1>-- Filter out negative values (patch before CVE reserved)</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>cvss_v3_severity</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a><span class=w>    </span><span class=k>CASE</span><span class=w> </span><span class=n>cvss_v3_severity</span><span class=w> </span>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span><span class=w> </span>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span><span class=w> </span>
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span><span class=w> </span>
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a><span class=w>    </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Bar Chart </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: severity_level </li> <li><strong>Y-axis</strong>: median_days_to_patch </li> <li><strong>Sort By</strong>: Custom order (Critical, High, Medium, Low)</li> </ul> <h3 id=ch5_fig_56_multi-vendor-time-to-patch-by-vulnerability-severity><strong>Ch5_Fig_5.6_Multi-vendor Time to Patch by Vulnerability Severity</strong><a class=headerlink href=#ch5_fig_56_multi-vendor-time-to-patch-by-vulnerability-severity title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: How does the time it takes to release a patch vary by the vulnerability's severity? </li> <li><strong>SQL Query</strong>: (This query for all vendors) </li> </ul> <div class="language-sql highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>WITH</span><span class=w> </span><span class=n>unified_patch_timing</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=w>    </span><span class=c1>-- Microsoft</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=p>,</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=w>        </span><span class=s1>&#39;Microsoft&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;CRITICAL&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=p>)</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=w>    </span><span class=c1>-- RedHat</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=w>        </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=p>,</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=w>        </span><span class=s1>&#39;RedHat&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;CRITICAL&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=p>)</span>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a>
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a>
</span><span id=__span-8-39><a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a><span class=w>    </span><span class=c1>-- Cisco</span>
</span><span id=__span-8-40><a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-8-41><a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-8-42><a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-8-43><a id=__codelineno-8-43 name=__codelineno-8-43 href=#__codelineno-8-43></a><span class=w>        </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-8-44><a id=__codelineno-8-44 name=__codelineno-8-44 href=#__codelineno-8-44></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=p>,</span>
</span><span id=__span-8-45><a id=__codelineno-8-45 name=__codelineno-8-45 href=#__codelineno-8-45></a><span class=w>        </span><span class=s1>&#39;Cisco&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-8-46><a id=__codelineno-8-46 name=__codelineno-8-46 href=#__codelineno-8-46></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-8-47><a id=__codelineno-8-47 name=__codelineno-8-47 href=#__codelineno-8-47></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-8-48><a id=__codelineno-8-48 name=__codelineno-8-48 href=#__codelineno-8-48></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-8-49><a id=__codelineno-8-49 name=__codelineno-8-49 href=#__codelineno-8-49></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;CRITICAL&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=p>)</span>
</span><span id=__span-8-50><a id=__codelineno-8-50 name=__codelineno-8-50 href=#__codelineno-8-50></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-8-51><a id=__codelineno-8-51 name=__codelineno-8-51 href=#__codelineno-8-51></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-8-52><a id=__codelineno-8-52 name=__codelineno-8-52 href=#__codelineno-8-52></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-8-53><a id=__codelineno-8-53 name=__codelineno-8-53 href=#__codelineno-8-53></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-8-54><a id=__codelineno-8-54 name=__codelineno-8-54 href=#__codelineno-8-54></a><span class=p>)</span>
</span><span id=__span-8-55><a id=__codelineno-8-55 name=__codelineno-8-55 href=#__codelineno-8-55></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-8-56><a id=__codelineno-8-56 name=__codelineno-8-56 href=#__codelineno-8-56></a><span class=w>    </span><span class=n>cvss_v3_severity</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-8-57><a id=__codelineno-8-57 name=__codelineno-8-57 href=#__codelineno-8-57></a><span class=w>    </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-8-58><a id=__codelineno-8-58 name=__codelineno-8-58 href=#__codelineno-8-58></a><span class=w>    </span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-8-59><a id=__codelineno-8-59 name=__codelineno-8-59 href=#__codelineno-8-59></a><span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-8-60><a id=__codelineno-8-60 name=__codelineno-8-60 href=#__codelineno-8-60></a><span class=k>FROM</span><span class=w> </span><span class=n>unified_patch_timing</span>
</span><span id=__span-8-61><a id=__codelineno-8-61 name=__codelineno-8-61 href=#__codelineno-8-61></a><span class=k>WHERE</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-8-62><a id=__codelineno-8-62 name=__codelineno-8-62 href=#__codelineno-8-62></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>cvss_v3_severity</span><span class=p>,</span><span class=w> </span><span class=n>vendor</span>
</span><span id=__span-8-63><a id=__codelineno-8-63 name=__codelineno-8-63 href=#__codelineno-8-63></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span>
</span><span id=__span-8-64><a id=__codelineno-8-64 name=__codelineno-8-64 href=#__codelineno-8-64></a><span class=w>    </span><span class=k>CASE</span><span class=w> </span><span class=n>cvss_v3_severity</span><span class=w> </span>
</span><span id=__span-8-65><a id=__codelineno-8-65 name=__codelineno-8-65 href=#__codelineno-8-65></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span>
</span><span id=__span-8-66><a id=__codelineno-8-66 name=__codelineno-8-66 href=#__codelineno-8-66></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span><span class=w> </span>
</span><span id=__span-8-67><a id=__codelineno-8-67 name=__codelineno-8-67 href=#__codelineno-8-67></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span><span class=w> </span>
</span><span id=__span-8-68><a id=__codelineno-8-68 name=__codelineno-8-68 href=#__codelineno-8-68></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span><span class=w> </span>
</span><span id=__span-8-69><a id=__codelineno-8-69 name=__codelineno-8-69 href=#__codelineno-8-69></a><span class=w>    </span><span class=k>END</span><span class=p>,</span><span class=w> </span><span class=n>vendor</span><span class=p>;</span>
</span></code></pre></div> <h3 id=ch5_fig_57_distribution-of-differences-in-days-between-exploit-adding-date-and-cve-creation-date-for-microsoft-products><strong>Ch5_Fig_5.7_Distribution of differences in days between Exploit Adding date and CVE Creation date for Microsoft products</strong><a class=headerlink href=#ch5_fig_57_distribution-of-differences-in-days-between-exploit-adding-date-and-cve-creation-date-for-microsoft-products title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: What is the typical time gap between CVE disclosure and exploit publication for Microsoft products? </li> <li> <p><strong>SQL Query</strong>:<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=k>WITH</span><span class=w> </span><span class=n>microsoft_cves</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>    </span><span class=c1>-- Identify distinct CVEs related to Microsoft, applying initial filters.</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=w>    </span><span class=c1>-- This CTE handles the unnesting robustly for DuckDB.</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=w>    </span><span class=p>,</span><span class=w> </span><span class=k>UNNEST</span><span class=p>(</span><span class=n>STRING_SPLIT</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>cpes</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cpe_entry</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>SPLIT_PART</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>.</span><span class=n>value</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;:&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>))</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;microsoft&#39;</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cpes</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cpes</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;&#39;</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=p>),</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=n>microsoft_exploit_gaps</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=w>    </span><span class=c1>-- Calculate the days_to_exploit for identified Microsoft CVEs with exploits.</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_exploit</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_cves</span><span class=p>)</span>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a><span class=p>),</span>
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a><span class=c1>-- Assign categories to each exploit gap record for easier grouping</span>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-9-29><a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-9-30><a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-9-31><a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a><span class=w>        </span><span class=n>days_to_exploit</span><span class=p>,</span>
</span><span id=__span-9-32><a id=__codelineno-9-32 name=__codelineno-9-32 href=#__codelineno-9-32></a><span class=w>        </span><span class=k>CASE</span>
</span><span id=__span-9-33><a id=__codelineno-9-33 name=__codelineno-9-33 href=#__codelineno-9-33></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span>
</span><span id=__span-9-34><a id=__codelineno-9-34 name=__codelineno-9-34 href=#__codelineno-9-34></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>181</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span>
</span><span id=__span-9-35><a id=__codelineno-9-35 name=__codelineno-9-35 href=#__codelineno-9-35></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>180</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>91</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span>
</span><span id=__span-9-36><a id=__codelineno-9-36 name=__codelineno-9-36 href=#__codelineno-9-36></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>90</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>31</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span>
</span><span id=__span-9-37><a id=__codelineno-9-37 name=__codelineno-9-37 href=#__codelineno-9-37></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>30</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span>
</span><span id=__span-9-38><a id=__codelineno-9-38 name=__codelineno-9-38 href=#__codelineno-9-38></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span>
</span><span id=__span-9-39><a id=__codelineno-9-39 name=__codelineno-9-39 href=#__codelineno-9-39></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>30</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span>
</span><span id=__span-9-40><a id=__codelineno-9-40 name=__codelineno-9-40 href=#__codelineno-9-40></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>31</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>90</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span>
</span><span id=__span-9-41><a id=__codelineno-9-41 name=__codelineno-9-41 href=#__codelineno-9-41></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>91</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>180</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span>
</span><span id=__span-9-42><a id=__codelineno-9-42 name=__codelineno-9-42 href=#__codelineno-9-42></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>181</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span>
</span><span id=__span-9-43><a id=__codelineno-9-43 name=__codelineno-9-43 href=#__codelineno-9-43></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span>
</span><span id=__span-9-44><a id=__codelineno-9-44 name=__codelineno-9-44 href=#__codelineno-9-44></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span>
</span><span id=__span-9-45><a id=__codelineno-9-45 name=__codelineno-9-45 href=#__codelineno-9-45></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-9-46><a id=__codelineno-9-46 name=__codelineno-9-46 href=#__codelineno-9-46></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_exploit_gaps</span>
</span><span id=__span-9-47><a id=__codelineno-9-47 name=__codelineno-9-47 href=#__codelineno-9-47></a><span class=p>),</span>
</span><span id=__span-9-48><a id=__codelineno-9-48 name=__codelineno-9-48 href=#__codelineno-9-48></a><span class=c1>-- Calculate statistics for each category (count, avg, median, mode)</span>
</span><span id=__span-9-49><a id=__codelineno-9-49 name=__codelineno-9-49 href=#__codelineno-9-49></a><span class=n>categorized_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-9-50><a id=__codelineno-9-50 name=__codelineno-9-50 href=#__codelineno-9-50></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-9-51><a id=__codelineno-9-51 name=__codelineno-9-51 href=#__codelineno-9-51></a><span class=w>        </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-9-52><a id=__codelineno-9-52 name=__codelineno-9-52 href=#__codelineno-9-52></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-9-53><a id=__codelineno-9-53 name=__codelineno-9-53 href=#__codelineno-9-53></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>days_to_exploit</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_days_to_exploit</span><span class=p>,</span>
</span><span id=__span-9-54><a id=__codelineno-9-54 name=__codelineno-9-54 href=#__codelineno-9-54></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_exploit</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_exploit</span><span class=p>,</span>
</span><span id=__span-9-55><a id=__codelineno-9-55 name=__codelineno-9-55 href=#__codelineno-9-55></a><span class=w>        </span><span class=c1>-- Subquery to calculate mode for the current category</span>
</span><span id=__span-9-56><a id=__codelineno-9-56 name=__codelineno-9-56 href=#__codelineno-9-56></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-9-57><a id=__codelineno-9-57 name=__codelineno-9-57 href=#__codelineno-9-57></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>days_to_exploit</span>
</span><span id=__span-9-58><a id=__codelineno-9-58 name=__codelineno-9-58 href=#__codelineno-9-58></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sub</span>
</span><span id=__span-9-59><a id=__codelineno-9-59 name=__codelineno-9-59 href=#__codelineno-9-59></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>sub</span><span class=p>.</span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=p>.</span><span class=n>time_gap_category</span>
</span><span id=__span-9-60><a id=__codelineno-9-60 name=__codelineno-9-60 href=#__codelineno-9-60></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>days_to_exploit</span>
</span><span id=__span-9-61><a id=__codelineno-9-61 name=__codelineno-9-61 href=#__codelineno-9-61></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>ASC</span><span class=w> </span><span class=c1>-- Order by value for consistent tie-breaking</span>
</span><span id=__span-9-62><a id=__codelineno-9-62 name=__codelineno-9-62 href=#__codelineno-9-62></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-9-63><a id=__codelineno-9-63 name=__codelineno-9-63 href=#__codelineno-9-63></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days_to_exploit</span>
</span><span id=__span-9-64><a id=__codelineno-9-64 name=__codelineno-9-64 href=#__codelineno-9-64></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span>
</span><span id=__span-9-65><a id=__codelineno-9-65 name=__codelineno-9-65 href=#__codelineno-9-65></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-9-66><a id=__codelineno-9-66 name=__codelineno-9-66 href=#__codelineno-9-66></a><span class=p>),</span>
</span><span id=__span-9-67><a id=__codelineno-9-67 name=__codelineno-9-67 href=#__codelineno-9-67></a><span class=c1>-- Calculate overall statistics (count, avg, median, mode)</span>
</span><span id=__span-9-68><a id=__codelineno-9-68 name=__codelineno-9-68 href=#__codelineno-9-68></a><span class=n>overall_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-9-69><a id=__codelineno-9-69 name=__codelineno-9-69 href=#__codelineno-9-69></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-9-70><a id=__codelineno-9-70 name=__codelineno-9-70 href=#__codelineno-9-70></a><span class=w>        </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-9-71><a id=__codelineno-9-71 name=__codelineno-9-71 href=#__codelineno-9-71></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-9-72><a id=__codelineno-9-72 name=__codelineno-9-72 href=#__codelineno-9-72></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>days_to_exploit</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_days_to_exploit</span><span class=p>,</span>
</span><span id=__span-9-73><a id=__codelineno-9-73 name=__codelineno-9-73 href=#__codelineno-9-73></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_exploit</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_exploit</span><span class=p>,</span>
</span><span id=__span-9-74><a id=__codelineno-9-74 name=__codelineno-9-74 href=#__codelineno-9-74></a><span class=w>        </span><span class=c1>-- Subquery to calculate overall mode</span>
</span><span id=__span-9-75><a id=__codelineno-9-75 name=__codelineno-9-75 href=#__codelineno-9-75></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-9-76><a id=__codelineno-9-76 name=__codelineno-9-76 href=#__codelineno-9-76></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>days_to_exploit</span>
</span><span id=__span-9-77><a id=__codelineno-9-77 name=__codelineno-9-77 href=#__codelineno-9-77></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_exploit_gaps</span>
</span><span id=__span-9-78><a id=__codelineno-9-78 name=__codelineno-9-78 href=#__codelineno-9-78></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>days_to_exploit</span>
</span><span id=__span-9-79><a id=__codelineno-9-79 name=__codelineno-9-79 href=#__codelineno-9-79></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>ASC</span><span class=w> </span><span class=c1>-- Order by value for consistent tie-breaking</span>
</span><span id=__span-9-80><a id=__codelineno-9-80 name=__codelineno-9-80 href=#__codelineno-9-80></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-9-81><a id=__codelineno-9-81 name=__codelineno-9-81 href=#__codelineno-9-81></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days_to_exploit</span>
</span><span id=__span-9-82><a id=__codelineno-9-82 name=__codelineno-9-82 href=#__codelineno-9-82></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_exploit_gaps</span>
</span><span id=__span-9-83><a id=__codelineno-9-83 name=__codelineno-9-83 href=#__codelineno-9-83></a><span class=p>)</span>
</span><span id=__span-9-84><a id=__codelineno-9-84 name=__codelineno-9-84 href=#__codelineno-9-84></a><span class=c1>-- Wrap the UNION ALL in a subquery (derived table) and then apply ORDER BY</span>
</span><span id=__span-9-85><a id=__codelineno-9-85 name=__codelineno-9-85 href=#__codelineno-9-85></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span>
</span><span id=__span-9-86><a id=__codelineno-9-86 name=__codelineno-9-86 href=#__codelineno-9-86></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-9-87><a id=__codelineno-9-87 name=__codelineno-9-87 href=#__codelineno-9-87></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_stats</span>
</span><span id=__span-9-88><a id=__codelineno-9-88 name=__codelineno-9-88 href=#__codelineno-9-88></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-9-89><a id=__codelineno-9-89 name=__codelineno-9-89 href=#__codelineno-9-89></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>overall_stats</span>
</span><span id=__span-9-90><a id=__codelineno-9-90 name=__codelineno-9-90 href=#__codelineno-9-90></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>combined_results</span>
</span><span id=__span-9-91><a id=__codelineno-9-91 name=__codelineno-9-91 href=#__codelineno-9-91></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span>
</span><span id=__span-9-92><a id=__codelineno-9-92 name=__codelineno-9-92 href=#__codelineno-9-92></a><span class=w>    </span><span class=k>CASE</span>
</span><span id=__span-9-93><a id=__codelineno-9-93 name=__codelineno-9-93 href=#__codelineno-9-93></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-9-94><a id=__codelineno-9-94 name=__codelineno-9-94 href=#__codelineno-9-94></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-9-95><a id=__codelineno-9-95 name=__codelineno-9-95 href=#__codelineno-9-95></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-9-96><a id=__codelineno-9-96 name=__codelineno-9-96 href=#__codelineno-9-96></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span>
</span><span id=__span-9-97><a id=__codelineno-9-97 name=__codelineno-9-97 href=#__codelineno-9-97></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>5</span>
</span><span id=__span-9-98><a id=__codelineno-9-98 name=__codelineno-9-98 href=#__codelineno-9-98></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>6</span>
</span><span id=__span-9-99><a id=__codelineno-9-99 name=__codelineno-9-99 href=#__codelineno-9-99></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>7</span>
</span><span id=__span-9-100><a id=__codelineno-9-100 name=__codelineno-9-100 href=#__codelineno-9-100></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>8</span>
</span><span id=__span-9-101><a id=__codelineno-9-101 name=__codelineno-9-101 href=#__codelineno-9-101></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>9</span>
</span><span id=__span-9-102><a id=__codelineno-9-102 name=__codelineno-9-102 href=#__codelineno-9-102></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>10</span>
</span><span id=__span-9-103><a id=__codelineno-9-103 name=__codelineno-9-103 href=#__codelineno-9-103></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>11</span>
</span><span id=__span-9-104><a id=__codelineno-9-104 name=__codelineno-9-104 href=#__codelineno-9-104></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=c1>-- Ensures overall row appears last</span>
</span><span id=__span-9-105><a id=__codelineno-9-105 name=__codelineno-9-105 href=#__codelineno-9-105></a><span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=mi>12</span>
</span><span id=__span-9-106><a id=__codelineno-9-106 name=__codelineno-9-106 href=#__codelineno-9-106></a><span class=w>    </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Histogram </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>Metric</strong>: days_to_exploit </li> <li><strong>Binning</strong>: Adjust bin size as needed (e.g., 30 days)</li> </ul> <h3 id=ch5_fig_571_distribution-of-differences-in-days-between-exploit-adding-date-and-cve-creation-date-all-cves-with-patch-and-exploit><strong>Ch5_Fig_5.7.1_Distribution of differences in days between Exploit Adding date and CVE Creation date (All CVEs with patch and exploit)</strong><a class=headerlink href=#ch5_fig_571_distribution-of-differences-in-days-between-exploit-adding-date-and-cve-creation-date-all-cves-with-patch-and-exploit title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=k>WITH</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w>            </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=w>                </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=w>            </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=w>        </span><span class=p>)</span>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-10-19><a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-10-20><a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-10-21><a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=w>        </span><span class=p>)</span>
</span><span id=__span-10-22><a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a><span class=p>),</span>
</span><span id=__span-10-23><a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a><span class=n>all_exploit_gaps</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-10-24><a id=__codelineno-10-24 name=__codelineno-10-24 href=#__codelineno-10-24></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-10-25><a id=__codelineno-10-25 name=__codelineno-10-25 href=#__codelineno-10-25></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-10-26><a id=__codelineno-10-26 name=__codelineno-10-26 href=#__codelineno-10-26></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-10-27><a id=__codelineno-10-27 name=__codelineno-10-27 href=#__codelineno-10-27></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-10-28><a id=__codelineno-10-28 name=__codelineno-10-28 href=#__codelineno-10-28></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_exploit</span>
</span><span id=__span-10-29><a id=__codelineno-10-29 name=__codelineno-10-29 href=#__codelineno-10-29></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-10-30><a id=__codelineno-10-30 name=__codelineno-10-30 href=#__codelineno-10-30></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-10-31><a id=__codelineno-10-31 name=__codelineno-10-31 href=#__codelineno-10-31></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=p>)</span>
</span><span id=__span-10-32><a id=__codelineno-10-32 name=__codelineno-10-32 href=#__codelineno-10-32></a><span class=p>),</span>
</span><span id=__span-10-33><a id=__codelineno-10-33 name=__codelineno-10-33 href=#__codelineno-10-33></a><span class=c1>-- Assign the 12 categories to each exploit gap record for grouping and mode calculation</span>
</span><span id=__span-10-34><a id=__codelineno-10-34 name=__codelineno-10-34 href=#__codelineno-10-34></a><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-10-35><a id=__codelineno-10-35 name=__codelineno-10-35 href=#__codelineno-10-35></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-10-36><a id=__codelineno-10-36 name=__codelineno-10-36 href=#__codelineno-10-36></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-10-37><a id=__codelineno-10-37 name=__codelineno-10-37 href=#__codelineno-10-37></a><span class=w>        </span><span class=n>days_to_exploit</span><span class=p>,</span>
</span><span id=__span-10-38><a id=__codelineno-10-38 name=__codelineno-10-38 href=#__codelineno-10-38></a><span class=w>        </span><span class=k>CASE</span>
</span><span id=__span-10-39><a id=__codelineno-10-39 name=__codelineno-10-39 href=#__codelineno-10-39></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span>
</span><span id=__span-10-40><a id=__codelineno-10-40 name=__codelineno-10-40 href=#__codelineno-10-40></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>181</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span>
</span><span id=__span-10-41><a id=__codelineno-10-41 name=__codelineno-10-41 href=#__codelineno-10-41></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>180</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>91</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span>
</span><span id=__span-10-42><a id=__codelineno-10-42 name=__codelineno-10-42 href=#__codelineno-10-42></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>90</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>31</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span>
</span><span id=__span-10-43><a id=__codelineno-10-43 name=__codelineno-10-43 href=#__codelineno-10-43></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>30</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span>
</span><span id=__span-10-44><a id=__codelineno-10-44 name=__codelineno-10-44 href=#__codelineno-10-44></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span>
</span><span id=__span-10-45><a id=__codelineno-10-45 name=__codelineno-10-45 href=#__codelineno-10-45></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>30</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span>
</span><span id=__span-10-46><a id=__codelineno-10-46 name=__codelineno-10-46 href=#__codelineno-10-46></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>31</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>90</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span>
</span><span id=__span-10-47><a id=__codelineno-10-47 name=__codelineno-10-47 href=#__codelineno-10-47></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>91</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>180</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span>
</span><span id=__span-10-48><a id=__codelineno-10-48 name=__codelineno-10-48 href=#__codelineno-10-48></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>181</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span>
</span><span id=__span-10-49><a id=__codelineno-10-49 name=__codelineno-10-49 href=#__codelineno-10-49></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span>
</span><span id=__span-10-50><a id=__codelineno-10-50 name=__codelineno-10-50 href=#__codelineno-10-50></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span>
</span><span id=__span-10-51><a id=__codelineno-10-51 name=__codelineno-10-51 href=#__codelineno-10-51></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-10-52><a id=__codelineno-10-52 name=__codelineno-10-52 href=#__codelineno-10-52></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>all_exploit_gaps</span>
</span><span id=__span-10-53><a id=__codelineno-10-53 name=__codelineno-10-53 href=#__codelineno-10-53></a><span class=p>),</span>
</span><span id=__span-10-54><a id=__codelineno-10-54 name=__codelineno-10-54 href=#__codelineno-10-54></a><span class=c1>-- Calculate statistics for each category (count, avg, median, mode)</span>
</span><span id=__span-10-55><a id=__codelineno-10-55 name=__codelineno-10-55 href=#__codelineno-10-55></a><span class=n>categorized_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-10-56><a id=__codelineno-10-56 name=__codelineno-10-56 href=#__codelineno-10-56></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-10-57><a id=__codelineno-10-57 name=__codelineno-10-57 href=#__codelineno-10-57></a><span class=w>        </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-10-58><a id=__codelineno-10-58 name=__codelineno-10-58 href=#__codelineno-10-58></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-10-59><a id=__codelineno-10-59 name=__codelineno-10-59 href=#__codelineno-10-59></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>days_to_exploit</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_days_to_exploit</span><span class=p>,</span>
</span><span id=__span-10-60><a id=__codelineno-10-60 name=__codelineno-10-60 href=#__codelineno-10-60></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_exploit</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_exploit</span><span class=p>,</span>
</span><span id=__span-10-61><a id=__codelineno-10-61 name=__codelineno-10-61 href=#__codelineno-10-61></a><span class=w>        </span><span class=c1>-- Subquery to calculate mode for the current category</span>
</span><span id=__span-10-62><a id=__codelineno-10-62 name=__codelineno-10-62 href=#__codelineno-10-62></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-10-63><a id=__codelineno-10-63 name=__codelineno-10-63 href=#__codelineno-10-63></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>days_to_exploit</span>
</span><span id=__span-10-64><a id=__codelineno-10-64 name=__codelineno-10-64 href=#__codelineno-10-64></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sub</span>
</span><span id=__span-10-65><a id=__codelineno-10-65 name=__codelineno-10-65 href=#__codelineno-10-65></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>sub</span><span class=p>.</span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=p>.</span><span class=n>time_gap_category</span>
</span><span id=__span-10-66><a id=__codelineno-10-66 name=__codelineno-10-66 href=#__codelineno-10-66></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>days_to_exploit</span>
</span><span id=__span-10-67><a id=__codelineno-10-67 name=__codelineno-10-67 href=#__codelineno-10-67></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-10-68><a id=__codelineno-10-68 name=__codelineno-10-68 href=#__codelineno-10-68></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-10-69><a id=__codelineno-10-69 name=__codelineno-10-69 href=#__codelineno-10-69></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days_to_exploit</span>
</span><span id=__span-10-70><a id=__codelineno-10-70 name=__codelineno-10-70 href=#__codelineno-10-70></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span>
</span><span id=__span-10-71><a id=__codelineno-10-71 name=__codelineno-10-71 href=#__codelineno-10-71></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-10-72><a id=__codelineno-10-72 name=__codelineno-10-72 href=#__codelineno-10-72></a><span class=p>),</span>
</span><span id=__span-10-73><a id=__codelineno-10-73 name=__codelineno-10-73 href=#__codelineno-10-73></a><span class=c1>-- Calculate overall statistics (count, avg, median, mode)</span>
</span><span id=__span-10-74><a id=__codelineno-10-74 name=__codelineno-10-74 href=#__codelineno-10-74></a><span class=n>overall_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-10-75><a id=__codelineno-10-75 name=__codelineno-10-75 href=#__codelineno-10-75></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-10-76><a id=__codelineno-10-76 name=__codelineno-10-76 href=#__codelineno-10-76></a><span class=w>        </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-10-77><a id=__codelineno-10-77 name=__codelineno-10-77 href=#__codelineno-10-77></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-10-78><a id=__codelineno-10-78 name=__codelineno-10-78 href=#__codelineno-10-78></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>days_to_exploit</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_days_to_exploit</span><span class=p>,</span>
</span><span id=__span-10-79><a id=__codelineno-10-79 name=__codelineno-10-79 href=#__codelineno-10-79></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_exploit</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_exploit</span><span class=p>,</span>
</span><span id=__span-10-80><a id=__codelineno-10-80 name=__codelineno-10-80 href=#__codelineno-10-80></a><span class=w>        </span><span class=c1>-- Subquery to calculate overall mode</span>
</span><span id=__span-10-81><a id=__codelineno-10-81 name=__codelineno-10-81 href=#__codelineno-10-81></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-10-82><a id=__codelineno-10-82 name=__codelineno-10-82 href=#__codelineno-10-82></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>days_to_exploit</span>
</span><span id=__span-10-83><a id=__codelineno-10-83 name=__codelineno-10-83 href=#__codelineno-10-83></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>all_exploit_gaps</span>
</span><span id=__span-10-84><a id=__codelineno-10-84 name=__codelineno-10-84 href=#__codelineno-10-84></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>days_to_exploit</span>
</span><span id=__span-10-85><a id=__codelineno-10-85 name=__codelineno-10-85 href=#__codelineno-10-85></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-10-86><a id=__codelineno-10-86 name=__codelineno-10-86 href=#__codelineno-10-86></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-10-87><a id=__codelineno-10-87 name=__codelineno-10-87 href=#__codelineno-10-87></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days_to_exploit</span>
</span><span id=__span-10-88><a id=__codelineno-10-88 name=__codelineno-10-88 href=#__codelineno-10-88></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>all_exploit_gaps</span>
</span><span id=__span-10-89><a id=__codelineno-10-89 name=__codelineno-10-89 href=#__codelineno-10-89></a><span class=p>)</span>
</span><span id=__span-10-90><a id=__codelineno-10-90 name=__codelineno-10-90 href=#__codelineno-10-90></a><span class=c1>-- Wrap the UNION ALL in a subquery (derived table) and then apply ORDER BY</span>
</span><span id=__span-10-91><a id=__codelineno-10-91 name=__codelineno-10-91 href=#__codelineno-10-91></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span>
</span><span id=__span-10-92><a id=__codelineno-10-92 name=__codelineno-10-92 href=#__codelineno-10-92></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-10-93><a id=__codelineno-10-93 name=__codelineno-10-93 href=#__codelineno-10-93></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_stats</span>
</span><span id=__span-10-94><a id=__codelineno-10-94 name=__codelineno-10-94 href=#__codelineno-10-94></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-10-95><a id=__codelineno-10-95 name=__codelineno-10-95 href=#__codelineno-10-95></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>overall_stats</span>
</span><span id=__span-10-96><a id=__codelineno-10-96 name=__codelineno-10-96 href=#__codelineno-10-96></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>combined_results</span>
</span><span id=__span-10-97><a id=__codelineno-10-97 name=__codelineno-10-97 href=#__codelineno-10-97></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span>
</span><span id=__span-10-98><a id=__codelineno-10-98 name=__codelineno-10-98 href=#__codelineno-10-98></a><span class=w>    </span><span class=k>CASE</span>
</span><span id=__span-10-99><a id=__codelineno-10-99 name=__codelineno-10-99 href=#__codelineno-10-99></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-10-100><a id=__codelineno-10-100 name=__codelineno-10-100 href=#__codelineno-10-100></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-10-101><a id=__codelineno-10-101 name=__codelineno-10-101 href=#__codelineno-10-101></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-10-102><a id=__codelineno-10-102 name=__codelineno-10-102 href=#__codelineno-10-102></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span>
</span><span id=__span-10-103><a id=__codelineno-10-103 name=__codelineno-10-103 href=#__codelineno-10-103></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>5</span>
</span><span id=__span-10-104><a id=__codelineno-10-104 name=__codelineno-10-104 href=#__codelineno-10-104></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>6</span>
</span><span id=__span-10-105><a id=__codelineno-10-105 name=__codelineno-10-105 href=#__codelineno-10-105></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>7</span>
</span><span id=__span-10-106><a id=__codelineno-10-106 name=__codelineno-10-106 href=#__codelineno-10-106></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>8</span>
</span><span id=__span-10-107><a id=__codelineno-10-107 name=__codelineno-10-107 href=#__codelineno-10-107></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>9</span>
</span><span id=__span-10-108><a id=__codelineno-10-108 name=__codelineno-10-108 href=#__codelineno-10-108></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>10</span>
</span><span id=__span-10-109><a id=__codelineno-10-109 name=__codelineno-10-109 href=#__codelineno-10-109></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>11</span>
</span><span id=__span-10-110><a id=__codelineno-10-110 name=__codelineno-10-110 href=#__codelineno-10-110></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>12</span>
</span><span id=__span-10-111><a id=__codelineno-10-111 name=__codelineno-10-111 href=#__codelineno-10-111></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=c1>-- Ensures overall row appears last</span>
</span><span id=__span-10-112><a id=__codelineno-10-112 name=__codelineno-10-112 href=#__codelineno-10-112></a><span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=mi>101</span><span class=w> </span><span class=c1>-- Fallback for any unexpected categories</span>
</span><span id=__span-10-113><a id=__codelineno-10-113 name=__codelineno-10-113 href=#__codelineno-10-113></a><span class=w>    </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div> <h3 id=ch5_fig_572_distribution-of-differences-in-days-between-cve-creation-date-and-patch-date-for-microsoft-products><strong>Ch5_Fig_5.7.2_Distribution of differences in days between CVE Creation date and Patch date for Microsoft products</strong><a class=headerlink href=#ch5_fig_572_distribution-of-differences-in-days-between-cve-creation-date-and-patch-date-for-microsoft-products title="Permanent link">&para;</a></h3> <div class="language-sql highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=k>WITH</span><span class=w> </span><span class=n>microsoft_cves_with_patch_and_exploit</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=w>    </span><span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>UNNEST</span><span class=p>(</span><span class=n>STRING_SPLIT</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>cpes</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cpe_unnest</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>)</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>SPLIT_PART</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;:&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>))</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;microsoft&#39;</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=p>),</span>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=n>microsoft_patch_gaps</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_cves_with_patch_and_exploit</span><span class=p>)</span>
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a><span class=p>),</span>
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a><span class=c1>-- Assign the 12 categories to each patch gap record for grouping and mode calculation</span>
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-11-29><a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a><span class=w>        </span><span class=n>days_to_patch</span><span class=p>,</span>
</span><span id=__span-11-30><a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a><span class=w>        </span><span class=k>CASE</span>
</span><span id=__span-11-31><a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span>
</span><span id=__span-11-32><a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>181</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span>
</span><span id=__span-11-33><a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>180</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>91</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span>
</span><span id=__span-11-34><a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>90</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>31</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span>
</span><span id=__span-11-35><a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>30</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span>
</span><span id=__span-11-36><a id=__codelineno-11-36 name=__codelineno-11-36 href=#__codelineno-11-36></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span>
</span><span id=__span-11-37><a id=__codelineno-11-37 name=__codelineno-11-37 href=#__codelineno-11-37></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>30</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span>
</span><span id=__span-11-38><a id=__codelineno-11-38 name=__codelineno-11-38 href=#__codelineno-11-38></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>31</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>90</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span>
</span><span id=__span-11-39><a id=__codelineno-11-39 name=__codelineno-11-39 href=#__codelineno-11-39></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>91</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>180</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span>
</span><span id=__span-11-40><a id=__codelineno-11-40 name=__codelineno-11-40 href=#__codelineno-11-40></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>181</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span>
</span><span id=__span-11-41><a id=__codelineno-11-41 name=__codelineno-11-41 href=#__codelineno-11-41></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span>
</span><span id=__span-11-42><a id=__codelineno-11-42 name=__codelineno-11-42 href=#__codelineno-11-42></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span>
</span><span id=__span-11-43><a id=__codelineno-11-43 name=__codelineno-11-43 href=#__codelineno-11-43></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-11-44><a id=__codelineno-11-44 name=__codelineno-11-44 href=#__codelineno-11-44></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_patch_gaps</span>
</span><span id=__span-11-45><a id=__codelineno-11-45 name=__codelineno-11-45 href=#__codelineno-11-45></a><span class=p>),</span>
</span><span id=__span-11-46><a id=__codelineno-11-46 name=__codelineno-11-46 href=#__codelineno-11-46></a><span class=c1>-- Calculate statistics for each category (count, avg, median, mode)</span>
</span><span id=__span-11-47><a id=__codelineno-11-47 name=__codelineno-11-47 href=#__codelineno-11-47></a><span class=n>categorized_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-11-48><a id=__codelineno-11-48 name=__codelineno-11-48 href=#__codelineno-11-48></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-11-49><a id=__codelineno-11-49 name=__codelineno-11-49 href=#__codelineno-11-49></a><span class=w>        </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-11-50><a id=__codelineno-11-50 name=__codelineno-11-50 href=#__codelineno-11-50></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-11-51><a id=__codelineno-11-51 name=__codelineno-11-51 href=#__codelineno-11-51></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_days_to_patch</span><span class=p>,</span>
</span><span id=__span-11-52><a id=__codelineno-11-52 name=__codelineno-11-52 href=#__codelineno-11-52></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-11-53><a id=__codelineno-11-53 name=__codelineno-11-53 href=#__codelineno-11-53></a><span class=w>        </span><span class=c1>-- Subquery to calculate mode for the current category</span>
</span><span id=__span-11-54><a id=__codelineno-11-54 name=__codelineno-11-54 href=#__codelineno-11-54></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-11-55><a id=__codelineno-11-55 name=__codelineno-11-55 href=#__codelineno-11-55></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-11-56><a id=__codelineno-11-56 name=__codelineno-11-56 href=#__codelineno-11-56></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sub</span>
</span><span id=__span-11-57><a id=__codelineno-11-57 name=__codelineno-11-57 href=#__codelineno-11-57></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>sub</span><span class=p>.</span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=p>.</span><span class=n>time_gap_category</span>
</span><span id=__span-11-58><a id=__codelineno-11-58 name=__codelineno-11-58 href=#__codelineno-11-58></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-11-59><a id=__codelineno-11-59 name=__codelineno-11-59 href=#__codelineno-11-59></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-11-60><a id=__codelineno-11-60 name=__codelineno-11-60 href=#__codelineno-11-60></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-11-61><a id=__codelineno-11-61 name=__codelineno-11-61 href=#__codelineno-11-61></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days_to_patch</span>
</span><span id=__span-11-62><a id=__codelineno-11-62 name=__codelineno-11-62 href=#__codelineno-11-62></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span>
</span><span id=__span-11-63><a id=__codelineno-11-63 name=__codelineno-11-63 href=#__codelineno-11-63></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-11-64><a id=__codelineno-11-64 name=__codelineno-11-64 href=#__codelineno-11-64></a><span class=p>),</span>
</span><span id=__span-11-65><a id=__codelineno-11-65 name=__codelineno-11-65 href=#__codelineno-11-65></a><span class=c1>-- Calculate overall statistics (count, avg, median, mode)</span>
</span><span id=__span-11-66><a id=__codelineno-11-66 name=__codelineno-11-66 href=#__codelineno-11-66></a><span class=n>overall_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-11-67><a id=__codelineno-11-67 name=__codelineno-11-67 href=#__codelineno-11-67></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-11-68><a id=__codelineno-11-68 name=__codelineno-11-68 href=#__codelineno-11-68></a><span class=w>        </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-11-69><a id=__codelineno-11-69 name=__codelineno-11-69 href=#__codelineno-11-69></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-11-70><a id=__codelineno-11-70 name=__codelineno-11-70 href=#__codelineno-11-70></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_days_to_patch</span><span class=p>,</span>
</span><span id=__span-11-71><a id=__codelineno-11-71 name=__codelineno-11-71 href=#__codelineno-11-71></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-11-72><a id=__codelineno-11-72 name=__codelineno-11-72 href=#__codelineno-11-72></a><span class=w>        </span><span class=c1>-- Subquery to calculate overall mode</span>
</span><span id=__span-11-73><a id=__codelineno-11-73 name=__codelineno-11-73 href=#__codelineno-11-73></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-11-74><a id=__codelineno-11-74 name=__codelineno-11-74 href=#__codelineno-11-74></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-11-75><a id=__codelineno-11-75 name=__codelineno-11-75 href=#__codelineno-11-75></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_patch_gaps</span>
</span><span id=__span-11-76><a id=__codelineno-11-76 name=__codelineno-11-76 href=#__codelineno-11-76></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-11-77><a id=__codelineno-11-77 name=__codelineno-11-77 href=#__codelineno-11-77></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-11-78><a id=__codelineno-11-78 name=__codelineno-11-78 href=#__codelineno-11-78></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-11-79><a id=__codelineno-11-79 name=__codelineno-11-79 href=#__codelineno-11-79></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days_to_patch</span>
</span><span id=__span-11-80><a id=__codelineno-11-80 name=__codelineno-11-80 href=#__codelineno-11-80></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_patch_gaps</span>
</span><span id=__span-11-81><a id=__codelineno-11-81 name=__codelineno-11-81 href=#__codelineno-11-81></a><span class=p>)</span>
</span><span id=__span-11-82><a id=__codelineno-11-82 name=__codelineno-11-82 href=#__codelineno-11-82></a><span class=c1>-- Wrap the UNION ALL in a subquery (derived table) and then apply ORDER BY</span>
</span><span id=__span-11-83><a id=__codelineno-11-83 name=__codelineno-11-83 href=#__codelineno-11-83></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span>
</span><span id=__span-11-84><a id=__codelineno-11-84 name=__codelineno-11-84 href=#__codelineno-11-84></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-11-85><a id=__codelineno-11-85 name=__codelineno-11-85 href=#__codelineno-11-85></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_stats</span>
</span><span id=__span-11-86><a id=__codelineno-11-86 name=__codelineno-11-86 href=#__codelineno-11-86></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-11-87><a id=__codelineno-11-87 name=__codelineno-11-87 href=#__codelineno-11-87></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>overall_stats</span>
</span><span id=__span-11-88><a id=__codelineno-11-88 name=__codelineno-11-88 href=#__codelineno-11-88></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>combined_results</span>
</span><span id=__span-11-89><a id=__codelineno-11-89 name=__codelineno-11-89 href=#__codelineno-11-89></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span>
</span><span id=__span-11-90><a id=__codelineno-11-90 name=__codelineno-11-90 href=#__codelineno-11-90></a><span class=w>    </span><span class=k>CASE</span>
</span><span id=__span-11-91><a id=__codelineno-11-91 name=__codelineno-11-91 href=#__codelineno-11-91></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-11-92><a id=__codelineno-11-92 name=__codelineno-11-92 href=#__codelineno-11-92></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-11-93><a id=__codelineno-11-93 name=__codelineno-11-93 href=#__codelineno-11-93></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-11-94><a id=__codelineno-11-94 name=__codelineno-11-94 href=#__codelineno-11-94></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span>
</span><span id=__span-11-95><a id=__codelineno-11-95 name=__codelineno-11-95 href=#__codelineno-11-95></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>5</span>
</span><span id=__span-11-96><a id=__codelineno-11-96 name=__codelineno-11-96 href=#__codelineno-11-96></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>6</span>
</span><span id=__span-11-97><a id=__codelineno-11-97 name=__codelineno-11-97 href=#__codelineno-11-97></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>7</span>
</span><span id=__span-11-98><a id=__codelineno-11-98 name=__codelineno-11-98 href=#__codelineno-11-98></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>8</span>
</span><span id=__span-11-99><a id=__codelineno-11-99 name=__codelineno-11-99 href=#__codelineno-11-99></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>9</span>
</span><span id=__span-11-100><a id=__codelineno-11-100 name=__codelineno-11-100 href=#__codelineno-11-100></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>10</span>
</span><span id=__span-11-101><a id=__codelineno-11-101 name=__codelineno-11-101 href=#__codelineno-11-101></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>11</span>
</span><span id=__span-11-102><a id=__codelineno-11-102 name=__codelineno-11-102 href=#__codelineno-11-102></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>12</span>
</span><span id=__span-11-103><a id=__codelineno-11-103 name=__codelineno-11-103 href=#__codelineno-11-103></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=c1>-- Ensures overall row appears last</span>
</span><span id=__span-11-104><a id=__codelineno-11-104 name=__codelineno-11-104 href=#__codelineno-11-104></a><span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=mi>101</span><span class=w> </span><span class=c1>-- Fallback for any unexpected categories</span>
</span><span id=__span-11-105><a id=__codelineno-11-105 name=__codelineno-11-105 href=#__codelineno-11-105></a><span class=w>    </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div> <h3 id=ch5_fig_573_distribution-of-differences-in-days-between-cve-creation-date-and-patch-date-all-cves-with-patch-and-exploit><strong>Ch5_Fig_5.7.3_Distribution of differences in days between CVE Creation date and Patch date (All CVEs with patch and exploit)</strong><a class=headerlink href=#ch5_fig_573_distribution-of-differences-in-days-between-cve-creation-date-and-patch-date-all-cves-with-patch-and-exploit title="Permanent link">&para;</a></h3> <p><strong>Question Answered</strong>: What is the typical time gap between CVE disclosure and patch release for all vendors (CVEs with both patch and exploit)? <div class="language-sql highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=k>WITH</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=w>            </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=w>                </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a><span class=w>            </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-12-15><a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span>
</span><span id=__span-12-16><a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-12-17><a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a><span class=w>        </span><span class=p>)</span>
</span><span id=__span-12-18><a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-12-19><a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-12-20><a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-12-21><a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a><span class=w>        </span><span class=p>)</span>
</span><span id=__span-12-22><a id=__codelineno-12-22 name=__codelineno-12-22 href=#__codelineno-12-22></a><span class=p>),</span>
</span><span id=__span-12-23><a id=__codelineno-12-23 name=__codelineno-12-23 href=#__codelineno-12-23></a><span class=n>unified_patch_gaps</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-12-24><a id=__codelineno-12-24 name=__codelineno-12-24 href=#__codelineno-12-24></a><span class=w>    </span><span class=c1>-- Microsoft patches</span>
</span><span id=__span-12-25><a id=__codelineno-12-25 name=__codelineno-12-25 href=#__codelineno-12-25></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-12-26><a id=__codelineno-12-26 name=__codelineno-12-26 href=#__codelineno-12-26></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-12-27><a id=__codelineno-12-27 name=__codelineno-12-27 href=#__codelineno-12-27></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-12-28><a id=__codelineno-12-28 name=__codelineno-12-28 href=#__codelineno-12-28></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-12-29><a id=__codelineno-12-29 name=__codelineno-12-29 href=#__codelineno-12-29></a><span class=w>        </span><span class=s1>&#39;Microsoft&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-12-30><a id=__codelineno-12-30 name=__codelineno-12-30 href=#__codelineno-12-30></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-12-31><a id=__codelineno-12-31 name=__codelineno-12-31 href=#__codelineno-12-31></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-12-32><a id=__codelineno-12-32 name=__codelineno-12-32 href=#__codelineno-12-32></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-12-33><a id=__codelineno-12-33 name=__codelineno-12-33 href=#__codelineno-12-33></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=p>)</span>
</span><span id=__span-12-34><a id=__codelineno-12-34 name=__codelineno-12-34 href=#__codelineno-12-34></a>
</span><span id=__span-12-35><a id=__codelineno-12-35 name=__codelineno-12-35 href=#__codelineno-12-35></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-12-36><a id=__codelineno-12-36 name=__codelineno-12-36 href=#__codelineno-12-36></a>
</span><span id=__span-12-37><a id=__codelineno-12-37 name=__codelineno-12-37 href=#__codelineno-12-37></a><span class=w>    </span><span class=c1>-- RedHat patches</span>
</span><span id=__span-12-38><a id=__codelineno-12-38 name=__codelineno-12-38 href=#__codelineno-12-38></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-12-39><a id=__codelineno-12-39 name=__codelineno-12-39 href=#__codelineno-12-39></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-12-40><a id=__codelineno-12-40 name=__codelineno-12-40 href=#__codelineno-12-40></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-12-41><a id=__codelineno-12-41 name=__codelineno-12-41 href=#__codelineno-12-41></a><span class=w>        </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-12-42><a id=__codelineno-12-42 name=__codelineno-12-42 href=#__codelineno-12-42></a><span class=w>        </span><span class=s1>&#39;RedHat&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-12-43><a id=__codelineno-12-43 name=__codelineno-12-43 href=#__codelineno-12-43></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-12-44><a id=__codelineno-12-44 name=__codelineno-12-44 href=#__codelineno-12-44></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-12-45><a id=__codelineno-12-45 name=__codelineno-12-45 href=#__codelineno-12-45></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-12-46><a id=__codelineno-12-46 name=__codelineno-12-46 href=#__codelineno-12-46></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=p>)</span>
</span><span id=__span-12-47><a id=__codelineno-12-47 name=__codelineno-12-47 href=#__codelineno-12-47></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-12-48><a id=__codelineno-12-48 name=__codelineno-12-48 href=#__codelineno-12-48></a>
</span><span id=__span-12-49><a id=__codelineno-12-49 name=__codelineno-12-49 href=#__codelineno-12-49></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-12-50><a id=__codelineno-12-50 name=__codelineno-12-50 href=#__codelineno-12-50></a>
</span><span id=__span-12-51><a id=__codelineno-12-51 name=__codelineno-12-51 href=#__codelineno-12-51></a><span class=w>    </span><span class=c1>-- Cisco patches</span>
</span><span id=__span-12-52><a id=__codelineno-12-52 name=__codelineno-12-52 href=#__codelineno-12-52></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-12-53><a id=__codelineno-12-53 name=__codelineno-12-53 href=#__codelineno-12-53></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-12-54><a id=__codelineno-12-54 name=__codelineno-12-54 href=#__codelineno-12-54></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-12-55><a id=__codelineno-12-55 name=__codelineno-12-55 href=#__codelineno-12-55></a><span class=w>        </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-12-56><a id=__codelineno-12-56 name=__codelineno-12-56 href=#__codelineno-12-56></a><span class=w>        </span><span class=s1>&#39;Cisco&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-12-57><a id=__codelineno-12-57 name=__codelineno-12-57 href=#__codelineno-12-57></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-12-58><a id=__codelineno-12-58 name=__codelineno-12-58 href=#__codelineno-12-58></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-12-59><a id=__codelineno-12-59 name=__codelineno-12-59 href=#__codelineno-12-59></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-12-60><a id=__codelineno-12-60 name=__codelineno-12-60 href=#__codelineno-12-60></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=p>)</span>
</span><span id=__span-12-61><a id=__codelineno-12-61 name=__codelineno-12-61 href=#__codelineno-12-61></a><span class=p>),</span>
</span><span id=__span-12-62><a id=__codelineno-12-62 name=__codelineno-12-62 href=#__codelineno-12-62></a><span class=c1>-- Assign the 12 categories to each patch gap record for grouping and mode calculation</span>
</span><span id=__span-12-63><a id=__codelineno-12-63 name=__codelineno-12-63 href=#__codelineno-12-63></a><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-12-64><a id=__codelineno-12-64 name=__codelineno-12-64 href=#__codelineno-12-64></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-12-65><a id=__codelineno-12-65 name=__codelineno-12-65 href=#__codelineno-12-65></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-12-66><a id=__codelineno-12-66 name=__codelineno-12-66 href=#__codelineno-12-66></a><span class=w>        </span><span class=n>days_to_patch</span><span class=p>,</span>
</span><span id=__span-12-67><a id=__codelineno-12-67 name=__codelineno-12-67 href=#__codelineno-12-67></a><span class=w>        </span><span class=k>CASE</span>
</span><span id=__span-12-68><a id=__codelineno-12-68 name=__codelineno-12-68 href=#__codelineno-12-68></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span>
</span><span id=__span-12-69><a id=__codelineno-12-69 name=__codelineno-12-69 href=#__codelineno-12-69></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>181</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span>
</span><span id=__span-12-70><a id=__codelineno-12-70 name=__codelineno-12-70 href=#__codelineno-12-70></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>180</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>91</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span>
</span><span id=__span-12-71><a id=__codelineno-12-71 name=__codelineno-12-71 href=#__codelineno-12-71></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>90</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>31</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span>
</span><span id=__span-12-72><a id=__codelineno-12-72 name=__codelineno-12-72 href=#__codelineno-12-72></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>30</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span>
</span><span id=__span-12-73><a id=__codelineno-12-73 name=__codelineno-12-73 href=#__codelineno-12-73></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span>
</span><span id=__span-12-74><a id=__codelineno-12-74 name=__codelineno-12-74 href=#__codelineno-12-74></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>30</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span>
</span><span id=__span-12-75><a id=__codelineno-12-75 name=__codelineno-12-75 href=#__codelineno-12-75></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>31</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>90</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span>
</span><span id=__span-12-76><a id=__codelineno-12-76 name=__codelineno-12-76 href=#__codelineno-12-76></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>91</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>180</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span>
</span><span id=__span-12-77><a id=__codelineno-12-77 name=__codelineno-12-77 href=#__codelineno-12-77></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>181</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span>
</span><span id=__span-12-78><a id=__codelineno-12-78 name=__codelineno-12-78 href=#__codelineno-12-78></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span>
</span><span id=__span-12-79><a id=__codelineno-12-79 name=__codelineno-12-79 href=#__codelineno-12-79></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span>
</span><span id=__span-12-80><a id=__codelineno-12-80 name=__codelineno-12-80 href=#__codelineno-12-80></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-12-81><a id=__codelineno-12-81 name=__codelineno-12-81 href=#__codelineno-12-81></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_patch_gaps</span>
</span><span id=__span-12-82><a id=__codelineno-12-82 name=__codelineno-12-82 href=#__codelineno-12-82></a><span class=p>),</span>
</span><span id=__span-12-83><a id=__codelineno-12-83 name=__codelineno-12-83 href=#__codelineno-12-83></a><span class=c1>-- Calculate statistics for each category (count, avg, median, mode)</span>
</span><span id=__span-12-84><a id=__codelineno-12-84 name=__codelineno-12-84 href=#__codelineno-12-84></a><span class=n>categorized_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-12-85><a id=__codelineno-12-85 name=__codelineno-12-85 href=#__codelineno-12-85></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-12-86><a id=__codelineno-12-86 name=__codelineno-12-86 href=#__codelineno-12-86></a><span class=w>        </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-12-87><a id=__codelineno-12-87 name=__codelineno-12-87 href=#__codelineno-12-87></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-12-88><a id=__codelineno-12-88 name=__codelineno-12-88 href=#__codelineno-12-88></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_days_to_patch</span><span class=p>,</span>
</span><span id=__span-12-89><a id=__codelineno-12-89 name=__codelineno-12-89 href=#__codelineno-12-89></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-12-90><a id=__codelineno-12-90 name=__codelineno-12-90 href=#__codelineno-12-90></a><span class=w>        </span><span class=c1>-- Subquery to calculate mode for the current category</span>
</span><span id=__span-12-91><a id=__codelineno-12-91 name=__codelineno-12-91 href=#__codelineno-12-91></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-12-92><a id=__codelineno-12-92 name=__codelineno-12-92 href=#__codelineno-12-92></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-12-93><a id=__codelineno-12-93 name=__codelineno-12-93 href=#__codelineno-12-93></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sub</span>
</span><span id=__span-12-94><a id=__codelineno-12-94 name=__codelineno-12-94 href=#__codelineno-12-94></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>sub</span><span class=p>.</span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=p>.</span><span class=n>time_gap_category</span>
</span><span id=__span-12-95><a id=__codelineno-12-95 name=__codelineno-12-95 href=#__codelineno-12-95></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-12-96><a id=__codelineno-12-96 name=__codelineno-12-96 href=#__codelineno-12-96></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-12-97><a id=__codelineno-12-97 name=__codelineno-12-97 href=#__codelineno-12-97></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-12-98><a id=__codelineno-12-98 name=__codelineno-12-98 href=#__codelineno-12-98></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days_to_patch</span>
</span><span id=__span-12-99><a id=__codelineno-12-99 name=__codelineno-12-99 href=#__codelineno-12-99></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span>
</span><span id=__span-12-100><a id=__codelineno-12-100 name=__codelineno-12-100 href=#__codelineno-12-100></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-12-101><a id=__codelineno-12-101 name=__codelineno-12-101 href=#__codelineno-12-101></a><span class=p>),</span>
</span><span id=__span-12-102><a id=__codelineno-12-102 name=__codelineno-12-102 href=#__codelineno-12-102></a><span class=c1>-- Calculate overall statistics (count, avg, median, mode)</span>
</span><span id=__span-12-103><a id=__codelineno-12-103 name=__codelineno-12-103 href=#__codelineno-12-103></a><span class=n>overall_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-12-104><a id=__codelineno-12-104 name=__codelineno-12-104 href=#__codelineno-12-104></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-12-105><a id=__codelineno-12-105 name=__codelineno-12-105 href=#__codelineno-12-105></a><span class=w>        </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-12-106><a id=__codelineno-12-106 name=__codelineno-12-106 href=#__codelineno-12-106></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-12-107><a id=__codelineno-12-107 name=__codelineno-12-107 href=#__codelineno-12-107></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_days_to_patch</span><span class=p>,</span>
</span><span id=__span-12-108><a id=__codelineno-12-108 name=__codelineno-12-108 href=#__codelineno-12-108></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-12-109><a id=__codelineno-12-109 name=__codelineno-12-109 href=#__codelineno-12-109></a><span class=w>        </span><span class=c1>-- Subquery to calculate overall mode</span>
</span><span id=__span-12-110><a id=__codelineno-12-110 name=__codelineno-12-110 href=#__codelineno-12-110></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-12-111><a id=__codelineno-12-111 name=__codelineno-12-111 href=#__codelineno-12-111></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-12-112><a id=__codelineno-12-112 name=__codelineno-12-112 href=#__codelineno-12-112></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_patch_gaps</span>
</span><span id=__span-12-113><a id=__codelineno-12-113 name=__codelineno-12-113 href=#__codelineno-12-113></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-12-114><a id=__codelineno-12-114 name=__codelineno-12-114 href=#__codelineno-12-114></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-12-115><a id=__codelineno-12-115 name=__codelineno-12-115 href=#__codelineno-12-115></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-12-116><a id=__codelineno-12-116 name=__codelineno-12-116 href=#__codelineno-12-116></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days_to_patch</span>
</span><span id=__span-12-117><a id=__codelineno-12-117 name=__codelineno-12-117 href=#__codelineno-12-117></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_patch_gaps</span>
</span><span id=__span-12-118><a id=__codelineno-12-118 name=__codelineno-12-118 href=#__codelineno-12-118></a><span class=p>)</span>
</span><span id=__span-12-119><a id=__codelineno-12-119 name=__codelineno-12-119 href=#__codelineno-12-119></a><span class=c1>-- Wrap the UNION ALL in a subquery (derived table) and then apply ORDER BY</span>
</span><span id=__span-12-120><a id=__codelineno-12-120 name=__codelineno-12-120 href=#__codelineno-12-120></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span>
</span><span id=__span-12-121><a id=__codelineno-12-121 name=__codelineno-12-121 href=#__codelineno-12-121></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-12-122><a id=__codelineno-12-122 name=__codelineno-12-122 href=#__codelineno-12-122></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_stats</span>
</span><span id=__span-12-123><a id=__codelineno-12-123 name=__codelineno-12-123 href=#__codelineno-12-123></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-12-124><a id=__codelineno-12-124 name=__codelineno-12-124 href=#__codelineno-12-124></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>overall_stats</span>
</span><span id=__span-12-125><a id=__codelineno-12-125 name=__codelineno-12-125 href=#__codelineno-12-125></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>combined_results</span>
</span><span id=__span-12-126><a id=__codelineno-12-126 name=__codelineno-12-126 href=#__codelineno-12-126></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span>
</span><span id=__span-12-127><a id=__codelineno-12-127 name=__codelineno-12-127 href=#__codelineno-12-127></a><span class=w>    </span><span class=k>CASE</span>
</span><span id=__span-12-128><a id=__codelineno-12-128 name=__codelineno-12-128 href=#__codelineno-12-128></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-12-129><a id=__codelineno-12-129 name=__codelineno-12-129 href=#__codelineno-12-129></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-12-130><a id=__codelineno-12-130 name=__codelineno-12-130 href=#__codelineno-12-130></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-12-131><a id=__codelineno-12-131 name=__codelineno-12-131 href=#__codelineno-12-131></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span>
</span><span id=__span-12-132><a id=__codelineno-12-132 name=__codelineno-12-132 href=#__codelineno-12-132></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>5</span>
</span><span id=__span-12-133><a id=__codelineno-12-133 name=__codelineno-12-133 href=#__codelineno-12-133></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>6</span>
</span><span id=__span-12-134><a id=__codelineno-12-134 name=__codelineno-12-134 href=#__codelineno-12-134></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>7</span>
</span><span id=__span-12-135><a id=__codelineno-12-135 name=__codelineno-12-135 href=#__codelineno-12-135></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>8</span>
</span><span id=__span-12-136><a id=__codelineno-12-136 name=__codelineno-12-136 href=#__codelineno-12-136></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>9</span>
</span><span id=__span-12-137><a id=__codelineno-12-137 name=__codelineno-12-137 href=#__codelineno-12-137></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>10</span>
</span><span id=__span-12-138><a id=__codelineno-12-138 name=__codelineno-12-138 href=#__codelineno-12-138></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>11</span>
</span><span id=__span-12-139><a id=__codelineno-12-139 name=__codelineno-12-139 href=#__codelineno-12-139></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>12</span>
</span><span id=__span-12-140><a id=__codelineno-12-140 name=__codelineno-12-140 href=#__codelineno-12-140></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=c1>-- Ensures overall row appears last</span>
</span><span id=__span-12-141><a id=__codelineno-12-141 name=__codelineno-12-141 href=#__codelineno-12-141></a><span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=mi>101</span><span class=w> </span><span class=c1>-- Fallback for any unexpected categories</span>
</span><span id=__span-12-142><a id=__codelineno-12-142 name=__codelineno-12-142 href=#__codelineno-12-142></a><span class=w>    </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div></p> <h3 id=figlifecycle_exp_minus_creation-distribution-of-differences-in-days-between-exploit-adding-date-and-cve-creation-date-including-third-party-applications><strong>fig:lifecycle_exp_minus_creation: Distribution of differences in days between Exploit Adding date and CVE Creation date (including third-party applications)</strong><a class=headerlink href=#figlifecycle_exp_minus_creation-distribution-of-differences-in-days-between-exploit-adding-date-and-cve-creation-date-including-third-party-applications title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: How does the time gap between CVE disclosure and exploit publication change when including third-party apps in the Microsoft ecosystem? </li> <li> <p><strong>SQL Query</strong>:<br> SELECT<br> DATEDIFF('day', cm.date_reserved, e.date_published) AS days_to_exploit<br> FROM<br> cve_main AS cm<br> JOIN<br> exploits AS e ON cm.cve_id = e.cve_id<br> WHERE<br> cm.date_reserved IS NOT NULL<br> AND e.date_published IS NOT NULL<br> AND e.date_published &lt;= '2025-05-13';</p> </li> <li> <p><strong>Superset Chart Type</strong>: Histogram </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>Metric</strong>: days_to_exploit </li> <li><strong>Binning</strong>: Adjust bin size as needed (e.g., 30 days)</li> </ul> <h3 id=ch5_fig_59_distribution-of-differences-in-days-between-patch-availability-and-exploit-adding-dates-for-microsoft-products><strong>Ch5_Fig_5.9_Distribution of differences in days between Patch Availability and Exploit Adding dates for Microsoft products</strong><a class=headerlink href=#ch5_fig_59_distribution-of-differences-in-days-between-patch-availability-and-exploit-adding-dates-for-microsoft-products title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: What is the typical time gap between exploit publication and patch availability for Microsoft products? </li> <li> <p><strong>SQL Query</strong>:<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>WITH</span><span class=w> </span><span class=n>microsoft_cves_with_patch_and_exploit</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=w>    </span><span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>UNNEST</span><span class=p>(</span><span class=n>STRING_SPLIT</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>cpes</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cpe_unnest</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>)</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>SPLIT_PART</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;:&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>))</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;microsoft&#39;</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=p>),</span>
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=n>microsoft_exploit_patch_gaps</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-13-17><a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-13-18><a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-13-19><a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-13-20><a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-13-21><a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-13-22><a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-13-23><a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-13-24><a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_cves_with_patch_and_exploit</span><span class=p>)</span>
</span><span id=__span-13-25><a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a><span class=p>),</span>
</span><span id=__span-13-26><a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a><span class=c1>-- Assign the 12 categories to each patch_exploit_gap record for grouping and mode calculation</span>
</span><span id=__span-13-27><a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-13-28><a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-13-29><a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-13-30><a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a><span class=w>        </span><span class=n>patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-13-31><a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a><span class=w>        </span><span class=k>CASE</span>
</span><span id=__span-13-32><a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span>
</span><span id=__span-13-33><a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>181</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span>
</span><span id=__span-13-34><a id=__codelineno-13-34 name=__codelineno-13-34 href=#__codelineno-13-34></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>180</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>91</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span>
</span><span id=__span-13-35><a id=__codelineno-13-35 name=__codelineno-13-35 href=#__codelineno-13-35></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>90</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>31</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span>
</span><span id=__span-13-36><a id=__codelineno-13-36 name=__codelineno-13-36 href=#__codelineno-13-36></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>30</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span>
</span><span id=__span-13-37><a id=__codelineno-13-37 name=__codelineno-13-37 href=#__codelineno-13-37></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span>
</span><span id=__span-13-38><a id=__codelineno-13-38 name=__codelineno-13-38 href=#__codelineno-13-38></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>30</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span>
</span><span id=__span-13-39><a id=__codelineno-13-39 name=__codelineno-13-39 href=#__codelineno-13-39></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>31</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>90</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span>
</span><span id=__span-13-40><a id=__codelineno-13-40 name=__codelineno-13-40 href=#__codelineno-13-40></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>91</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>180</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span>
</span><span id=__span-13-41><a id=__codelineno-13-41 name=__codelineno-13-41 href=#__codelineno-13-41></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>181</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span>
</span><span id=__span-13-42><a id=__codelineno-13-42 name=__codelineno-13-42 href=#__codelineno-13-42></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span>
</span><span id=__span-13-43><a id=__codelineno-13-43 name=__codelineno-13-43 href=#__codelineno-13-43></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span>
</span><span id=__span-13-44><a id=__codelineno-13-44 name=__codelineno-13-44 href=#__codelineno-13-44></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-13-45><a id=__codelineno-13-45 name=__codelineno-13-45 href=#__codelineno-13-45></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_exploit_patch_gaps</span>
</span><span id=__span-13-46><a id=__codelineno-13-46 name=__codelineno-13-46 href=#__codelineno-13-46></a><span class=p>),</span>
</span><span id=__span-13-47><a id=__codelineno-13-47 name=__codelineno-13-47 href=#__codelineno-13-47></a><span class=c1>-- Calculate statistics for each category (count, avg, median, mode)</span>
</span><span id=__span-13-48><a id=__codelineno-13-48 name=__codelineno-13-48 href=#__codelineno-13-48></a><span class=n>categorized_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-13-49><a id=__codelineno-13-49 name=__codelineno-13-49 href=#__codelineno-13-49></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-13-50><a id=__codelineno-13-50 name=__codelineno-13-50 href=#__codelineno-13-50></a><span class=w>        </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-13-51><a id=__codelineno-13-51 name=__codelineno-13-51 href=#__codelineno-13-51></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-13-52><a id=__codelineno-13-52 name=__codelineno-13-52 href=#__codelineno-13-52></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-13-53><a id=__codelineno-13-53 name=__codelineno-13-53 href=#__codelineno-13-53></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-13-54><a id=__codelineno-13-54 name=__codelineno-13-54 href=#__codelineno-13-54></a><span class=w>        </span><span class=c1>-- Subquery to calculate mode for the current category</span>
</span><span id=__span-13-55><a id=__codelineno-13-55 name=__codelineno-13-55 href=#__codelineno-13-55></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-13-56><a id=__codelineno-13-56 name=__codelineno-13-56 href=#__codelineno-13-56></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-13-57><a id=__codelineno-13-57 name=__codelineno-13-57 href=#__codelineno-13-57></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sub</span>
</span><span id=__span-13-58><a id=__codelineno-13-58 name=__codelineno-13-58 href=#__codelineno-13-58></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>sub</span><span class=p>.</span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=p>.</span><span class=n>time_gap_category</span>
</span><span id=__span-13-59><a id=__codelineno-13-59 name=__codelineno-13-59 href=#__codelineno-13-59></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-13-60><a id=__codelineno-13-60 name=__codelineno-13-60 href=#__codelineno-13-60></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-13-61><a id=__codelineno-13-61 name=__codelineno-13-61 href=#__codelineno-13-61></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-13-62><a id=__codelineno-13-62 name=__codelineno-13-62 href=#__codelineno-13-62></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_patch_exploit_gap</span>
</span><span id=__span-13-63><a id=__codelineno-13-63 name=__codelineno-13-63 href=#__codelineno-13-63></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span>
</span><span id=__span-13-64><a id=__codelineno-13-64 name=__codelineno-13-64 href=#__codelineno-13-64></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-13-65><a id=__codelineno-13-65 name=__codelineno-13-65 href=#__codelineno-13-65></a><span class=p>),</span>
</span><span id=__span-13-66><a id=__codelineno-13-66 name=__codelineno-13-66 href=#__codelineno-13-66></a><span class=c1>-- Calculate overall statistics (count, avg, median, mode)</span>
</span><span id=__span-13-67><a id=__codelineno-13-67 name=__codelineno-13-67 href=#__codelineno-13-67></a><span class=n>overall_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-13-68><a id=__codelineno-13-68 name=__codelineno-13-68 href=#__codelineno-13-68></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-13-69><a id=__codelineno-13-69 name=__codelineno-13-69 href=#__codelineno-13-69></a><span class=w>        </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-13-70><a id=__codelineno-13-70 name=__codelineno-13-70 href=#__codelineno-13-70></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-13-71><a id=__codelineno-13-71 name=__codelineno-13-71 href=#__codelineno-13-71></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-13-72><a id=__codelineno-13-72 name=__codelineno-13-72 href=#__codelineno-13-72></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-13-73><a id=__codelineno-13-73 name=__codelineno-13-73 href=#__codelineno-13-73></a><span class=w>        </span><span class=c1>-- Subquery to calculate overall mode</span>
</span><span id=__span-13-74><a id=__codelineno-13-74 name=__codelineno-13-74 href=#__codelineno-13-74></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-13-75><a id=__codelineno-13-75 name=__codelineno-13-75 href=#__codelineno-13-75></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-13-76><a id=__codelineno-13-76 name=__codelineno-13-76 href=#__codelineno-13-76></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_exploit_patch_gaps</span>
</span><span id=__span-13-77><a id=__codelineno-13-77 name=__codelineno-13-77 href=#__codelineno-13-77></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-13-78><a id=__codelineno-13-78 name=__codelineno-13-78 href=#__codelineno-13-78></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-13-79><a id=__codelineno-13-79 name=__codelineno-13-79 href=#__codelineno-13-79></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-13-80><a id=__codelineno-13-80 name=__codelineno-13-80 href=#__codelineno-13-80></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_patch_exploit_gap</span>
</span><span id=__span-13-81><a id=__codelineno-13-81 name=__codelineno-13-81 href=#__codelineno-13-81></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_exploit_patch_gaps</span>
</span><span id=__span-13-82><a id=__codelineno-13-82 name=__codelineno-13-82 href=#__codelineno-13-82></a><span class=p>)</span>
</span><span id=__span-13-83><a id=__codelineno-13-83 name=__codelineno-13-83 href=#__codelineno-13-83></a><span class=c1>-- Wrap the UNION ALL in a subquery (derived table) and then apply ORDER BY</span>
</span><span id=__span-13-84><a id=__codelineno-13-84 name=__codelineno-13-84 href=#__codelineno-13-84></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span>
</span><span id=__span-13-85><a id=__codelineno-13-85 name=__codelineno-13-85 href=#__codelineno-13-85></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-13-86><a id=__codelineno-13-86 name=__codelineno-13-86 href=#__codelineno-13-86></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_stats</span>
</span><span id=__span-13-87><a id=__codelineno-13-87 name=__codelineno-13-87 href=#__codelineno-13-87></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-13-88><a id=__codelineno-13-88 name=__codelineno-13-88 href=#__codelineno-13-88></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>overall_stats</span>
</span><span id=__span-13-89><a id=__codelineno-13-89 name=__codelineno-13-89 href=#__codelineno-13-89></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>combined_results</span>
</span><span id=__span-13-90><a id=__codelineno-13-90 name=__codelineno-13-90 href=#__codelineno-13-90></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span>
</span><span id=__span-13-91><a id=__codelineno-13-91 name=__codelineno-13-91 href=#__codelineno-13-91></a><span class=w>    </span><span class=k>CASE</span>
</span><span id=__span-13-92><a id=__codelineno-13-92 name=__codelineno-13-92 href=#__codelineno-13-92></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-13-93><a id=__codelineno-13-93 name=__codelineno-13-93 href=#__codelineno-13-93></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-13-94><a id=__codelineno-13-94 name=__codelineno-13-94 href=#__codelineno-13-94></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-13-95><a id=__codelineno-13-95 name=__codelineno-13-95 href=#__codelineno-13-95></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span>
</span><span id=__span-13-96><a id=__codelineno-13-96 name=__codelineno-13-96 href=#__codelineno-13-96></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>5</span>
</span><span id=__span-13-97><a id=__codelineno-13-97 name=__codelineno-13-97 href=#__codelineno-13-97></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>6</span>
</span><span id=__span-13-98><a id=__codelineno-13-98 name=__codelineno-13-98 href=#__codelineno-13-98></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>7</span>
</span><span id=__span-13-99><a id=__codelineno-13-99 name=__codelineno-13-99 href=#__codelineno-13-99></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>8</span>
</span><span id=__span-13-100><a id=__codelineno-13-100 name=__codelineno-13-100 href=#__codelineno-13-100></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>9</span>
</span><span id=__span-13-101><a id=__codelineno-13-101 name=__codelineno-13-101 href=#__codelineno-13-101></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>10</span>
</span><span id=__span-13-102><a id=__codelineno-13-102 name=__codelineno-13-102 href=#__codelineno-13-102></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>11</span>
</span><span id=__span-13-103><a id=__codelineno-13-103 name=__codelineno-13-103 href=#__codelineno-13-103></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>12</span>
</span><span id=__span-13-104><a id=__codelineno-13-104 name=__codelineno-13-104 href=#__codelineno-13-104></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=c1>-- Ensures overall row appears last</span>
</span><span id=__span-13-105><a id=__codelineno-13-105 name=__codelineno-13-105 href=#__codelineno-13-105></a><span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=mi>101</span><span class=w> </span><span class=c1>-- Fallback for any unexpected categories</span>
</span><span id=__span-13-106><a id=__codelineno-13-106 name=__codelineno-13-106 href=#__codelineno-13-106></a><span class=w>    </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Histogram </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>Metric</strong>: patch_exploit_gap </li> <li><strong>Binning</strong>: Adjust bin size as needed (e.g., 30 days)</li> </ul> <h3 id=ch5_fig_510_distribution-of-differences-in-days-between-patch-availability-and-exploit-adding-dates-all-cves-with-patch-and-exploit><strong>Ch5_Fig_5.10_Distribution of differences in days between Patch Availability and Exploit Adding dates (All CVEs with patch and exploit)</strong><a class=headerlink href=#ch5_fig_510_distribution-of-differences-in-days-between-patch-availability-and-exploit-adding-dates-all-cves-with-patch-and-exploit title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: How does the time gap between exploit and patch change when including third-party apps in the Microsoft ecosystem? </li> <li> <p><strong>SQL Query</strong>: (This query uses the unified_patches CTE for a comprehensive view.)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=k>WITH</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=w>            </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=w>                </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=w>            </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span>
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-14-17><a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=w>        </span><span class=p>)</span>
</span><span id=__span-14-18><a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-14-19><a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-14-20><a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=c1>-- Updated date</span>
</span><span id=__span-14-21><a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a><span class=w>        </span><span class=p>)</span>
</span><span id=__span-14-22><a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a><span class=p>),</span>
</span><span id=__span-14-23><a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a><span class=n>unified_exploit_patch_gaps</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-14-24><a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a><span class=w>    </span><span class=c1>-- Microsoft</span>
</span><span id=__span-14-25><a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-14-26><a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-14-27><a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-14-28><a id=__codelineno-14-28 name=__codelineno-14-28 href=#__codelineno-14-28></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-14-29><a id=__codelineno-14-29 name=__codelineno-14-29 href=#__codelineno-14-29></a><span class=w>        </span><span class=s1>&#39;Microsoft&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-14-30><a id=__codelineno-14-30 name=__codelineno-14-30 href=#__codelineno-14-30></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-14-31><a id=__codelineno-14-31 name=__codelineno-14-31 href=#__codelineno-14-31></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-14-32><a id=__codelineno-14-32 name=__codelineno-14-32 href=#__codelineno-14-32></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-14-33><a id=__codelineno-14-33 name=__codelineno-14-33 href=#__codelineno-14-33></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-14-34><a id=__codelineno-14-34 name=__codelineno-14-34 href=#__codelineno-14-34></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=p>)</span>
</span><span id=__span-14-35><a id=__codelineno-14-35 name=__codelineno-14-35 href=#__codelineno-14-35></a>
</span><span id=__span-14-36><a id=__codelineno-14-36 name=__codelineno-14-36 href=#__codelineno-14-36></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-14-37><a id=__codelineno-14-37 name=__codelineno-14-37 href=#__codelineno-14-37></a>
</span><span id=__span-14-38><a id=__codelineno-14-38 name=__codelineno-14-38 href=#__codelineno-14-38></a><span class=w>    </span><span class=c1>-- RedHat</span>
</span><span id=__span-14-39><a id=__codelineno-14-39 name=__codelineno-14-39 href=#__codelineno-14-39></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-14-40><a id=__codelineno-14-40 name=__codelineno-14-40 href=#__codelineno-14-40></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-14-41><a id=__codelineno-14-41 name=__codelineno-14-41 href=#__codelineno-14-41></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-14-42><a id=__codelineno-14-42 name=__codelineno-14-42 href=#__codelineno-14-42></a><span class=w>        </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-14-43><a id=__codelineno-14-43 name=__codelineno-14-43 href=#__codelineno-14-43></a><span class=w>        </span><span class=s1>&#39;RedHat&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-14-44><a id=__codelineno-14-44 name=__codelineno-14-44 href=#__codelineno-14-44></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-14-45><a id=__codelineno-14-45 name=__codelineno-14-45 href=#__codelineno-14-45></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-14-46><a id=__codelineno-14-46 name=__codelineno-14-46 href=#__codelineno-14-46></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-14-47><a id=__codelineno-14-47 name=__codelineno-14-47 href=#__codelineno-14-47></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-14-48><a id=__codelineno-14-48 name=__codelineno-14-48 href=#__codelineno-14-48></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=p>)</span>
</span><span id=__span-14-49><a id=__codelineno-14-49 name=__codelineno-14-49 href=#__codelineno-14-49></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-14-50><a id=__codelineno-14-50 name=__codelineno-14-50 href=#__codelineno-14-50></a>
</span><span id=__span-14-51><a id=__codelineno-14-51 name=__codelineno-14-51 href=#__codelineno-14-51></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-14-52><a id=__codelineno-14-52 name=__codelineno-14-52 href=#__codelineno-14-52></a>
</span><span id=__span-14-53><a id=__codelineno-14-53 name=__codelineno-14-53 href=#__codelineno-14-53></a><span class=w>    </span><span class=c1>-- Cisco</span>
</span><span id=__span-14-54><a id=__codelineno-14-54 name=__codelineno-14-54 href=#__codelineno-14-54></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-14-55><a id=__codelineno-14-55 name=__codelineno-14-55 href=#__codelineno-14-55></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-14-56><a id=__codelineno-14-56 name=__codelineno-14-56 href=#__codelineno-14-56></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-14-57><a id=__codelineno-14-57 name=__codelineno-14-57 href=#__codelineno-14-57></a><span class=w>        </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-14-58><a id=__codelineno-14-58 name=__codelineno-14-58 href=#__codelineno-14-58></a><span class=w>        </span><span class=s1>&#39;Cisco&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-14-59><a id=__codelineno-14-59 name=__codelineno-14-59 href=#__codelineno-14-59></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-14-60><a id=__codelineno-14-60 name=__codelineno-14-60 href=#__codelineno-14-60></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-14-61><a id=__codelineno-14-61 name=__codelineno-14-61 href=#__codelineno-14-61></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-14-62><a id=__codelineno-14-62 name=__codelineno-14-62 href=#__codelineno-14-62></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-14-63><a id=__codelineno-14-63 name=__codelineno-14-63 href=#__codelineno-14-63></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=p>)</span>
</span><span id=__span-14-64><a id=__codelineno-14-64 name=__codelineno-14-64 href=#__codelineno-14-64></a><span class=p>),</span>
</span><span id=__span-14-65><a id=__codelineno-14-65 name=__codelineno-14-65 href=#__codelineno-14-65></a><span class=c1>-- Assign the 12 categories to each patch_exploit_gap record for grouping and mode calculation</span>
</span><span id=__span-14-66><a id=__codelineno-14-66 name=__codelineno-14-66 href=#__codelineno-14-66></a><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-14-67><a id=__codelineno-14-67 name=__codelineno-14-67 href=#__codelineno-14-67></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-14-68><a id=__codelineno-14-68 name=__codelineno-14-68 href=#__codelineno-14-68></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-14-69><a id=__codelineno-14-69 name=__codelineno-14-69 href=#__codelineno-14-69></a><span class=w>        </span><span class=n>patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-14-70><a id=__codelineno-14-70 name=__codelineno-14-70 href=#__codelineno-14-70></a><span class=w>        </span><span class=k>CASE</span>
</span><span id=__span-14-71><a id=__codelineno-14-71 name=__codelineno-14-71 href=#__codelineno-14-71></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span>
</span><span id=__span-14-72><a id=__codelineno-14-72 name=__codelineno-14-72 href=#__codelineno-14-72></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>365</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>181</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span>
</span><span id=__span-14-73><a id=__codelineno-14-73 name=__codelineno-14-73 href=#__codelineno-14-73></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>180</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>91</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span>
</span><span id=__span-14-74><a id=__codelineno-14-74 name=__codelineno-14-74 href=#__codelineno-14-74></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>90</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>31</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span>
</span><span id=__span-14-75><a id=__codelineno-14-75 name=__codelineno-14-75 href=#__codelineno-14-75></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=o>-</span><span class=mi>30</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span>
</span><span id=__span-14-76><a id=__codelineno-14-76 name=__codelineno-14-76 href=#__codelineno-14-76></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span>
</span><span id=__span-14-77><a id=__codelineno-14-77 name=__codelineno-14-77 href=#__codelineno-14-77></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>30</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span>
</span><span id=__span-14-78><a id=__codelineno-14-78 name=__codelineno-14-78 href=#__codelineno-14-78></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>31</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>90</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span>
</span><span id=__span-14-79><a id=__codelineno-14-79 name=__codelineno-14-79 href=#__codelineno-14-79></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>91</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>180</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span>
</span><span id=__span-14-80><a id=__codelineno-14-80 name=__codelineno-14-80 href=#__codelineno-14-80></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>181</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span>
</span><span id=__span-14-81><a id=__codelineno-14-81 name=__codelineno-14-81 href=#__codelineno-14-81></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>365</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span>
</span><span id=__span-14-82><a id=__codelineno-14-82 name=__codelineno-14-82 href=#__codelineno-14-82></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span>
</span><span id=__span-14-83><a id=__codelineno-14-83 name=__codelineno-14-83 href=#__codelineno-14-83></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-14-84><a id=__codelineno-14-84 name=__codelineno-14-84 href=#__codelineno-14-84></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_exploit_patch_gaps</span>
</span><span id=__span-14-85><a id=__codelineno-14-85 name=__codelineno-14-85 href=#__codelineno-14-85></a><span class=p>),</span>
</span><span id=__span-14-86><a id=__codelineno-14-86 name=__codelineno-14-86 href=#__codelineno-14-86></a><span class=c1>-- Calculate statistics for each category (count, avg, median, mode)</span>
</span><span id=__span-14-87><a id=__codelineno-14-87 name=__codelineno-14-87 href=#__codelineno-14-87></a><span class=n>categorized_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-14-88><a id=__codelineno-14-88 name=__codelineno-14-88 href=#__codelineno-14-88></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-14-89><a id=__codelineno-14-89 name=__codelineno-14-89 href=#__codelineno-14-89></a><span class=w>        </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-14-90><a id=__codelineno-14-90 name=__codelineno-14-90 href=#__codelineno-14-90></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-14-91><a id=__codelineno-14-91 name=__codelineno-14-91 href=#__codelineno-14-91></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-14-92><a id=__codelineno-14-92 name=__codelineno-14-92 href=#__codelineno-14-92></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-14-93><a id=__codelineno-14-93 name=__codelineno-14-93 href=#__codelineno-14-93></a><span class=w>        </span><span class=c1>-- Subquery to calculate mode for the current category</span>
</span><span id=__span-14-94><a id=__codelineno-14-94 name=__codelineno-14-94 href=#__codelineno-14-94></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-14-95><a id=__codelineno-14-95 name=__codelineno-14-95 href=#__codelineno-14-95></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-14-96><a id=__codelineno-14-96 name=__codelineno-14-96 href=#__codelineno-14-96></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sub</span>
</span><span id=__span-14-97><a id=__codelineno-14-97 name=__codelineno-14-97 href=#__codelineno-14-97></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>sub</span><span class=p>.</span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span><span class=p>.</span><span class=n>time_gap_category</span>
</span><span id=__span-14-98><a id=__codelineno-14-98 name=__codelineno-14-98 href=#__codelineno-14-98></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-14-99><a id=__codelineno-14-99 name=__codelineno-14-99 href=#__codelineno-14-99></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-14-100><a id=__codelineno-14-100 name=__codelineno-14-100 href=#__codelineno-14-100></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-14-101><a id=__codelineno-14-101 name=__codelineno-14-101 href=#__codelineno-14-101></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_patch_exploit_gap</span>
</span><span id=__span-14-102><a id=__codelineno-14-102 name=__codelineno-14-102 href=#__codelineno-14-102></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_gaps_with_mode_input</span>
</span><span id=__span-14-103><a id=__codelineno-14-103 name=__codelineno-14-103 href=#__codelineno-14-103></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>time_gap_category</span>
</span><span id=__span-14-104><a id=__codelineno-14-104 name=__codelineno-14-104 href=#__codelineno-14-104></a><span class=p>),</span>
</span><span id=__span-14-105><a id=__codelineno-14-105 name=__codelineno-14-105 href=#__codelineno-14-105></a><span class=c1>-- Calculate overall statistics (count, avg, median, mode)</span>
</span><span id=__span-14-106><a id=__codelineno-14-106 name=__codelineno-14-106 href=#__codelineno-14-106></a><span class=n>overall_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-14-107><a id=__codelineno-14-107 name=__codelineno-14-107 href=#__codelineno-14-107></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-14-108><a id=__codelineno-14-108 name=__codelineno-14-108 href=#__codelineno-14-108></a><span class=w>        </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_gap_category</span><span class=p>,</span>
</span><span id=__span-14-109><a id=__codelineno-14-109 name=__codelineno-14-109 href=#__codelineno-14-109></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_count</span><span class=p>,</span>
</span><span id=__span-14-110><a id=__codelineno-14-110 name=__codelineno-14-110 href=#__codelineno-14-110></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-14-111><a id=__codelineno-14-111 name=__codelineno-14-111 href=#__codelineno-14-111></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-14-112><a id=__codelineno-14-112 name=__codelineno-14-112 href=#__codelineno-14-112></a><span class=w>        </span><span class=c1>-- Subquery to calculate overall mode</span>
</span><span id=__span-14-113><a id=__codelineno-14-113 name=__codelineno-14-113 href=#__codelineno-14-113></a><span class=w>        </span><span class=p>(</span>
</span><span id=__span-14-114><a id=__codelineno-14-114 name=__codelineno-14-114 href=#__codelineno-14-114></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-14-115><a id=__codelineno-14-115 name=__codelineno-14-115 href=#__codelineno-14-115></a><span class=w>            </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_exploit_patch_gaps</span>
</span><span id=__span-14-116><a id=__codelineno-14-116 name=__codelineno-14-116 href=#__codelineno-14-116></a><span class=w>            </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>patch_exploit_gap</span>
</span><span id=__span-14-117><a id=__codelineno-14-117 name=__codelineno-14-117 href=#__codelineno-14-117></a><span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>ASC</span>
</span><span id=__span-14-118><a id=__codelineno-14-118 name=__codelineno-14-118 href=#__codelineno-14-118></a><span class=w>            </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-14-119><a id=__codelineno-14-119 name=__codelineno-14-119 href=#__codelineno-14-119></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_patch_exploit_gap</span>
</span><span id=__span-14-120><a id=__codelineno-14-120 name=__codelineno-14-120 href=#__codelineno-14-120></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_exploit_patch_gaps</span>
</span><span id=__span-14-121><a id=__codelineno-14-121 name=__codelineno-14-121 href=#__codelineno-14-121></a><span class=p>)</span>
</span><span id=__span-14-122><a id=__codelineno-14-122 name=__codelineno-14-122 href=#__codelineno-14-122></a><span class=c1>-- Wrap the UNION ALL in a subquery (derived table) and then apply ORDER BY</span>
</span><span id=__span-14-123><a id=__codelineno-14-123 name=__codelineno-14-123 href=#__codelineno-14-123></a><span class=k>SELECT</span><span class=w> </span><span class=o>*</span>
</span><span id=__span-14-124><a id=__codelineno-14-124 name=__codelineno-14-124 href=#__codelineno-14-124></a><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-14-125><a id=__codelineno-14-125 name=__codelineno-14-125 href=#__codelineno-14-125></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>categorized_stats</span>
</span><span id=__span-14-126><a id=__codelineno-14-126 name=__codelineno-14-126 href=#__codelineno-14-126></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-14-127><a id=__codelineno-14-127 name=__codelineno-14-127 href=#__codelineno-14-127></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>overall_stats</span>
</span><span id=__span-14-128><a id=__codelineno-14-128 name=__codelineno-14-128 href=#__codelineno-14-128></a><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>combined_results</span>
</span><span id=__span-14-129><a id=__codelineno-14-129 name=__codelineno-14-129 href=#__codelineno-14-129></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span>
</span><span id=__span-14-130><a id=__codelineno-14-130 name=__codelineno-14-130 href=#__codelineno-14-130></a><span class=w>    </span><span class=k>CASE</span>
</span><span id=__span-14-131><a id=__codelineno-14-131 name=__codelineno-14-131 href=#__codelineno-14-131></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&lt; -365 days (More than 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-14-132><a id=__codelineno-14-132 name=__codelineno-14-132 href=#__codelineno-14-132></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-365 to -181 days (6 months to 1 year before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-14-133><a id=__codelineno-14-133 name=__codelineno-14-133 href=#__codelineno-14-133></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-180 to -91 days (3 to 6 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-14-134><a id=__codelineno-14-134 name=__codelineno-14-134 href=#__codelineno-14-134></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-90 to -31 days (1 to 3 months before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span>
</span><span id=__span-14-135><a id=__codelineno-14-135 name=__codelineno-14-135 href=#__codelineno-14-135></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-30 to -1 days (Up to 1 month before CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>5</span>
</span><span id=__span-14-136><a id=__codelineno-14-136 name=__codelineno-14-136 href=#__codelineno-14-136></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;0 days (Same day as CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>6</span>
</span><span id=__span-14-137><a id=__codelineno-14-137 name=__codelineno-14-137 href=#__codelineno-14-137></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;1 to 30 days (Up to 1 month after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>7</span>
</span><span id=__span-14-138><a id=__codelineno-14-138 name=__codelineno-14-138 href=#__codelineno-14-138></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;31 to 90 days (1 to 3 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>8</span>
</span><span id=__span-14-139><a id=__codelineno-14-139 name=__codelineno-14-139 href=#__codelineno-14-139></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;91 to 180 days (3 to 6 months after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>9</span>
</span><span id=__span-14-140><a id=__codelineno-14-140 name=__codelineno-14-140 href=#__codelineno-14-140></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;181 to 365 days (6 months to 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>10</span>
</span><span id=__span-14-141><a id=__codelineno-14-141 name=__codelineno-14-141 href=#__codelineno-14-141></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&gt; 365 days (More than 1 year after CVE)&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>11</span>
</span><span id=__span-14-142><a id=__codelineno-14-142 name=__codelineno-14-142 href=#__codelineno-14-142></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>12</span>
</span><span id=__span-14-143><a id=__codelineno-14-143 name=__codelineno-14-143 href=#__codelineno-14-143></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>time_gap_category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Overall Distribution&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=c1>-- Ensures overall row appears last</span>
</span><span id=__span-14-144><a id=__codelineno-14-144 name=__codelineno-14-144 href=#__codelineno-14-144></a><span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=mi>101</span><span class=w> </span><span class=c1>-- Fallback for any unexpected categories</span>
</span><span id=__span-14-145><a id=__codelineno-14-145 name=__codelineno-14-145 href=#__codelineno-14-145></a><span class=w>    </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Histogram </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>Metric</strong>: patch_exploit_gap </li> <li><strong>Binning</strong>: Adjust bin size as needed (e.g., 30 days)</li> </ul> <h3 id=ch5_fig_511_gap-between-exploit-and-patch-dates-for-microsoft-related-cves-2016-2025><strong>Ch5_Fig_5.11_Gap between exploit and patch dates for Microsoft-related CVEs (2016-2025)</strong><a class=headerlink href=#ch5_fig_511_gap-between-exploit-and-patch-dates-for-microsoft-related-cves-2016-2025 title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: For Microsoft-related CVEs, what percentage are patched before they are exploited? </li> <li> <p><strong>SQL Query</strong>:<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=k>WITH</span><span class=w> </span><span class=n>microsoft_cves_with_patch_and_exploit</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=w>    </span><span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>UNNEST</span><span class=p>(</span><span class=n>STRING_SPLIT</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>cpes</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cpe_unnest</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>)</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>SPLIT_PART</span><span class=p>(</span><span class=n>cpe_entry</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;:&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>))</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;microsoft&#39;</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-15-14><a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=p>),</span>
</span><span id=__span-15-15><a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a><span class=n>indexed_cves</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-15-16><a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-15-17><a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-15-18><a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-15-19><a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_published_date</span><span class=p>,</span>
</span><span id=__span-15-20><a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a><span class=w>        </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>ASC</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_index</span>
</span><span id=__span-15-21><a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-15-22><a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-15-23><a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_cves_with_patch_and_exploit</span><span class=p>)</span>
</span><span id=__span-15-24><a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a><span class=p>)</span>
</span><span id=__span-15-25><a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a><span class=k>SELECT</span>
</span><span id=__span-15-26><a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a><span class=w>    </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-15-27><a id=__codelineno-15-27 name=__codelineno-15-27 href=#__codelineno-15-27></a><span class=w>    </span><span class=n>date_reserved</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>date_value</span><span class=p>,</span>
</span><span id=__span-15-28><a id=__codelineno-15-28 name=__codelineno-15-28 href=#__codelineno-15-28></a><span class=w>    </span><span class=s1>&#39;CVE Reserve Date&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>date_type</span><span class=p>,</span>
</span><span id=__span-15-29><a id=__codelineno-15-29 name=__codelineno-15-29 href=#__codelineno-15-29></a><span class=w>    </span><span class=n>cve_index</span>
</span><span id=__span-15-30><a id=__codelineno-15-30 name=__codelineno-15-30 href=#__codelineno-15-30></a><span class=k>FROM</span><span class=w> </span><span class=n>indexed_cves</span>
</span><span id=__span-15-31><a id=__codelineno-15-31 name=__codelineno-15-31 href=#__codelineno-15-31></a>
</span><span id=__span-15-32><a id=__codelineno-15-32 name=__codelineno-15-32 href=#__codelineno-15-32></a><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-15-33><a id=__codelineno-15-33 name=__codelineno-15-33 href=#__codelineno-15-33></a>
</span><span id=__span-15-34><a id=__codelineno-15-34 name=__codelineno-15-34 href=#__codelineno-15-34></a><span class=k>SELECT</span>
</span><span id=__span-15-35><a id=__codelineno-15-35 name=__codelineno-15-35 href=#__codelineno-15-35></a><span class=w>    </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-15-36><a id=__codelineno-15-36 name=__codelineno-15-36 href=#__codelineno-15-36></a><span class=w>    </span><span class=n>exploit_published_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>date_value</span><span class=p>,</span>
</span><span id=__span-15-37><a id=__codelineno-15-37 name=__codelineno-15-37 href=#__codelineno-15-37></a><span class=w>    </span><span class=s1>&#39;Exploit Published Date&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>date_type</span><span class=p>,</span>
</span><span id=__span-15-38><a id=__codelineno-15-38 name=__codelineno-15-38 href=#__codelineno-15-38></a><span class=w>    </span><span class=n>cve_index</span>
</span><span id=__span-15-39><a id=__codelineno-15-39 name=__codelineno-15-39 href=#__codelineno-15-39></a><span class=k>FROM</span><span class=w> </span><span class=n>indexed_cves</span>
</span><span id=__span-15-40><a id=__codelineno-15-40 name=__codelineno-15-40 href=#__codelineno-15-40></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>cve_index</span><span class=p>,</span><span class=w> </span><span class=n>date_type</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Line Chart </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>Set X-Axis to</strong> date_value.</li> <li><strong>Set Y-Axis to</strong> cve_index.</li> <li><strong>Set Group by / Series to</strong> date_type.</li> </ul> <h3 id=ch5_fig_511_gap-between-exploit-and-patch-dates-for-all-vendors-cves-2016-2025><strong>Ch5_Fig_5.11_Gap between exploit and patch dates for All Vendors CVEs (2016-2025)</strong><a class=headerlink href=#ch5_fig_511_gap-between-exploit-and-patch-dates-for-all-vendors-cves-2016-2025 title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: For all vendor CVEs, what percentage are patched before they are exploited across the ecosystem? </li> <li><strong>SQL Query</strong>: </li> </ul> <p><div class="language-sql highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=k>WITH</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=w>            </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=w>                </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=w>            </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=w>        </span><span class=p>)</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a><span class=w>            </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span>
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a><span class=w>            </span><span class=k>WHERE</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a><span class=w>        </span><span class=p>)</span>
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a><span class=p>),</span>
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a><span class=n>indexed_cves</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-16-24><a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-16-25><a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-16-26><a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-16-27><a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_published_date</span><span class=p>,</span>
</span><span id=__span-16-28><a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a><span class=w>        </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>ASC</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_index</span>
</span><span id=__span-16-29><a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-16-30><a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-16-31><a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>cve_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=p>)</span>
</span><span id=__span-16-32><a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a><span class=p>)</span>
</span><span id=__span-16-33><a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a><span class=k>SELECT</span>
</span><span id=__span-16-34><a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a><span class=w>    </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-16-35><a id=__codelineno-16-35 name=__codelineno-16-35 href=#__codelineno-16-35></a><span class=w>    </span><span class=n>date_reserved</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>date_value</span><span class=p>,</span>
</span><span id=__span-16-36><a id=__codelineno-16-36 name=__codelineno-16-36 href=#__codelineno-16-36></a><span class=w>    </span><span class=s1>&#39;CVE Reserve Date&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>date_type</span><span class=p>,</span>
</span><span id=__span-16-37><a id=__codelineno-16-37 name=__codelineno-16-37 href=#__codelineno-16-37></a><span class=w>    </span><span class=n>cve_index</span>
</span><span id=__span-16-38><a id=__codelineno-16-38 name=__codelineno-16-38 href=#__codelineno-16-38></a><span class=k>FROM</span><span class=w> </span><span class=n>indexed_cves</span>
</span><span id=__span-16-39><a id=__codelineno-16-39 name=__codelineno-16-39 href=#__codelineno-16-39></a>
</span><span id=__span-16-40><a id=__codelineno-16-40 name=__codelineno-16-40 href=#__codelineno-16-40></a><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-16-41><a id=__codelineno-16-41 name=__codelineno-16-41 href=#__codelineno-16-41></a>
</span><span id=__span-16-42><a id=__codelineno-16-42 name=__codelineno-16-42 href=#__codelineno-16-42></a><span class=k>SELECT</span>
</span><span id=__span-16-43><a id=__codelineno-16-43 name=__codelineno-16-43 href=#__codelineno-16-43></a><span class=w>    </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-16-44><a id=__codelineno-16-44 name=__codelineno-16-44 href=#__codelineno-16-44></a><span class=w>    </span><span class=n>exploit_published_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>date_value</span><span class=p>,</span>
</span><span id=__span-16-45><a id=__codelineno-16-45 name=__codelineno-16-45 href=#__codelineno-16-45></a><span class=w>    </span><span class=s1>&#39;Exploit Published Date&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>date_type</span><span class=p>,</span>
</span><span id=__span-16-46><a id=__codelineno-16-46 name=__codelineno-16-46 href=#__codelineno-16-46></a><span class=w>    </span><span class=n>cve_index</span>
</span><span id=__span-16-47><a id=__codelineno-16-47 name=__codelineno-16-47 href=#__codelineno-16-47></a><span class=k>FROM</span><span class=w> </span><span class=n>indexed_cves</span>
</span><span id=__span-16-48><a id=__codelineno-16-48 name=__codelineno-16-48 href=#__codelineno-16-48></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>cve_index</span><span class=p>,</span><span class=w> </span><span class=n>date_type</span><span class=p>;</span>
</span></code></pre></div> * <strong>Superset Chart Type</strong>: Line Chart<br> * <strong>Superset Configuration</strong>:<br> * <strong>Set X-Axis to</strong> date_value. * <strong>Set Y-Axis to</strong> cve_index. * <strong>Set Group by / Series to</strong> date_type.</p> <h3 id=ch5_tab_51_lifecycle-events-differences-by-severity-days><strong>Ch5_Tab_5.1_Lifecycle Events Differences by Severity (Days)</strong><a class=headerlink href=#ch5_tab_51_lifecycle-events-differences-by-severity-days title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: How do the time differences between lifecycle events (disclosure, exploit, patch) vary across different severity levels? </li> <li> <p><strong>SQL Query</strong>: (This query uses msrc_patches for Microsoft-specific data as per the original table.)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=k>WITH</span><span class=w> </span><span class=n>microsoft_cves_with_patch_and_exploit</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>,</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=w>        </span><span class=c1>-- Prioritize CVSS versions: v4 -&gt; v3 -&gt; v2</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-17-22><a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-17-23><a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-17-24><a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-17-25><a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-17-26><a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-17-27><a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-17-28><a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-17-29><a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-17-30><a id=__codelineno-17-30 name=__codelineno-17-30 href=#__codelineno-17-30></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-17-31><a id=__codelineno-17-31 name=__codelineno-17-31 href=#__codelineno-17-31></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-17-32><a id=__codelineno-17-32 name=__codelineno-17-32 href=#__codelineno-17-32></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-17-33><a id=__codelineno-17-33 name=__codelineno-17-33 href=#__codelineno-17-33></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-17-34><a id=__codelineno-17-34 name=__codelineno-17-34 href=#__codelineno-17-34></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-17-35><a id=__codelineno-17-35 name=__codelineno-17-35 href=#__codelineno-17-35></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-17-36><a id=__codelineno-17-36 name=__codelineno-17-36 href=#__codelineno-17-36></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-17-37><a id=__codelineno-17-37 name=__codelineno-17-37 href=#__codelineno-17-37></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-17-38><a id=__codelineno-17-38 name=__codelineno-17-38 href=#__codelineno-17-38></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-17-39><a id=__codelineno-17-39 name=__codelineno-17-39 href=#__codelineno-17-39></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-17-40><a id=__codelineno-17-40 name=__codelineno-17-40 href=#__codelineno-17-40></a><span class=p>),</span>
</span><span id=__span-17-41><a id=__codelineno-17-41 name=__codelineno-17-41 href=#__codelineno-17-41></a><span class=n>lifecycle_timing</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-17-42><a id=__codelineno-17-42 name=__codelineno-17-42 href=#__codelineno-17-42></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-17-43><a id=__codelineno-17-43 name=__codelineno-17-43 href=#__codelineno-17-43></a><span class=w>        </span><span class=n>mc</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-17-44><a id=__codelineno-17-44 name=__codelineno-17-44 href=#__codelineno-17-44></a><span class=w>        </span><span class=n>mc</span><span class=p>.</span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-17-45><a id=__codelineno-17-45 name=__codelineno-17-45 href=#__codelineno-17-45></a><span class=w>        </span><span class=n>mc</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-17-46><a id=__codelineno-17-46 name=__codelineno-17-46 href=#__codelineno-17-46></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-17-47><a id=__codelineno-17-47 name=__codelineno-17-47 href=#__codelineno-17-47></a><span class=w>        </span><span class=n>mc</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-17-48><a id=__codelineno-17-48 name=__codelineno-17-48 href=#__codelineno-17-48></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_creation_gap</span><span class=p>,</span>
</span><span id=__span-17-49><a id=__codelineno-17-49 name=__codelineno-17-49 href=#__codelineno-17-49></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-17-50><a id=__codelineno-17-50 name=__codelineno-17-50 href=#__codelineno-17-50></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_creation_gap</span>
</span><span id=__span-17-51><a id=__codelineno-17-51 name=__codelineno-17-51 href=#__codelineno-17-51></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_cves_with_patch_and_exploit</span><span class=w> </span><span class=n>mc</span>
</span><span id=__span-17-52><a id=__codelineno-17-52 name=__codelineno-17-52 href=#__codelineno-17-52></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-17-53><a id=__codelineno-17-53 name=__codelineno-17-53 href=#__codelineno-17-53></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>severity_level</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-17-54><a id=__codelineno-17-54 name=__codelineno-17-54 href=#__codelineno-17-54></a><span class=p>),</span>
</span><span id=__span-17-55><a id=__codelineno-17-55 name=__codelineno-17-55 href=#__codelineno-17-55></a><span class=n>event_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-17-56><a id=__codelineno-17-56 name=__codelineno-17-56 href=#__codelineno-17-56></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-17-57><a id=__codelineno-17-57 name=__codelineno-17-57 href=#__codelineno-17-57></a><span class=w>        </span><span class=s1>&#39;Exploit - Creation&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-17-58><a id=__codelineno-17-58 name=__codelineno-17-58 href=#__codelineno-17-58></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-17-59><a id=__codelineno-17-59 name=__codelineno-17-59 href=#__codelineno-17-59></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>exploit_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span>
</span><span id=__span-17-60><a id=__codelineno-17-60 name=__codelineno-17-60 href=#__codelineno-17-60></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>exploit_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span>
</span><span id=__span-17-61><a id=__codelineno-17-61 name=__codelineno-17-61 href=#__codelineno-17-61></a><span class=w>        </span><span class=k>MODE</span><span class=p>(</span><span class=n>exploit_creation_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days</span><span class=p>,</span>
</span><span id=__span-17-62><a id=__codelineno-17-62 name=__codelineno-17-62 href=#__codelineno-17-62></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-17-63><a id=__codelineno-17-63 name=__codelineno-17-63 href=#__codelineno-17-63></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>lifecycle_timing</span>
</span><span id=__span-17-64><a id=__codelineno-17-64 name=__codelineno-17-64 href=#__codelineno-17-64></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-17-65><a id=__codelineno-17-65 name=__codelineno-17-65 href=#__codelineno-17-65></a>
</span><span id=__span-17-66><a id=__codelineno-17-66 name=__codelineno-17-66 href=#__codelineno-17-66></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-17-67><a id=__codelineno-17-67 name=__codelineno-17-67 href=#__codelineno-17-67></a>
</span><span id=__span-17-68><a id=__codelineno-17-68 name=__codelineno-17-68 href=#__codelineno-17-68></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-17-69><a id=__codelineno-17-69 name=__codelineno-17-69 href=#__codelineno-17-69></a><span class=w>        </span><span class=s1>&#39;Patch - Exploit&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-17-70><a id=__codelineno-17-70 name=__codelineno-17-70 href=#__codelineno-17-70></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-17-71><a id=__codelineno-17-71 name=__codelineno-17-71 href=#__codelineno-17-71></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span>
</span><span id=__span-17-72><a id=__codelineno-17-72 name=__codelineno-17-72 href=#__codelineno-17-72></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span>
</span><span id=__span-17-73><a id=__codelineno-17-73 name=__codelineno-17-73 href=#__codelineno-17-73></a><span class=w>        </span><span class=k>MODE</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days</span><span class=p>,</span>
</span><span id=__span-17-74><a id=__codelineno-17-74 name=__codelineno-17-74 href=#__codelineno-17-74></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-17-75><a id=__codelineno-17-75 name=__codelineno-17-75 href=#__codelineno-17-75></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>lifecycle_timing</span>
</span><span id=__span-17-76><a id=__codelineno-17-76 name=__codelineno-17-76 href=#__codelineno-17-76></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-17-77><a id=__codelineno-17-77 name=__codelineno-17-77 href=#__codelineno-17-77></a>
</span><span id=__span-17-78><a id=__codelineno-17-78 name=__codelineno-17-78 href=#__codelineno-17-78></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-17-79><a id=__codelineno-17-79 name=__codelineno-17-79 href=#__codelineno-17-79></a>
</span><span id=__span-17-80><a id=__codelineno-17-80 name=__codelineno-17-80 href=#__codelineno-17-80></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-17-81><a id=__codelineno-17-81 name=__codelineno-17-81 href=#__codelineno-17-81></a><span class=w>        </span><span class=s1>&#39;Patch - Creation&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-17-82><a id=__codelineno-17-82 name=__codelineno-17-82 href=#__codelineno-17-82></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-17-83><a id=__codelineno-17-83 name=__codelineno-17-83 href=#__codelineno-17-83></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span>
</span><span id=__span-17-84><a id=__codelineno-17-84 name=__codelineno-17-84 href=#__codelineno-17-84></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span>
</span><span id=__span-17-85><a id=__codelineno-17-85 name=__codelineno-17-85 href=#__codelineno-17-85></a><span class=w>        </span><span class=k>MODE</span><span class=p>(</span><span class=n>patch_creation_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days</span><span class=p>,</span>
</span><span id=__span-17-86><a id=__codelineno-17-86 name=__codelineno-17-86 href=#__codelineno-17-86></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-17-87><a id=__codelineno-17-87 name=__codelineno-17-87 href=#__codelineno-17-87></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>lifecycle_timing</span>
</span><span id=__span-17-88><a id=__codelineno-17-88 name=__codelineno-17-88 href=#__codelineno-17-88></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-17-89><a id=__codelineno-17-89 name=__codelineno-17-89 href=#__codelineno-17-89></a><span class=p>)</span>
</span><span id=__span-17-90><a id=__codelineno-17-90 name=__codelineno-17-90 href=#__codelineno-17-90></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-17-91><a id=__codelineno-17-91 name=__codelineno-17-91 href=#__codelineno-17-91></a><span class=w>    </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-17-92><a id=__codelineno-17-92 name=__codelineno-17-92 href=#__codelineno-17-92></a><span class=w>    </span><span class=k>COALESCE</span><span class=p>(</span><span class=k>MAX</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>CONCAT</span><span class=p>(</span><span class=s1>&#39;μ:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; m:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; mo:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mode_days</span><span class=p>)</span><span class=w> </span><span class=k>END</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>critical</span><span class=p>,</span>
</span><span id=__span-17-93><a id=__codelineno-17-93 name=__codelineno-17-93 href=#__codelineno-17-93></a><span class=w>    </span><span class=k>COALESCE</span><span class=p>(</span><span class=k>MAX</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>CONCAT</span><span class=p>(</span><span class=s1>&#39;μ:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; m:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; mo:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mode_days</span><span class=p>)</span><span class=w> </span><span class=k>END</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>high</span><span class=p>,</span>
</span><span id=__span-17-94><a id=__codelineno-17-94 name=__codelineno-17-94 href=#__codelineno-17-94></a><span class=w>    </span><span class=k>COALESCE</span><span class=p>(</span><span class=k>MAX</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>CONCAT</span><span class=p>(</span><span class=s1>&#39;μ:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; m:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; mo:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mode_days</span><span class=p>)</span><span class=w> </span><span class=k>END</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>medium</span><span class=p>,</span>
</span><span id=__span-17-95><a id=__codelineno-17-95 name=__codelineno-17-95 href=#__codelineno-17-95></a><span class=w>    </span><span class=k>COALESCE</span><span class=p>(</span><span class=k>MAX</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>CONCAT</span><span class=p>(</span><span class=s1>&#39;μ:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; m:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; mo:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mode_days</span><span class=p>)</span><span class=w> </span><span class=k>END</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>low</span>
</span><span id=__span-17-96><a id=__codelineno-17-96 name=__codelineno-17-96 href=#__codelineno-17-96></a><span class=k>FROM</span><span class=w> </span><span class=n>event_stats</span>
</span><span id=__span-17-97><a id=__codelineno-17-97 name=__codelineno-17-97 href=#__codelineno-17-97></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-17-98><a id=__codelineno-17-98 name=__codelineno-17-98 href=#__codelineno-17-98></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span>
</span><span id=__span-17-99><a id=__codelineno-17-99 name=__codelineno-17-99 href=#__codelineno-17-99></a><span class=w>    </span><span class=k>CASE</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-17-100><a id=__codelineno-17-100 name=__codelineno-17-100 href=#__codelineno-17-100></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;Exploit - Creation&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-17-101><a id=__codelineno-17-101 name=__codelineno-17-101 href=#__codelineno-17-101></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;Patch - Exploit&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-17-102><a id=__codelineno-17-102 name=__codelineno-17-102 href=#__codelineno-17-102></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;Patch - Creation&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-17-103><a id=__codelineno-17-103 name=__codelineno-17-103 href=#__codelineno-17-103></a><span class=w>    </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Table </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>Columns</strong>: severity_level, median_exploit_creation_gap, median_patch_exploit_gap, median_patch_creation_gap</li> </ul> <h3 id=ch5_tab_51_multi_vendor_lifecycle-events-differences-by-severity-days><strong>Ch5_Tab_5.1_Multi_Vendor_Lifecycle Events Differences by Severity (Days)</strong><a class=headerlink href=#ch5_tab_51_multi_vendor_lifecycle-events-differences-by-severity-days title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: How do the time differences between lifecycle events vary across different severity levels for all vendors?</li> </ul> <div class="language-sql highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=k>WITH</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=w>    </span><span class=c1>-- Microsoft</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=w>        </span><span class=s1>&#39;Microsoft&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-18-15><a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-18-16><a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-18-17><a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-18><a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-18-19><a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-18-20><a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-18-21><a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-18-22><a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-18-23><a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-18-24><a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-25><a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-18-26><a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-18-27><a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-18-28><a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-18-29><a id=__codelineno-18-29 name=__codelineno-18-29 href=#__codelineno-18-29></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-18-30><a id=__codelineno-18-30 name=__codelineno-18-30 href=#__codelineno-18-30></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-18-31><a id=__codelineno-18-31 name=__codelineno-18-31 href=#__codelineno-18-31></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-18-32><a id=__codelineno-18-32 name=__codelineno-18-32 href=#__codelineno-18-32></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-18-33><a id=__codelineno-18-33 name=__codelineno-18-33 href=#__codelineno-18-33></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-18-34><a id=__codelineno-18-34 name=__codelineno-18-34 href=#__codelineno-18-34></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-18-35><a id=__codelineno-18-35 name=__codelineno-18-35 href=#__codelineno-18-35></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-18-36><a id=__codelineno-18-36 name=__codelineno-18-36 href=#__codelineno-18-36></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-18-37><a id=__codelineno-18-37 name=__codelineno-18-37 href=#__codelineno-18-37></a>
</span><span id=__span-18-38><a id=__codelineno-18-38 name=__codelineno-18-38 href=#__codelineno-18-38></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-18-39><a id=__codelineno-18-39 name=__codelineno-18-39 href=#__codelineno-18-39></a>
</span><span id=__span-18-40><a id=__codelineno-18-40 name=__codelineno-18-40 href=#__codelineno-18-40></a><span class=w>    </span><span class=c1>-- RedHat</span>
</span><span id=__span-18-41><a id=__codelineno-18-41 name=__codelineno-18-41 href=#__codelineno-18-41></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-18-42><a id=__codelineno-18-42 name=__codelineno-18-42 href=#__codelineno-18-42></a><span class=w>        </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-18-43><a id=__codelineno-18-43 name=__codelineno-18-43 href=#__codelineno-18-43></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-18-44><a id=__codelineno-18-44 name=__codelineno-18-44 href=#__codelineno-18-44></a><span class=w>        </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-18-45><a id=__codelineno-18-45 name=__codelineno-18-45 href=#__codelineno-18-45></a><span class=w>        </span><span class=s1>&#39;RedHat&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-18-46><a id=__codelineno-18-46 name=__codelineno-18-46 href=#__codelineno-18-46></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-47><a id=__codelineno-18-47 name=__codelineno-18-47 href=#__codelineno-18-47></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-18-48><a id=__codelineno-18-48 name=__codelineno-18-48 href=#__codelineno-18-48></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-49><a id=__codelineno-18-49 name=__codelineno-18-49 href=#__codelineno-18-49></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-18-50><a id=__codelineno-18-50 name=__codelineno-18-50 href=#__codelineno-18-50></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-18-51><a id=__codelineno-18-51 name=__codelineno-18-51 href=#__codelineno-18-51></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-18-52><a id=__codelineno-18-52 name=__codelineno-18-52 href=#__codelineno-18-52></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-18-53><a id=__codelineno-18-53 name=__codelineno-18-53 href=#__codelineno-18-53></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-18-54><a id=__codelineno-18-54 name=__codelineno-18-54 href=#__codelineno-18-54></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-18-55><a id=__codelineno-18-55 name=__codelineno-18-55 href=#__codelineno-18-55></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-56><a id=__codelineno-18-56 name=__codelineno-18-56 href=#__codelineno-18-56></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-18-57><a id=__codelineno-18-57 name=__codelineno-18-57 href=#__codelineno-18-57></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-18-58><a id=__codelineno-18-58 name=__codelineno-18-58 href=#__codelineno-18-58></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-18-59><a id=__codelineno-18-59 name=__codelineno-18-59 href=#__codelineno-18-59></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-18-60><a id=__codelineno-18-60 name=__codelineno-18-60 href=#__codelineno-18-60></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-18-61><a id=__codelineno-18-61 name=__codelineno-18-61 href=#__codelineno-18-61></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-18-62><a id=__codelineno-18-62 name=__codelineno-18-62 href=#__codelineno-18-62></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-63><a id=__codelineno-18-63 name=__codelineno-18-63 href=#__codelineno-18-63></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-18-64><a id=__codelineno-18-64 name=__codelineno-18-64 href=#__codelineno-18-64></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-18-65><a id=__codelineno-18-65 name=__codelineno-18-65 href=#__codelineno-18-65></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-18-66><a id=__codelineno-18-66 name=__codelineno-18-66 href=#__codelineno-18-66></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-18-67><a id=__codelineno-18-67 name=__codelineno-18-67 href=#__codelineno-18-67></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-18-68><a id=__codelineno-18-68 name=__codelineno-18-68 href=#__codelineno-18-68></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-18-69><a id=__codelineno-18-69 name=__codelineno-18-69 href=#__codelineno-18-69></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span>
</span><span id=__span-18-70><a id=__codelineno-18-70 name=__codelineno-18-70 href=#__codelineno-18-70></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-18-71><a id=__codelineno-18-71 name=__codelineno-18-71 href=#__codelineno-18-71></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-18-72><a id=__codelineno-18-72 name=__codelineno-18-72 href=#__codelineno-18-72></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-18-73><a id=__codelineno-18-73 name=__codelineno-18-73 href=#__codelineno-18-73></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-18-74><a id=__codelineno-18-74 name=__codelineno-18-74 href=#__codelineno-18-74></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-18-75><a id=__codelineno-18-75 name=__codelineno-18-75 href=#__codelineno-18-75></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-18-76><a id=__codelineno-18-76 name=__codelineno-18-76 href=#__codelineno-18-76></a>
</span><span id=__span-18-77><a id=__codelineno-18-77 name=__codelineno-18-77 href=#__codelineno-18-77></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-18-78><a id=__codelineno-18-78 name=__codelineno-18-78 href=#__codelineno-18-78></a>
</span><span id=__span-18-79><a id=__codelineno-18-79 name=__codelineno-18-79 href=#__codelineno-18-79></a><span class=w>    </span><span class=c1>-- Cisco</span>
</span><span id=__span-18-80><a id=__codelineno-18-80 name=__codelineno-18-80 href=#__codelineno-18-80></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-18-81><a id=__codelineno-18-81 name=__codelineno-18-81 href=#__codelineno-18-81></a><span class=w>        </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-18-82><a id=__codelineno-18-82 name=__codelineno-18-82 href=#__codelineno-18-82></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-18-83><a id=__codelineno-18-83 name=__codelineno-18-83 href=#__codelineno-18-83></a><span class=w>        </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-18-84><a id=__codelineno-18-84 name=__codelineno-18-84 href=#__codelineno-18-84></a><span class=w>        </span><span class=s1>&#39;Cisco&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-18-85><a id=__codelineno-18-85 name=__codelineno-18-85 href=#__codelineno-18-85></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-86><a id=__codelineno-18-86 name=__codelineno-18-86 href=#__codelineno-18-86></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-18-87><a id=__codelineno-18-87 name=__codelineno-18-87 href=#__codelineno-18-87></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-88><a id=__codelineno-18-88 name=__codelineno-18-88 href=#__codelineno-18-88></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-18-89><a id=__codelineno-18-89 name=__codelineno-18-89 href=#__codelineno-18-89></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-18-90><a id=__codelineno-18-90 name=__codelineno-18-90 href=#__codelineno-18-90></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-18-91><a id=__codelineno-18-91 name=__codelineno-18-91 href=#__codelineno-18-91></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-18-92><a id=__codelineno-18-92 name=__codelineno-18-92 href=#__codelineno-18-92></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-18-93><a id=__codelineno-18-93 name=__codelineno-18-93 href=#__codelineno-18-93></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-18-94><a id=__codelineno-18-94 name=__codelineno-18-94 href=#__codelineno-18-94></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-95><a id=__codelineno-18-95 name=__codelineno-18-95 href=#__codelineno-18-95></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-18-96><a id=__codelineno-18-96 name=__codelineno-18-96 href=#__codelineno-18-96></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-18-97><a id=__codelineno-18-97 name=__codelineno-18-97 href=#__codelineno-18-97></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-18-98><a id=__codelineno-18-98 name=__codelineno-18-98 href=#__codelineno-18-98></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-18-99><a id=__codelineno-18-99 name=__codelineno-18-99 href=#__codelineno-18-99></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-18-100><a id=__codelineno-18-100 name=__codelineno-18-100 href=#__codelineno-18-100></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-18-101><a id=__codelineno-18-101 name=__codelineno-18-101 href=#__codelineno-18-101></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-18-102><a id=__codelineno-18-102 name=__codelineno-18-102 href=#__codelineno-18-102></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-18-103><a id=__codelineno-18-103 name=__codelineno-18-103 href=#__codelineno-18-103></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-18-104><a id=__codelineno-18-104 name=__codelineno-18-104 href=#__codelineno-18-104></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-18-105><a id=__codelineno-18-105 name=__codelineno-18-105 href=#__codelineno-18-105></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-18-106><a id=__codelineno-18-106 name=__codelineno-18-106 href=#__codelineno-18-106></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-18-107><a id=__codelineno-18-107 name=__codelineno-18-107 href=#__codelineno-18-107></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-18-108><a id=__codelineno-18-108 name=__codelineno-18-108 href=#__codelineno-18-108></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span>
</span><span id=__span-18-109><a id=__codelineno-18-109 name=__codelineno-18-109 href=#__codelineno-18-109></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-18-110><a id=__codelineno-18-110 name=__codelineno-18-110 href=#__codelineno-18-110></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-18-111><a id=__codelineno-18-111 name=__codelineno-18-111 href=#__codelineno-18-111></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-18-112><a id=__codelineno-18-112 name=__codelineno-18-112 href=#__codelineno-18-112></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-18-113><a id=__codelineno-18-113 name=__codelineno-18-113 href=#__codelineno-18-113></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-18-114><a id=__codelineno-18-114 name=__codelineno-18-114 href=#__codelineno-18-114></a><span class=p>),</span>
</span><span id=__span-18-115><a id=__codelineno-18-115 name=__codelineno-18-115 href=#__codelineno-18-115></a><span class=n>unified_lifecycle_timing</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-18-116><a id=__codelineno-18-116 name=__codelineno-18-116 href=#__codelineno-18-116></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-18-117><a id=__codelineno-18-117 name=__codelineno-18-117 href=#__codelineno-18-117></a><span class=w>        </span><span class=n>ac</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-18-118><a id=__codelineno-18-118 name=__codelineno-18-118 href=#__codelineno-18-118></a><span class=w>        </span><span class=n>ac</span><span class=p>.</span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-18-119><a id=__codelineno-18-119 name=__codelineno-18-119 href=#__codelineno-18-119></a><span class=w>        </span><span class=n>ac</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-18-120><a id=__codelineno-18-120 name=__codelineno-18-120 href=#__codelineno-18-120></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-18-121><a id=__codelineno-18-121 name=__codelineno-18-121 href=#__codelineno-18-121></a><span class=w>        </span><span class=n>ac</span><span class=p>.</span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-18-122><a id=__codelineno-18-122 name=__codelineno-18-122 href=#__codelineno-18-122></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_creation_gap</span><span class=p>,</span>
</span><span id=__span-18-123><a id=__codelineno-18-123 name=__codelineno-18-123 href=#__codelineno-18-123></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>patch_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-18-124><a id=__codelineno-18-124 name=__codelineno-18-124 href=#__codelineno-18-124></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>patch_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_creation_gap</span>
</span><span id=__span-18-125><a id=__codelineno-18-125 name=__codelineno-18-125 href=#__codelineno-18-125></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=w> </span><span class=n>ac</span>
</span><span id=__span-18-126><a id=__codelineno-18-126 name=__codelineno-18-126 href=#__codelineno-18-126></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-18-127><a id=__codelineno-18-127 name=__codelineno-18-127 href=#__codelineno-18-127></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>severity_level</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-18-128><a id=__codelineno-18-128 name=__codelineno-18-128 href=#__codelineno-18-128></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-18-129><a id=__codelineno-18-129 name=__codelineno-18-129 href=#__codelineno-18-129></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-18-130><a id=__codelineno-18-130 name=__codelineno-18-130 href=#__codelineno-18-130></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-18-131><a id=__codelineno-18-131 name=__codelineno-18-131 href=#__codelineno-18-131></a><span class=p>),</span>
</span><span id=__span-18-132><a id=__codelineno-18-132 name=__codelineno-18-132 href=#__codelineno-18-132></a><span class=n>event_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-18-133><a id=__codelineno-18-133 name=__codelineno-18-133 href=#__codelineno-18-133></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-18-134><a id=__codelineno-18-134 name=__codelineno-18-134 href=#__codelineno-18-134></a><span class=w>        </span><span class=s1>&#39;Exploit - Creation&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-18-135><a id=__codelineno-18-135 name=__codelineno-18-135 href=#__codelineno-18-135></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-18-136><a id=__codelineno-18-136 name=__codelineno-18-136 href=#__codelineno-18-136></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>exploit_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span>
</span><span id=__span-18-137><a id=__codelineno-18-137 name=__codelineno-18-137 href=#__codelineno-18-137></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>exploit_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span>
</span><span id=__span-18-138><a id=__codelineno-18-138 name=__codelineno-18-138 href=#__codelineno-18-138></a><span class=w>        </span><span class=k>MODE</span><span class=p>(</span><span class=n>exploit_creation_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days</span><span class=p>,</span>
</span><span id=__span-18-139><a id=__codelineno-18-139 name=__codelineno-18-139 href=#__codelineno-18-139></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-18-140><a id=__codelineno-18-140 name=__codelineno-18-140 href=#__codelineno-18-140></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_lifecycle_timing</span>
</span><span id=__span-18-141><a id=__codelineno-18-141 name=__codelineno-18-141 href=#__codelineno-18-141></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-18-142><a id=__codelineno-18-142 name=__codelineno-18-142 href=#__codelineno-18-142></a>
</span><span id=__span-18-143><a id=__codelineno-18-143 name=__codelineno-18-143 href=#__codelineno-18-143></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-18-144><a id=__codelineno-18-144 name=__codelineno-18-144 href=#__codelineno-18-144></a>
</span><span id=__span-18-145><a id=__codelineno-18-145 name=__codelineno-18-145 href=#__codelineno-18-145></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-18-146><a id=__codelineno-18-146 name=__codelineno-18-146 href=#__codelineno-18-146></a><span class=w>        </span><span class=s1>&#39;Patch - Exploit&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-18-147><a id=__codelineno-18-147 name=__codelineno-18-147 href=#__codelineno-18-147></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-18-148><a id=__codelineno-18-148 name=__codelineno-18-148 href=#__codelineno-18-148></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span>
</span><span id=__span-18-149><a id=__codelineno-18-149 name=__codelineno-18-149 href=#__codelineno-18-149></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span>
</span><span id=__span-18-150><a id=__codelineno-18-150 name=__codelineno-18-150 href=#__codelineno-18-150></a><span class=w>        </span><span class=k>MODE</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days</span><span class=p>,</span>
</span><span id=__span-18-151><a id=__codelineno-18-151 name=__codelineno-18-151 href=#__codelineno-18-151></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-18-152><a id=__codelineno-18-152 name=__codelineno-18-152 href=#__codelineno-18-152></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_lifecycle_timing</span>
</span><span id=__span-18-153><a id=__codelineno-18-153 name=__codelineno-18-153 href=#__codelineno-18-153></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-18-154><a id=__codelineno-18-154 name=__codelineno-18-154 href=#__codelineno-18-154></a>
</span><span id=__span-18-155><a id=__codelineno-18-155 name=__codelineno-18-155 href=#__codelineno-18-155></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-18-156><a id=__codelineno-18-156 name=__codelineno-18-156 href=#__codelineno-18-156></a>
</span><span id=__span-18-157><a id=__codelineno-18-157 name=__codelineno-18-157 href=#__codelineno-18-157></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-18-158><a id=__codelineno-18-158 name=__codelineno-18-158 href=#__codelineno-18-158></a><span class=w>        </span><span class=s1>&#39;Patch - Creation&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-18-159><a id=__codelineno-18-159 name=__codelineno-18-159 href=#__codelineno-18-159></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-18-160><a id=__codelineno-18-160 name=__codelineno-18-160 href=#__codelineno-18-160></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span>
</span><span id=__span-18-161><a id=__codelineno-18-161 name=__codelineno-18-161 href=#__codelineno-18-161></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span>
</span><span id=__span-18-162><a id=__codelineno-18-162 name=__codelineno-18-162 href=#__codelineno-18-162></a><span class=w>        </span><span class=k>MODE</span><span class=p>(</span><span class=n>patch_creation_gap</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mode_days</span><span class=p>,</span>
</span><span id=__span-18-163><a id=__codelineno-18-163 name=__codelineno-18-163 href=#__codelineno-18-163></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-18-164><a id=__codelineno-18-164 name=__codelineno-18-164 href=#__codelineno-18-164></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_lifecycle_timing</span>
</span><span id=__span-18-165><a id=__codelineno-18-165 name=__codelineno-18-165 href=#__codelineno-18-165></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-18-166><a id=__codelineno-18-166 name=__codelineno-18-166 href=#__codelineno-18-166></a><span class=p>)</span>
</span><span id=__span-18-167><a id=__codelineno-18-167 name=__codelineno-18-167 href=#__codelineno-18-167></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-18-168><a id=__codelineno-18-168 name=__codelineno-18-168 href=#__codelineno-18-168></a><span class=w>    </span><span class=n>event_type</span><span class=p>,</span>
</span><span id=__span-18-169><a id=__codelineno-18-169 name=__codelineno-18-169 href=#__codelineno-18-169></a><span class=w>    </span><span class=k>COALESCE</span><span class=p>(</span><span class=k>MAX</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>CONCAT</span><span class=p>(</span><span class=s1>&#39;μ:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; m:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; mo:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mode_days</span><span class=p>)</span><span class=w> </span><span class=k>END</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>critical</span><span class=p>,</span>
</span><span id=__span-18-170><a id=__codelineno-18-170 name=__codelineno-18-170 href=#__codelineno-18-170></a><span class=w>    </span><span class=k>COALESCE</span><span class=p>(</span><span class=k>MAX</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>CONCAT</span><span class=p>(</span><span class=s1>&#39;μ:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; m:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; mo:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mode_days</span><span class=p>)</span><span class=w> </span><span class=k>END</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>high</span><span class=p>,</span>
</span><span id=__span-18-171><a id=__codelineno-18-171 name=__codelineno-18-171 href=#__codelineno-18-171></a><span class=w>    </span><span class=k>COALESCE</span><span class=p>(</span><span class=k>MAX</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>CONCAT</span><span class=p>(</span><span class=s1>&#39;μ:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; m:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; mo:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mode_days</span><span class=p>)</span><span class=w> </span><span class=k>END</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>medium</span><span class=p>,</span>
</span><span id=__span-18-172><a id=__codelineno-18-172 name=__codelineno-18-172 href=#__codelineno-18-172></a><span class=w>    </span><span class=k>COALESCE</span><span class=p>(</span><span class=k>MAX</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>CONCAT</span><span class=p>(</span><span class=s1>&#39;μ:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mean_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; m:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>median_days</span><span class=p>,</span><span class=w> </span><span class=s1>&#39; mo:&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mode_days</span><span class=p>)</span><span class=w> </span><span class=k>END</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>low</span>
</span><span id=__span-18-173><a id=__codelineno-18-173 name=__codelineno-18-173 href=#__codelineno-18-173></a><span class=k>FROM</span><span class=w> </span><span class=n>event_stats</span>
</span><span id=__span-18-174><a id=__codelineno-18-174 name=__codelineno-18-174 href=#__codelineno-18-174></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-18-175><a id=__codelineno-18-175 name=__codelineno-18-175 href=#__codelineno-18-175></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span>
</span><span id=__span-18-176><a id=__codelineno-18-176 name=__codelineno-18-176 href=#__codelineno-18-176></a><span class=w>    </span><span class=k>CASE</span><span class=w> </span><span class=n>event_type</span>
</span><span id=__span-18-177><a id=__codelineno-18-177 name=__codelineno-18-177 href=#__codelineno-18-177></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;Exploit - Creation&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-18-178><a id=__codelineno-18-178 name=__codelineno-18-178 href=#__codelineno-18-178></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;Patch - Exploit&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-18-179><a id=__codelineno-18-179 name=__codelineno-18-179 href=#__codelineno-18-179></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;Patch - Creation&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-18-180><a id=__codelineno-18-180 name=__codelineno-18-180 href=#__codelineno-18-180></a><span class=w>    </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div> <h3 id=ch5_fig_512_yearly-trend-of-mean-and-median-time-differences-for-critical-severity-across-all-events><strong>Ch5_Fig_5.12_Yearly trend of mean and median time differences for Critical severity across all events</strong><a class=headerlink href=#ch5_fig_512_yearly-trend-of-mean-and-median-time-differences-for-critical-severity-across-all-events title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: What is the yearly trend for lifecycle event timing for Critical severity vulnerabilities? </li> <li> <p><strong>SQL Query</strong>: (This query uses msrc_patches for Microsoft-specific data. You could adapt it to use unified_patches for an overall view.)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=k>WITH</span><span class=w> </span><span class=n>microsoft_cves_with_patch_and_exploit</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>,</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=w>        </span><span class=c1>-- Prioritize CVSS versions: v4 -&gt; v3 -&gt; v2</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-19-14><a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-19-15><a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-19-16><a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-19-17><a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-19-18><a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-19-19><a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-19-20><a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-19-21><a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-19-22><a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-19-23><a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-19-24><a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-19-25><a id=__codelineno-19-25 name=__codelineno-19-25 href=#__codelineno-19-25></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-19-26><a id=__codelineno-19-26 name=__codelineno-19-26 href=#__codelineno-19-26></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-19-27><a id=__codelineno-19-27 name=__codelineno-19-27 href=#__codelineno-19-27></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-19-28><a id=__codelineno-19-28 name=__codelineno-19-28 href=#__codelineno-19-28></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-19-29><a id=__codelineno-19-29 name=__codelineno-19-29 href=#__codelineno-19-29></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-19-30><a id=__codelineno-19-30 name=__codelineno-19-30 href=#__codelineno-19-30></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-19-31><a id=__codelineno-19-31 name=__codelineno-19-31 href=#__codelineno-19-31></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-19-32><a id=__codelineno-19-32 name=__codelineno-19-32 href=#__codelineno-19-32></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-19-33><a id=__codelineno-19-33 name=__codelineno-19-33 href=#__codelineno-19-33></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-19-34><a id=__codelineno-19-34 name=__codelineno-19-34 href=#__codelineno-19-34></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-19-35><a id=__codelineno-19-35 name=__codelineno-19-35 href=#__codelineno-19-35></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-19-36><a id=__codelineno-19-36 name=__codelineno-19-36 href=#__codelineno-19-36></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-19-37><a id=__codelineno-19-37 name=__codelineno-19-37 href=#__codelineno-19-37></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-19-38><a id=__codelineno-19-38 name=__codelineno-19-38 href=#__codelineno-19-38></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-19-39><a id=__codelineno-19-39 name=__codelineno-19-39 href=#__codelineno-19-39></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-19-40><a id=__codelineno-19-40 name=__codelineno-19-40 href=#__codelineno-19-40></a><span class=p>),</span>
</span><span id=__span-19-41><a id=__codelineno-19-41 name=__codelineno-19-41 href=#__codelineno-19-41></a><span class=n>yearly_lifecycle_timing</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-19-42><a id=__codelineno-19-42 name=__codelineno-19-42 href=#__codelineno-19-42></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-19-43><a id=__codelineno-19-43 name=__codelineno-19-43 href=#__codelineno-19-43></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-19-44><a id=__codelineno-19-44 name=__codelineno-19-44 href=#__codelineno-19-44></a><span class=w>        </span><span class=n>mc</span><span class=p>.</span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-19-45><a id=__codelineno-19-45 name=__codelineno-19-45 href=#__codelineno-19-45></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_creation_gap</span><span class=p>,</span>
</span><span id=__span-19-46><a id=__codelineno-19-46 name=__codelineno-19-46 href=#__codelineno-19-46></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-19-47><a id=__codelineno-19-47 name=__codelineno-19-47 href=#__codelineno-19-47></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_creation_gap</span>
</span><span id=__span-19-48><a id=__codelineno-19-48 name=__codelineno-19-48 href=#__codelineno-19-48></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_cves_with_patch_and_exploit</span><span class=w> </span><span class=n>mc</span>
</span><span id=__span-19-49><a id=__codelineno-19-49 name=__codelineno-19-49 href=#__codelineno-19-49></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-19-50><a id=__codelineno-19-50 name=__codelineno-19-50 href=#__codelineno-19-50></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-19-51><a id=__codelineno-19-51 name=__codelineno-19-51 href=#__codelineno-19-51></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-19-52><a id=__codelineno-19-52 name=__codelineno-19-52 href=#__codelineno-19-52></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016&#39;</span>
</span><span id=__span-19-53><a id=__codelineno-19-53 name=__codelineno-19-53 href=#__codelineno-19-53></a><span class=p>),</span>
</span><span id=__span-19-54><a id=__codelineno-19-54 name=__codelineno-19-54 href=#__codelineno-19-54></a><span class=n>yearly_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-19-55><a id=__codelineno-19-55 name=__codelineno-19-55 href=#__codelineno-19-55></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-19-56><a id=__codelineno-19-56 name=__codelineno-19-56 href=#__codelineno-19-56></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-19-57><a id=__codelineno-19-57 name=__codelineno-19-57 href=#__codelineno-19-57></a><span class=w>        </span><span class=s1>&#39;Exploit - Creation (Mean)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-19-58><a id=__codelineno-19-58 name=__codelineno-19-58 href=#__codelineno-19-58></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>exploit_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-19-59><a id=__codelineno-19-59 name=__codelineno-19-59 href=#__codelineno-19-59></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-19-60><a id=__codelineno-19-60 name=__codelineno-19-60 href=#__codelineno-19-60></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-19-61><a id=__codelineno-19-61 name=__codelineno-19-61 href=#__codelineno-19-61></a>
</span><span id=__span-19-62><a id=__codelineno-19-62 name=__codelineno-19-62 href=#__codelineno-19-62></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-19-63><a id=__codelineno-19-63 name=__codelineno-19-63 href=#__codelineno-19-63></a>
</span><span id=__span-19-64><a id=__codelineno-19-64 name=__codelineno-19-64 href=#__codelineno-19-64></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-19-65><a id=__codelineno-19-65 name=__codelineno-19-65 href=#__codelineno-19-65></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-19-66><a id=__codelineno-19-66 name=__codelineno-19-66 href=#__codelineno-19-66></a><span class=w>        </span><span class=s1>&#39;Exploit - Creation (Median)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-19-67><a id=__codelineno-19-67 name=__codelineno-19-67 href=#__codelineno-19-67></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>exploit_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-19-68><a id=__codelineno-19-68 name=__codelineno-19-68 href=#__codelineno-19-68></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-19-69><a id=__codelineno-19-69 name=__codelineno-19-69 href=#__codelineno-19-69></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-19-70><a id=__codelineno-19-70 name=__codelineno-19-70 href=#__codelineno-19-70></a>
</span><span id=__span-19-71><a id=__codelineno-19-71 name=__codelineno-19-71 href=#__codelineno-19-71></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-19-72><a id=__codelineno-19-72 name=__codelineno-19-72 href=#__codelineno-19-72></a>
</span><span id=__span-19-73><a id=__codelineno-19-73 name=__codelineno-19-73 href=#__codelineno-19-73></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-19-74><a id=__codelineno-19-74 name=__codelineno-19-74 href=#__codelineno-19-74></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-19-75><a id=__codelineno-19-75 name=__codelineno-19-75 href=#__codelineno-19-75></a><span class=w>        </span><span class=s1>&#39;Patch - Exploit (Mean)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-19-76><a id=__codelineno-19-76 name=__codelineno-19-76 href=#__codelineno-19-76></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-19-77><a id=__codelineno-19-77 name=__codelineno-19-77 href=#__codelineno-19-77></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-19-78><a id=__codelineno-19-78 name=__codelineno-19-78 href=#__codelineno-19-78></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-19-79><a id=__codelineno-19-79 name=__codelineno-19-79 href=#__codelineno-19-79></a>
</span><span id=__span-19-80><a id=__codelineno-19-80 name=__codelineno-19-80 href=#__codelineno-19-80></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-19-81><a id=__codelineno-19-81 name=__codelineno-19-81 href=#__codelineno-19-81></a>
</span><span id=__span-19-82><a id=__codelineno-19-82 name=__codelineno-19-82 href=#__codelineno-19-82></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-19-83><a id=__codelineno-19-83 name=__codelineno-19-83 href=#__codelineno-19-83></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-19-84><a id=__codelineno-19-84 name=__codelineno-19-84 href=#__codelineno-19-84></a><span class=w>        </span><span class=s1>&#39;Patch - Exploit (Median)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-19-85><a id=__codelineno-19-85 name=__codelineno-19-85 href=#__codelineno-19-85></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-19-86><a id=__codelineno-19-86 name=__codelineno-19-86 href=#__codelineno-19-86></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-19-87><a id=__codelineno-19-87 name=__codelineno-19-87 href=#__codelineno-19-87></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-19-88><a id=__codelineno-19-88 name=__codelineno-19-88 href=#__codelineno-19-88></a>
</span><span id=__span-19-89><a id=__codelineno-19-89 name=__codelineno-19-89 href=#__codelineno-19-89></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-19-90><a id=__codelineno-19-90 name=__codelineno-19-90 href=#__codelineno-19-90></a>
</span><span id=__span-19-91><a id=__codelineno-19-91 name=__codelineno-19-91 href=#__codelineno-19-91></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-19-92><a id=__codelineno-19-92 name=__codelineno-19-92 href=#__codelineno-19-92></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-19-93><a id=__codelineno-19-93 name=__codelineno-19-93 href=#__codelineno-19-93></a><span class=w>        </span><span class=s1>&#39;Patch - Creation (Mean)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-19-94><a id=__codelineno-19-94 name=__codelineno-19-94 href=#__codelineno-19-94></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-19-95><a id=__codelineno-19-95 name=__codelineno-19-95 href=#__codelineno-19-95></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-19-96><a id=__codelineno-19-96 name=__codelineno-19-96 href=#__codelineno-19-96></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-19-97><a id=__codelineno-19-97 name=__codelineno-19-97 href=#__codelineno-19-97></a>
</span><span id=__span-19-98><a id=__codelineno-19-98 name=__codelineno-19-98 href=#__codelineno-19-98></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-19-99><a id=__codelineno-19-99 name=__codelineno-19-99 href=#__codelineno-19-99></a>
</span><span id=__span-19-100><a id=__codelineno-19-100 name=__codelineno-19-100 href=#__codelineno-19-100></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-19-101><a id=__codelineno-19-101 name=__codelineno-19-101 href=#__codelineno-19-101></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-19-102><a id=__codelineno-19-102 name=__codelineno-19-102 href=#__codelineno-19-102></a><span class=w>        </span><span class=s1>&#39;Patch - Creation (Median)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-19-103><a id=__codelineno-19-103 name=__codelineno-19-103 href=#__codelineno-19-103></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-19-104><a id=__codelineno-19-104 name=__codelineno-19-104 href=#__codelineno-19-104></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-19-105><a id=__codelineno-19-105 name=__codelineno-19-105 href=#__codelineno-19-105></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-19-106><a id=__codelineno-19-106 name=__codelineno-19-106 href=#__codelineno-19-106></a><span class=p>)</span>
</span><span id=__span-19-107><a id=__codelineno-19-107 name=__codelineno-19-107 href=#__codelineno-19-107></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-19-108><a id=__codelineno-19-108 name=__codelineno-19-108 href=#__codelineno-19-108></a><span class=w>    </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-19-109><a id=__codelineno-19-109 name=__codelineno-19-109 href=#__codelineno-19-109></a><span class=w>    </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-19-110><a id=__codelineno-19-110 name=__codelineno-19-110 href=#__codelineno-19-110></a><span class=w>    </span><span class=n>days_value</span>
</span><span id=__span-19-111><a id=__codelineno-19-111 name=__codelineno-19-111 href=#__codelineno-19-111></a><span class=k>FROM</span><span class=w> </span><span class=n>yearly_stats</span>
</span><span id=__span-19-112><a id=__codelineno-19-112 name=__codelineno-19-112 href=#__codelineno-19-112></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>event_metric</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Line Chart </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: year </li> <li><strong>Y-axis</strong>: median_days (and/or mean_days as separate series) </li> <li><strong>Group By</strong>: event_type </li> <li><strong>Time Range</strong>: Custom, 2016-01-01 to 2025-05-13 </li> <li><strong>Filters</strong>: severity_level = 'CRITICAL' (if not already filtered in SQL)</li> </ul> <h3 id=ch5_fig_512_multi-vendors_yearly-trend-of-mean-and-median-time-differences-for-critical-severity-across-all-events><strong>Ch5_Fig_5.12_Multi-vendors_Yearly trend of mean and median time differences for Critical severity across all events</strong><a class=headerlink href=#ch5_fig_512_multi-vendors_yearly-trend-of-mean-and-median-time-differences-for-critical-severity-across-all-events title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: What is the yearly trend for lifecycle event timing for Critical severity vulnerabilities for all vendors? </li> <li><strong>SQL Query</strong>: ( Adapt it to use unified_patches for an overall view.) <div class="language-sql highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=k>WITH</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=w>    </span><span class=c1>-- Microsoft</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-20-12><a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-20-13><a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-20-14><a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-20-15><a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-20-16><a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-17><a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-20-18><a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-20-19><a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-20-20><a id=__codelineno-20-20 name=__codelineno-20-20 href=#__codelineno-20-20></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-20-21><a id=__codelineno-20-21 name=__codelineno-20-21 href=#__codelineno-20-21></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-20-22><a id=__codelineno-20-22 name=__codelineno-20-22 href=#__codelineno-20-22></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-20-23><a id=__codelineno-20-23 name=__codelineno-20-23 href=#__codelineno-20-23></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-24><a id=__codelineno-20-24 name=__codelineno-20-24 href=#__codelineno-20-24></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-20-25><a id=__codelineno-20-25 name=__codelineno-20-25 href=#__codelineno-20-25></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-20-26><a id=__codelineno-20-26 name=__codelineno-20-26 href=#__codelineno-20-26></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-20-27><a id=__codelineno-20-27 name=__codelineno-20-27 href=#__codelineno-20-27></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-20-28><a id=__codelineno-20-28 name=__codelineno-20-28 href=#__codelineno-20-28></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-20-29><a id=__codelineno-20-29 name=__codelineno-20-29 href=#__codelineno-20-29></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-20-30><a id=__codelineno-20-30 name=__codelineno-20-30 href=#__codelineno-20-30></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-20-31><a id=__codelineno-20-31 name=__codelineno-20-31 href=#__codelineno-20-31></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-20-32><a id=__codelineno-20-32 name=__codelineno-20-32 href=#__codelineno-20-32></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-20-33><a id=__codelineno-20-33 name=__codelineno-20-33 href=#__codelineno-20-33></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-20-34><a id=__codelineno-20-34 name=__codelineno-20-34 href=#__codelineno-20-34></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-20-35><a id=__codelineno-20-35 name=__codelineno-20-35 href=#__codelineno-20-35></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-20-36><a id=__codelineno-20-36 name=__codelineno-20-36 href=#__codelineno-20-36></a>
</span><span id=__span-20-37><a id=__codelineno-20-37 name=__codelineno-20-37 href=#__codelineno-20-37></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-20-38><a id=__codelineno-20-38 name=__codelineno-20-38 href=#__codelineno-20-38></a>
</span><span id=__span-20-39><a id=__codelineno-20-39 name=__codelineno-20-39 href=#__codelineno-20-39></a><span class=w>    </span><span class=c1>-- RedHat</span>
</span><span id=__span-20-40><a id=__codelineno-20-40 name=__codelineno-20-40 href=#__codelineno-20-40></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-20-41><a id=__codelineno-20-41 name=__codelineno-20-41 href=#__codelineno-20-41></a><span class=w>        </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-20-42><a id=__codelineno-20-42 name=__codelineno-20-42 href=#__codelineno-20-42></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-20-43><a id=__codelineno-20-43 name=__codelineno-20-43 href=#__codelineno-20-43></a><span class=w>        </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-20-44><a id=__codelineno-20-44 name=__codelineno-20-44 href=#__codelineno-20-44></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-45><a id=__codelineno-20-45 name=__codelineno-20-45 href=#__codelineno-20-45></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-20-46><a id=__codelineno-20-46 name=__codelineno-20-46 href=#__codelineno-20-46></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-47><a id=__codelineno-20-47 name=__codelineno-20-47 href=#__codelineno-20-47></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-20-48><a id=__codelineno-20-48 name=__codelineno-20-48 href=#__codelineno-20-48></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-20-49><a id=__codelineno-20-49 name=__codelineno-20-49 href=#__codelineno-20-49></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-20-50><a id=__codelineno-20-50 name=__codelineno-20-50 href=#__codelineno-20-50></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-20-51><a id=__codelineno-20-51 name=__codelineno-20-51 href=#__codelineno-20-51></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-20-52><a id=__codelineno-20-52 name=__codelineno-20-52 href=#__codelineno-20-52></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-20-53><a id=__codelineno-20-53 name=__codelineno-20-53 href=#__codelineno-20-53></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-54><a id=__codelineno-20-54 name=__codelineno-20-54 href=#__codelineno-20-54></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-20-55><a id=__codelineno-20-55 name=__codelineno-20-55 href=#__codelineno-20-55></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-20-56><a id=__codelineno-20-56 name=__codelineno-20-56 href=#__codelineno-20-56></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-20-57><a id=__codelineno-20-57 name=__codelineno-20-57 href=#__codelineno-20-57></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-20-58><a id=__codelineno-20-58 name=__codelineno-20-58 href=#__codelineno-20-58></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-20-59><a id=__codelineno-20-59 name=__codelineno-20-59 href=#__codelineno-20-59></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-20-60><a id=__codelineno-20-60 name=__codelineno-20-60 href=#__codelineno-20-60></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-61><a id=__codelineno-20-61 name=__codelineno-20-61 href=#__codelineno-20-61></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-20-62><a id=__codelineno-20-62 name=__codelineno-20-62 href=#__codelineno-20-62></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-20-63><a id=__codelineno-20-63 name=__codelineno-20-63 href=#__codelineno-20-63></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-20-64><a id=__codelineno-20-64 name=__codelineno-20-64 href=#__codelineno-20-64></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-20-65><a id=__codelineno-20-65 name=__codelineno-20-65 href=#__codelineno-20-65></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-20-66><a id=__codelineno-20-66 name=__codelineno-20-66 href=#__codelineno-20-66></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-20-67><a id=__codelineno-20-67 name=__codelineno-20-67 href=#__codelineno-20-67></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span>
</span><span id=__span-20-68><a id=__codelineno-20-68 name=__codelineno-20-68 href=#__codelineno-20-68></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-20-69><a id=__codelineno-20-69 name=__codelineno-20-69 href=#__codelineno-20-69></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-20-70><a id=__codelineno-20-70 name=__codelineno-20-70 href=#__codelineno-20-70></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-20-71><a id=__codelineno-20-71 name=__codelineno-20-71 href=#__codelineno-20-71></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-20-72><a id=__codelineno-20-72 name=__codelineno-20-72 href=#__codelineno-20-72></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-20-73><a id=__codelineno-20-73 name=__codelineno-20-73 href=#__codelineno-20-73></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-20-74><a id=__codelineno-20-74 name=__codelineno-20-74 href=#__codelineno-20-74></a>
</span><span id=__span-20-75><a id=__codelineno-20-75 name=__codelineno-20-75 href=#__codelineno-20-75></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-20-76><a id=__codelineno-20-76 name=__codelineno-20-76 href=#__codelineno-20-76></a>
</span><span id=__span-20-77><a id=__codelineno-20-77 name=__codelineno-20-77 href=#__codelineno-20-77></a><span class=w>    </span><span class=c1>-- Cisco</span>
</span><span id=__span-20-78><a id=__codelineno-20-78 name=__codelineno-20-78 href=#__codelineno-20-78></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span>
</span><span id=__span-20-79><a id=__codelineno-20-79 name=__codelineno-20-79 href=#__codelineno-20-79></a><span class=w>        </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-20-80><a id=__codelineno-20-80 name=__codelineno-20-80 href=#__codelineno-20-80></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-20-81><a id=__codelineno-20-81 name=__codelineno-20-81 href=#__codelineno-20-81></a><span class=w>        </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-20-82><a id=__codelineno-20-82 name=__codelineno-20-82 href=#__codelineno-20-82></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-83><a id=__codelineno-20-83 name=__codelineno-20-83 href=#__codelineno-20-83></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-20-84><a id=__codelineno-20-84 name=__codelineno-20-84 href=#__codelineno-20-84></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-85><a id=__codelineno-20-85 name=__codelineno-20-85 href=#__codelineno-20-85></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-20-86><a id=__codelineno-20-86 name=__codelineno-20-86 href=#__codelineno-20-86></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-20-87><a id=__codelineno-20-87 name=__codelineno-20-87 href=#__codelineno-20-87></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-20-88><a id=__codelineno-20-88 name=__codelineno-20-88 href=#__codelineno-20-88></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-20-89><a id=__codelineno-20-89 name=__codelineno-20-89 href=#__codelineno-20-89></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-20-90><a id=__codelineno-20-90 name=__codelineno-20-90 href=#__codelineno-20-90></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-20-91><a id=__codelineno-20-91 name=__codelineno-20-91 href=#__codelineno-20-91></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-92><a id=__codelineno-20-92 name=__codelineno-20-92 href=#__codelineno-20-92></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-20-93><a id=__codelineno-20-93 name=__codelineno-20-93 href=#__codelineno-20-93></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-20-94><a id=__codelineno-20-94 name=__codelineno-20-94 href=#__codelineno-20-94></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-20-95><a id=__codelineno-20-95 name=__codelineno-20-95 href=#__codelineno-20-95></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-20-96><a id=__codelineno-20-96 name=__codelineno-20-96 href=#__codelineno-20-96></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-20-97><a id=__codelineno-20-97 name=__codelineno-20-97 href=#__codelineno-20-97></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-20-98><a id=__codelineno-20-98 name=__codelineno-20-98 href=#__codelineno-20-98></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-20-99><a id=__codelineno-20-99 name=__codelineno-20-99 href=#__codelineno-20-99></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-20-100><a id=__codelineno-20-100 name=__codelineno-20-100 href=#__codelineno-20-100></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-20-101><a id=__codelineno-20-101 name=__codelineno-20-101 href=#__codelineno-20-101></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-20-102><a id=__codelineno-20-102 name=__codelineno-20-102 href=#__codelineno-20-102></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-20-103><a id=__codelineno-20-103 name=__codelineno-20-103 href=#__codelineno-20-103></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-20-104><a id=__codelineno-20-104 name=__codelineno-20-104 href=#__codelineno-20-104></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-20-105><a id=__codelineno-20-105 name=__codelineno-20-105 href=#__codelineno-20-105></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span>
</span><span id=__span-20-106><a id=__codelineno-20-106 name=__codelineno-20-106 href=#__codelineno-20-106></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-20-107><a id=__codelineno-20-107 name=__codelineno-20-107 href=#__codelineno-20-107></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-20-108><a id=__codelineno-20-108 name=__codelineno-20-108 href=#__codelineno-20-108></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-20-109><a id=__codelineno-20-109 name=__codelineno-20-109 href=#__codelineno-20-109></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-20-110><a id=__codelineno-20-110 name=__codelineno-20-110 href=#__codelineno-20-110></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-20-111><a id=__codelineno-20-111 name=__codelineno-20-111 href=#__codelineno-20-111></a><span class=p>),</span>
</span><span id=__span-20-112><a id=__codelineno-20-112 name=__codelineno-20-112 href=#__codelineno-20-112></a><span class=n>yearly_lifecycle_timing</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-20-113><a id=__codelineno-20-113 name=__codelineno-20-113 href=#__codelineno-20-113></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-20-114><a id=__codelineno-20-114 name=__codelineno-20-114 href=#__codelineno-20-114></a><span class=w>        </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>ac</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-20-115><a id=__codelineno-20-115 name=__codelineno-20-115 href=#__codelineno-20-115></a><span class=w>        </span><span class=n>ac</span><span class=p>.</span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-20-116><a id=__codelineno-20-116 name=__codelineno-20-116 href=#__codelineno-20-116></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploit_creation_gap</span><span class=p>,</span>
</span><span id=__span-20-117><a id=__codelineno-20-117 name=__codelineno-20-117 href=#__codelineno-20-117></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>patch_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-20-118><a id=__codelineno-20-118 name=__codelineno-20-118 href=#__codelineno-20-118></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>patch_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_creation_gap</span>
</span><span id=__span-20-119><a id=__codelineno-20-119 name=__codelineno-20-119 href=#__codelineno-20-119></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>all_cves_with_patch_and_exploit</span><span class=w> </span><span class=n>ac</span>
</span><span id=__span-20-120><a id=__codelineno-20-120 name=__codelineno-20-120 href=#__codelineno-20-120></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-20-121><a id=__codelineno-20-121 name=__codelineno-20-121 href=#__codelineno-20-121></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-20-122><a id=__codelineno-20-122 name=__codelineno-20-122 href=#__codelineno-20-122></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>ac</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-20-123><a id=__codelineno-20-123 name=__codelineno-20-123 href=#__codelineno-20-123></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-20-124><a id=__codelineno-20-124 name=__codelineno-20-124 href=#__codelineno-20-124></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-20-125><a id=__codelineno-20-125 name=__codelineno-20-125 href=#__codelineno-20-125></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>ac</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016&#39;</span>
</span><span id=__span-20-126><a id=__codelineno-20-126 name=__codelineno-20-126 href=#__codelineno-20-126></a><span class=p>),</span>
</span><span id=__span-20-127><a id=__codelineno-20-127 name=__codelineno-20-127 href=#__codelineno-20-127></a><span class=n>yearly_stats</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-20-128><a id=__codelineno-20-128 name=__codelineno-20-128 href=#__codelineno-20-128></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-20-129><a id=__codelineno-20-129 name=__codelineno-20-129 href=#__codelineno-20-129></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-20-130><a id=__codelineno-20-130 name=__codelineno-20-130 href=#__codelineno-20-130></a><span class=w>        </span><span class=s1>&#39;Exploit - Creation (Mean)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-20-131><a id=__codelineno-20-131 name=__codelineno-20-131 href=#__codelineno-20-131></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>exploit_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-20-132><a id=__codelineno-20-132 name=__codelineno-20-132 href=#__codelineno-20-132></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-20-133><a id=__codelineno-20-133 name=__codelineno-20-133 href=#__codelineno-20-133></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-20-134><a id=__codelineno-20-134 name=__codelineno-20-134 href=#__codelineno-20-134></a>
</span><span id=__span-20-135><a id=__codelineno-20-135 name=__codelineno-20-135 href=#__codelineno-20-135></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-20-136><a id=__codelineno-20-136 name=__codelineno-20-136 href=#__codelineno-20-136></a>
</span><span id=__span-20-137><a id=__codelineno-20-137 name=__codelineno-20-137 href=#__codelineno-20-137></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-20-138><a id=__codelineno-20-138 name=__codelineno-20-138 href=#__codelineno-20-138></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-20-139><a id=__codelineno-20-139 name=__codelineno-20-139 href=#__codelineno-20-139></a><span class=w>        </span><span class=s1>&#39;Exploit - Creation (Median)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-20-140><a id=__codelineno-20-140 name=__codelineno-20-140 href=#__codelineno-20-140></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>exploit_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-20-141><a id=__codelineno-20-141 name=__codelineno-20-141 href=#__codelineno-20-141></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-20-142><a id=__codelineno-20-142 name=__codelineno-20-142 href=#__codelineno-20-142></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-20-143><a id=__codelineno-20-143 name=__codelineno-20-143 href=#__codelineno-20-143></a>
</span><span id=__span-20-144><a id=__codelineno-20-144 name=__codelineno-20-144 href=#__codelineno-20-144></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-20-145><a id=__codelineno-20-145 name=__codelineno-20-145 href=#__codelineno-20-145></a>
</span><span id=__span-20-146><a id=__codelineno-20-146 name=__codelineno-20-146 href=#__codelineno-20-146></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-20-147><a id=__codelineno-20-147 name=__codelineno-20-147 href=#__codelineno-20-147></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-20-148><a id=__codelineno-20-148 name=__codelineno-20-148 href=#__codelineno-20-148></a><span class=w>        </span><span class=s1>&#39;Patch - Exploit (Mean)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-20-149><a id=__codelineno-20-149 name=__codelineno-20-149 href=#__codelineno-20-149></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-20-150><a id=__codelineno-20-150 name=__codelineno-20-150 href=#__codelineno-20-150></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-20-151><a id=__codelineno-20-151 name=__codelineno-20-151 href=#__codelineno-20-151></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-20-152><a id=__codelineno-20-152 name=__codelineno-20-152 href=#__codelineno-20-152></a>
</span><span id=__span-20-153><a id=__codelineno-20-153 name=__codelineno-20-153 href=#__codelineno-20-153></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-20-154><a id=__codelineno-20-154 name=__codelineno-20-154 href=#__codelineno-20-154></a>
</span><span id=__span-20-155><a id=__codelineno-20-155 name=__codelineno-20-155 href=#__codelineno-20-155></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-20-156><a id=__codelineno-20-156 name=__codelineno-20-156 href=#__codelineno-20-156></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-20-157><a id=__codelineno-20-157 name=__codelineno-20-157 href=#__codelineno-20-157></a><span class=w>        </span><span class=s1>&#39;Patch - Exploit (Median)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-20-158><a id=__codelineno-20-158 name=__codelineno-20-158 href=#__codelineno-20-158></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_exploit_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-20-159><a id=__codelineno-20-159 name=__codelineno-20-159 href=#__codelineno-20-159></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-20-160><a id=__codelineno-20-160 name=__codelineno-20-160 href=#__codelineno-20-160></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-20-161><a id=__codelineno-20-161 name=__codelineno-20-161 href=#__codelineno-20-161></a>
</span><span id=__span-20-162><a id=__codelineno-20-162 name=__codelineno-20-162 href=#__codelineno-20-162></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-20-163><a id=__codelineno-20-163 name=__codelineno-20-163 href=#__codelineno-20-163></a>
</span><span id=__span-20-164><a id=__codelineno-20-164 name=__codelineno-20-164 href=#__codelineno-20-164></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-20-165><a id=__codelineno-20-165 name=__codelineno-20-165 href=#__codelineno-20-165></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-20-166><a id=__codelineno-20-166 name=__codelineno-20-166 href=#__codelineno-20-166></a><span class=w>        </span><span class=s1>&#39;Patch - Creation (Mean)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-20-167><a id=__codelineno-20-167 name=__codelineno-20-167 href=#__codelineno-20-167></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=k>AVG</span><span class=p>(</span><span class=n>patch_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-20-168><a id=__codelineno-20-168 name=__codelineno-20-168 href=#__codelineno-20-168></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-20-169><a id=__codelineno-20-169 name=__codelineno-20-169 href=#__codelineno-20-169></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-20-170><a id=__codelineno-20-170 name=__codelineno-20-170 href=#__codelineno-20-170></a>
</span><span id=__span-20-171><a id=__codelineno-20-171 name=__codelineno-20-171 href=#__codelineno-20-171></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-20-172><a id=__codelineno-20-172 name=__codelineno-20-172 href=#__codelineno-20-172></a>
</span><span id=__span-20-173><a id=__codelineno-20-173 name=__codelineno-20-173 href=#__codelineno-20-173></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-20-174><a id=__codelineno-20-174 name=__codelineno-20-174 href=#__codelineno-20-174></a><span class=w>        </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-20-175><a id=__codelineno-20-175 name=__codelineno-20-175 href=#__codelineno-20-175></a><span class=w>        </span><span class=s1>&#39;Patch - Creation (Median)&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-20-176><a id=__codelineno-20-176 name=__codelineno-20-176 href=#__codelineno-20-176></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>patch_creation_gap</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_value</span>
</span><span id=__span-20-177><a id=__codelineno-20-177 name=__codelineno-20-177 href=#__codelineno-20-177></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>yearly_lifecycle_timing</span>
</span><span id=__span-20-178><a id=__codelineno-20-178 name=__codelineno-20-178 href=#__codelineno-20-178></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span>
</span><span id=__span-20-179><a id=__codelineno-20-179 name=__codelineno-20-179 href=#__codelineno-20-179></a><span class=p>)</span>
</span><span id=__span-20-180><a id=__codelineno-20-180 name=__codelineno-20-180 href=#__codelineno-20-180></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-20-181><a id=__codelineno-20-181 name=__codelineno-20-181 href=#__codelineno-20-181></a><span class=w>    </span><span class=k>year</span><span class=p>,</span>
</span><span id=__span-20-182><a id=__codelineno-20-182 name=__codelineno-20-182 href=#__codelineno-20-182></a><span class=w>    </span><span class=n>event_metric</span><span class=p>,</span>
</span><span id=__span-20-183><a id=__codelineno-20-183 name=__codelineno-20-183 href=#__codelineno-20-183></a><span class=w>    </span><span class=n>days_value</span>
</span><span id=__span-20-184><a id=__codelineno-20-184 name=__codelineno-20-184 href=#__codelineno-20-184></a><span class=k>FROM</span><span class=w> </span><span class=n>yearly_stats</span>
</span><span id=__span-20-185><a id=__codelineno-20-185 name=__codelineno-20-185 href=#__codelineno-20-185></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>event_metric</span><span class=p>;</span>
</span></code></pre></div></li> </ul> <h3 id=ch5_fig_513_yearly-trend-of-mean-and-median-time-differences-for-high-severity-across-all-events><strong>Ch5_Fig_5.13_Yearly trend of mean and median time differences for High severity across all events</strong><a class=headerlink href=#ch5_fig_513_yearly-trend-of-mean-and-median-time-differences-for-high-severity-across-all-events title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: What is the yearly trend for lifecycle event timing for High severity vulnerabilities? </li> <li> <p><strong>SQL Query</strong>: (Same as above, replace CRITICAL with HIGH in WHERE clauses)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=n>Same</span><span class=w> </span><span class=k>structure</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>above</span><span class=p>,</span><span class=w> </span><span class=n>but</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Line Chart </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: year </li> <li><strong>Y-axis</strong>: median_days (and/or mean_days as separate series) </li> <li><strong>Group By</strong>: event_type </li> <li><strong>Time Range</strong>: Custom, 2016-01-01 to 2025-05-13 </li> <li><strong>Filters</strong>: severity_level = 'HIGH'</li> </ul> <h3 id=ch5_fig_514_yearly-trend-of-mean-and-median-time-differences-for-medium-severity-across-all-events><strong>Ch5_Fig_5.14_Yearly trend of mean and median time differences for Medium severity across all events</strong><a class=headerlink href=#ch5_fig_514_yearly-trend-of-mean-and-median-time-differences-for-medium-severity-across-all-events title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: What is the yearly trend for lifecycle event timing for Medium severity vulnerabilities? </li> <li><strong>SQL Query</strong>: (Same as above, replace CRITICAL with MEDIUM in WHERE clauses)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=n>Same</span><span class=w> </span><span class=k>structure</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>above</span><span class=p>,</span><span class=w> </span><span class=n>but</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span></code></pre></div></li> <li><strong>Superset Chart Type</strong>: Line Chart </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: year </li> <li><strong>Y-axis</strong>: median_days (and/or mean_days as separate series) </li> <li><strong>Group By</strong>: event_type </li> <li><strong>Time Range</strong>: Custom, 2016-01-01 to 2025-05-13 </li> <li><strong>Filters</strong>: severity_level = 'MEDIUM'</li> </ul> <h3 id=ch5_fig_515_yearly-trend-of-mean-and-median-time-differences-for-low-severity-across-all-events><strong>Ch5_Fig_5.15_Yearly trend of mean and median time differences for Low severity across all events</strong><a class=headerlink href=#ch5_fig_515_yearly-trend-of-mean-and-median-time-differences-for-low-severity-across-all-events title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: What is the yearly trend for lifecycle event timing for Low severity vulnerabilities? </li> <li> <p><strong>SQL Query</strong>: (Same as above, replace CRITICAL with LOW in WHERE clauses)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=n>Same</span><span class=w> </span><span class=k>structure</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>above</span><span class=p>,</span><span class=w> </span><span class=n>but</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>mc</span><span class=p>.</span><span class=n>severity_level</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Line Chart </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: year </li> <li><strong>Y-axis</strong>: median_days (and/or mean_days as separate series) </li> <li><strong>Group By</strong>: event_type </li> <li><strong>Time Range</strong>: Custom, 2016-01-01 to 2025-05-13 </li> <li><strong>Filters</strong>: severity_level = 'LOW'</li> </ul> <h3 id=ch5_fig_516_three-way-comparison-median-patching-times-in-days-for-all-microsoft-patched-cves-non-exploited-patched-cves-and-exploited-patched-cves-by-severity-level><strong>Ch5_Fig_5.16_Three-Way Comparison: Median Patching Times (in days) for All Microsoft Patched CVEs, Non-Exploited Patched CVEs, and Exploited Patched CVEs by Severity Level</strong><a class=headerlink href=#ch5_fig_516_three-way-comparison-median-patching-times-in-days-for-all-microsoft-patched-cves-non-exploited-patched-cves-and-exploited-patched-cves-by-severity-level title="Permanent link">&para;</a></h3> <ul> <li><strong>Question Answered</strong>: How does the median time to patch differ for non-exploited vs. exploited vulnerabilities across severity levels? </li> <li> <p><strong>SQL Query</strong>:<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=k>WITH</span><span class=w> </span><span class=n>microsoft_patch_timing</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=w>    </span><span class=c1>-- All Microsoft Patched CVEs</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>,</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>has_exploit</span><span class=p>,</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-24-15><a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-24-16><a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-24-17><a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-24-18><a id=__codelineno-24-18 name=__codelineno-24-18 href=#__codelineno-24-18></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-24-19><a id=__codelineno-24-19 name=__codelineno-24-19 href=#__codelineno-24-19></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-24-20><a id=__codelineno-24-20 name=__codelineno-24-20 href=#__codelineno-24-20></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-24-21><a id=__codelineno-24-21 name=__codelineno-24-21 href=#__codelineno-24-21></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-24-22><a id=__codelineno-24-22 name=__codelineno-24-22 href=#__codelineno-24-22></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-24-23><a id=__codelineno-24-23 name=__codelineno-24-23 href=#__codelineno-24-23></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-24-24><a id=__codelineno-24-24 name=__codelineno-24-24 href=#__codelineno-24-24></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-24-25><a id=__codelineno-24-25 name=__codelineno-24-25 href=#__codelineno-24-25></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-24-26><a id=__codelineno-24-26 name=__codelineno-24-26 href=#__codelineno-24-26></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-24-27><a id=__codelineno-24-27 name=__codelineno-24-27 href=#__codelineno-24-27></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-24-28><a id=__codelineno-24-28 name=__codelineno-24-28 href=#__codelineno-24-28></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-24-29><a id=__codelineno-24-29 name=__codelineno-24-29 href=#__codelineno-24-29></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-24-30><a id=__codelineno-24-30 name=__codelineno-24-30 href=#__codelineno-24-30></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-24-31><a id=__codelineno-24-31 name=__codelineno-24-31 href=#__codelineno-24-31></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-24-32><a id=__codelineno-24-32 name=__codelineno-24-32 href=#__codelineno-24-32></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-24-33><a id=__codelineno-24-33 name=__codelineno-24-33 href=#__codelineno-24-33></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-24-34><a id=__codelineno-24-34 name=__codelineno-24-34 href=#__codelineno-24-34></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-24-35><a id=__codelineno-24-35 name=__codelineno-24-35 href=#__codelineno-24-35></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-24-36><a id=__codelineno-24-36 name=__codelineno-24-36 href=#__codelineno-24-36></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-24-37><a id=__codelineno-24-37 name=__codelineno-24-37 href=#__codelineno-24-37></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-24-38><a id=__codelineno-24-38 name=__codelineno-24-38 href=#__codelineno-24-38></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-24-39><a id=__codelineno-24-39 name=__codelineno-24-39 href=#__codelineno-24-39></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w>  </span><span class=c1>-- Ensure patch comes after CVE</span>
</span><span id=__span-24-40><a id=__codelineno-24-40 name=__codelineno-24-40 href=#__codelineno-24-40></a><span class=p>),</span>
</span><span id=__span-24-41><a id=__codelineno-24-41 name=__codelineno-24-41 href=#__codelineno-24-41></a><span class=n>patch_categories</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-24-42><a id=__codelineno-24-42 name=__codelineno-24-42 href=#__codelineno-24-42></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-24-43><a id=__codelineno-24-43 name=__codelineno-24-43 href=#__codelineno-24-43></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-24-44><a id=__codelineno-24-44 name=__codelineno-24-44 href=#__codelineno-24-44></a><span class=w>        </span><span class=s1>&#39;All Microsoft Patched&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>category</span><span class=p>,</span>
</span><span id=__span-24-45><a id=__codelineno-24-45 name=__codelineno-24-45 href=#__codelineno-24-45></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-24-46><a id=__codelineno-24-46 name=__codelineno-24-46 href=#__codelineno-24-46></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-24-47><a id=__codelineno-24-47 name=__codelineno-24-47 href=#__codelineno-24-47></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_patch_timing</span>
</span><span id=__span-24-48><a id=__codelineno-24-48 name=__codelineno-24-48 href=#__codelineno-24-48></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-24-49><a id=__codelineno-24-49 name=__codelineno-24-49 href=#__codelineno-24-49></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-24-50><a id=__codelineno-24-50 name=__codelineno-24-50 href=#__codelineno-24-50></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-24-51><a id=__codelineno-24-51 name=__codelineno-24-51 href=#__codelineno-24-51></a>
</span><span id=__span-24-52><a id=__codelineno-24-52 name=__codelineno-24-52 href=#__codelineno-24-52></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-24-53><a id=__codelineno-24-53 name=__codelineno-24-53 href=#__codelineno-24-53></a>
</span><span id=__span-24-54><a id=__codelineno-24-54 name=__codelineno-24-54 href=#__codelineno-24-54></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-24-55><a id=__codelineno-24-55 name=__codelineno-24-55 href=#__codelineno-24-55></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-24-56><a id=__codelineno-24-56 name=__codelineno-24-56 href=#__codelineno-24-56></a><span class=w>        </span><span class=s1>&#39;Non-Exploited Patched&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>category</span><span class=p>,</span>
</span><span id=__span-24-57><a id=__codelineno-24-57 name=__codelineno-24-57 href=#__codelineno-24-57></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-24-58><a id=__codelineno-24-58 name=__codelineno-24-58 href=#__codelineno-24-58></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-24-59><a id=__codelineno-24-59 name=__codelineno-24-59 href=#__codelineno-24-59></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_patch_timing</span>
</span><span id=__span-24-60><a id=__codelineno-24-60 name=__codelineno-24-60 href=#__codelineno-24-60></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-24-61><a id=__codelineno-24-61 name=__codelineno-24-61 href=#__codelineno-24-61></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>has_exploit</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-24-62><a id=__codelineno-24-62 name=__codelineno-24-62 href=#__codelineno-24-62></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-24-63><a id=__codelineno-24-63 name=__codelineno-24-63 href=#__codelineno-24-63></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-24-64><a id=__codelineno-24-64 name=__codelineno-24-64 href=#__codelineno-24-64></a>
</span><span id=__span-24-65><a id=__codelineno-24-65 name=__codelineno-24-65 href=#__codelineno-24-65></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-24-66><a id=__codelineno-24-66 name=__codelineno-24-66 href=#__codelineno-24-66></a>
</span><span id=__span-24-67><a id=__codelineno-24-67 name=__codelineno-24-67 href=#__codelineno-24-67></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-24-68><a id=__codelineno-24-68 name=__codelineno-24-68 href=#__codelineno-24-68></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-24-69><a id=__codelineno-24-69 name=__codelineno-24-69 href=#__codelineno-24-69></a><span class=w>        </span><span class=s1>&#39;Exploited Patched&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>category</span><span class=p>,</span>
</span><span id=__span-24-70><a id=__codelineno-24-70 name=__codelineno-24-70 href=#__codelineno-24-70></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-24-71><a id=__codelineno-24-71 name=__codelineno-24-71 href=#__codelineno-24-71></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-24-72><a id=__codelineno-24-72 name=__codelineno-24-72 href=#__codelineno-24-72></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>microsoft_patch_timing</span>
</span><span id=__span-24-73><a id=__codelineno-24-73 name=__codelineno-24-73 href=#__codelineno-24-73></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-24-74><a id=__codelineno-24-74 name=__codelineno-24-74 href=#__codelineno-24-74></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>has_exploit</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-24-75><a id=__codelineno-24-75 name=__codelineno-24-75 href=#__codelineno-24-75></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-24-76><a id=__codelineno-24-76 name=__codelineno-24-76 href=#__codelineno-24-76></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-24-77><a id=__codelineno-24-77 name=__codelineno-24-77 href=#__codelineno-24-77></a><span class=p>)</span>
</span><span id=__span-24-78><a id=__codelineno-24-78 name=__codelineno-24-78 href=#__codelineno-24-78></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-24-79><a id=__codelineno-24-79 name=__codelineno-24-79 href=#__codelineno-24-79></a><span class=w>    </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-24-80><a id=__codelineno-24-80 name=__codelineno-24-80 href=#__codelineno-24-80></a><span class=w>    </span><span class=n>category</span><span class=p>,</span>
</span><span id=__span-24-81><a id=__codelineno-24-81 name=__codelineno-24-81 href=#__codelineno-24-81></a><span class=w>    </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-24-82><a id=__codelineno-24-82 name=__codelineno-24-82 href=#__codelineno-24-82></a><span class=w>    </span><span class=n>sample_size</span>
</span><span id=__span-24-83><a id=__codelineno-24-83 name=__codelineno-24-83 href=#__codelineno-24-83></a><span class=k>FROM</span><span class=w> </span><span class=n>patch_categories</span>
</span><span id=__span-24-84><a id=__codelineno-24-84 name=__codelineno-24-84 href=#__codelineno-24-84></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span>
</span><span id=__span-24-85><a id=__codelineno-24-85 name=__codelineno-24-85 href=#__codelineno-24-85></a><span class=w>    </span><span class=k>CASE</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span>
</span><span id=__span-24-86><a id=__codelineno-24-86 name=__codelineno-24-86 href=#__codelineno-24-86></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span>
</span><span id=__span-24-87><a id=__codelineno-24-87 name=__codelineno-24-87 href=#__codelineno-24-87></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span><span class=w> </span>
</span><span id=__span-24-88><a id=__codelineno-24-88 name=__codelineno-24-88 href=#__codelineno-24-88></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span><span class=w> </span>
</span><span id=__span-24-89><a id=__codelineno-24-89 name=__codelineno-24-89 href=#__codelineno-24-89></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span><span class=w> </span>
</span><span id=__span-24-90><a id=__codelineno-24-90 name=__codelineno-24-90 href=#__codelineno-24-90></a><span class=w>    </span><span class=k>END</span><span class=p>,</span>
</span><span id=__span-24-91><a id=__codelineno-24-91 name=__codelineno-24-91 href=#__codelineno-24-91></a><span class=w>    </span><span class=k>CASE</span><span class=w> </span><span class=n>category</span>
</span><span id=__span-24-92><a id=__codelineno-24-92 name=__codelineno-24-92 href=#__codelineno-24-92></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;All Microsoft Patched&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-24-93><a id=__codelineno-24-93 name=__codelineno-24-93 href=#__codelineno-24-93></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;Non-Exploited Patched&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-24-94><a id=__codelineno-24-94 name=__codelineno-24-94 href=#__codelineno-24-94></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;Exploited Patched&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-24-95><a id=__codelineno-24-95 name=__codelineno-24-95 href=#__codelineno-24-95></a><span class=w>    </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div></p> </li> <li> <p><strong>Superset Chart Type</strong>: Grouped Bar Chart </p> </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: severity_level </li> <li><strong>Y-axis</strong>: median_days_to_patch </li> <li><strong>Group By</strong>: category </li> <li><strong>Sort By</strong>: Custom order for severity (Critical, High, Medium, Low)</li> </ul> <h3 id=ch5_fig_516_multi-vendor_three-way-comparison-median-patching-times-in-days-for-all-microsoft-patched-cves-non-exploited-patched-cves-and-exploited-patched-cves-by-severity-level><strong>Ch5_Fig_5.16_Multi-vendor_Three-Way Comparison: Median Patching Times (in days) for All Microsoft Patched CVEs, Non-Exploited Patched CVEs, and Exploited Patched CVEs by Severity Level</strong><a class=headerlink href=#ch5_fig_516_multi-vendor_three-way-comparison-median-patching-times-in-days-for-all-microsoft-patched-cves-non-exploited-patched-cves-and-exploited-patched-cves-by-severity-level title="Permanent link">&para;</a></h3> <ul> <li> <p><strong>Question Answered</strong>: How does the median time to patch differ for non-exploited vs. exploited vulnerabilities across severity levels for Multi-vendors? </p> </li> <li> <p><strong>SQL Query</strong> <div class="language-sql highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=k>WITH</span><span class=w> </span><span class=n>unified_patch_timing</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=w>    </span><span class=c1>-- Microsoft</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>has_exploit</span><span class=p>,</span>
</span><span id=__span-25-8><a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=w>        </span><span class=s1>&#39;Microsoft&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-25-9><a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-10><a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-25-11><a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-12><a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-25-13><a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-25-14><a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-25-15><a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-25-16><a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-25-17><a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-25-18><a id=__codelineno-25-18 name=__codelineno-25-18 href=#__codelineno-25-18></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-19><a id=__codelineno-25-19 name=__codelineno-25-19 href=#__codelineno-25-19></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-25-20><a id=__codelineno-25-20 name=__codelineno-25-20 href=#__codelineno-25-20></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-25-21><a id=__codelineno-25-21 name=__codelineno-25-21 href=#__codelineno-25-21></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-25-22><a id=__codelineno-25-22 name=__codelineno-25-22 href=#__codelineno-25-22></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-25-23><a id=__codelineno-25-23 name=__codelineno-25-23 href=#__codelineno-25-23></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-25-24><a id=__codelineno-25-24 name=__codelineno-25-24 href=#__codelineno-25-24></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-25-25><a id=__codelineno-25-25 name=__codelineno-25-25 href=#__codelineno-25-25></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-26><a id=__codelineno-25-26 name=__codelineno-25-26 href=#__codelineno-25-26></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-25-27><a id=__codelineno-25-27 name=__codelineno-25-27 href=#__codelineno-25-27></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-25-28><a id=__codelineno-25-28 name=__codelineno-25-28 href=#__codelineno-25-28></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-25-29><a id=__codelineno-25-29 name=__codelineno-25-29 href=#__codelineno-25-29></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-25-30><a id=__codelineno-25-30 name=__codelineno-25-30 href=#__codelineno-25-30></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-31><a id=__codelineno-25-31 name=__codelineno-25-31 href=#__codelineno-25-31></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-25-32><a id=__codelineno-25-32 name=__codelineno-25-32 href=#__codelineno-25-32></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-25-33><a id=__codelineno-25-33 name=__codelineno-25-33 href=#__codelineno-25-33></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span>
</span><span id=__span-25-34><a id=__codelineno-25-34 name=__codelineno-25-34 href=#__codelineno-25-34></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-25-35><a id=__codelineno-25-35 name=__codelineno-25-35 href=#__codelineno-25-35></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-25-36><a id=__codelineno-25-36 name=__codelineno-25-36 href=#__codelineno-25-36></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-37><a id=__codelineno-25-37 name=__codelineno-25-37 href=#__codelineno-25-37></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-38><a id=__codelineno-25-38 name=__codelineno-25-38 href=#__codelineno-25-38></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-25-39><a id=__codelineno-25-39 name=__codelineno-25-39 href=#__codelineno-25-39></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-25-40><a id=__codelineno-25-40 name=__codelineno-25-40 href=#__codelineno-25-40></a>
</span><span id=__span-25-41><a id=__codelineno-25-41 name=__codelineno-25-41 href=#__codelineno-25-41></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-25-42><a id=__codelineno-25-42 name=__codelineno-25-42 href=#__codelineno-25-42></a>
</span><span id=__span-25-43><a id=__codelineno-25-43 name=__codelineno-25-43 href=#__codelineno-25-43></a><span class=w>    </span><span class=c1>-- RedHat</span>
</span><span id=__span-25-44><a id=__codelineno-25-44 name=__codelineno-25-44 href=#__codelineno-25-44></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-25-45><a id=__codelineno-25-45 name=__codelineno-25-45 href=#__codelineno-25-45></a><span class=w>        </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-25-46><a id=__codelineno-25-46 name=__codelineno-25-46 href=#__codelineno-25-46></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-25-47><a id=__codelineno-25-47 name=__codelineno-25-47 href=#__codelineno-25-47></a><span class=w>        </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-25-48><a id=__codelineno-25-48 name=__codelineno-25-48 href=#__codelineno-25-48></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>has_exploit</span><span class=p>,</span>
</span><span id=__span-25-49><a id=__codelineno-25-49 name=__codelineno-25-49 href=#__codelineno-25-49></a><span class=w>        </span><span class=s1>&#39;RedHat&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-25-50><a id=__codelineno-25-50 name=__codelineno-25-50 href=#__codelineno-25-50></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-51><a id=__codelineno-25-51 name=__codelineno-25-51 href=#__codelineno-25-51></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-25-52><a id=__codelineno-25-52 name=__codelineno-25-52 href=#__codelineno-25-52></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-53><a id=__codelineno-25-53 name=__codelineno-25-53 href=#__codelineno-25-53></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-25-54><a id=__codelineno-25-54 name=__codelineno-25-54 href=#__codelineno-25-54></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-25-55><a id=__codelineno-25-55 name=__codelineno-25-55 href=#__codelineno-25-55></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-25-56><a id=__codelineno-25-56 name=__codelineno-25-56 href=#__codelineno-25-56></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-25-57><a id=__codelineno-25-57 name=__codelineno-25-57 href=#__codelineno-25-57></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-25-58><a id=__codelineno-25-58 name=__codelineno-25-58 href=#__codelineno-25-58></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-25-59><a id=__codelineno-25-59 name=__codelineno-25-59 href=#__codelineno-25-59></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-60><a id=__codelineno-25-60 name=__codelineno-25-60 href=#__codelineno-25-60></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-25-61><a id=__codelineno-25-61 name=__codelineno-25-61 href=#__codelineno-25-61></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-25-62><a id=__codelineno-25-62 name=__codelineno-25-62 href=#__codelineno-25-62></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-25-63><a id=__codelineno-25-63 name=__codelineno-25-63 href=#__codelineno-25-63></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-25-64><a id=__codelineno-25-64 name=__codelineno-25-64 href=#__codelineno-25-64></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-25-65><a id=__codelineno-25-65 name=__codelineno-25-65 href=#__codelineno-25-65></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-25-66><a id=__codelineno-25-66 name=__codelineno-25-66 href=#__codelineno-25-66></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-67><a id=__codelineno-25-67 name=__codelineno-25-67 href=#__codelineno-25-67></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-25-68><a id=__codelineno-25-68 name=__codelineno-25-68 href=#__codelineno-25-68></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-25-69><a id=__codelineno-25-69 name=__codelineno-25-69 href=#__codelineno-25-69></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-25-70><a id=__codelineno-25-70 name=__codelineno-25-70 href=#__codelineno-25-70></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-25-71><a id=__codelineno-25-71 name=__codelineno-25-71 href=#__codelineno-25-71></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-72><a id=__codelineno-25-72 name=__codelineno-25-72 href=#__codelineno-25-72></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-25-73><a id=__codelineno-25-73 name=__codelineno-25-73 href=#__codelineno-25-73></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-25-74><a id=__codelineno-25-74 name=__codelineno-25-74 href=#__codelineno-25-74></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span>
</span><span id=__span-25-75><a id=__codelineno-25-75 name=__codelineno-25-75 href=#__codelineno-25-75></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-25-76><a id=__codelineno-25-76 name=__codelineno-25-76 href=#__codelineno-25-76></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-25-77><a id=__codelineno-25-77 name=__codelineno-25-77 href=#__codelineno-25-77></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-78><a id=__codelineno-25-78 name=__codelineno-25-78 href=#__codelineno-25-78></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-79><a id=__codelineno-25-79 name=__codelineno-25-79 href=#__codelineno-25-79></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-25-80><a id=__codelineno-25-80 name=__codelineno-25-80 href=#__codelineno-25-80></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-25-81><a id=__codelineno-25-81 name=__codelineno-25-81 href=#__codelineno-25-81></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-25-82><a id=__codelineno-25-82 name=__codelineno-25-82 href=#__codelineno-25-82></a>
</span><span id=__span-25-83><a id=__codelineno-25-83 name=__codelineno-25-83 href=#__codelineno-25-83></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-25-84><a id=__codelineno-25-84 name=__codelineno-25-84 href=#__codelineno-25-84></a>
</span><span id=__span-25-85><a id=__codelineno-25-85 name=__codelineno-25-85 href=#__codelineno-25-85></a><span class=w>    </span><span class=c1>-- Cisco</span>
</span><span id=__span-25-86><a id=__codelineno-25-86 name=__codelineno-25-86 href=#__codelineno-25-86></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-25-87><a id=__codelineno-25-87 name=__codelineno-25-87 href=#__codelineno-25-87></a><span class=w>        </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-25-88><a id=__codelineno-25-88 name=__codelineno-25-88 href=#__codelineno-25-88></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-25-89><a id=__codelineno-25-89 name=__codelineno-25-89 href=#__codelineno-25-89></a><span class=w>        </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-25-90><a id=__codelineno-25-90 name=__codelineno-25-90 href=#__codelineno-25-90></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>has_exploit</span><span class=p>,</span>
</span><span id=__span-25-91><a id=__codelineno-25-91 name=__codelineno-25-91 href=#__codelineno-25-91></a><span class=w>        </span><span class=s1>&#39;Cisco&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-25-92><a id=__codelineno-25-92 name=__codelineno-25-92 href=#__codelineno-25-92></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-93><a id=__codelineno-25-93 name=__codelineno-25-93 href=#__codelineno-25-93></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-25-94><a id=__codelineno-25-94 name=__codelineno-25-94 href=#__codelineno-25-94></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-95><a id=__codelineno-25-95 name=__codelineno-25-95 href=#__codelineno-25-95></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-25-96><a id=__codelineno-25-96 name=__codelineno-25-96 href=#__codelineno-25-96></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-25-97><a id=__codelineno-25-97 name=__codelineno-25-97 href=#__codelineno-25-97></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-25-98><a id=__codelineno-25-98 name=__codelineno-25-98 href=#__codelineno-25-98></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-25-99><a id=__codelineno-25-99 name=__codelineno-25-99 href=#__codelineno-25-99></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-25-100><a id=__codelineno-25-100 name=__codelineno-25-100 href=#__codelineno-25-100></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-25-101><a id=__codelineno-25-101 name=__codelineno-25-101 href=#__codelineno-25-101></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-102><a id=__codelineno-25-102 name=__codelineno-25-102 href=#__codelineno-25-102></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-25-103><a id=__codelineno-25-103 name=__codelineno-25-103 href=#__codelineno-25-103></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-25-104><a id=__codelineno-25-104 name=__codelineno-25-104 href=#__codelineno-25-104></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-25-105><a id=__codelineno-25-105 name=__codelineno-25-105 href=#__codelineno-25-105></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-25-106><a id=__codelineno-25-106 name=__codelineno-25-106 href=#__codelineno-25-106></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-25-107><a id=__codelineno-25-107 name=__codelineno-25-107 href=#__codelineno-25-107></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-25-108><a id=__codelineno-25-108 name=__codelineno-25-108 href=#__codelineno-25-108></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-25-109><a id=__codelineno-25-109 name=__codelineno-25-109 href=#__codelineno-25-109></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-25-110><a id=__codelineno-25-110 name=__codelineno-25-110 href=#__codelineno-25-110></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-25-111><a id=__codelineno-25-111 name=__codelineno-25-111 href=#__codelineno-25-111></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-25-112><a id=__codelineno-25-112 name=__codelineno-25-112 href=#__codelineno-25-112></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-25-113><a id=__codelineno-25-113 name=__codelineno-25-113 href=#__codelineno-25-113></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-114><a id=__codelineno-25-114 name=__codelineno-25-114 href=#__codelineno-25-114></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-25-115><a id=__codelineno-25-115 name=__codelineno-25-115 href=#__codelineno-25-115></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_patch</span>
</span><span id=__span-25-116><a id=__codelineno-25-116 name=__codelineno-25-116 href=#__codelineno-25-116></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span>
</span><span id=__span-25-117><a id=__codelineno-25-117 name=__codelineno-25-117 href=#__codelineno-25-117></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-25-118><a id=__codelineno-25-118 name=__codelineno-25-118 href=#__codelineno-25-118></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-25-119><a id=__codelineno-25-119 name=__codelineno-25-119 href=#__codelineno-25-119></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-120><a id=__codelineno-25-120 name=__codelineno-25-120 href=#__codelineno-25-120></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-121><a id=__codelineno-25-121 name=__codelineno-25-121 href=#__codelineno-25-121></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-25-122><a id=__codelineno-25-122 name=__codelineno-25-122 href=#__codelineno-25-122></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-25-123><a id=__codelineno-25-123 name=__codelineno-25-123 href=#__codelineno-25-123></a><span class=p>),</span>
</span><span id=__span-25-124><a id=__codelineno-25-124 name=__codelineno-25-124 href=#__codelineno-25-124></a><span class=n>patch_categories</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-25-125><a id=__codelineno-25-125 name=__codelineno-25-125 href=#__codelineno-25-125></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-25-126><a id=__codelineno-25-126 name=__codelineno-25-126 href=#__codelineno-25-126></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-25-127><a id=__codelineno-25-127 name=__codelineno-25-127 href=#__codelineno-25-127></a><span class=w>        </span><span class=s1>&#39;All Vendor Patched&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>category</span><span class=p>,</span>
</span><span id=__span-25-128><a id=__codelineno-25-128 name=__codelineno-25-128 href=#__codelineno-25-128></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-25-129><a id=__codelineno-25-129 name=__codelineno-25-129 href=#__codelineno-25-129></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-25-130><a id=__codelineno-25-130 name=__codelineno-25-130 href=#__codelineno-25-130></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_patch_timing</span>
</span><span id=__span-25-131><a id=__codelineno-25-131 name=__codelineno-25-131 href=#__codelineno-25-131></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-132><a id=__codelineno-25-132 name=__codelineno-25-132 href=#__codelineno-25-132></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-25-133><a id=__codelineno-25-133 name=__codelineno-25-133 href=#__codelineno-25-133></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-25-134><a id=__codelineno-25-134 name=__codelineno-25-134 href=#__codelineno-25-134></a>
</span><span id=__span-25-135><a id=__codelineno-25-135 name=__codelineno-25-135 href=#__codelineno-25-135></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-25-136><a id=__codelineno-25-136 name=__codelineno-25-136 href=#__codelineno-25-136></a>
</span><span id=__span-25-137><a id=__codelineno-25-137 name=__codelineno-25-137 href=#__codelineno-25-137></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-25-138><a id=__codelineno-25-138 name=__codelineno-25-138 href=#__codelineno-25-138></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-25-139><a id=__codelineno-25-139 name=__codelineno-25-139 href=#__codelineno-25-139></a><span class=w>        </span><span class=s1>&#39;Non-Exploited Patched&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>category</span><span class=p>,</span>
</span><span id=__span-25-140><a id=__codelineno-25-140 name=__codelineno-25-140 href=#__codelineno-25-140></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-25-141><a id=__codelineno-25-141 name=__codelineno-25-141 href=#__codelineno-25-141></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-25-142><a id=__codelineno-25-142 name=__codelineno-25-142 href=#__codelineno-25-142></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_patch_timing</span>
</span><span id=__span-25-143><a id=__codelineno-25-143 name=__codelineno-25-143 href=#__codelineno-25-143></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-144><a id=__codelineno-25-144 name=__codelineno-25-144 href=#__codelineno-25-144></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>has_exploit</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-25-145><a id=__codelineno-25-145 name=__codelineno-25-145 href=#__codelineno-25-145></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-25-146><a id=__codelineno-25-146 name=__codelineno-25-146 href=#__codelineno-25-146></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-25-147><a id=__codelineno-25-147 name=__codelineno-25-147 href=#__codelineno-25-147></a>
</span><span id=__span-25-148><a id=__codelineno-25-148 name=__codelineno-25-148 href=#__codelineno-25-148></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-25-149><a id=__codelineno-25-149 name=__codelineno-25-149 href=#__codelineno-25-149></a>
</span><span id=__span-25-150><a id=__codelineno-25-150 name=__codelineno-25-150 href=#__codelineno-25-150></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-25-151><a id=__codelineno-25-151 name=__codelineno-25-151 href=#__codelineno-25-151></a><span class=w>        </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-25-152><a id=__codelineno-25-152 name=__codelineno-25-152 href=#__codelineno-25-152></a><span class=w>        </span><span class=s1>&#39;Exploited Patched&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>category</span><span class=p>,</span>
</span><span id=__span-25-153><a id=__codelineno-25-153 name=__codelineno-25-153 href=#__codelineno-25-153></a><span class=w>        </span><span class=n>ROUND</span><span class=p>(</span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>days_to_patch</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-25-154><a id=__codelineno-25-154 name=__codelineno-25-154 href=#__codelineno-25-154></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>sample_size</span>
</span><span id=__span-25-155><a id=__codelineno-25-155 name=__codelineno-25-155 href=#__codelineno-25-155></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>unified_patch_timing</span>
</span><span id=__span-25-156><a id=__codelineno-25-156 name=__codelineno-25-156 href=#__codelineno-25-156></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-25-157><a id=__codelineno-25-157 name=__codelineno-25-157 href=#__codelineno-25-157></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>has_exploit</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-25-158><a id=__codelineno-25-158 name=__codelineno-25-158 href=#__codelineno-25-158></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>days_to_patch</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-25-159><a id=__codelineno-25-159 name=__codelineno-25-159 href=#__codelineno-25-159></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>severity_level</span>
</span><span id=__span-25-160><a id=__codelineno-25-160 name=__codelineno-25-160 href=#__codelineno-25-160></a><span class=p>)</span>
</span><span id=__span-25-161><a id=__codelineno-25-161 name=__codelineno-25-161 href=#__codelineno-25-161></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-25-162><a id=__codelineno-25-162 name=__codelineno-25-162 href=#__codelineno-25-162></a><span class=w>    </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-25-163><a id=__codelineno-25-163 name=__codelineno-25-163 href=#__codelineno-25-163></a><span class=w>    </span><span class=n>category</span><span class=p>,</span>
</span><span id=__span-25-164><a id=__codelineno-25-164 name=__codelineno-25-164 href=#__codelineno-25-164></a><span class=w>    </span><span class=n>median_days_to_patch</span><span class=p>,</span>
</span><span id=__span-25-165><a id=__codelineno-25-165 name=__codelineno-25-165 href=#__codelineno-25-165></a><span class=w>    </span><span class=n>sample_size</span>
</span><span id=__span-25-166><a id=__codelineno-25-166 name=__codelineno-25-166 href=#__codelineno-25-166></a><span class=k>FROM</span><span class=w> </span><span class=n>patch_categories</span>
</span><span id=__span-25-167><a id=__codelineno-25-167 name=__codelineno-25-167 href=#__codelineno-25-167></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span>
</span><span id=__span-25-168><a id=__codelineno-25-168 name=__codelineno-25-168 href=#__codelineno-25-168></a><span class=w>    </span><span class=k>CASE</span><span class=w> </span><span class=n>severity_level</span><span class=w> </span>
</span><span id=__span-25-169><a id=__codelineno-25-169 name=__codelineno-25-169 href=#__codelineno-25-169></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span>
</span><span id=__span-25-170><a id=__codelineno-25-170 name=__codelineno-25-170 href=#__codelineno-25-170></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span><span class=w> </span>
</span><span id=__span-25-171><a id=__codelineno-25-171 name=__codelineno-25-171 href=#__codelineno-25-171></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span><span class=w> </span>
</span><span id=__span-25-172><a id=__codelineno-25-172 name=__codelineno-25-172 href=#__codelineno-25-172></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span><span class=w> </span>
</span><span id=__span-25-173><a id=__codelineno-25-173 name=__codelineno-25-173 href=#__codelineno-25-173></a><span class=w>    </span><span class=k>END</span><span class=p>,</span>
</span><span id=__span-25-174><a id=__codelineno-25-174 name=__codelineno-25-174 href=#__codelineno-25-174></a><span class=w>    </span><span class=k>CASE</span><span class=w> </span><span class=n>category</span>
</span><span id=__span-25-175><a id=__codelineno-25-175 name=__codelineno-25-175 href=#__codelineno-25-175></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;All Vendor Patched&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
</span><span id=__span-25-176><a id=__codelineno-25-176 name=__codelineno-25-176 href=#__codelineno-25-176></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;Non-Exploited Patched&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span>
</span><span id=__span-25-177><a id=__codelineno-25-177 name=__codelineno-25-177 href=#__codelineno-25-177></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;Exploited Patched&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-25-178><a id=__codelineno-25-178 name=__codelineno-25-178 href=#__codelineno-25-178></a><span class=w>    </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div></p> </li> </ul> <h3 id=ch5_tab_52_cve-with-more-than-1000-days-between-exploitation-and-cve-creation-datemicrosoft><strong>Ch5_Tab_5.2_CVE with more than 1000 days between Exploitation and CVE Creation Date(Microsoft)</strong><a class=headerlink href=#ch5_tab_52_cve-with-more-than-1000-days-between-exploitation-and-cve-creation-datemicrosoft title="Permanent link">&para;</a></h3> <ul> <li> <p><strong>Question Answered</strong>: Which CVEs have extremely long gaps (&gt;1000 days) between CVE creation and exploit publication? </p> </li> <li> <p><strong>SQL Query</strong>: <div class="language-sql highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=k>WITH</span><span class=w> </span><span class=n>long_exploit_gaps</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_to_exploit</span><span class=p>,</span>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=w>        </span><span class=c1>-- Prioritize CVSS versions: v4 -&gt; v3 -&gt; v2</span>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=w>        </span><span class=k>COALESCE</span><span class=p>(</span>
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>END</span><span class=p>,</span>
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>END</span><span class=p>,</span>
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>END</span>
</span><span id=__span-26-12><a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_score</span><span class=p>,</span>
</span><span id=__span-26-13><a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=w>        </span><span class=k>CASE</span>
</span><span id=__span-26-14><a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v4&#39;</span>
</span><span id=__span-26-15><a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v3&#39;</span>
</span><span id=__span-26-16><a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v2&#39;</span>
</span><span id=__span-26-17><a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-26-18><a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_version</span><span class=p>,</span>
</span><span id=__span-26-19><a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a><span class=w>        </span><span class=k>CASE</span>
</span><span id=__span-26-20><a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-26-21><a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a><span class=w>                </span><span class=k>CASE</span>
</span><span id=__span-26-22><a id=__codelineno-26-22 name=__codelineno-26-22 href=#__codelineno-26-22></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-26-23><a id=__codelineno-26-23 name=__codelineno-26-23 href=#__codelineno-26-23></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-26-24><a id=__codelineno-26-24 name=__codelineno-26-24 href=#__codelineno-26-24></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-26-25><a id=__codelineno-26-25 name=__codelineno-26-25 href=#__codelineno-26-25></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-26-26><a id=__codelineno-26-26 name=__codelineno-26-26 href=#__codelineno-26-26></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-26-27><a id=__codelineno-26-27 name=__codelineno-26-27 href=#__codelineno-26-27></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-26-28><a id=__codelineno-26-28 name=__codelineno-26-28 href=#__codelineno-26-28></a><span class=w>                </span><span class=k>CASE</span>
</span><span id=__span-26-29><a id=__codelineno-26-29 name=__codelineno-26-29 href=#__codelineno-26-29></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-26-30><a id=__codelineno-26-30 name=__codelineno-26-30 href=#__codelineno-26-30></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-26-31><a id=__codelineno-26-31 name=__codelineno-26-31 href=#__codelineno-26-31></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-26-32><a id=__codelineno-26-32 name=__codelineno-26-32 href=#__codelineno-26-32></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-26-33><a id=__codelineno-26-33 name=__codelineno-26-33 href=#__codelineno-26-33></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-26-34><a id=__codelineno-26-34 name=__codelineno-26-34 href=#__codelineno-26-34></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-26-35><a id=__codelineno-26-35 name=__codelineno-26-35 href=#__codelineno-26-35></a><span class=w>                </span><span class=k>CASE</span>
</span><span id=__span-26-36><a id=__codelineno-26-36 name=__codelineno-26-36 href=#__codelineno-26-36></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-26-37><a id=__codelineno-26-37 name=__codelineno-26-37 href=#__codelineno-26-37></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-26-38><a id=__codelineno-26-38 name=__codelineno-26-38 href=#__codelineno-26-38></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-26-39><a id=__codelineno-26-39 name=__codelineno-26-39 href=#__codelineno-26-39></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-26-40><a id=__codelineno-26-40 name=__codelineno-26-40 href=#__codelineno-26-40></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-26-41><a id=__codelineno-26-41 name=__codelineno-26-41 href=#__codelineno-26-41></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-26-42><a id=__codelineno-26-42 name=__codelineno-26-42 href=#__codelineno-26-42></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cwe_ids</span><span class=p>,</span>
</span><span id=__span-26-43><a id=__codelineno-26-43 name=__codelineno-26-43 href=#__codelineno-26-43></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=k>type</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>exploit_type</span><span class=p>,</span>
</span><span id=__span-26-44><a id=__codelineno-26-44 name=__codelineno-26-44 href=#__codelineno-26-44></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>platform</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>exploit_platform</span><span class=p>,</span>
</span><span id=__span-26-45><a id=__codelineno-26-45 name=__codelineno-26-45 href=#__codelineno-26-45></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>verified</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>exploit_verified</span><span class=p>,</span>
</span><span id=__span-26-46><a id=__codelineno-26-46 name=__codelineno-26-46 href=#__codelineno-26-46></a><span class=w>        </span><span class=n>SUBSTR</span><span class=p>(</span><span class=n>cm</span><span class=p>.</span><span class=n>description</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39;...&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>short_description</span>
</span><span id=__span-26-47><a id=__codelineno-26-47 name=__codelineno-26-47 href=#__codelineno-26-47></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-26-48><a id=__codelineno-26-48 name=__codelineno-26-48 href=#__codelineno-26-48></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-26-49><a id=__codelineno-26-49 name=__codelineno-26-49 href=#__codelineno-26-49></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-26-50><a id=__codelineno-26-50 name=__codelineno-26-50 href=#__codelineno-26-50></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-26-51><a id=__codelineno-26-51 name=__codelineno-26-51 href=#__codelineno-26-51></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-26-52><a id=__codelineno-26-52 name=__codelineno-26-52 href=#__codelineno-26-52></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-26-53><a id=__codelineno-26-53 name=__codelineno-26-53 href=#__codelineno-26-53></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-26-54><a id=__codelineno-26-54 name=__codelineno-26-54 href=#__codelineno-26-54></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-26-55><a id=__codelineno-26-55 name=__codelineno-26-55 href=#__codelineno-26-55></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-26-56><a id=__codelineno-26-56 name=__codelineno-26-56 href=#__codelineno-26-56></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1000</span>
</span><span id=__span-26-57><a id=__codelineno-26-57 name=__codelineno-26-57 href=#__codelineno-26-57></a><span class=p>)</span>
</span><span id=__span-26-58><a id=__codelineno-26-58 name=__codelineno-26-58 href=#__codelineno-26-58></a><span class=k>SELECT</span>
</span><span id=__span-26-59><a id=__codelineno-26-59 name=__codelineno-26-59 href=#__codelineno-26-59></a><span class=w>    </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-26-60><a id=__codelineno-26-60 name=__codelineno-26-60 href=#__codelineno-26-60></a><span class=w>    </span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-26-61><a id=__codelineno-26-61 name=__codelineno-26-61 href=#__codelineno-26-61></a><span class=w>    </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-26-62><a id=__codelineno-26-62 name=__codelineno-26-62 href=#__codelineno-26-62></a><span class=w>    </span><span class=n>days_to_exploit</span><span class=p>,</span>
</span><span id=__span-26-63><a id=__codelineno-26-63 name=__codelineno-26-63 href=#__codelineno-26-63></a><span class=w>    </span><span class=n>ROUND</span><span class=p>(</span><span class=n>cvss_score</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_score</span><span class=p>,</span>
</span><span id=__span-26-64><a id=__codelineno-26-64 name=__codelineno-26-64 href=#__codelineno-26-64></a><span class=w>    </span><span class=n>cvss_version</span><span class=p>,</span>
</span><span id=__span-26-65><a id=__codelineno-26-65 name=__codelineno-26-65 href=#__codelineno-26-65></a><span class=w>    </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-26-66><a id=__codelineno-26-66 name=__codelineno-26-66 href=#__codelineno-26-66></a><span class=w>    </span><span class=n>cwe_ids</span><span class=p>,</span>
</span><span id=__span-26-67><a id=__codelineno-26-67 name=__codelineno-26-67 href=#__codelineno-26-67></a><span class=w>    </span><span class=n>exploit_type</span><span class=p>,</span>
</span><span id=__span-26-68><a id=__codelineno-26-68 name=__codelineno-26-68 href=#__codelineno-26-68></a><span class=w>    </span><span class=n>exploit_platform</span><span class=p>,</span>
</span><span id=__span-26-69><a id=__codelineno-26-69 name=__codelineno-26-69 href=#__codelineno-26-69></a><span class=w>    </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>exploit_verified</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Yes&#39;</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;No&#39;</span><span class=w> </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>verified</span><span class=p>,</span>
</span><span id=__span-26-70><a id=__codelineno-26-70 name=__codelineno-26-70 href=#__codelineno-26-70></a><span class=w>    </span><span class=n>short_description</span>
</span><span id=__span-26-71><a id=__codelineno-26-71 name=__codelineno-26-71 href=#__codelineno-26-71></a><span class=k>FROM</span><span class=w> </span><span class=n>long_exploit_gaps</span>
</span><span id=__span-26-72><a id=__codelineno-26-72 name=__codelineno-26-72 href=#__codelineno-26-72></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>days_to_exploit</span><span class=w> </span><span class=k>DESC</span>
</span><span id=__span-26-73><a id=__codelineno-26-73 name=__codelineno-26-73 href=#__codelineno-26-73></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span><span class=p>;</span>
</span></code></pre></div></p> </li> </ul> <h3 id=ch5_tab_53_cves-with-more-than-1000-days-between-patching-and-exploitation-dateall-vendors><strong>Ch5_Tab_5.3_CVEs with more than 1000 days between Patching and Exploitation Date(All vendors)</strong><a class=headerlink href=#ch5_tab_53_cves-with-more-than-1000-days-between-patching-and-exploitation-dateall-vendors title="Permanent link">&para;</a></h3> <ul> <li> <p><strong>Question Answered</strong>: Which CVEs have extremely long gaps (&gt;1000 days) between exploit publication and patch availability?</p> </li> <li> <p><strong>SQL Query</strong>: <div class="language-sql highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=k>WITH</span><span class=w> </span><span class=n>long_patch_gaps</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=w>    </span><span class=c1>-- Microsoft patches</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=w>        </span><span class=s1>&#39;Microsoft&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_vendor</span><span class=p>,</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=w>        </span><span class=n>mp</span><span class=p>.</span><span class=n>product_name</span><span class=p>,</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-27-11><a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a><span class=w>        </span><span class=c1>-- Prioritize CVSS versions: v4 -&gt; v3 -&gt; v2</span>
</span><span id=__span-27-12><a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a><span class=w>        </span><span class=k>COALESCE</span><span class=p>(</span>
</span><span id=__span-27-13><a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>END</span><span class=p>,</span>
</span><span id=__span-27-14><a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>END</span><span class=p>,</span>
</span><span id=__span-27-15><a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>END</span>
</span><span id=__span-27-16><a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_score</span><span class=p>,</span>
</span><span id=__span-27-17><a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-18><a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v4&#39;</span>
</span><span id=__span-27-19><a id=__codelineno-27-19 name=__codelineno-27-19 href=#__codelineno-27-19></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v3&#39;</span>
</span><span id=__span-27-20><a id=__codelineno-27-20 name=__codelineno-27-20 href=#__codelineno-27-20></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v2&#39;</span>
</span><span id=__span-27-21><a id=__codelineno-27-21 name=__codelineno-27-21 href=#__codelineno-27-21></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-27-22><a id=__codelineno-27-22 name=__codelineno-27-22 href=#__codelineno-27-22></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_version</span><span class=p>,</span>
</span><span id=__span-27-23><a id=__codelineno-27-23 name=__codelineno-27-23 href=#__codelineno-27-23></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-24><a id=__codelineno-27-24 name=__codelineno-27-24 href=#__codelineno-27-24></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-27-25><a id=__codelineno-27-25 name=__codelineno-27-25 href=#__codelineno-27-25></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-26><a id=__codelineno-27-26 name=__codelineno-27-26 href=#__codelineno-27-26></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-27-27><a id=__codelineno-27-27 name=__codelineno-27-27 href=#__codelineno-27-27></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-27-28><a id=__codelineno-27-28 name=__codelineno-27-28 href=#__codelineno-27-28></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-27-29><a id=__codelineno-27-29 name=__codelineno-27-29 href=#__codelineno-27-29></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-27-30><a id=__codelineno-27-30 name=__codelineno-27-30 href=#__codelineno-27-30></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-27-31><a id=__codelineno-27-31 name=__codelineno-27-31 href=#__codelineno-27-31></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-27-32><a id=__codelineno-27-32 name=__codelineno-27-32 href=#__codelineno-27-32></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-33><a id=__codelineno-27-33 name=__codelineno-27-33 href=#__codelineno-27-33></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-27-34><a id=__codelineno-27-34 name=__codelineno-27-34 href=#__codelineno-27-34></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-27-35><a id=__codelineno-27-35 name=__codelineno-27-35 href=#__codelineno-27-35></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-27-36><a id=__codelineno-27-36 name=__codelineno-27-36 href=#__codelineno-27-36></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-27-37><a id=__codelineno-27-37 name=__codelineno-27-37 href=#__codelineno-27-37></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-27-38><a id=__codelineno-27-38 name=__codelineno-27-38 href=#__codelineno-27-38></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-27-39><a id=__codelineno-27-39 name=__codelineno-27-39 href=#__codelineno-27-39></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-40><a id=__codelineno-27-40 name=__codelineno-27-40 href=#__codelineno-27-40></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-27-41><a id=__codelineno-27-41 name=__codelineno-27-41 href=#__codelineno-27-41></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-27-42><a id=__codelineno-27-42 name=__codelineno-27-42 href=#__codelineno-27-42></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-27-43><a id=__codelineno-27-43 name=__codelineno-27-43 href=#__codelineno-27-43></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-27-44><a id=__codelineno-27-44 name=__codelineno-27-44 href=#__codelineno-27-44></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-27-45><a id=__codelineno-27-45 name=__codelineno-27-45 href=#__codelineno-27-45></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-27-46><a id=__codelineno-27-46 name=__codelineno-27-46 href=#__codelineno-27-46></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cwe_ids</span><span class=p>,</span>
</span><span id=__span-27-47><a id=__codelineno-27-47 name=__codelineno-27-47 href=#__codelineno-27-47></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>description</span>
</span><span id=__span-27-48><a id=__codelineno-27-48 name=__codelineno-27-48 href=#__codelineno-27-48></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-27-49><a id=__codelineno-27-49 name=__codelineno-27-49 href=#__codelineno-27-49></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-27-50><a id=__codelineno-27-50 name=__codelineno-27-50 href=#__codelineno-27-50></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>msrc_patches</span><span class=w> </span><span class=n>mp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-27-51><a id=__codelineno-27-51 name=__codelineno-27-51 href=#__codelineno-27-51></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-27-52><a id=__codelineno-27-52 name=__codelineno-27-52 href=#__codelineno-27-52></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-27-53><a id=__codelineno-27-53 name=__codelineno-27-53 href=#__codelineno-27-53></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-27-54><a id=__codelineno-27-54 name=__codelineno-27-54 href=#__codelineno-27-54></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-27-55><a id=__codelineno-27-55 name=__codelineno-27-55 href=#__codelineno-27-55></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-27-56><a id=__codelineno-27-56 name=__codelineno-27-56 href=#__codelineno-27-56></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-27-57><a id=__codelineno-27-57 name=__codelineno-27-57 href=#__codelineno-27-57></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-27-58><a id=__codelineno-27-58 name=__codelineno-27-58 href=#__codelineno-27-58></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>mp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1000</span>
</span><span id=__span-27-59><a id=__codelineno-27-59 name=__codelineno-27-59 href=#__codelineno-27-59></a>
</span><span id=__span-27-60><a id=__codelineno-27-60 name=__codelineno-27-60 href=#__codelineno-27-60></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-27-61><a id=__codelineno-27-61 name=__codelineno-27-61 href=#__codelineno-27-61></a>
</span><span id=__span-27-62><a id=__codelineno-27-62 name=__codelineno-27-62 href=#__codelineno-27-62></a><span class=w>    </span><span class=c1>-- RedHat patches</span>
</span><span id=__span-27-63><a id=__codelineno-27-63 name=__codelineno-27-63 href=#__codelineno-27-63></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-27-64><a id=__codelineno-27-64 name=__codelineno-27-64 href=#__codelineno-27-64></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-27-65><a id=__codelineno-27-65 name=__codelineno-27-65 href=#__codelineno-27-65></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-27-66><a id=__codelineno-27-66 name=__codelineno-27-66 href=#__codelineno-27-66></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-27-67><a id=__codelineno-27-67 name=__codelineno-27-67 href=#__codelineno-27-67></a><span class=w>        </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-27-68><a id=__codelineno-27-68 name=__codelineno-27-68 href=#__codelineno-27-68></a><span class=w>        </span><span class=s1>&#39;RedHat&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_vendor</span><span class=p>,</span>
</span><span id=__span-27-69><a id=__codelineno-27-69 name=__codelineno-27-69 href=#__codelineno-27-69></a><span class=w>        </span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>,</span>
</span><span id=__span-27-70><a id=__codelineno-27-70 name=__codelineno-27-70 href=#__codelineno-27-70></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-27-71><a id=__codelineno-27-71 name=__codelineno-27-71 href=#__codelineno-27-71></a><span class=w>        </span><span class=k>COALESCE</span><span class=p>(</span>
</span><span id=__span-27-72><a id=__codelineno-27-72 name=__codelineno-27-72 href=#__codelineno-27-72></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>END</span><span class=p>,</span>
</span><span id=__span-27-73><a id=__codelineno-27-73 name=__codelineno-27-73 href=#__codelineno-27-73></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>END</span><span class=p>,</span>
</span><span id=__span-27-74><a id=__codelineno-27-74 name=__codelineno-27-74 href=#__codelineno-27-74></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>END</span>
</span><span id=__span-27-75><a id=__codelineno-27-75 name=__codelineno-27-75 href=#__codelineno-27-75></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_score</span><span class=p>,</span>
</span><span id=__span-27-76><a id=__codelineno-27-76 name=__codelineno-27-76 href=#__codelineno-27-76></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-77><a id=__codelineno-27-77 name=__codelineno-27-77 href=#__codelineno-27-77></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v4&#39;</span>
</span><span id=__span-27-78><a id=__codelineno-27-78 name=__codelineno-27-78 href=#__codelineno-27-78></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v3&#39;</span>
</span><span id=__span-27-79><a id=__codelineno-27-79 name=__codelineno-27-79 href=#__codelineno-27-79></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v2&#39;</span>
</span><span id=__span-27-80><a id=__codelineno-27-80 name=__codelineno-27-80 href=#__codelineno-27-80></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-27-81><a id=__codelineno-27-81 name=__codelineno-27-81 href=#__codelineno-27-81></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_version</span><span class=p>,</span>
</span><span id=__span-27-82><a id=__codelineno-27-82 name=__codelineno-27-82 href=#__codelineno-27-82></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-83><a id=__codelineno-27-83 name=__codelineno-27-83 href=#__codelineno-27-83></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-27-84><a id=__codelineno-27-84 name=__codelineno-27-84 href=#__codelineno-27-84></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-85><a id=__codelineno-27-85 name=__codelineno-27-85 href=#__codelineno-27-85></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-27-86><a id=__codelineno-27-86 name=__codelineno-27-86 href=#__codelineno-27-86></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-27-87><a id=__codelineno-27-87 name=__codelineno-27-87 href=#__codelineno-27-87></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-27-88><a id=__codelineno-27-88 name=__codelineno-27-88 href=#__codelineno-27-88></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-27-89><a id=__codelineno-27-89 name=__codelineno-27-89 href=#__codelineno-27-89></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-27-90><a id=__codelineno-27-90 name=__codelineno-27-90 href=#__codelineno-27-90></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-27-91><a id=__codelineno-27-91 name=__codelineno-27-91 href=#__codelineno-27-91></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-92><a id=__codelineno-27-92 name=__codelineno-27-92 href=#__codelineno-27-92></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-27-93><a id=__codelineno-27-93 name=__codelineno-27-93 href=#__codelineno-27-93></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-27-94><a id=__codelineno-27-94 name=__codelineno-27-94 href=#__codelineno-27-94></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-27-95><a id=__codelineno-27-95 name=__codelineno-27-95 href=#__codelineno-27-95></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-27-96><a id=__codelineno-27-96 name=__codelineno-27-96 href=#__codelineno-27-96></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-27-97><a id=__codelineno-27-97 name=__codelineno-27-97 href=#__codelineno-27-97></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-27-98><a id=__codelineno-27-98 name=__codelineno-27-98 href=#__codelineno-27-98></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-99><a id=__codelineno-27-99 name=__codelineno-27-99 href=#__codelineno-27-99></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-27-100><a id=__codelineno-27-100 name=__codelineno-27-100 href=#__codelineno-27-100></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-27-101><a id=__codelineno-27-101 name=__codelineno-27-101 href=#__codelineno-27-101></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-27-102><a id=__codelineno-27-102 name=__codelineno-27-102 href=#__codelineno-27-102></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-27-103><a id=__codelineno-27-103 name=__codelineno-27-103 href=#__codelineno-27-103></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-27-104><a id=__codelineno-27-104 name=__codelineno-27-104 href=#__codelineno-27-104></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-27-105><a id=__codelineno-27-105 name=__codelineno-27-105 href=#__codelineno-27-105></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cwe_ids</span><span class=p>,</span>
</span><span id=__span-27-106><a id=__codelineno-27-106 name=__codelineno-27-106 href=#__codelineno-27-106></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>description</span>
</span><span id=__span-27-107><a id=__codelineno-27-107 name=__codelineno-27-107 href=#__codelineno-27-107></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-27-108><a id=__codelineno-27-108 name=__codelineno-27-108 href=#__codelineno-27-108></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-27-109><a id=__codelineno-27-109 name=__codelineno-27-109 href=#__codelineno-27-109></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>redhat_patches</span><span class=w> </span><span class=n>rp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-27-110><a id=__codelineno-27-110 name=__codelineno-27-110 href=#__codelineno-27-110></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-27-111><a id=__codelineno-27-111 name=__codelineno-27-111 href=#__codelineno-27-111></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-27-112><a id=__codelineno-27-112 name=__codelineno-27-112 href=#__codelineno-27-112></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-27-113><a id=__codelineno-27-113 name=__codelineno-27-113 href=#__codelineno-27-113></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-27-114><a id=__codelineno-27-114 name=__codelineno-27-114 href=#__codelineno-27-114></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-27-115><a id=__codelineno-27-115 name=__codelineno-27-115 href=#__codelineno-27-115></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-27-116><a id=__codelineno-27-116 name=__codelineno-27-116 href=#__codelineno-27-116></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-27-117><a id=__codelineno-27-117 name=__codelineno-27-117 href=#__codelineno-27-117></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>rp</span><span class=p>.</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=p>)</span>
</span><span id=__span-27-118><a id=__codelineno-27-118 name=__codelineno-27-118 href=#__codelineno-27-118></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>rp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1000</span>
</span><span id=__span-27-119><a id=__codelineno-27-119 name=__codelineno-27-119 href=#__codelineno-27-119></a>
</span><span id=__span-27-120><a id=__codelineno-27-120 name=__codelineno-27-120 href=#__codelineno-27-120></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-27-121><a id=__codelineno-27-121 name=__codelineno-27-121 href=#__codelineno-27-121></a>
</span><span id=__span-27-122><a id=__codelineno-27-122 name=__codelineno-27-122 href=#__codelineno-27-122></a><span class=w>    </span><span class=c1>-- Cisco patches</span>
</span><span id=__span-27-123><a id=__codelineno-27-123 name=__codelineno-27-123 href=#__codelineno-27-123></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-27-124><a id=__codelineno-27-124 name=__codelineno-27-124 href=#__codelineno-27-124></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-27-125><a id=__codelineno-27-125 name=__codelineno-27-125 href=#__codelineno-27-125></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-27-126><a id=__codelineno-27-126 name=__codelineno-27-126 href=#__codelineno-27-126></a><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-27-127><a id=__codelineno-27-127 name=__codelineno-27-127 href=#__codelineno-27-127></a><span class=w>        </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-27-128><a id=__codelineno-27-128 name=__codelineno-27-128 href=#__codelineno-27-128></a><span class=w>        </span><span class=s1>&#39;Cisco&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>patch_vendor</span><span class=p>,</span>
</span><span id=__span-27-129><a id=__codelineno-27-129 name=__codelineno-27-129 href=#__codelineno-27-129></a><span class=w>        </span><span class=n>cp</span><span class=p>.</span><span class=n>product_name</span><span class=p>,</span>
</span><span id=__span-27-130><a id=__codelineno-27-130 name=__codelineno-27-130 href=#__codelineno-27-130></a><span class=w>        </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-27-131><a id=__codelineno-27-131 name=__codelineno-27-131 href=#__codelineno-27-131></a><span class=w>        </span><span class=k>COALESCE</span><span class=p>(</span>
</span><span id=__span-27-132><a id=__codelineno-27-132 name=__codelineno-27-132 href=#__codelineno-27-132></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>END</span><span class=p>,</span>
</span><span id=__span-27-133><a id=__codelineno-27-133 name=__codelineno-27-133 href=#__codelineno-27-133></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>END</span><span class=p>,</span>
</span><span id=__span-27-134><a id=__codelineno-27-134 name=__codelineno-27-134 href=#__codelineno-27-134></a><span class=w>            </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>END</span>
</span><span id=__span-27-135><a id=__codelineno-27-135 name=__codelineno-27-135 href=#__codelineno-27-135></a><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_score</span><span class=p>,</span>
</span><span id=__span-27-136><a id=__codelineno-27-136 name=__codelineno-27-136 href=#__codelineno-27-136></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-137><a id=__codelineno-27-137 name=__codelineno-27-137 href=#__codelineno-27-137></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v4&#39;</span>
</span><span id=__span-27-138><a id=__codelineno-27-138 name=__codelineno-27-138 href=#__codelineno-27-138></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v3&#39;</span>
</span><span id=__span-27-139><a id=__codelineno-27-139 name=__codelineno-27-139 href=#__codelineno-27-139></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;v2&#39;</span>
</span><span id=__span-27-140><a id=__codelineno-27-140 name=__codelineno-27-140 href=#__codelineno-27-140></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-27-141><a id=__codelineno-27-141 name=__codelineno-27-141 href=#__codelineno-27-141></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_version</span><span class=p>,</span>
</span><span id=__span-27-142><a id=__codelineno-27-142 name=__codelineno-27-142 href=#__codelineno-27-142></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-143><a id=__codelineno-27-143 name=__codelineno-27-143 href=#__codelineno-27-143></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-27-144><a id=__codelineno-27-144 name=__codelineno-27-144 href=#__codelineno-27-144></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-145><a id=__codelineno-27-145 name=__codelineno-27-145 href=#__codelineno-27-145></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-27-146><a id=__codelineno-27-146 name=__codelineno-27-146 href=#__codelineno-27-146></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-27-147><a id=__codelineno-27-147 name=__codelineno-27-147 href=#__codelineno-27-147></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-27-148><a id=__codelineno-27-148 name=__codelineno-27-148 href=#__codelineno-27-148></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v4_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-27-149><a id=__codelineno-27-149 name=__codelineno-27-149 href=#__codelineno-27-149></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-27-150><a id=__codelineno-27-150 name=__codelineno-27-150 href=#__codelineno-27-150></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-27-151><a id=__codelineno-27-151 name=__codelineno-27-151 href=#__codelineno-27-151></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-152><a id=__codelineno-27-152 name=__codelineno-27-152 href=#__codelineno-27-152></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>9</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span>
</span><span id=__span-27-153><a id=__codelineno-27-153 name=__codelineno-27-153 href=#__codelineno-27-153></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-27-154><a id=__codelineno-27-154 name=__codelineno-27-154 href=#__codelineno-27-154></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-27-155><a id=__codelineno-27-155 name=__codelineno-27-155 href=#__codelineno-27-155></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-27-156><a id=__codelineno-27-156 name=__codelineno-27-156 href=#__codelineno-27-156></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-27-157><a id=__codelineno-27-157 name=__codelineno-27-157 href=#__codelineno-27-157></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span>
</span><span id=__span-27-158><a id=__codelineno-27-158 name=__codelineno-27-158 href=#__codelineno-27-158></a><span class=w>                </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-27-159><a id=__codelineno-27-159 name=__codelineno-27-159 href=#__codelineno-27-159></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>7</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span>
</span><span id=__span-27-160><a id=__codelineno-27-160 name=__codelineno-27-160 href=#__codelineno-27-160></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span>
</span><span id=__span-27-161><a id=__codelineno-27-161 name=__codelineno-27-161 href=#__codelineno-27-161></a><span class=w>                    </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v2_score</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span>
</span><span id=__span-27-162><a id=__codelineno-27-162 name=__codelineno-27-162 href=#__codelineno-27-162></a><span class=w>                </span><span class=k>END</span>
</span><span id=__span-27-163><a id=__codelineno-27-163 name=__codelineno-27-163 href=#__codelineno-27-163></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-27-164><a id=__codelineno-27-164 name=__codelineno-27-164 href=#__codelineno-27-164></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-27-165><a id=__codelineno-27-165 name=__codelineno-27-165 href=#__codelineno-27-165></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>cwe_ids</span><span class=p>,</span>
</span><span id=__span-27-166><a id=__codelineno-27-166 name=__codelineno-27-166 href=#__codelineno-27-166></a><span class=w>        </span><span class=n>cm</span><span class=p>.</span><span class=n>description</span>
</span><span id=__span-27-167><a id=__codelineno-27-167 name=__codelineno-27-167 href=#__codelineno-27-167></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cve_main</span><span class=w> </span><span class=n>cm</span>
</span><span id=__span-27-168><a id=__codelineno-27-168 name=__codelineno-27-168 href=#__codelineno-27-168></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>exploits</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-27-169><a id=__codelineno-27-169 name=__codelineno-27-169 href=#__codelineno-27-169></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>cisco_patches</span><span class=w> </span><span class=n>cp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>cve_id</span>
</span><span id=__span-27-170><a id=__codelineno-27-170 name=__codelineno-27-170 href=#__codelineno-27-170></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=k>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PUBLISHED&#39;</span>
</span><span id=__span-27-171><a id=__codelineno-27-171 name=__codelineno-27-171 href=#__codelineno-27-171></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_reserved</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-27-172><a id=__codelineno-27-172 name=__codelineno-27-172 href=#__codelineno-27-172></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-27-173><a id=__codelineno-27-173 name=__codelineno-27-173 href=#__codelineno-27-173></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
</span><span id=__span-27-174><a id=__codelineno-27-174 name=__codelineno-27-174 href=#__codelineno-27-174></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span>
</span><span id=__span-27-175><a id=__codelineno-27-175 name=__codelineno-27-175 href=#__codelineno-27-175></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-27-176><a id=__codelineno-27-176 name=__codelineno-27-176 href=#__codelineno-27-176></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-27-177><a id=__codelineno-27-177 name=__codelineno-27-177 href=#__codelineno-27-177></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>DATE_DIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>cp</span><span class=p>.</span><span class=n>initial_release_date</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1000</span>
</span><span id=__span-27-178><a id=__codelineno-27-178 name=__codelineno-27-178 href=#__codelineno-27-178></a><span class=p>)</span>
</span><span id=__span-27-179><a id=__codelineno-27-179 name=__codelineno-27-179 href=#__codelineno-27-179></a><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-27-180><a id=__codelineno-27-180 name=__codelineno-27-180 href=#__codelineno-27-180></a><span class=w>    </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-27-181><a id=__codelineno-27-181 name=__codelineno-27-181 href=#__codelineno-27-181></a><span class=w>    </span><span class=n>date_reserved</span><span class=p>,</span>
</span><span id=__span-27-182><a id=__codelineno-27-182 name=__codelineno-27-182 href=#__codelineno-27-182></a><span class=w>    </span><span class=n>exploit_date</span><span class=p>,</span>
</span><span id=__span-27-183><a id=__codelineno-27-183 name=__codelineno-27-183 href=#__codelineno-27-183></a><span class=w>    </span><span class=n>patch_date</span><span class=p>,</span>
</span><span id=__span-27-184><a id=__codelineno-27-184 name=__codelineno-27-184 href=#__codelineno-27-184></a><span class=w>    </span><span class=n>patch_exploit_gap</span><span class=p>,</span>
</span><span id=__span-27-185><a id=__codelineno-27-185 name=__codelineno-27-185 href=#__codelineno-27-185></a><span class=w>    </span><span class=n>patch_vendor</span><span class=p>,</span>
</span><span id=__span-27-186><a id=__codelineno-27-186 name=__codelineno-27-186 href=#__codelineno-27-186></a><span class=w>    </span><span class=n>product_name</span><span class=p>,</span>
</span><span id=__span-27-187><a id=__codelineno-27-187 name=__codelineno-27-187 href=#__codelineno-27-187></a><span class=w>    </span><span class=n>ROUND</span><span class=p>(</span><span class=n>cvss_score</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>cvss_score</span><span class=p>,</span>
</span><span id=__span-27-188><a id=__codelineno-27-188 name=__codelineno-27-188 href=#__codelineno-27-188></a><span class=w>    </span><span class=n>cvss_version</span><span class=p>,</span>
</span><span id=__span-27-189><a id=__codelineno-27-189 name=__codelineno-27-189 href=#__codelineno-27-189></a><span class=w>    </span><span class=n>severity_level</span><span class=p>,</span>
</span><span id=__span-27-190><a id=__codelineno-27-190 name=__codelineno-27-190 href=#__codelineno-27-190></a><span class=w>    </span><span class=n>cwe_ids</span><span class=p>,</span>
</span><span id=__span-27-191><a id=__codelineno-27-191 name=__codelineno-27-191 href=#__codelineno-27-191></a><span class=w>    </span><span class=n>SUBSTR</span><span class=p>(</span><span class=n>description</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39;...&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>short_description</span>
</span><span id=__span-27-192><a id=__codelineno-27-192 name=__codelineno-27-192 href=#__codelineno-27-192></a><span class=k>FROM</span><span class=w> </span><span class=n>long_patch_gaps</span>
</span><span id=__span-27-193><a id=__codelineno-27-193 name=__codelineno-27-193 href=#__codelineno-27-193></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>patch_exploit_gap</span><span class=w> </span><span class=k>DESC</span>
</span><span id=__span-27-194><a id=__codelineno-27-194 name=__codelineno-27-194 href=#__codelineno-27-194></a><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span><span class=p>;</span>
</span></code></pre></div></p> </li> </ul> <h1 id=comparative-analysis-of-patching-and-vulnerability-lifecycles-commercial-vendors-vs-open-source><strong>Comparative Analysis of Patching and Vulnerability Lifecycles: Commercial Vendors vs. Open Source</strong><a class=headerlink href=#comparative-analysis-of-patching-and-vulnerability-lifecycles-commercial-vendors-vs-open-source title="Permanent link">&para;</a></h1> <p>This document provides SQL queries (DuckDB syntax) and Apache Superset configurations for a comparative analysis of patching and vulnerability lifecycle events across major commercial vendors (Microsoft, Red Hat, Cisco) and prominent open-source ecosystems (GitHub Advisories, MoreFixes). The analysis incorporates data up to May 13, 2025, and adheres to the specific filtering requirements for Red Hat products and the distinctions between commercial and open-source patch data.</p> <h2 id=unified-patch-data-definition><strong>Unified Patch Data Definition</strong><a class=headerlink href=#unified-patch-data-definition title="Permanent link">&para;</a></h2> <p>To facilitate comprehensive comparisons, the following Common Table Expression (CTE) named unified_patches combines patch information from all available sources, standardizing column names and introducing a vendor_source and patch_type to distinguish between commercial vendors and open-source projects. This CTE will be used as the foundation for subsequent queries.</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=k>WITH</span><span class=w> </span><span class=n>unified_patches</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>  </span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=w>    </span><span class=c1>-- Microsoft Patches  </span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=w>    </span><span class=k>SELECT</span><span class=w>  </span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=w>        </span><span class=n>release_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=w>        </span><span class=s1>&#39;Microsoft&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=w>        </span><span class=s1>&#39;Commercial&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_type</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=w>        </span><span class=n>cvss_score</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=w>        </span><span class=n>cvss_vector</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=w>        </span><span class=n>cwe_ids</span><span class=w>  </span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a><span class=w>    </span><span class=k>FROM</span><span class=w>  </span>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=w>        </span><span class=n>msrc_patches</span><span class=w>  </span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a><span class=w>    </span><span class=k>WHERE</span><span class=w>  </span>
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a><span class=w>        </span><span class=n>release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a>
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a>
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a><span class=w>    </span><span class=c1>-- Red Hat Patches (filtered for official Red Hat products)  </span>
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a><span class=w>    </span><span class=k>SELECT</span><span class=w>  </span>
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-21><a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a><span class=w>        </span><span class=n>current_release_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-22><a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a><span class=w>        </span><span class=s1>&#39;RedHat&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-23><a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a><span class=w>        </span><span class=s1>&#39;Commercial&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_type</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-24><a id=__codelineno-28-24 name=__codelineno-28-24 href=#__codelineno-28-24></a><span class=w>        </span><span class=n>cvss_score</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-25><a id=__codelineno-28-25 name=__codelineno-28-25 href=#__codelineno-28-25></a><span class=w>        </span><span class=n>cvss_vector</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-26><a id=__codelineno-28-26 name=__codelineno-28-26 href=#__codelineno-28-26></a><span class=w>        </span><span class=n>cwe_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cwe_ids</span><span class=w> </span><span class=c1>-- Assuming cwe_id is singular in redhat_patches  </span>
</span><span id=__span-28-27><a id=__codelineno-28-27 name=__codelineno-28-27 href=#__codelineno-28-27></a><span class=w>    </span><span class=k>FROM</span><span class=w>  </span>
</span><span id=__span-28-28><a id=__codelineno-28-28 name=__codelineno-28-28 href=#__codelineno-28-28></a><span class=w>        </span><span class=n>redhat_patches</span><span class=w>  </span>
</span><span id=__span-28-29><a id=__codelineno-28-29 name=__codelineno-28-29 href=#__codelineno-28-29></a><span class=w>    </span><span class=k>WHERE</span><span class=w>  </span>
</span><span id=__span-28-30><a id=__codelineno-28-30 name=__codelineno-28-30 href=#__codelineno-28-30></a><span class=w>        </span><span class=n>current_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span><span class=w>  </span>
</span><span id=__span-28-31><a id=__codelineno-28-31 name=__codelineno-28-31 href=#__codelineno-28-31></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=w>  </span>
</span><span id=__span-28-32><a id=__codelineno-28-32 name=__codelineno-28-32 href=#__codelineno-28-32></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rh%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-33><a id=__codelineno-28-33 name=__codelineno-28-33 href=#__codelineno-28-33></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-34><a id=__codelineno-28-34 name=__codelineno-28-34 href=#__codelineno-28-34></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red-hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-35><a id=__codelineno-28-35 name=__codelineno-28-35 href=#__codelineno-28-35></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-36><a id=__codelineno-28-36 name=__codelineno-28-36 href=#__codelineno-28-36></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-37><a id=__codelineno-28-37 name=__codelineno-28-37 href=#__codelineno-28-37></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%baseos%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-38><a id=__codelineno-28-38 name=__codelineno-28-38 href=#__codelineno-28-38></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%appstream%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-39><a id=__codelineno-28-39 name=__codelineno-28-39 href=#__codelineno-28-39></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_name</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%openshift%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-40><a id=__codelineno-28-40 name=__codelineno-28-40 href=#__codelineno-28-40></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rh%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-41><a id=__codelineno-28-41 name=__codelineno-28-41 href=#__codelineno-28-41></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-42><a id=__codelineno-28-42 name=__codelineno-28-42 href=#__codelineno-28-42></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%red-hat%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-43><a id=__codelineno-28-43 name=__codelineno-28-43 href=#__codelineno-28-43></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%rhel%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-44><a id=__codelineno-28-44 name=__codelineno-28-44 href=#__codelineno-28-44></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%enterprise linux%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-45><a id=__codelineno-28-45 name=__codelineno-28-45 href=#__codelineno-28-45></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%baseos%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-46><a id=__codelineno-28-46 name=__codelineno-28-46 href=#__codelineno-28-46></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%appstream%&#39;</span><span class=w> </span><span class=k>OR</span><span class=w>  </span>
</span><span id=__span-28-47><a id=__codelineno-28-47 name=__codelineno-28-47 href=#__codelineno-28-47></a><span class=w>            </span><span class=k>LOWER</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%openshift%&#39;</span><span class=w>  </span>
</span><span id=__span-28-48><a id=__codelineno-28-48 name=__codelineno-28-48 href=#__codelineno-28-48></a><span class=w>        </span><span class=p>)</span>
</span><span id=__span-28-49><a id=__codelineno-28-49 name=__codelineno-28-49 href=#__codelineno-28-49></a>
</span><span id=__span-28-50><a id=__codelineno-28-50 name=__codelineno-28-50 href=#__codelineno-28-50></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-28-51><a id=__codelineno-28-51 name=__codelineno-28-51 href=#__codelineno-28-51></a>
</span><span id=__span-28-52><a id=__codelineno-28-52 name=__codelineno-28-52 href=#__codelineno-28-52></a><span class=w>    </span><span class=c1>-- Cisco Patches  </span>
</span><span id=__span-28-53><a id=__codelineno-28-53 name=__codelineno-28-53 href=#__codelineno-28-53></a><span class=w>    </span><span class=k>SELECT</span><span class=w>  </span>
</span><span id=__span-28-54><a id=__codelineno-28-54 name=__codelineno-28-54 href=#__codelineno-28-54></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-55><a id=__codelineno-28-55 name=__codelineno-28-55 href=#__codelineno-28-55></a><span class=w>        </span><span class=n>current_release_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-56><a id=__codelineno-28-56 name=__codelineno-28-56 href=#__codelineno-28-56></a><span class=w>        </span><span class=s1>&#39;Cisco&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-57><a id=__codelineno-28-57 name=__codelineno-28-57 href=#__codelineno-28-57></a><span class=w>        </span><span class=s1>&#39;Commercial&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_type</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-58><a id=__codelineno-28-58 name=__codelineno-28-58 href=#__codelineno-28-58></a><span class=w>        </span><span class=n>cvss_score</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-59><a id=__codelineno-28-59 name=__codelineno-28-59 href=#__codelineno-28-59></a><span class=w>        </span><span class=n>cvss_vector</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-60><a id=__codelineno-28-60 name=__codelineno-28-60 href=#__codelineno-28-60></a><span class=w>        </span><span class=k>NULL</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cwe_ids</span><span class=w> </span><span class=c1>-- Cisco patches table doesn&#39;t have cwe_ids directly  </span>
</span><span id=__span-28-61><a id=__codelineno-28-61 name=__codelineno-28-61 href=#__codelineno-28-61></a><span class=w>    </span><span class=k>FROM</span><span class=w>  </span>
</span><span id=__span-28-62><a id=__codelineno-28-62 name=__codelineno-28-62 href=#__codelineno-28-62></a><span class=w>        </span><span class=n>cisco_patches</span><span class=w>  </span>
</span><span id=__span-28-63><a id=__codelineno-28-63 name=__codelineno-28-63 href=#__codelineno-28-63></a><span class=w>    </span><span class=k>WHERE</span><span class=w>  </span>
</span><span id=__span-28-64><a id=__codelineno-28-64 name=__codelineno-28-64 href=#__codelineno-28-64></a><span class=w>        </span><span class=n>current_release_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span>
</span><span id=__span-28-65><a id=__codelineno-28-65 name=__codelineno-28-65 href=#__codelineno-28-65></a>
</span><span id=__span-28-66><a id=__codelineno-28-66 name=__codelineno-28-66 href=#__codelineno-28-66></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-28-67><a id=__codelineno-28-67 name=__codelineno-28-67 href=#__codelineno-28-67></a>
</span><span id=__span-28-68><a id=__codelineno-28-68 name=__codelineno-28-68 href=#__codelineno-28-68></a><span class=w>    </span><span class=c1>-- GitHub Advisories (inferred patches)  </span>
</span><span id=__span-28-69><a id=__codelineno-28-69 name=__codelineno-28-69 href=#__codelineno-28-69></a><span class=w>    </span><span class=k>SELECT</span><span class=w>  </span>
</span><span id=__span-28-70><a id=__codelineno-28-70 name=__codelineno-28-70 href=#__codelineno-28-70></a><span class=w>        </span><span class=n>primary_cve</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cve_id</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-71><a id=__codelineno-28-71 name=__codelineno-28-71 href=#__codelineno-28-71></a><span class=w>        </span><span class=n>published</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span><span class=w> </span><span class=c1>-- Using published date as patch date for advisories  </span>
</span><span id=__span-28-72><a id=__codelineno-28-72 name=__codelineno-28-72 href=#__codelineno-28-72></a><span class=w>        </span><span class=s1>&#39;GitHub&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-73><a id=__codelineno-28-73 name=__codelineno-28-73 href=#__codelineno-28-73></a><span class=w>        </span><span class=s1>&#39;OpenSource&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_type</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-74><a id=__codelineno-28-74 name=__codelineno-28-74 href=#__codelineno-28-74></a><span class=w>        </span><span class=n>cvss_v3_score</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_score</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-75><a id=__codelineno-28-75 name=__codelineno-28-75 href=#__codelineno-28-75></a><span class=w>        </span><span class=n>cvss_v3_vector</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_v3_vector</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-76><a id=__codelineno-28-76 name=__codelineno-28-76 href=#__codelineno-28-76></a><span class=w>        </span><span class=n>cwe_ids</span><span class=w>  </span>
</span><span id=__span-28-77><a id=__codelineno-28-77 name=__codelineno-28-77 href=#__codelineno-28-77></a><span class=w>    </span><span class=k>FROM</span><span class=w>  </span>
</span><span id=__span-28-78><a id=__codelineno-28-78 name=__codelineno-28-78 href=#__codelineno-28-78></a><span class=w>        </span><span class=n>github_advisories</span><span class=w>  </span>
</span><span id=__span-28-79><a id=__codelineno-28-79 name=__codelineno-28-79 href=#__codelineno-28-79></a><span class=w>    </span><span class=k>WHERE</span><span class=w>  </span>
</span><span id=__span-28-80><a id=__codelineno-28-80 name=__codelineno-28-80 href=#__codelineno-28-80></a><span class=w>        </span><span class=p>(</span><span class=n>patched</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=n>patch_available</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w>  </span>
</span><span id=__span-28-81><a id=__codelineno-28-81 name=__codelineno-28-81 href=#__codelineno-28-81></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>published</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span><span class=w>  </span>
</span><span id=__span-28-82><a id=__codelineno-28-82 name=__codelineno-28-82 href=#__codelineno-28-82></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>primary_cve</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>primary_cve</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;&#39;</span>
</span><span id=__span-28-83><a id=__codelineno-28-83 name=__codelineno-28-83 href=#__codelineno-28-83></a>
</span><span id=__span-28-84><a id=__codelineno-28-84 name=__codelineno-28-84 href=#__codelineno-28-84></a><span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
</span><span id=__span-28-85><a id=__codelineno-28-85 name=__codelineno-28-85 href=#__codelineno-28-85></a>
</span><span id=__span-28-86><a id=__codelineno-28-86 name=__codelineno-28-86 href=#__codelineno-28-86></a><span class=w>    </span><span class=c1>-- MoreFixes (commits as fixes)  </span>
</span><span id=__span-28-87><a id=__codelineno-28-87 name=__codelineno-28-87 href=#__codelineno-28-87></a><span class=w>    </span><span class=k>SELECT</span><span class=w>  </span>
</span><span id=__span-28-88><a id=__codelineno-28-88 name=__codelineno-28-88 href=#__codelineno-28-88></a><span class=w>        </span><span class=n>mf_f</span><span class=p>.</span><span class=n>cve_id</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-89><a id=__codelineno-28-89 name=__codelineno-28-89 href=#__codelineno-28-89></a><span class=w>        </span><span class=n>mf_c</span><span class=p>.</span><span class=n>author_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_date</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-90><a id=__codelineno-28-90 name=__codelineno-28-90 href=#__codelineno-28-90></a><span class=w>        </span><span class=s1>&#39;MoreFixes&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-91><a id=__codelineno-28-91 name=__codelineno-28-91 href=#__codelineno-28-91></a><span class=w>        </span><span class=s1>&#39;OpenSource&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patch_type</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-92><a id=__codelineno-28-92 name=__codelineno-28-92 href=#__codelineno-28-92></a><span class=w>        </span><span class=k>NULL</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_score</span><span class=p>,</span><span class=w> </span><span class=c1>-- MoreFixes fixes table doesn&#39;t have CVSS directly  </span>
</span><span id=__span-28-93><a id=__codelineno-28-93 name=__codelineno-28-93 href=#__codelineno-28-93></a><span class=w>        </span><span class=k>NULL</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cvss_vector</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-28-94><a id=__codelineno-28-94 name=__codelineno-28-94 href=#__codelineno-28-94></a><span class=w>        </span><span class=n>mf_cw</span><span class=p>.</span><span class=n>cwe_id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cwe_ids</span><span class=w> </span><span class=c1>-- Join with morefixes_cwe_classification for CWEs  </span>
</span><span id=__span-28-95><a id=__codelineno-28-95 name=__codelineno-28-95 href=#__codelineno-28-95></a><span class=w>    </span><span class=k>FROM</span><span class=w>  </span>
</span><span id=__span-28-96><a id=__codelineno-28-96 name=__codelineno-28-96 href=#__codelineno-28-96></a><span class=w>        </span><span class=n>morefixes_fixes</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mf_f</span><span class=w>  </span>
</span><span id=__span-28-97><a id=__codelineno-28-97 name=__codelineno-28-97 href=#__codelineno-28-97></a><span class=w>    </span><span class=k>JOIN</span><span class=w>  </span>
</span><span id=__span-28-98><a id=__codelineno-28-98 name=__codelineno-28-98 href=#__codelineno-28-98></a><span class=w>        </span><span class=n>morefixes_commits</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mf_c</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mf_f</span><span class=p>.</span><span class=n>hash</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mf_c</span><span class=p>.</span><span class=n>hash</span><span class=w>  </span>
</span><span id=__span-28-99><a id=__codelineno-28-99 name=__codelineno-28-99 href=#__codelineno-28-99></a><span class=w>    </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w>  </span>
</span><span id=__span-28-100><a id=__codelineno-28-100 name=__codelineno-28-100 href=#__codelineno-28-100></a><span class=w>        </span><span class=n>morefixes_cwe_classification</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mf_cw</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>mf_f</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mf_cw</span><span class=p>.</span><span class=n>cve_id</span><span class=w>  </span>
</span><span id=__span-28-101><a id=__codelineno-28-101 name=__codelineno-28-101 href=#__codelineno-28-101></a><span class=w>    </span><span class=k>WHERE</span><span class=w>  </span>
</span><span id=__span-28-102><a id=__codelineno-28-102 name=__codelineno-28-102 href=#__codelineno-28-102></a><span class=w>        </span><span class=n>mf_c</span><span class=p>.</span><span class=n>author_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span><span class=w>  </span>
</span><span id=__span-28-103><a id=__codelineno-28-103 name=__codelineno-28-103 href=#__codelineno-28-103></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>mf_f</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>mf_f</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w>  </span>
</span><span id=__span-28-104><a id=__codelineno-28-104 name=__codelineno-28-104 href=#__codelineno-28-104></a><span class=p>)</span>
</span></code></pre></div> <h2 id=patching-volume-by-vendorsource><strong>Patching Volume by Vendor/Source</strong><a class=headerlink href=#patching-volume-by-vendorsource title="Permanent link">&para;</a></h2> <ul> <li><strong>Question Answered</strong>: How has the volume of patches changed annually across commercial vendors and open-source projects? </li> <li><strong>SQL Query</strong>:<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=w>  </span><span class=c1>-- Requires the unified_patches CTE defined above  </span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=w>  </span><span class=k>WITH</span><span class=w> </span><span class=n>unified_patches</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>  </span>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=w>      </span><span class=c1>-- ... (Unified Patch Data CTE as defined in the introduction) ...  </span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=w>  </span><span class=p>)</span><span class=w>  </span>
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=w>  </span><span class=k>SELECT</span><span class=w>  </span>
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=w>      </span><span class=n>STRFTIME</span><span class=p>(</span><span class=n>patch_date</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=w>      </span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=w>      </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patched_cve_count</span><span class=w>  </span>
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a><span class=w>  </span><span class=k>FROM</span><span class=w>  </span>
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a><span class=w>      </span><span class=n>unified_patches</span><span class=w>  </span>
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a><span class=w>  </span><span class=k>WHERE</span><span class=w>  </span>
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a><span class=w>      </span><span class=n>patch_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span><span class=w> </span><span class=c1>-- Start from a reasonable comparison point  </span>
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a><span class=w>  </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w>  </span>
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a><span class=w>      </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>vendor_source</span><span class=w>  </span>
</span><span id=__span-29-15><a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a><span class=w>  </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w>  </span>
</span><span id=__span-29-16><a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a><span class=w>      </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>vendor_source</span><span class=p>;</span>
</span></code></pre></div></li> <li><strong>Superset Chart Type</strong>: Line Chart </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: year </li> <li><strong>Y-axis</strong>: patched_cve_count </li> <li><strong>Group By</strong>: vendor_source </li> <li><strong>Time Range</strong>: Custom, e.g., 2016-01-01 to 2025-05-13 </li> <li><strong>Chart Options</strong>: Use different colors for each vendor_source.</li> </ul> <h2 id=top-patched-cwes-by-vendorsource><strong>Top Patched CWEs by Vendor/Source</strong><a class=headerlink href=#top-patched-cwes-by-vendorsource title="Permanent link">&para;</a></h2> <ul> <li><strong>Question Answered</strong>: What are the most common weakness types addressed by patches from different commercial vendors and open-source projects? </li> <li><strong>SQL Query</strong>: (This query will show top CWEs for each vendor/source. You might need to create separate charts in Superset or use a filter for vendor_source.)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=w>  </span><span class=c1>-- Requires the unified_patches CTE defined above  </span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=w>  </span><span class=k>WITH</span><span class=w> </span><span class=n>unified_patches</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>  </span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=w>      </span><span class=c1>-- ... (Unified Patch Data CTE as defined in the introduction) ...  </span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=w>  </span><span class=p>),</span><span class=w>  </span>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=w>  </span><span class=n>PatchedCWEs</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>  </span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=w>      </span><span class=k>SELECT</span><span class=w>  </span>
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=w>          </span><span class=n>up</span><span class=p>.</span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=w>          </span><span class=n>t</span><span class=p>.</span><span class=n>cwe_id</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=w>          </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>cve_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>patched_cve_count</span><span class=w>  </span>
</span><span id=__span-30-10><a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a><span class=w>      </span><span class=k>FROM</span><span class=w>  </span>
</span><span id=__span-30-11><a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a><span class=w>          </span><span class=n>unified_patches</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>up</span><span class=w>  </span>
</span><span id=__span-30-12><a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a><span class=w>      </span><span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>UNNEST</span><span class=p>(</span><span class=n>STRING_SPLIT_BY_REGEX</span><span class=p>(</span><span class=n>up</span><span class=p>.</span><span class=n>cwe_ids</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>t</span><span class=p>(</span><span class=n>cwe_id</span><span class=p>)</span><span class=w>  </span>
</span><span id=__span-30-13><a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a><span class=w>      </span><span class=k>WHERE</span><span class=w>  </span>
</span><span id=__span-30-14><a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a><span class=w>          </span><span class=n>t</span><span class=p>.</span><span class=n>cwe_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>cwe_id</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w>  </span>
</span><span id=__span-30-15><a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a><span class=w>          </span><span class=k>AND</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span><span class=w>  </span>
</span><span id=__span-30-16><a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a><span class=w>      </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w>  </span>
</span><span id=__span-30-17><a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a><span class=w>          </span><span class=n>up</span><span class=p>.</span><span class=n>vendor_source</span><span class=p>,</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>cwe_id</span><span class=w>  </span>
</span><span id=__span-30-18><a id=__codelineno-30-18 name=__codelineno-30-18 href=#__codelineno-30-18></a><span class=w>  </span><span class=p>)</span><span class=w>  </span>
</span><span id=__span-30-19><a id=__codelineno-30-19 name=__codelineno-30-19 href=#__codelineno-30-19></a><span class=w>  </span><span class=k>SELECT</span><span class=w>  </span>
</span><span id=__span-30-20><a id=__codelineno-30-20 name=__codelineno-30-20 href=#__codelineno-30-20></a><span class=w>      </span><span class=n>pc</span><span class=p>.</span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-30-21><a id=__codelineno-30-21 name=__codelineno-30-21 href=#__codelineno-30-21></a><span class=w>      </span><span class=n>cr</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cwe_name</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-30-22><a id=__codelineno-30-22 name=__codelineno-30-22 href=#__codelineno-30-22></a><span class=w>      </span><span class=n>pc</span><span class=p>.</span><span class=n>patched_cve_count</span><span class=w>  </span>
</span><span id=__span-30-23><a id=__codelineno-30-23 name=__codelineno-30-23 href=#__codelineno-30-23></a><span class=w>  </span><span class=k>FROM</span><span class=w>  </span>
</span><span id=__span-30-24><a id=__codelineno-30-24 name=__codelineno-30-24 href=#__codelineno-30-24></a><span class=w>      </span><span class=n>PatchedCWEs</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>pc</span><span class=w>  </span>
</span><span id=__span-30-25><a id=__codelineno-30-25 name=__codelineno-30-25 href=#__codelineno-30-25></a><span class=w>  </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w>  </span>
</span><span id=__span-30-26><a id=__codelineno-30-26 name=__codelineno-30-26 href=#__codelineno-30-26></a><span class=w>      </span><span class=n>cwe_ref</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cr</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>pc</span><span class=p>.</span><span class=n>cwe_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cr</span><span class=p>.</span><span class=n>cwe_id</span><span class=w>  </span>
</span><span id=__span-30-27><a id=__codelineno-30-27 name=__codelineno-30-27 href=#__codelineno-30-27></a><span class=w>  </span><span class=n>QUALIFY</span><span class=w> </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>pc</span><span class=p>.</span><span class=n>vendor_source</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>pc</span><span class=p>.</span><span class=n>patched_cve_count</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>10</span><span class=w>  </span>
</span><span id=__span-30-28><a id=__codelineno-30-28 name=__codelineno-30-28 href=#__codelineno-30-28></a><span class=w>  </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w>  </span>
</span><span id=__span-30-29><a id=__codelineno-30-29 name=__codelineno-30-29 href=#__codelineno-30-29></a><span class=w>      </span><span class=n>pc</span><span class=p>.</span><span class=n>vendor_source</span><span class=p>,</span><span class=w> </span><span class=n>pc</span><span class=p>.</span><span class=n>patched_cve_count</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>
</span></code></pre></div></li> <li><strong>Superset Chart Type</strong>: Bar Chart (Horizontal) </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: patched_cve_count </li> <li><strong>Y-axis</strong>: cwe_name </li> <li><strong>Breakdown by</strong>: vendor_source (This will create separate bars for each vendor/source, allowing comparison) </li> <li><strong>Sort By</strong>: patched_cve_count (Descending) </li> <li><strong>Limit</strong>: 10 (per vendor/source, handled by QUALIFY in SQL)</li> </ul> <h2 id=time-to-patch-by-severity-multi-vendorsource><strong>Time to Patch by Severity (Multi-Vendor/Source)</strong><a class=headerlink href=#time-to-patch-by-severity-multi-vendorsource title="Permanent link">&para;</a></h2> <ul> <li><strong>Question Answered</strong>: How does time to patch vary by severity across different commercial vendors and open-source projects? </li> <li><strong>SQL Query</strong>: (This query joins with cve_main to get severity and date_published for Time to Patch calculation. It uses cvss_v3_severity.)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=w>  </span><span class=c1>-- Requires the unified_patches CTE defined above  </span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=w>  </span><span class=k>WITH</span><span class=w> </span><span class=n>unified_patches</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>  </span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=w>      </span><span class=c1>-- ... (Unified Patch Data CTE as defined in the introduction) ...  </span>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=w>  </span><span class=p>)</span><span class=w>  </span>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=w>  </span><span class=k>SELECT</span><span class=w>  </span>
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=w>      </span><span class=n>up</span><span class=p>.</span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=w>      </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>severity_level</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-31-8><a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a><span class=w>      </span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>DATEDIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=w>  </span>
</span><span id=__span-31-9><a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a><span class=w>  </span><span class=k>FROM</span><span class=w>  </span>
</span><span id=__span-31-10><a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a><span class=w>      </span><span class=n>unified_patches</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>up</span><span class=w>  </span>
</span><span id=__span-31-11><a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a><span class=w>  </span><span class=k>JOIN</span><span class=w>  </span>
</span><span id=__span-31-12><a id=__codelineno-31-12 name=__codelineno-31-12 href=#__codelineno-31-12></a><span class=w>      </span><span class=n>cve_main</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w>  </span>
</span><span id=__span-31-13><a id=__codelineno-31-13 name=__codelineno-31-13 href=#__codelineno-31-13></a><span class=w>  </span><span class=k>WHERE</span><span class=w>  </span>
</span><span id=__span-31-14><a id=__codelineno-31-14 name=__codelineno-31-14 href=#__codelineno-31-14></a><span class=w>      </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w>  </span>
</span><span id=__span-31-15><a id=__codelineno-31-15 name=__codelineno-31-15 href=#__codelineno-31-15></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;CRITICAL&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=p>)</span><span class=w> </span><span class=c1>-- Filter valid severities  </span>
</span><span id=__span-31-16><a id=__codelineno-31-16 name=__codelineno-31-16 href=#__codelineno-31-16></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>  </span>
</span><span id=__span-31-17><a id=__codelineno-31-17 name=__codelineno-31-17 href=#__codelineno-31-17></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>  </span>
</span><span id=__span-31-18><a id=__codelineno-31-18 name=__codelineno-31-18 href=#__codelineno-31-18></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span><span class=w> </span><span class=c1>-- Align with patch data start  </span>
</span><span id=__span-31-19><a id=__codelineno-31-19 name=__codelineno-31-19 href=#__codelineno-31-19></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span><span class=w>  </span>
</span><span id=__span-31-20><a id=__codelineno-31-20 name=__codelineno-31-20 href=#__codelineno-31-20></a><span class=w>  </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w>  </span>
</span><span id=__span-31-21><a id=__codelineno-31-21 name=__codelineno-31-21 href=#__codelineno-31-21></a><span class=w>      </span><span class=n>up</span><span class=p>.</span><span class=n>vendor_source</span><span class=p>,</span><span class=w> </span><span class=n>severity_level</span><span class=w>  </span>
</span><span id=__span-31-22><a id=__codelineno-31-22 name=__codelineno-31-22 href=#__codelineno-31-22></a><span class=w>  </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w>  </span>
</span><span id=__span-31-23><a id=__codelineno-31-23 name=__codelineno-31-23 href=#__codelineno-31-23></a><span class=w>      </span><span class=n>up</span><span class=p>.</span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-31-24><a id=__codelineno-31-24 name=__codelineno-31-24 href=#__codelineno-31-24></a><span class=w>      </span><span class=k>CASE</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cvss_v3_severity</span><span class=w>  </span>
</span><span id=__span-31-25><a id=__codelineno-31-25 name=__codelineno-31-25 href=#__codelineno-31-25></a><span class=w>          </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;CRITICAL&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w>  </span>
</span><span id=__span-31-26><a id=__codelineno-31-26 name=__codelineno-31-26 href=#__codelineno-31-26></a><span class=w>          </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;HIGH&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span><span class=w>  </span>
</span><span id=__span-31-27><a id=__codelineno-31-27 name=__codelineno-31-27 href=#__codelineno-31-27></a><span class=w>          </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;MEDIUM&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span><span class=w>  </span>
</span><span id=__span-31-28><a id=__codelineno-31-28 name=__codelineno-31-28 href=#__codelineno-31-28></a><span class=w>          </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;LOW&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span><span class=w>  </span>
</span><span id=__span-31-29><a id=__codelineno-31-29 name=__codelineno-31-29 href=#__codelineno-31-29></a><span class=w>          </span><span class=k>ELSE</span><span class=w> </span><span class=mi>5</span><span class=w>  </span>
</span><span id=__span-31-30><a id=__codelineno-31-30 name=__codelineno-31-30 href=#__codelineno-31-30></a><span class=w>      </span><span class=k>END</span><span class=p>;</span>
</span></code></pre></div></li> <li><strong>Superset Chart Type</strong>: Grouped Bar Chart </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: severity_level </li> <li><strong>Y-axis</strong>: median_days_to_patch </li> <li><strong>Group By</strong>: vendor_source </li> <li><strong>Sort By</strong>: Custom order for severity (Critical, High, Medium, Low)</li> </ul> <h2 id=exploit-patch-gap-multi-vendorsource><strong>Exploit-Patch Gap (Multi-Vendor/Source)</strong><a class=headerlink href=#exploit-patch-gap-multi-vendorsource title="Permanent link">&para;</a></h2> <ul> <li><strong>Question Answered</strong>: What is the typical time gap between exploit publication and patch availability for different vendors and open-source projects? </li> <li><strong>SQL Query</strong>: (This query considers CVEs that have both an exploit and a patch. It uses the earliest exploit date from exploits table.)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=w>  </span><span class=c1>-- Requires the unified_patches CTE defined above  </span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=w>  </span><span class=k>WITH</span><span class=w> </span><span class=n>unified_patches</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>  </span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=w>      </span><span class=c1>-- ... (Unified Patch Data CTE as defined in the introduction) ...  </span>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=w>  </span><span class=p>)</span><span class=w>  </span>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=w>  </span><span class=k>SELECT</span><span class=w>  </span>
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a><span class=w>      </span><span class=n>up</span><span class=p>.</span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a><span class=w>      </span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>DATEDIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_exploit_patch_gap</span><span class=w>  </span>
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a><span class=w>  </span><span class=k>FROM</span><span class=w>  </span>
</span><span id=__span-32-9><a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a><span class=w>      </span><span class=n>unified_patches</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>up</span><span class=w>  </span>
</span><span id=__span-32-10><a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a><span class=w>  </span><span class=k>JOIN</span><span class=w>  </span>
</span><span id=__span-32-11><a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a><span class=w>      </span><span class=n>exploits</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>cve_id</span><span class=w>  </span>
</span><span id=__span-32-12><a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a><span class=w>  </span><span class=k>WHERE</span><span class=w>  </span>
</span><span id=__span-32-13><a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a><span class=w>      </span><span class=n>e</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>  </span>
</span><span id=__span-32-14><a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>  </span>
</span><span id=__span-32-15><a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span><span class=w> </span><span class=c1>-- Align with patch data start  </span>
</span><span id=__span-32-16><a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span><span class=w>  </span>
</span><span id=__span-32-17><a id=__codelineno-32-17 name=__codelineno-32-17 href=#__codelineno-32-17></a><span class=w>  </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w>  </span>
</span><span id=__span-32-18><a id=__codelineno-32-18 name=__codelineno-32-18 href=#__codelineno-32-18></a><span class=w>      </span><span class=n>up</span><span class=p>.</span><span class=n>vendor_source</span><span class=w>  </span>
</span><span id=__span-32-19><a id=__codelineno-32-19 name=__codelineno-32-19 href=#__codelineno-32-19></a><span class=w>  </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w>  </span>
</span><span id=__span-32-20><a id=__codelineno-32-20 name=__codelineno-32-20 href=#__codelineno-32-20></a><span class=w>      </span><span class=n>median_exploit_patch_gap</span><span class=p>;</span>
</span></code></pre></div></li> <li><strong>Superset Chart Type</strong>: Bar Chart </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: vendor_source </li> <li><strong>Y-axis</strong>: median_exploit_patch_gap </li> <li><strong>Sort By</strong>: median_exploit_patch_gap (Ascending) </li> <li><strong>Chart Options</strong>: Consider adding a reference line at 0 to clearly show positive/negative gaps.</li> </ul> <h2 id=exploited-vs-non-exploited-patching-time-multi-vendorsource><strong>Exploited vs. Non-Exploited Patching Time (Multi-Vendor/Source)</strong><a class=headerlink href=#exploited-vs-non-exploited-patching-time-multi-vendorsource title="Permanent link">&para;</a></h2> <ul> <li><strong>Question Answered</strong>: How does the time to patch differ for exploited versus non-exploited vulnerabilities across different vendors and open-source projects? </li> <li><strong>SQL Query</strong>: (This query joins unified_patches with cve_main to get has_exploit status and date_published for Time to Patch calculation.)<br> <div class="language-sql highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=w>  </span><span class=c1>-- Requires the unified_patches CTE defined above  </span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=w>  </span><span class=k>WITH</span><span class=w> </span><span class=n>unified_patches</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>  </span>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=w>      </span><span class=c1>-- ... (Unified Patch Data CTE as defined in the introduction) ...  </span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=w>  </span><span class=p>)</span><span class=w>  </span>
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=w>  </span><span class=k>SELECT</span><span class=w>  </span>
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a><span class=w>      </span><span class=n>up</span><span class=p>.</span><span class=n>vendor_source</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a><span class=w>      </span><span class=k>CASE</span><span class=w>  </span>
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a><span class=w>          </span><span class=k>WHEN</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>has_exploit</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Exploited&#39;</span><span class=w>  </span>
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=w>          </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Non-Exploited&#39;</span><span class=w>  </span>
</span><span id=__span-33-10><a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a><span class=w>      </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>exploitation_status</span><span class=p>,</span><span class=w>  </span>
</span><span id=__span-33-11><a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=w>      </span><span class=n>MEDIAN</span><span class=p>(</span><span class=n>DATEDIFF</span><span class=p>(</span><span class=s1>&#39;day&#39;</span><span class=p>,</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>date_published</span><span class=p>,</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>median_days_to_patch</span><span class=w>  </span>
</span><span id=__span-33-12><a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a><span class=w>  </span><span class=k>FROM</span><span class=w>  </span>
</span><span id=__span-33-13><a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a><span class=w>      </span><span class=n>unified_patches</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>up</span><span class=w>  </span>
</span><span id=__span-33-14><a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a><span class=w>  </span><span class=k>JOIN</span><span class=w>  </span>
</span><span id=__span-33-15><a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a><span class=w>      </span><span class=n>cve_main</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cm</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>cve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cm</span><span class=p>.</span><span class=n>cve_id</span><span class=w>  </span>
</span><span id=__span-33-16><a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a><span class=w>  </span><span class=k>WHERE</span><span class=w>  </span>
</span><span id=__span-33-17><a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a><span class=w>      </span><span class=n>cm</span><span class=p>.</span><span class=n>date_published</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>  </span>
</span><span id=__span-33-18><a id=__codelineno-33-18 name=__codelineno-33-18 href=#__codelineno-33-18></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>  </span>
</span><span id=__span-33-19><a id=__codelineno-33-19 name=__codelineno-33-19 href=#__codelineno-33-19></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2016-01-01&#39;</span><span class=w> </span><span class=c1>-- Align with patch data start  </span>
</span><span id=__span-33-20><a id=__codelineno-33-20 name=__codelineno-33-20 href=#__codelineno-33-20></a><span class=w>      </span><span class=k>AND</span><span class=w> </span><span class=n>up</span><span class=p>.</span><span class=n>patch_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=s1>&#39;2025-05-13&#39;</span><span class=w>  </span>
</span><span id=__span-33-21><a id=__codelineno-33-21 name=__codelineno-33-21 href=#__codelineno-33-21></a><span class=w>  </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w>  </span>
</span><span id=__span-33-22><a id=__codelineno-33-22 name=__codelineno-33-22 href=#__codelineno-33-22></a><span class=w>      </span><span class=n>up</span><span class=p>.</span><span class=n>vendor_source</span><span class=p>,</span><span class=w> </span><span class=n>exploitation_status</span><span class=w>  </span>
</span><span id=__span-33-23><a id=__codelineno-33-23 name=__codelineno-33-23 href=#__codelineno-33-23></a><span class=w>  </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w>  </span>
</span><span id=__span-33-24><a id=__codelineno-33-24 name=__codelineno-33-24 href=#__codelineno-33-24></a><span class=w>      </span><span class=n>up</span><span class=p>.</span><span class=n>vendor_source</span><span class=p>,</span><span class=w> </span><span class=n>exploitation_status</span><span class=p>;</span>
</span></code></pre></div></li> <li><strong>Superset Chart Type</strong>: Grouped Bar Chart </li> <li><strong>Superset Configuration</strong>: </li> <li><strong>X-axis</strong>: vendor_source </li> <li><strong>Y-axis</strong>: median_days_to_patch </li> <li><strong>Group By</strong>: exploitation_status </li> <li><strong>Sort By</strong>: vendor_source</li> </ul> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../chapter-4-enhanced/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 4 - CVE Analysis"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Chapter 4 - CVE Analysis </div> </div> </a> <a href=../cpe-cve-old-vs-new/ class="md-footer__link md-footer__link--next" aria-label="Next: CVE-CPE Differences Analysis"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> CVE-CPE Differences Analysis </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.50899def.min.js></script> <script src=../../../javascripts/mathjax.js></script> <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?version=4.8.0"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../../javascripts/tablesort.js></script> <script src=../../../javascripts/print.js></script> </body> </html>