<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Analyzing CVE Lifecycle and Relationships with Exploits, Patches, CWEs, and CPEs"><meta name=author content="Eid ALBADDAH"><link href=https://doc.ifthreat.com/analysis/current/cwe-cve-old-vs-new/ rel=canonical><link href=../cpe-cve-old-vs-new/ rel=prev><link href=../exploit-discrepancies-comprehensive/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.16"><title>CVE-CWE Differences Analysis - CVE Lifecycle Analysis Research Hub</title><link rel=stylesheet href=../../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../stylesheets/extra.css><link rel=stylesheet href=https://cdn.tailwindcss.com><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#cwe-analysis-database-evolution-and-quality-improvements class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="CVE Lifecycle Analysis Research Hub" class="md-header__button md-logo" aria-label="CVE Lifecycle Analysis Research Hub" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 12h7c-.53 4.11-3.28 7.78-7 8.92zH5V6.3l7-3.11M12 1 3 5v6c0 5.55 3.84 10.73 9 12 5.16-1.27 9-6.45 9-12V5z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> CVE Lifecycle Analysis Research Hub </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> CVE-CWE Differences Analysis </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=deep-amber data-md-color-accent=amber aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=deep-amber data-md-color-accent=amber aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../data/ class=md-tabs__link> Data & Schema </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../ class=md-tabs__link> Analysis & Visualizations </a> </li> <li class=md-tabs__item> <a href=../../../research/ class=md-tabs__link> Research Ideas & Exploration </a> </li> <li class=md-tabs__item> <a href=../../../publications/ class=md-tabs__link> Conference Papers </a> </li> <li class=md-tabs__item> <a href=../../../methodology/ class=md-tabs__link> Methodology </a> </li> <li class=md-tabs__item> <a href=../../../future/ class=md-tabs__link> Future Work </a> </li> <li class=md-tabs__item> <a href=../../../resources/ class=md-tabs__link> Resources </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="CVE Lifecycle Analysis Research Hub" class="md-nav__button md-logo" aria-label="CVE Lifecycle Analysis Research Hub" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 12h7c-.53 4.11-3.28 7.78-7 8.92zH5V6.3l7-3.11M12 1 3 5v6c0 5.55 3.84 10.73 9 12 5.16-1.27 9-6.45 9-12V5z"/></svg> </a> CVE Lifecycle Analysis Research Hub </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../data/ class=md-nav__link> <span class=md-ellipsis> Data & Schema </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> Analysis & Visualizations </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Analysis & Visualizations </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <div class="md-nav__link md-nav__container"> <a href=../../transfer-report/ class="md-nav__link "> <span class=md-ellipsis> Transfer Report </span> </a> <label class="md-nav__link " for=__nav_3_2 id=__nav_3_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Transfer Report </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transfer-report/transfer-report-pdf/ class=md-nav__link> <span class=md-ellipsis> Transfer Report (PDF) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Current Research </span> </a> <label class="md-nav__link " for=__nav_3_3 id=__nav_3_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Current Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../chapter-4-enhanced/ class=md-nav__link> <span class=md-ellipsis> Chapter 4 - CVE Analysis </span> </a> </li> <li class=md-nav__item> <a href=../chapter-5-enhanced/ class=md-nav__link> <span class=md-ellipsis> Chapter 5 - Lifecycle Analysis </span> </a> </li> <li class=md-nav__item> <a href=../cpe-cve-old-vs-new/ class=md-nav__link> <span class=md-ellipsis> CVE-CPE Differences Analysis </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> CVE-CWE Differences Analysis </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> CVE-CWE Differences Analysis </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> <nav class=md-nav aria-label=Introduction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-are-cwes class=md-nav__link> <span class=md-ellipsis> What are CWEs? </span> </a> </li> <li class=md-nav__item> <a href=#research-objectives class=md-nav__link> <span class=md-ellipsis> Research Objectives </span> </a> </li> <li class=md-nav__item> <a href=#methodology-overview class=md-nav__link> <span class=md-ellipsis> Methodology Overview </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#key-findings class=md-nav__link> <span class=md-ellipsis> Key Findings </span> </a> <nav class=md-nav aria-label="Key Findings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-database-growth-and-coverage-improvements class=md-nav__link> <span class=md-ellipsis> 1. Database Growth and Coverage Improvements </span> </a> </li> <li class=md-nav__item> <a href=#2-enhanced-cwe-content-analysis class=md-nav__link> <span class=md-ellipsis> 2. Enhanced CWE Content Analysis </span> </a> </li> <li class=md-nav__item> <a href=#3-cwe-distribution-evolution class=md-nav__link> <span class=md-ellipsis> 3. CWE Distribution Evolution </span> </a> <nav class=md-nav aria-label="3. CWE Distribution Evolution"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#top-15-cwes-comparison class=md-nav__link> <span class=md-ellipsis> Top 15 CWEs Comparison </span> </a> </li> <li class=md-nav__item> <a href=#major-gainers-and-losers class=md-nav__link> <span class=md-ellipsis> Major Gainers and Losers </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-the-cwe-310-disappearance-a-quality-improvement-story class=md-nav__link> <span class=md-ellipsis> 4. The CWE-310 Disappearance: A Quality Improvement Story </span> </a> <nav class=md-nav aria-label="4. The CWE-310 Disappearance: A Quality Improvement Story"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-evolution-of-cwe-classification class=md-nav__link> <span class=md-ellipsis> The Evolution of CWE Classification </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cwe-deprecation-analysis class=md-nav__link> <span class=md-ellipsis> CWE Deprecation Analysis </span> </a> </li> <li class=md-nav__item> <a href=#5-detailed-cwe-content-changes-examples class=md-nav__link> <span class=md-ellipsis> 5. Detailed CWE Content Changes Examples </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#severity-and-platform-analysis class=md-nav__link> <span class=md-ellipsis> Severity and Platform Analysis </span> </a> <nav class=md-nav aria-label="Severity and Platform Analysis"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#statistical-analysis-by-cvss-severity class=md-nav__link> <span class=md-ellipsis> Statistical Analysis by CVSS Severity </span> </a> </li> <li class=md-nav__item> <a href=#cwe-cpe-co-occurrence-analysis class=md-nav__link> <span class=md-ellipsis> CWE-CPE Co-occurrence Analysis </span> </a> </li> <li class=md-nav__item> <a href=#top-cwe-vendor-platform-combinations class=md-nav__link> <span class=md-ellipsis> Top CWE-Vendor-Platform Combinations </span> </a> </li> <li class=md-nav__item> <a href=#cwe-cpe-type-distribution class=md-nav__link> <span class=md-ellipsis> CWE-CPE Type Distribution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#temporal-evolution class=md-nav__link> <span class=md-ellipsis> Temporal Evolution </span> </a> </li> <li class=md-nav__item> <a href=#methodology-deep-dive class=md-nav__link> <span class=md-ellipsis> Methodology Deep Dive </span> </a> <nav class=md-nav aria-label="Methodology Deep Dive"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-content-based-comparison-approach class=md-nav__link> <span class=md-ellipsis> 1. Content-Based Comparison Approach </span> </a> </li> <li class=md-nav__item> <a href=#2-multi-version-cvss-support class=md-nav__link> <span class=md-ellipsis> 2. Multi-Version CVSS Support </span> </a> </li> <li class=md-nav__item> <a href=#3-enhanced-cpe-type-extraction class=md-nav__link> <span class=md-ellipsis> 3. Enhanced CPE Type Extraction </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#visualizations class=md-nav__link> <span class=md-ellipsis> Visualizations </span> </a> <nav class=md-nav aria-label=Visualizations> <ul class=md-nav__list> <li class=md-nav__item> <a href=#enhanced-cwe-cpe-relationship-analysis class=md-nav__link> <span class=md-ellipsis> Enhanced CWE-CPE Relationship Analysis </span> </a> </li> <li class=md-nav__item> <a href=#statistical-measures-comparison class=md-nav__link> <span class=md-ellipsis> Statistical Measures Comparison </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#key-interpretations-and-implications class=md-nav__link> <span class=md-ellipsis> Key Interpretations and Implications </span> </a> <nav class=md-nav aria-label="Key Interpretations and Implications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-data-quality-maturation class=md-nav__link> <span class=md-ellipsis> 1. Data Quality Maturation </span> </a> </li> <li class=md-nav__item> <a href=#2-security-landscape-evolution class=md-nav__link> <span class=md-ellipsis> 2. Security Landscape Evolution </span> </a> </li> <li class=md-nav__item> <a href=#3-platform-specific-security-patterns class=md-nav__link> <span class=md-ellipsis> 3. Platform-Specific Security Patterns </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#enhanced-summary-statistics class=md-nav__link> <span class=md-ellipsis> Enhanced Summary Statistics </span> </a> </li> <li class=md-nav__item> <a href=#conclusions class=md-nav__link> <span class=md-ellipsis> Conclusions </span> </a> </li> <li class=md-nav__item> <a href=#technical-notes class=md-nav__link> <span class=md-ellipsis> Technical Notes </span> </a> </li> <li class=md-nav__item> <a href=#detailed-analysis-with-code class=md-nav__link> <span class=md-ellipsis> Detailed analysis with code </span> </a> </li> <li class=md-nav__item> <a href=#cwe-difference-between-old-updated-21-april-2024-vs-new-db-updated-13-may-2025 class=md-nav__link> <span class=md-ellipsis> CWE Difference between Old (Updated 21 April 2024) vs New DB (Updated 13 May 2025) </span> </a> <nav class=md-nav aria-label="CWE Difference between Old (Updated 21 April 2024) vs New DB (Updated 13 May 2025)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-environment-setup-and-data-loading class=md-nav__link> <span class=md-ellipsis> 1. Environment Setup and Data Loading </span> </a> </li> <li class=md-nav__item> <a href=#2-load-parquet-data-for-analysis class=md-nav__link> <span class=md-ellipsis> 2. Load Parquet Data for Analysis </span> </a> </li> <li class=md-nav__item> <a href=#execute-analysis class=md-nav__link> <span class=md-ellipsis> Execute analysis </span> </a> <nav class=md-nav aria-label="Execute analysis"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cwe-analysis-with-yearly-coverage-trends-and-detailed-change-analysis class=md-nav__link> <span class=md-ellipsis> CWE analysis with yearly coverage trends and detailed change analysis </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../exploit-discrepancies-comprehensive/ class=md-nav__link> <span class=md-ellipsis> Exploit Discrepancies Analysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../superset-playground/ class=md-nav__link> <span class=md-ellipsis> Superset Analytics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../research/ class=md-nav__link> <span class=md-ellipsis> Research Ideas & Exploration </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../publications/ class=md-nav__link> <span class=md-ellipsis> Conference Papers </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../methodology/ class=md-nav__link> <span class=md-ellipsis> Methodology </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../future/ class=md-nav__link> <span class=md-ellipsis> Future Work </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../resources/ class=md-nav__link> <span class=md-ellipsis> Resources </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=cwe-analysis-database-evolution-and-quality-improvements>CWE Analysis: Database Evolution and Quality Improvements<a class=headerlink href=#cwe-analysis-database-evolution-and-quality-improvements title="Permanent link">&para;</a></h1> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>This analysis examines the evolution of Common Weakness Enumeration (CWE) assignments in CVE databases, comparing an older dataset (up to April 2024) with a newer dataset (up to May 2025). The study reveals significant improvements in data quality, coverage, and standardization practices in vulnerability classification.</p> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <h3 id=what-are-cwes>What are CWEs?<a class=headerlink href=#what-are-cwes title="Permanent link">&para;</a></h3> <p>Common Weakness Enumeration (CWE) is a community-developed list of software and hardware weakness types that serve as a common language for describing security weaknesses in architecture, design, and code. Each CWE provides:</p> <ul> <li><strong>Standardized naming</strong> for security weaknesses</li> <li><strong>Detailed descriptions</strong> of the weakness</li> <li><strong>Common consequences</strong> and potential impacts</li> <li><strong>Mitigation strategies</strong> and best practices</li> </ul> <h3 id=research-objectives>Research Objectives<a class=headerlink href=#research-objectives title="Permanent link">&para;</a></h3> <p>This comprehensive analysis aims to:</p> <ol> <li><strong>Quantify improvements</strong> in CWE coverage between database versions</li> <li><strong>Identify patterns</strong> in CWE assignment evolution</li> <li><strong>Analyze content changes</strong> beyond simple count differences</li> <li><strong>Understand relationships</strong> between CWEs, severity scores, and affected platforms</li> <li><strong>Document quality improvements</strong> in vulnerability classification</li> </ol> <h3 id=methodology-overview>Methodology Overview<a class=headerlink href=#methodology-overview title="Permanent link">&para;</a></h3> <p>Our analysis employs multiple analytical approaches:</p> <pre class=mermaid><code>graph TD
    A[CVE Databases] --&gt; B[CWE Distribution Analysis]
    A --&gt; C[Content Change Analysis]
    A --&gt; D[Coverage Evolution]
    A --&gt; E[Severity Relationships]

    B --&gt; F[Statistical Comparison]
    C --&gt; G[Actual CWE Content Diff]
    D --&gt; H[Temporal Trends]
    E --&gt; I[CVSS Integration]

    F --&gt; J[Key Insights]
    G --&gt; J
    H --&gt; J
    I --&gt; J</code></pre> <div class="admonition note"> <p class=admonition-title>Methodology Note</p> <p>Unlike simple count-based comparisons, our analysis examines the actual CWE content changes, providing deeper insights into data quality improvements.</p> </div> <h2 id=key-findings>Key Findings<a class=headerlink href=#key-findings title="Permanent link">&para;</a></h2> <h3 id=1-database-growth-and-coverage-improvements>1. Database Growth and Coverage Improvements<a class=headerlink href=#1-database-growth-and-coverage-improvements title="Permanent link">&para;</a></h3> <p>The comparison reveals substantial improvements across multiple dimensions:</p> <table> <thead> <tr> <th>Metric</th> <th>Old Database</th> <th>New Database</th> <th>Change</th> <th>Impact</th> </tr> </thead> <tbody> <tr> <td><strong>Total CVEs</strong></td> <td>232,395</td> <td>278,734</td> <td><strong>+46,339</strong> (+19.9%)</td> <td>Significant database expansion</td> </tr> <tr> <td><strong>CWE Coverage</strong></td> <td>75.4%</td> <td>80.0%</td> <td><strong>+4.6</strong> percentage points</td> <td>Better weakness classification</td> </tr> <tr> <td><strong>CVSS v3 Coverage</strong></td> <td>22.3%</td> <td>72.8%</td> <td><strong>+50.5</strong> percentage points</td> <td>Modern scoring adoption</td> </tr> <tr> <td><strong>CVSS v2 Coverage</strong></td> <td>78.7%</td> <td>67.0%</td> <td><strong>-11.8</strong> percentage points</td> <td>Legacy system migration</td> </tr> <tr> <td><strong>Any CVSS Coverage</strong></td> <td>79.6%</td> <td>98.8%</td> <td><strong>+19.2</strong> percentage points</td> <td>Near-universal scoring</td> </tr> </tbody> </table> <div class="admonition success"> <p class=admonition-title>Key Insight</p> <p>The dramatic increase in CVSS v3 coverage (from 22.3% to 72.8%) indicates a successful migration from CVSS v2 to the more modern v3 scoring system, while maintaining near-universal CVSS coverage overall.</p> </div> <h3 id=2-enhanced-cwe-content-analysis>2. Enhanced CWE Content Analysis<a class=headerlink href=#2-enhanced-cwe-content-analysis title="Permanent link">&para;</a></h3> <p>Our analysis goes beyond simple count comparisons to examine actual CWE content changes:</p> <table> <thead> <tr> <th>Change Type</th> <th>CVE Count</th> <th>Percentage</th> <th>Interpretation</th> </tr> </thead> <tbody> <tr> <td><strong>Both Empty</strong></td> <td>179,732</td> <td>77.3%</td> <td>CVEs without CWE assignments in either database</td> </tr> <tr> <td><strong>Identical</strong></td> <td>49,599</td> <td>21.3%</td> <td>CVEs with unchanged CWE assignments</td> </tr> <tr> <td><strong>Removed CWEs</strong></td> <td>2,482</td> <td>1.1%</td> <td>CVEs where CWE assignments were removed</td> </tr> <tr> <td><strong>Added CWEs</strong></td> <td>451</td> <td>0.2%</td> <td>CVEs where new CWE assignments were added</td> </tr> <tr> <td><strong>Content Changed</strong></td> <td>152</td> <td>0.1%</td> <td>CVEs with modified CWE assignments</td> </tr> </tbody> </table> <div class="admonition info"> <p class=admonition-title>Analysis Insight</p> <p>The low percentage of content changes (1.4% total) suggests that the CWE assignment process has been relatively stable, with changes likely representing quality improvements rather than arbitrary modifications.</p> </div> <h3 id=3-cwe-distribution-evolution>3. CWE Distribution Evolution<a class=headerlink href=#3-cwe-distribution-evolution title="Permanent link">&para;</a></h3> <h4 id=top-15-cwes-comparison>Top 15 CWEs Comparison<a class=headerlink href=#top-15-cwes-comparison title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>CWE ID</th> <th>CWE Name</th> <th>Old CVEs</th> <th>New CVEs</th> <th>Difference</th> <th>% Change</th> </tr> </thead> <tbody> <tr> <td><strong>CWE-79</strong></td> <td>Improper Neutralization of Input (XSS)</td> <td>26,727</td> <td>35,275</td> <td>+8,548</td> <td>+32.0%</td> </tr> <tr> <td><strong>CWE-89</strong></td> <td>SQL Injection</td> <td>11,356</td> <td>14,642</td> <td>+3,286</td> <td>+28.9%</td> </tr> <tr> <td><strong>CWE-119</strong></td> <td>Improper Restriction of Operations</td> <td>11,899</td> <td>12,037</td> <td>+138</td> <td>+1.2%</td> </tr> <tr> <td><strong>CWE-20</strong></td> <td>Improper Input Validation</td> <td>10,441</td> <td>10,840</td> <td>+399</td> <td>+3.8%</td> </tr> <tr> <td><strong>CWE-787</strong></td> <td>Out-of-bounds Write</td> <td>10,183</td> <td>9,849</td> <td>-334</td> <td>-3.3%</td> </tr> <tr> <td><strong>CWE-200</strong></td> <td>Exposure of Sensitive Information</td> <td>7,852</td> <td>8,669</td> <td>+817</td> <td>+10.4%</td> </tr> <tr> <td><strong>CWE-352</strong></td> <td>Cross-Site Request Forgery (CSRF)</td> <td>5,630</td> <td>7,524</td> <td>+1,894</td> <td>+33.6%</td> </tr> <tr> <td><strong>CWE-125</strong></td> <td>Out-of-bounds Read</td> <td>5,864</td> <td>6,879</td> <td>+1,015</td> <td>+17.3%</td> </tr> <tr> <td><strong>CWE-22</strong></td> <td>Improper Limitation of Pathname</td> <td>5,902</td> <td>6,723</td> <td>+821</td> <td>+13.9%</td> </tr> <tr> <td><strong>CWE-416</strong></td> <td>Use After Free</td> <td>4,141</td> <td>5,625</td> <td>+1,484</td> <td>+35.8%</td> </tr> <tr> <td><strong>CWE-264</strong></td> <td>Permissions/Privileges/Access Controls</td> <td>5,459</td> <td>5,444</td> <td>-15</td> <td>-0.3%</td> </tr> <tr> <td><strong>CWE-862</strong></td> <td>Missing Authorization</td> <td>2,306</td> <td>4,513</td> <td>+2,207</td> <td>+95.7%</td> </tr> <tr> <td><strong>CWE-94</strong></td> <td>Code Injection</td> <td>3,268</td> <td>4,455</td> <td>+1,187</td> <td>+36.3%</td> </tr> <tr> <td><strong>CWE-78</strong></td> <td>OS Command Injection</td> <td>3,460</td> <td>4,045</td> <td>+585</td> <td>+16.9%</td> </tr> <tr> <td><strong>CWE-476</strong></td> <td>NULL Pointer Dereference</td> <td>2,413</td> <td>3,724</td> <td>+1,311</td> <td>+54.3%</td> </tr> </tbody> </table> <h4 id=major-gainers-and-losers>Major Gainers and Losers<a class=headerlink href=#major-gainers-and-losers title="Permanent link">&para;</a></h4> <div class="admonition tip"> <p class=admonition-title>Top 5 CWE Gainers</p> <ul> <li><strong>CWE-79</strong> (XSS): +8,548 CVEs (+32.0%)</li> <li><strong>CWE-89</strong> (SQL Injection): +3,286 CVEs (+28.9%)</li> <li><strong>CWE-862</strong> (Missing Authorization): +2,207 CVEs (+95.7%)</li> <li><strong>CWE-352</strong> (CSRF): +1,894 CVEs (+33.6%)</li> <li><strong>CWE-416</strong> (Use After Free): +1,484 CVEs (+35.8%)</li> </ul> </div> <div class="admonition success"> <p class=admonition-title>Top CWE Growth Areas</p> <p><strong>Authorization Issues Surge</strong>: </p> <p>CWE-862 (Missing Authorization) shows remarkable 95.7% growth (+2,207 CVEs), indicating increased focus on access control vulnerabilities</p> <p><strong>Memory Safety Persistence</strong>: </p> <p>CWE-416 (Use After Free) growth of 35.8% (+1,484 CVEs) demonstrates ongoing memory management challenges</p> <p><strong>Web Security Expansion</strong>: </p> <p>CWE-352 (CSRF) growth of 33.6% (+1,894 CVEs) reflects the evolving web application threat landscape</p> </div> <div class="admonition warning"> <p class=admonition-title>Notable CWE Disappearances</p> <ul> <li><strong>CWE-787</strong> (Out-of-bounds Write): -334 CVEs (-3.3%)</li> <li><strong>CWE-190</strong> (Integer Overflow): -2,326 CVEs (-100.0%)</li> <li><strong>CWE-310</strong> (Cryptographic Issues): -2,482 CVEs (-100.0%)</li> </ul> </div> <h3 id=4-the-cwe-310-disappearance-a-quality-improvement-story>4. The CWE-310 Disappearance: A Quality Improvement Story<a class=headerlink href=#4-the-cwe-310-disappearance-a-quality-improvement-story title="Permanent link">&para;</a></h3> <div class="admonition danger"> <p class=admonition-title>Critical Change: CWE-310 Complete Removal</p> <p>CWE-310 showed a complete disappearance (-2,482 CVEs, -100.0%), representing a fundamental shift in vulnerability classification practices.</p> </div> <div class="admonition question"> <p class=admonition-title>Why Did CWE-310 Disappear?</p> <p><strong>CWE-310 ("Cryptographic Issues")</strong> was classified as a <strong>"Category"</strong> rather than a specific weakness. According to MITRE's official documentation:</p> <ul> <li><strong>Status</strong>: Category (high-level grouping)</li> <li><strong>Vulnerability Mapping</strong>: <strong>PROHIBITED</strong> since 2019</li> <li><strong>Reason</strong>: Too generic for actionable vulnerability information</li> </ul> </div> <h4 id=the-evolution-of-cwe-classification>The Evolution of CWE Classification<a class=headerlink href=#the-evolution-of-cwe-classification title="Permanent link">&para;</a></h4> <div class="admonition abstract"> <p class=admonition-title>CWE Classification Hierarchy</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:3><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><input id=__tabbed_1_3 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Categories (Prohibited for CVE Mapping)</label><label for=__tabbed_1_2>Base Weaknesses (Preferred)</label><label for=__tabbed_1_3>Variant Weaknesses (Acceptable)</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>High-level organizational groupings that share common attributes</p> <ul> <li><strong>Example</strong>: CWE-310 "Cryptographic Issues"</li> <li><strong>Problem</strong>: Too broad, not actionable</li> <li><strong>Status</strong>: ❌ <strong>Mapping Prohibited</strong></li> </ul> </div> <div class=tabbed-block> <p>Specific issues mostly independent of technology</p> <ul> <li><strong>CWE-327</strong>: Use of Broken/Risky Cryptographic Algorithm</li> <li><strong>CWE-326</strong>: Inadequate Encryption Strength</li> <li><strong>Status</strong>: ✅ <strong>Recommended for Mapping</strong></li> </ul> </div> <div class=tabbed-block> <p>Technology-specific manifestations of base weaknesses</p> <ul> <li><strong>CWE-780</strong>: Use of RSA Algorithm without OAEP</li> <li><strong>CWE-311</strong>: Missing Encryption of Sensitive Data</li> <li><strong>Status</strong>: ✅ <strong>Acceptable for Mapping</strong></li> </ul> </div> </div> </div> </div> <div class="admonition example"> <p class=admonition-title>CWE-310 Replacement Strategy</p> <p>Instead of using the broad category "Cryptographic Issues," the new approach favors specific weaknesses:</p> <table> <thead> <tr> <th>Old Approach</th> <th>New Approach</th> </tr> </thead> <tbody> <tr> <td>❌ CWE-310: Cryptographic Issues</td> <td>✅ CWE-327: Use of Broken Cryptographic Algorithm</td> </tr> <tr> <td>❌ Generic, non-actionable</td> <td>✅ CWE-326: Inadequate Encryption Strength</td> </tr> <tr> <td>❌ Category-level mapping</td> <td>✅ CWE-311: Missing Encryption of Sensitive Data</td> </tr> <tr> <td>❌ Deprecated since 2019</td> <td>✅ CWE-320: Key Management Errors</td> </tr> </tbody> </table> </div> <div class="admonition quote"> <p class=admonition-title>Official Documentation References</p> <p>This change is supported by official MITRE and industry documentation:</p> <ol> <li><a href=https://cwe.mitre.org/documents/cwe_usage/guidance.html><strong>MITRE CWE Usage Guidance</strong></a>: Emphasizes accurate root cause mapping</li> <li><a href=https://www.ipa.go.jp/en/security/vulnerabilities/cwe.html><strong>IPA Security Vulnerabilities Guide</strong></a>: Explains CWE classification best practices</li> <li><a href=https://cwe.mitre.org/data/definitions/310.html><strong>CWE-310 Official Page</strong></a>: States "Vulnerability Mapping: PROHIBITED"</li> <li><a href=https://cwe.mitre.org/top25/archive/2022/2022_cwe_top25_supplemental.html#problematicMappingDetails><strong>CWE Top 25 Supplemental Data</strong></a>: Details problematic mapping practices</li> </ol> </div> <h3 id=cwe-deprecation-analysis>CWE Deprecation Analysis<a class=headerlink href=#cwe-deprecation-analysis title="Permanent link">&para;</a></h3> <div class="admonition warning"> <p class=admonition-title>Significant CWE Removals</p> <p>Several CWEs show complete disappearance, indicating systematic data quality improvements:</p> </div> <table> <thead> <tr> <th>CWE ID</th> <th>Change</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <td><strong>CWE-190</strong></td> <td>-2,326 CVEs (-100.0%)</td> <td>Integer Overflow categorization changes</td> </tr> <tr> <td><strong>CWE-310</strong></td> <td>-2,482 CVEs (-100.0%)</td> <td>Category deprecation (as previously analyzed)</td> </tr> <tr> <td><strong>CWE-399</strong></td> <td>-6 CVEs (-0.2%)</td> <td>Resource management recategorization</td> </tr> <tr> <td><strong>CWE-264</strong></td> <td>-15 CVEs (-0.3%)</td> <td>Access control consolidation</td> </tr> </tbody> </table> <div class="admonition info"> <p class=admonition-title>Deprecation Impact</p> <p>These removals represent the evolution toward more specific, actionable CWE assignments rather than broad categorical classifications.</p> </div> <h3 id=5-detailed-cwe-content-changes-examples>5. Detailed CWE Content Changes Examples<a class=headerlink href=#5-detailed-cwe-content-changes-examples title="Permanent link">&para;</a></h3> <p>The following table shows specific examples of how CWE assignments evolved:</p> <table> <thead> <tr> <th>CVE ID</th> <th>Change Type</th> <th>Old CWEs</th> <th>New CWEs</th> <th>Analysis</th> </tr> </thead> <tbody> <tr> <td>CVE-1999-0006</td> <td>Modified</td> <td>NVD-CWE-Other</td> <td>CWE-125, NVD-CWE-Other</td> <td>Added specific out-of-bounds read classification</td> </tr> <tr> <td>CVE-1999-0011</td> <td>Modified</td> <td>NVD-CWE-Other</td> <td>CWE-1067, NVD-CWE-Other</td> <td>Added insufficient compartmentalization</td> </tr> <tr> <td>CVE-1999-0012</td> <td>Modified</td> <td>NVD-CWE-Other</td> <td>CWE-290, NVD-CWE-Other</td> <td>Added authentication bypass classification</td> </tr> <tr> <td>CVE-1999-0013</td> <td>Modified</td> <td>NVD-CWE-Other</td> <td>CWE-522, NVD-CWE-Other</td> <td>Added insufficiently protected credentials</td> </tr> <tr> <td>CVE-1999-0236</td> <td>Modified</td> <td>CWE-200</td> <td>NVD-CWE-noinfo</td> <td>Information disclosure reclassified</td> </tr> </tbody> </table> <div class="admonition note"> <p class=admonition-title>Content Change Patterns</p> <p>Most content changes involve moving from generic "NVD-CWE-Other" classifications to specific, actionable CWE assignments, demonstrating ongoing quality improvement efforts.</p> </div> <h2 id=severity-and-platform-analysis>Severity and Platform Analysis<a class=headerlink href=#severity-and-platform-analysis title="Permanent link">&para;</a></h2> <h3 id=statistical-analysis-by-cvss-severity>Statistical Analysis by CVSS Severity<a class=headerlink href=#statistical-analysis-by-cvss-severity title="Permanent link">&para;</a></h3> <p>The comprehensive statistical analysis across severity categories reveals consistent patterns:</p> <table> <thead> <tr> <th>Severity Category</th> <th>CVE Count</th> <th>CWE Statistics</th> <th>CPE Statistics</th> <th>CVSS Average</th> <th>Key Insights</th> </tr> </thead> <tbody> <tr> <td><strong>Critical (9.0-10.0)</strong></td> <td>23,735</td> <td>Avg: 1.1, Median: 1.0, Mode: 1</td> <td>Avg: 7.9, Median: 1.0, Mode: 1</td> <td>9.7</td> <td>Single CWE assignments dominate</td> </tr> <tr> <td><strong>High (7.0-8.9)</strong></td> <td>70,379</td> <td>Avg: 1.1, Median: 1.0, Mode: 1</td> <td>Avg: 9.9, Median: 1.0, Mode: 1</td> <td>7.9</td> <td>Highest platform impact</td> </tr> <tr> <td><strong>Medium (4.0-6.9)</strong></td> <td>79,707</td> <td>Avg: 1.1, Median: 1.0, Mode: 1</td> <td>Avg: 7.1, Median: 1.0, Mode: 1</td> <td>5.7</td> <td>Most numerous category</td> </tr> <tr> <td><strong>Low (0.1-3.9)</strong></td> <td>6,417</td> <td>Avg: 1.1, Median: 1.0, Mode: 1</td> <td>Avg: 4.5, Median: 1.0, Mode: 1</td> <td>3.2</td> <td>Lowest platform impact</td> </tr> <tr> <td><strong>No Score</strong></td> <td>42,708</td> <td>Avg: 1.0, Median: 1.0, Mode: 1</td> <td>Avg: 15.2, Median: 2.0, Mode: 1</td> <td>N/A</td> <td>Legacy or specialized CVEs</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Statistical Insights</p> <p><strong>Consistency Across Severity</strong>: The median and mode values of 1.0 for CWEs across all severity levels indicate that single CWE assignments are the standard practice, regardless of vulnerability severity.</p> <p><strong>Unscored Vulnerabilities</strong>: CVEs without CVSS scores show higher average CPE counts (15.2), suggesting they may represent complex, multi-platform issues that are harder to score.</p> </div> <h3 id=cwe-cpe-co-occurrence-analysis>CWE-CPE Co-occurrence Analysis<a class=headerlink href=#cwe-cpe-co-occurrence-analysis title="Permanent link">&para;</a></h3> <p>The analysis reveals the relationship between CWE complexity and CPE coverage patterns:</p> <table> <thead> <tr> <th>CWE Category</th> <th>CPE Category</th> <th>CPE Type</th> <th>CVE Count</th> <th>Avg CWEs</th> <th>Avg CPEs</th> <th>Hardware</th> <th>OS</th> <th>Application</th> </tr> </thead> <tbody> <tr> <td><strong>1 CWE</strong></td> <td>1 CPE</td> <td>Application</td> <td>88,554</td> <td>1.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>1.2</td> </tr> <tr> <td><strong>1 CWE</strong></td> <td>2-5 CPEs</td> <td>Mixed/Unknown</td> <td>22,722</td> <td>1.0</td> <td>2.8</td> <td>0.7</td> <td>1.9</td> <td>0.9</td> </tr> <tr> <td><strong>1 CWE</strong></td> <td>2-5 CPEs</td> <td>Application</td> <td>20,710</td> <td>1.0</td> <td>2.8</td> <td>0.0</td> <td>0.0</td> <td>3.4</td> </tr> <tr> <td><strong>1 CWE</strong></td> <td>11-50 CPEs</td> <td>Mixed/Unknown</td> <td>8,896</td> <td>1.0</td> <td>22.4</td> <td>10.0</td> <td>11.9</td> <td>6.0</td> </tr> <tr> <td><strong>1 CWE</strong></td> <td>1 CPE</td> <td>Operating System</td> <td>8,536</td> <td>1.0</td> <td>1.0</td> <td>0.0</td> <td>1.2</td> <td>0.0</td> </tr> <tr> <td><strong>1 CWE</strong></td> <td>11-50 CPEs</td> <td>Application</td> <td>8,019</td> <td>1.0</td> <td>23.2</td> <td>0.0</td> <td>0.0</td> <td>29.0</td> </tr> <tr> <td><strong>1 CWE</strong></td> <td>6-10 CPEs</td> <td>Mixed/Unknown</td> <td>7,756</td> <td>1.0</td> <td>7.4</td> <td>1.6</td> <td>4.7</td> <td>2.9</td> </tr> <tr> <td><strong>2 CWEs</strong></td> <td>1 CPE</td> <td>Application</td> <td>3,645</td> <td>2.0</td> <td>1.0</td> <td>0.0</td> <td>0.0</td> <td>1.2</td> </tr> <tr> <td><strong>1 CWE</strong></td> <td>11-50 CPEs</td> <td>Operating System</td> <td>3,470</td> <td>1.0</td> <td>19.7</td> <td>0.0</td> <td>24.6</td> <td>0.0</td> </tr> </tbody> </table> <div class="admonition success"> <p class=admonition-title>Co-occurrence Pattern Insights</p> <p><strong>Single CWE Dominance</strong>: 88,554 CVEs have exactly one CWE assignment with one CPE, representing the most common vulnerability pattern</p> <p><strong>Application Focus</strong>: Applications dominate single CWE assignments, indicating straightforward vulnerability-to-software mappings</p> <p><strong>Complexity Correlation</strong>: Higher CPE counts often correlate with mixed/unknown platform types, suggesting cross-platform vulnerabilities</p> </div> <h3 id=top-cwe-vendor-platform-combinations>Top CWE-Vendor-Platform Combinations<a class=headerlink href=#top-cwe-vendor-platform-combinations title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>CWE ID</th> <th>CWE Name</th> <th>Vendor</th> <th>CPE Type</th> <th>CVE Count</th> <th>CPE Instances</th> </tr> </thead> <tbody> <tr> <td><strong>CWE-119</strong></td> <td>Memory Corruption</td> <td>Apple</td> <td>Operating System</td> <td>1,943</td> <td>9,037</td> </tr> <tr> <td><strong>CWE-119</strong></td> <td>Memory Corruption</td> <td>Microsoft</td> <td>Operating System</td> <td>1,562</td> <td>5,095</td> </tr> <tr> <td><strong>CWE-79</strong></td> <td>Cross-site Scripting</td> <td>IBM</td> <td>Application</td> <td>1,429</td> <td>14,591</td> </tr> <tr> <td><strong>CWE-787</strong></td> <td>Out-of-bounds Write</td> <td>Google</td> <td>Operating System</td> <td>1,360</td> <td>3,129</td> </tr> <tr> <td><strong>CWE-476</strong></td> <td>NULL Pointer Dereference</td> <td>Linux</td> <td>Operating System</td> <td>1,268</td> <td>3,480</td> </tr> <tr> <td><strong>CWE-787</strong></td> <td>Out-of-bounds Write</td> <td>Microsoft</td> <td>Operating System</td> <td>1,245</td> <td>5,346</td> </tr> <tr> <td><strong>CWE-416</strong></td> <td>Use After Free</td> <td>Linux</td> <td>Operating System</td> <td>1,173</td> <td>2,799</td> </tr> <tr> <td><strong>CWE-125</strong></td> <td>Out-of-bounds Read</td> <td>Microsoft</td> <td>Operating System</td> <td>1,160</td> <td>3,621</td> </tr> </tbody> </table> <div class="admonition warning"> <p class=admonition-title>Security Focus Areas</p> <p>The dominance of memory safety issues (CWE-119, CWE-787, CWE-416) in operating systems highlights the critical importance of memory-safe programming practices in system-level software.</p> </div> <h3 id=cwe-cpe-type-distribution>CWE-CPE Type Distribution<a class=headerlink href=#cwe-cpe-type-distribution title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>CWE ID</th> <th>CWE Name</th> <th>CPE Type</th> <th>CVE Count</th> <th>Avg Hardware</th> <th>Avg OS</th> <th>Avg Application</th> </tr> </thead> <tbody> <tr> <td><strong>CWE-79</strong></td> <td>XSS</td> <td>Application</td> <td>28,728</td> <td>1.0</td> <td>1.0</td> <td>1.9</td> </tr> <tr> <td><strong>CWE-89</strong></td> <td>SQL Injection</td> <td>Application</td> <td>13,246</td> <td>0.4</td> <td>0.4</td> <td>1.4</td> </tr> <tr> <td><strong>CWE-119</strong></td> <td>Memory Corruption</td> <td>Application</td> <td>9,145</td> <td>2.9</td> <td>3.2</td> <td>3.9</td> </tr> <tr> <td><strong>CWE-20</strong></td> <td>Input Validation</td> <td>Application</td> <td>7,149</td> <td>2.5</td> <td>2.6</td> <td>3.4</td> </tr> <tr> <td><strong>CWE-787</strong></td> <td>Out-of-bounds Write</td> <td>Operating System</td> <td>3,939</td> <td>3.5</td> <td>3.9</td> <td>2.9</td> </tr> <tr> <td><strong>CWE-20</strong></td> <td>Input Validation</td> <td>Operating System</td> <td>3,134</td> <td>17.4</td> <td>17.9</td> <td>16.9</td> </tr> </tbody> </table> <h2 id=temporal-evolution>Temporal Evolution<a class=headerlink href=#temporal-evolution title="Permanent link">&para;</a></h2> <p><img alt="CWE Temporal Evolution" src=../difference_between_cwe_old_vs_new_db_files/difference_between_cwe_old_vs_new_db_8_1.png></p> <div class="admonition abstract"> <p class=admonition-title>Temporal Trends</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>CVE Volume Growth</label><label for=__tabbed_2_2>Coverage Stability</label></div> <div class=tabbed-content> <div class=tabbed-block> <ul> <li><strong>Consistent Growth</strong>: Steady increase in CVE volumes year-over-year</li> <li><strong>Database Expansion</strong>: New database contains significantly more recent CVEs</li> </ul> </div> <div class=tabbed-block> <ul> <li><strong>Maintained Quality</strong>: CWE coverage has remained stable over time</li> <li><strong>Recent Improvements</strong>: Enhanced data quality in recent years</li> </ul> </div> </div> </div> </div> <h2 id=methodology-deep-dive>Methodology Deep Dive<a class=headerlink href=#methodology-deep-dive title="Permanent link">&para;</a></h2> <h3 id=1-content-based-comparison-approach>1. Content-Based Comparison Approach<a class=headerlink href=#1-content-based-comparison-approach title="Permanent link">&para;</a></h3> <div class="admonition example"> <p class=admonition-title>Enhanced Analysis Method</p> <p>Unlike traditional count-based analyses, our methodology examines actual CWE string content:</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1>-- Content change detection logic</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=n>old_cwe_string</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>new_cwe_string</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Identical&#39;</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=n>old_cwe_string</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>new_cwe_string</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Added CWEs&#39;</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span><span class=k>WHEN</span><span class=w> </span><span class=n>old_cwe_string</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>new_cwe_string</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Removed CWEs&#39;</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>    </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Content Changed&#39;</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=k>END</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>change_type</span>
</span></code></pre></div> </div> <h3 id=2-multi-version-cvss-support>2. Multi-Version CVSS Support<a class=headerlink href=#2-multi-version-cvss-support title="Permanent link">&para;</a></h3> <div class="admonition gear"> <p class=admonition-title>CVSS Integration Strategy</p> <p>Our analysis incorporates both CVSS scoring systems:</p> <ul> <li><strong>CVSS v3</strong>: Modern scoring system (preferred when available)</li> <li><strong>CVSS v2</strong>: Legacy scoring system (fallback option) </li> <li><strong>Best Available</strong>: Uses v3 when available, falls back to v2 for comprehensive coverage</li> </ul> </div> <h3 id=3-enhanced-cpe-type-extraction>3. Enhanced CPE Type Extraction<a class=headerlink href=#3-enhanced-cpe-type-extraction title="Permanent link">&para;</a></h3> <div class="admonition code"> <p class=admonition-title>CPE Format Support</p> <p>Supporting both CPE format versions ensures comprehensive platform analysis:</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>CPE v2.2 Format</label><label for=__tabbed_3_2>CPE v2.3 Format</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>cpe:/[h|o|a]:vendor:product:version
</span></code></pre></div> Legacy format still widely used</p> </div> <div class=tabbed-block> <p><div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>cpe:2.3:[h|o|a]:vendor:product:version:update:edition
</span></code></pre></div> Modern standardized format</p> </div> </div> </div> <p><strong>Type Indicators:</strong></p> <ul> <li><code>h</code> = Hardware platforms</li> <li><code>o</code> = Operating System</li> <li><code>a</code> = Application software</li> </ul> </div> <h2 id=visualizations>Visualizations<a class=headerlink href=#visualizations title="Permanent link">&para;</a></h2> <h3 id=enhanced-cwe-cpe-relationship-analysis>Enhanced CWE-CPE Relationship Analysis<a class=headerlink href=#enhanced-cwe-cpe-relationship-analysis title="Permanent link">&para;</a></h3> <p><img alt="Enhanced CWE-CPE Analysis" src=../difference_between_cwe_old_vs_new_db_files/difference_between_cwe_old_vs_new_db_8_9.png></p> <h3 id=statistical-measures-comparison>Statistical Measures Comparison<a class=headerlink href=#statistical-measures-comparison title="Permanent link">&para;</a></h3> <p><img alt="Enhanced Severity Statistics" src=../difference_between_cwe_old_vs_new_db_files/difference_between_cwe_old_vs_new_db_8_10.png></p> <div class="admonition info"> <p class=admonition-title>Visualization Insights</p> <p>The charts demonstrate clear patterns in CWE-CPE relationships and provide statistical validation of our findings through multiple analytical perspectives.</p> </div> <h2 id=key-interpretations-and-implications>Key Interpretations and Implications<a class=headerlink href=#key-interpretations-and-implications title="Permanent link">&para;</a></h2> <h3 id=1-data-quality-maturation>1. Data Quality Maturation<a class=headerlink href=#1-data-quality-maturation title="Permanent link">&para;</a></h3> <div class="admonition success"> <p class=admonition-title>Quality Improvement Indicators</p> <p>The analysis reveals several positive trends:</p> <ul> <li><strong>✅ Standardization</strong>: Movement away from broad categories (CWE-310) to specific weaknesses</li> <li><strong>✅ Coverage Enhancement</strong>: 4.6 percentage point increase in CWE coverage </li> <li><strong>✅ CVSS Migration</strong>: Successful transition to CVSS v3 standard</li> <li><strong>✅ Content Stability</strong>: Only 1.4% of CVEs experienced CWE content changes</li> </ul> </div> <h3 id=2-security-landscape-evolution>2. Security Landscape Evolution<a class=headerlink href=#2-security-landscape-evolution title="Permanent link">&para;</a></h3> <div class="admonition trend"> <p class=admonition-title>Emerging Security Patterns</p> <p>The data reveals important trends in the cybersecurity landscape:</p> <p><strong>Web Application Dominance</strong>: The growth in CWE-79 (XSS) and CWE-89 (SQL Injection) reflects the continued prominence of web application vulnerabilities in the threat landscape.</p> <p><strong>Memory Safety Crisis</strong>: The prevalence of CWE-119, CWE-787, and CWE-416 underscores ongoing challenges with memory management in system software, highlighting the need for memory-safe programming languages.</p> <p><strong>Authorization Gap</strong>: The 95.7% increase in CWE-862 (Missing Authorization) demonstrates growing recognition and detection of access control vulnerabilities.</p> </div> <h3 id=3-platform-specific-security-patterns>3. Platform-Specific Security Patterns<a class=headerlink href=#3-platform-specific-security-patterns title="Permanent link">&para;</a></h3> <div class="admonition chart"> <p class=admonition-title>Platform Risk Profiles</p> <div class="tabbed-set tabbed-alternate" data-tabs=4:3><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><input id=__tabbed_4_2 name=__tabbed_4 type=radio><input id=__tabbed_4_3 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=__tabbed_4_1>Operating Systems</label><label for=__tabbed_4_2>Applications</label><label for=__tabbed_4_3>Enterprise Software</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><strong>Primary Concerns</strong>: Memory corruption vulnerabilities dominate</p> <ul> <li>CWE-119 (Memory Corruption)</li> <li>CWE-787 (Out-of-bounds Write)</li> <li>CWE-416 (Use After Free)</li> </ul> </div> <div class=tabbed-block> <p><strong>Primary Concerns</strong>: Input validation and injection attacks</p> <ul> <li>CWE-79 (Cross-site Scripting)</li> <li>CWE-89 (SQL Injection)</li> <li>CWE-20 (Input Validation)</li> </ul> </div> <div class=tabbed-block> <p><strong>Characteristics</strong>: Complex, multi-faceted vulnerabilities</p> <ul> <li>Higher CPE counts per CVE</li> <li>Multiple platform impacts</li> <li>Authorization and access control issues</li> </ul> </div> </div> </div> </div> <h2 id=enhanced-summary-statistics>Enhanced Summary Statistics<a class=headerlink href=#enhanced-summary-statistics title="Permanent link">&para;</a></h2> <div class="admonition summary"> <p class=admonition-title>Database Evolution Summary</p> <p><strong>Growth Metrics:</strong></p> <ul> <li>Database Growth: <strong>+46,339 CVEs</strong> (+19.9%)</li> <li>CWE Coverage Change: <strong>+4.6</strong> percentage points</li> <li>CVSS v3 Coverage Change: <strong>+50.5</strong> percentage points</li> <li>CVSS v2 Coverage Change: <strong>-11.8</strong> percentage points</li> </ul> <p><strong>Content Change Distribution:</strong></p> <ul> <li>Both Empty: <strong>179,732 CVEs</strong> (77.3%)</li> <li>Identical: <strong>49,599 CVEs</strong> (21.3%)</li> <li>Removed CWEs: <strong>2,482 CVEs</strong> (1.1%)</li> <li>Added CWEs: <strong>451 CVEs</strong> (0.2%)</li> <li>Content Changed: <strong>152 CVEs</strong> (0.1%)</li> </ul> </div> <h2 id=conclusions>Conclusions<a class=headerlink href=#conclusions title="Permanent link">&para;</a></h2> <div class="admonition check"> <p class=admonition-title>Analysis Conclusions</p> <p>This comprehensive analysis demonstrates significant improvements in CVE database quality and CWE assignment practices:</p> <ol> <li><strong>📈 Enhanced Coverage</strong>: Both quantitative (more CVEs) and qualitative (better CWE coverage) improvements</li> <li><strong>🎯 Standardization Progress</strong>: Movement toward more specific, actionable CWE assignments</li> <li><strong>🔄 Modern Standards Adoption</strong>: Successful CVSS v3 migration maintaining near-universal scoring</li> <li><strong>⚖️ Stable Content</strong>: Low change rates indicate mature, reliable classification processes</li> </ol> </div> <div class="admonition crystal_ball"> <p class=admonition-title>Future Implications</p> <p>These improvements enhance the utility of CVE data for security professionals, enabling:</p> <ul> <li><strong>More precise risk assessment</strong> through specific weakness identification</li> <li><strong>Better vulnerability prioritization</strong> using enhanced CVSS v3 scoring</li> <li><strong>More targeted remediation strategies</strong> based on root cause analysis</li> <li><strong>Improved security metrics</strong> through standardized weakness classification</li> </ul> </div> <h2 id=technical-notes>Technical Notes<a class=headerlink href=#technical-notes title="Permanent link">&para;</a></h2> <div class="admonition gear"> <p class=admonition-title>Analysis Parameters</p> <ul> <li><strong>Analysis Period</strong>: Old database (until April 2024) vs New database (until May 2025)</li> <li><strong>Scope</strong>: Published CVEs with CWE assignments, excluding NVD-CWE-* placeholder entries</li> <li><strong>Tools</strong>: SQL analysis with statistical functions, Python for visualization</li> <li><strong>Data Quality</strong>: Comprehensive filtering to focus on actionable weaknesses</li> <li><strong>Statistical Methods</strong>: Average, median, and mode calculations for comprehensive analysis</li> </ul> </div> <hr> <div class="admonition quote"> <p class=admonition-title>Research Impact</p> <p>This analysis demonstrates the evolution of vulnerability classification practices and the continuous improvement in cybersecurity data quality, providing valuable insights for security professionals, researchers, and policy makers in understanding the changing landscape of software vulnerabilities.</p> </div> <h2 id=detailed-analysis-with-code>Detailed analysis with code<a class=headerlink href=#detailed-analysis-with-code title="Permanent link">&para;</a></h2> <h2 id=cwe-difference-between-old-updated-21-april-2024-vs-new-db-updated-13-may-2025>CWE Difference between Old (Updated 21 April 2024) vs New DB (Updated 13 May 2025)<a class=headerlink href=#cwe-difference-between-old-updated-21-april-2024-vs-new-db-updated-13-may-2025 title="Permanent link">&para;</a></h2> <h3 id=1-environment-setup-and-data-loading>1. Environment Setup and Data Loading<a class=headerlink href=#1-environment-setup-and-data-loading title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=kn>import</span><span class=w> </span><span class=nn>duckdb</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=kn>import</span><span class=w> </span><span class=nn>seaborn</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>sns</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=kn>import</span><span class=w> </span><span class=nn>json</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=kn>from</span><span class=w> </span><span class=nn>datetime</span><span class=w> </span><span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=kn>import</span><span class=w> </span><span class=nn>warnings</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=n>warnings</span><span class=o>.</span><span class=n>filterwarnings</span><span class=p>(</span><span class=s1>&#39;ignore&#39;</span><span class=p>)</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=kn>from</span><span class=w> </span><span class=nn>matplotlib.patches</span><span class=w> </span><span class=kn>import</span> <span class=n>Patch</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.patches</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>mpatches</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy</span><span class=w> </span><span class=kn>import</span> <span class=n>stats</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=c1># Try to use Modin for faster pandas operations</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=k>try</span><span class=p>:</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>    <span class=kn>import</span><span class=w> </span><span class=nn>modin.pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>mpd</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a>    <span class=n>USE_MODIN</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Using Modin for accelerated pandas operations&quot;</span><span class=p>)</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class=k>except</span> <span class=ne>ImportError</span><span class=p>:</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a>    <span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>mpd</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a>    <span class=n>USE_MODIN</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Using standard pandas (Modin not available)&quot;</span><span class=p>)</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class=c1># Set up high-quality plotting parameters</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;figure.dpi&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>300</span>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;savefig.dpi&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>300</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;savefig.format&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;eps&#39;</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;font.size&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>12</span>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;axes.titlesize&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>14</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;axes.labelsize&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>12</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;xtick.labelsize&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>10</span>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;ytick.labelsize&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>10</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;legend.fontsize&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>10</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a><span class=c1># Global analysis period settings</span>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a><span class=n>ANALYSIS_END_DATE</span> <span class=o>=</span> <span class=s2>&quot;2024-12-31&quot;</span>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a><span class=n>ANALYSIS_START_DATE</span> <span class=o>=</span> <span class=s2>&quot;1999-01-01&quot;</span>  <span class=c1># Set to None for all data</span>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a><span class=n>USE_ALL_DATA</span> <span class=o>=</span> <span class=kc>True</span>  <span class=c1># Toggle this to switch between full dataset and filtered</span>
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40 href=#__codelineno-3-40></a>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41 href=#__codelineno-3-41></a><span class=c1># Create output directory for figures</span>
</span><span id=__span-3-42><a id=__codelineno-3-42 name=__codelineno-3-42 href=#__codelineno-3-42></a><span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=s1>&#39;figures&#39;</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-3-43><a id=__codelineno-3-43 name=__codelineno-3-43 href=#__codelineno-3-43></a><span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=s1>&#39;parquet_data&#39;</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-3-44><a id=__codelineno-3-44 name=__codelineno-3-44 href=#__codelineno-3-44></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Analysis Period: </span><span class=si>{</span><span class=s1>&#39;All available data&#39;</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>USE_ALL_DATA</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>ANALYSIS_START_DATE</span><span class=si>}</span><span class=s1> to </span><span class=si>{</span><span class=n>ANALYSIS_END_DATE</span><span class=si>}</span><span class=s1>&#39;</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>Using Modin for accelerated pandas operations
Analysis Period: All available data
</code></pre></div> <h3 id=2-load-parquet-data-for-analysis>2. Load Parquet Data for Analysis<a class=headerlink href=#2-load-parquet-data-for-analysis title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>def</span><span class=w> </span><span class=nf>load_parquet_data</span><span class=p>():</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=sd>    Load Parquet files into DuckDB for analysis</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>    <span class=c1># Create a new connection for analysis</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>    <span class=n>con</span> <span class=o>=</span> <span class=n>duckdb</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=s1>&#39;:memory:&#39;</span><span class=p>)</span>  <span class=c1># Use in-memory database for faster processing</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>    <span class=c1># Load all parquet files</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>    <span class=n>parquet_files</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>        <span class=c1># MySQL tables</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>        <span class=s1>&#39;cve_main&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_cve.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>        <span class=s1>&#39;cve_main_old&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_cvev5_v2.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>        <span class=s1>&#39;exploits&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_exploit.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>        <span class=s1>&#39;exploits_old&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_exploit_old.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>        <span class=s1>&#39;msrc_patches&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_msrc_vuln_unified.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>        <span class=s1>&#39;cisco_patches&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_cisco_vuln_unified.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>        <span class=s1>&#39;redhat_patches&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_redhat_vuln_unified.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>        <span class=s1>&#39;github_advisories&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_github_advisory_unified.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>        <span class=s1>&#39;cwe_ref&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_cwe.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a>        <span class=s1>&#39;capec_ref&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_capec.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a>        <span class=c1># PostgreSQL tables (MoreFixes)</span>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a>        <span class=s1>&#39;morefixes_cve&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\postgres_cve.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a>        <span class=s1>&#39;morefixes_fixes&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\postgres_fixes.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a>        <span class=s1>&#39;morefixes_commits&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\postgres_commits.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a>        <span class=s1>&#39;morefixes_repository&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\postgres_repository.parquet&#39;</span>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a>    <span class=p>}</span>
</span><span id=__span-4-29><a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a>
</span><span id=__span-4-30><a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a>    <span class=c1># Create views for each parquet file</span>
</span><span id=__span-4-31><a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a>    <span class=k>for</span> <span class=n>table_name</span><span class=p>,</span> <span class=n>file_path</span> <span class=ow>in</span> <span class=n>parquet_files</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-4-32><a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a>        <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span><span id=__span-4-33><a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a>            <span class=n>con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CREATE OR REPLACE VIEW </span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2> AS SELECT * FROM &#39;</span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>&#39;&quot;</span><span class=p>)</span>
</span><span id=__span-4-34><a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;✓ Loaded </span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-4-35><a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-4-36><a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;✗ File not found: </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-4-37><a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a>
</span><span id=__span-4-38><a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a>    <span class=k>return</span> <span class=n>con</span>
</span><span id=__span-4-39><a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a>
</span><span id=__span-4-40><a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a><span class=c1># Load data for analysis</span>
</span><span id=__span-4-41><a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Loading Parquet data for analysis...&quot;</span><span class=p>)</span>
</span><span id=__span-4-42><a id=__codelineno-4-42 name=__codelineno-4-42 href=#__codelineno-4-42></a><span class=n>analysis_con</span> <span class=o>=</span> <span class=n>load_parquet_data</span><span class=p>()</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>Loading Parquet data for analysis...
✓ Loaded cve_main
✓ Loaded cve_main_old
✓ Loaded exploits
✓ Loaded exploits_old
✓ Loaded msrc_patches
✓ Loaded cisco_patches
✓ Loaded redhat_patches
✓ Loaded github_advisories
✓ Loaded cwe_ref
✓ Loaded capec_ref
✓ Loaded morefixes_cve
✓ Loaded morefixes_fixes
✓ Loaded morefixes_commits
✓ Loaded morefixes_repository
</code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># List of all table names I&#39;ve loaded</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=n>table_names</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>    <span class=s2>&quot;cve_main&quot;</span><span class=p>,</span> <span class=s2>&quot;cve_main_old&quot;</span><span class=p>,</span> <span class=s2>&quot;exploits&quot;</span><span class=p>,</span> <span class=s2>&quot;msrc_patches&quot;</span><span class=p>,</span> <span class=s2>&quot;cisco_patches&quot;</span><span class=p>,</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=s2>&quot;redhat_patches&quot;</span><span class=p>,</span> <span class=s2>&quot;github_advisories&quot;</span><span class=p>,</span> <span class=s2>&quot;cwe_ref&quot;</span><span class=p>,</span> <span class=s2>&quot;capec_ref&quot;</span><span class=p>,</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>    <span class=s2>&quot;morefixes_cve&quot;</span><span class=p>,</span> <span class=s2>&quot;morefixes_fixes&quot;</span><span class=p>,</span> <span class=s2>&quot;morefixes_commits&quot;</span><span class=p>,</span> <span class=s2>&quot;morefixes_repository&quot;</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=p>]</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>--- Schema for all loaded tables ---&quot;</span><span class=p>)</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=k>for</span> <span class=n>table_name</span> <span class=ow>in</span> <span class=n>table_names</span><span class=p>:</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Schema for table: </span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>        <span class=c1># Execute PRAGMA table_info() to get schema</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>        <span class=n>schema_info</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;PRAGMA table_info(&#39;</span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>&#39;);&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>schema_info</span><span class=p>:</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  (Table &#39;</span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>&#39; not found or is empty)&quot;</span><span class=p>)</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>            <span class=k>continue</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>        <span class=c1># Print header</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a>        <span class=n>header</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;cid&quot;</span><span class=p>,</span> <span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;type&quot;</span><span class=p>,</span> <span class=s2>&quot;notnull&quot;</span><span class=p>,</span> <span class=s2>&quot;pk&quot;</span><span class=p>,</span> <span class=s2>&quot;dflt_value&quot;</span><span class=p>]</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=s1>&#39; &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>col</span><span class=si>:</span><span class=s1>&lt;15</span><span class=si>}</span><span class=s1>&#39;</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>col</span><span class=w> </span><span class=ow>in</span><span class=w> </span><span class=n>header</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=s1>&#39;-&#39;</span><span class=o>*</span><span class=mi>90</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a>        <span class=c1># Print rows</span>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a>        <span class=k>for</span> <span class=n>col_info</span> <span class=ow>in</span> <span class=n>schema_info</span><span class=p>:</span>
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a>            <span class=n>cid</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>col_type</span><span class=p>,</span> <span class=n>notnull</span><span class=p>,</span> <span class=n>pk</span><span class=p>,</span> <span class=n>dflt_value</span> <span class=o>=</span> <span class=n>col_info</span>
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>cid</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>col_type</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>notnull</span><span class=p>)</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>pk</span><span class=p>)</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>dflt_value</span><span class=p>)</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a>    <span class=k>except</span> <span class=n>duckdb</span><span class=o>.</span><span class=n>ParserException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Error retrieving schema for </span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  An unexpected error occurred for </span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>--- Schema for all loaded tables ---

Schema for table: cve_main
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               id              BIGINT          False           None            False          
  1               cve_id          VARCHAR         False           None            False          
  2               assigner_org    VARCHAR         False           None            False          
  3               state           VARCHAR         False           None            False          
  4               description     VARCHAR         False           None            False          
  5               date_reserved   TIMESTAMP       False           None            False          
  6               date_published  TIMESTAMP       False           None            False          
  7               date_updated    TIMESTAMP       False           None            False          
  8               cvss_v2_score   FLOAT           False           None            False          
  9               cvss_v2_vector  VARCHAR         False           None            False          
  10              cvss_v3_score   FLOAT           False           None            False          
  11              cvss_v3_vector  VARCHAR         False           None            False          
  12              cvss_v3_severity VARCHAR         False           None            False          
  13              cvss_v4_score   FLOAT           False           None            False          
  14              cvss_v4_vector  VARCHAR         False           None            False          
  15              cvss_v4_severity VARCHAR         False           None            False          
  16              cwe_ids         VARCHAR         False           None            False          
  17              cpes            VARCHAR         False           None            False          
  18              vendors         VARCHAR         False           None            False          
  19              products        VARCHAR         False           None            False          
  20              references      VARCHAR         False           None            False          
  21              ssvc_exploitation VARCHAR         False           None            False          
  22              ssvc_automatable VARCHAR         False           None            False          
  23              ssvc_technical_impact VARCHAR         False           None            False          
  24              kev_known_exploited TINYINT         False           None            False          
  25              kev_vendor_project VARCHAR         False           None            False          
  26              kev_product     VARCHAR         False           None            False          
  27              kev_vulnerability_name VARCHAR         False           None            False          
  28              kev_date_added  TIMESTAMP       False           None            False          
  29              kev_short_description VARCHAR         False           None            False          
  30              kev_required_action VARCHAR         False           None            False          
  31              kev_due_date    TIMESTAMP       False           None            False          
  32              kev_ransomware_use VARCHAR         False           None            False          
  33              kev_notes       VARCHAR         False           None            False          
  34              kev_cwes        VARCHAR         False           None            False          
  35              epss_score      FLOAT           False           None            False          
  36              epss_percentile FLOAT           False           None            False          
  37              data_sources    VARCHAR         False           None            False          
  38              created_at      TIMESTAMP WITH TIME ZONE False           None            False          
  39              updated_at      TIMESTAMP WITH TIME ZONE False           None            False          
  40              has_exploit     TINYINT         False           None            False          
  41              exploit_count   INTEGER         False           None            False          
  42              first_exploit_date TIMESTAMP       False           None            False          
  43              latest_exploit_date TIMESTAMP       False           None            False

Schema for table: cve_main_old
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               id              BIGINT          False           None            False          
  1               CVE ID          VARCHAR         False           None            False          
  2               State           VARCHAR         False           None            False          
  3               Date Published  TIMESTAMP       False           None            False          
  4               Date Updated    TIMESTAMP       False           None            False          
  5               Date Reserved   TIMESTAMP       False           None            False          
  6               Descriptions    VARCHAR         False           None            False          
  7               Affected Products VARCHAR         False           None            False          
  8               References      VARCHAR         False           None            False          
  9               Problem Types   VARCHAR         False           None            False          
  10              Base Severity   VARCHAR         False           None            False          
  11              Confidentiality Impact VARCHAR         False           None            False          
  12              Integrity Impact VARCHAR         False           None            False          
  13              Availability Impact VARCHAR         False           None            False          
  14              CVSS 2.0 Base Score FLOAT           False           None            False          
  15              CVSS 3.0 Base Score FLOAT           False           None            False          
  16              CVSS 3.1 Base Score FLOAT           False           None            False          
  17              cwe             VARCHAR         False           None            False          
  18              EPSS            FLOAT           False           None            False          
  19              vendors         VARCHAR         False           None            False          
  20              Software CPES   VARCHAR         False           None            False          
  21              V Score         FLOAT           False           None            False

Schema for table: exploits
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               id              BIGINT          False           None            False          
  1               file            VARCHAR         False           None            False          
  2               description     VARCHAR         False           None            False          
  3               date_published  TIMESTAMP       False           None            False          
  4               author          VARCHAR         False           None            False          
  5               type            VARCHAR         False           None            False          
  6               platform        VARCHAR         False           None            False          
  7               port            DOUBLE          False           None            False          
  8               date_added      TIMESTAMP       False           None            False          
  9               date_updated    TIMESTAMP       False           None            False          
  10              verified        BIGINT          False           None            False          
  11              codes           VARCHAR         False           None            False          
  12              tags            VARCHAR         False           None            False          
  13              aliases         VARCHAR         False           None            False          
  14              screenshot_url  VARCHAR         False           None            False          
  15              application_url VARCHAR         False           None            False          
  16              source_url      VARCHAR         False           None            False          
  17              cve_id          VARCHAR         False           None            False

Schema for table: msrc_patches
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               title           VARCHAR         False           None            False          
  1               release_date    TIMESTAMP       False           None            False          
  2               initial_release_date TIMESTAMP       False           None            False          
  3               cvrf_id         VARCHAR         False           None            False          
  4               cve_id          VARCHAR         False           None            False          
  5               exploited_status INTEGER         False           None            False          
  6               exploitation_potential_lsr INTEGER         False           None            False          
  7               exploitation_potential_osr INTEGER         False           None            False          
  8               publicly_disclosed INTEGER         False           None            False          
  9               cvss_score      FLOAT           False           None            False          
  10              cvss_vector     VARCHAR         False           None            False          
  11              vuln_title      VARCHAR         False           None            False          
  12              product_id      VARCHAR         False           None            False          
  13              product_name    VARCHAR         False           None            False          
  14              product_branch  VARCHAR         False           None            False          
  15              product_cpe     VARCHAR         False           None            False          
  16              threats         VARCHAR         False           None            False          
  17              remediations    VARCHAR         False           None            False          
  18              cwe_ids         VARCHAR         False           None            False          
  19              notes           VARCHAR         False           None            False          
  20              acknowledgments VARCHAR         False           None            False

Schema for table: cisco_patches
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               advisory_id     VARCHAR         False           None            False          
  1               title           VARCHAR         False           None            False          
  2               cve_id          VARCHAR         False           None            False          
  3               vulnerability_title VARCHAR         False           None            False          
  4               current_release_date TIMESTAMP       False           None            False          
  5               initial_release_date TIMESTAMP       False           None            False          
  6               vulnerability_release_date TIMESTAMP       False           None            False          
  7               status          VARCHAR         False           None            False          
  8               version         VARCHAR         False           None            False          
  9               publisher       VARCHAR         False           None            False          
  10              publisher_category VARCHAR         False           None            False          
  11              summary         VARCHAR         False           None            False          
  12              details         VARCHAR         False           None            False          
  13              cvss_score      FLOAT           False           None            False          
  14              cvss_severity   VARCHAR         False           None            False          
  15              cvss_vector     VARCHAR         False           None            False          
  16              bug_ids         VARCHAR         False           None            False          
  17              product_id      VARCHAR         False           None            False          
  18              product_name    VARCHAR         False           None            False          
  19              product_full_path VARCHAR         False           None            False          
  20              acknowledgments VARCHAR         False           None            False          
  21              references      VARCHAR         False           None            False          
  22              remediations    VARCHAR         False           None            False

Schema for table: redhat_patches
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               id              BIGINT          False           None            False          
  1               advisory_id     VARCHAR         False           None            False          
  2               title           VARCHAR         False           None            False          
  3               cve_id          VARCHAR         False           None            False          
  4               cwe_id          VARCHAR         False           None            False          
  5               vulnerability_title VARCHAR         False           None            False          
  6               current_release_date TIMESTAMP       False           None            False          
  7               initial_release_date TIMESTAMP       False           None            False          
  8               discovery_date  TIMESTAMP       False           None            False          
  9               release_date    TIMESTAMP       False           None            False          
  10              status          VARCHAR         False           None            False          
  11              version         VARCHAR         False           None            False          
  12              publisher       VARCHAR         False           None            False          
  13              publisher_category VARCHAR         False           None            False          
  14              summary         VARCHAR         False           None            False          
  15              details         VARCHAR         False           None            False          
  16              cvss_score      FLOAT           False           None            False          
  17              cvss_severity   VARCHAR         False           None            False          
  18              cvss_vector     VARCHAR         False           None            False          
  19              threat_impact   VARCHAR         False           None            False          
  20              aggregate_severity VARCHAR         False           None            False          
  21              product_id      VARCHAR         False           None            False          
  22              product_name    VARCHAR         False           None            False

Schema for table: github_advisories
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               id              BIGINT          False           None            False          
  1               ghsa_id         VARCHAR         False           None            False          
  2               schema_version  VARCHAR         False           None            False          
  3               published       TIMESTAMP       False           None            False          
  4               modified        TIMESTAMP       False           None            False          
  5               summary         VARCHAR         False           None            False          
  6               details         VARCHAR         False           None            False          
  7               primary_cve     VARCHAR         False           None            False          
  8               all_cves        VARCHAR         False           None            False          
  9               cvss_v3_score   FLOAT           False           None            False          
  10              cvss_v3_vector  VARCHAR         False           None            False          
  11              cvss_v4_score   FLOAT           False           None            False          
  12              cvss_v4_vector  VARCHAR         False           None            False          
  13              database_severity VARCHAR         False           None            False          
  14              severity_score  FLOAT           False           None            False          
  15              cwe_ids         VARCHAR         False           None            False          
  16              github_reviewed BOOLEAN         False           None            False          
  17              github_reviewed_at TIMESTAMP       False           None            False          
  18              nvd_published_at TIMESTAMP       False           None            False          
  19              exploited       TINYINT         False           None            False          
  20              exploitability_level TINYINT         False           None            False          
  21              poc_available   TINYINT         False           None            False          
  22              patched         TINYINT         False           None            False          
  23              patch_available TINYINT         False           None            False          
  24              primary_ecosystem VARCHAR         False           None            False          
  25              all_ecosystems  VARCHAR         False           None            False          
  26              package_ecosystem VARCHAR         False           None            False          
  27              package_name    VARCHAR         False           None            False          
  28              package_purl    VARCHAR         False           None            False          
  29              references      VARCHAR         False           None            False          
  30              affected_ranges VARCHAR         False           None            False          
  31              affected_versions VARCHAR         False           None            False          
  32              created_at      TIMESTAMP WITH TIME ZONE False           None            False          
  33              updated_at      TIMESTAMP WITH TIME ZONE False           None            False

Schema for table: cwe_ref
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               cwe_id          VARCHAR         False           None            False          
  1               name            VARCHAR         False           None            False          
  2               weakness_abstraction VARCHAR         False           None            False          
  3               status          VARCHAR         False           None            False          
  4               description     VARCHAR         False           None            False          
  5               extended_description VARCHAR         False           None            False          
  6               related_weaknesses VARCHAR         False           None            False          
  7               weakness_ordinalities VARCHAR         False           None            False          
  8               applicable_platforms VARCHAR         False           None            False          
  9               background_details VARCHAR         False           None            False          
  10              alternate_terms VARCHAR         False           None            False          
  11              modes_of_introduction VARCHAR         False           None            False          
  12              exploitation_factors VARCHAR         False           None            False          
  13              likelihood_of_exploit VARCHAR         False           None            False          
  14              common_consequences VARCHAR         False           None            False          
  15              detection_methods VARCHAR         False           None            False          
  16              potential_mitigations VARCHAR         False           None            False          
  17              observed_examples VARCHAR         False           None            False          
  18              functional_areas VARCHAR         False           None            False          
  19              affected_resources VARCHAR         False           None            False          
  20              taxonomy_mappings VARCHAR         False           None            False          
  21              related_attack_patterns VARCHAR         False           None            False          
  22              notes           VARCHAR         False           None            False          
  23              created_at      TIMESTAMP WITH TIME ZONE False           None            False

Schema for table: capec_ref
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               capec_id        VARCHAR         False           None            False          
  1               name            VARCHAR         False           None            False          
  2               abstraction     VARCHAR         False           None            False          
  3               status          VARCHAR         False           None            False          
  4               description     VARCHAR         False           None            False          
  5               alternate_terms VARCHAR         False           None            False          
  6               likelihood_of_attack VARCHAR         False           None            False          
  7               typical_severity VARCHAR         False           None            False          
  8               related_attack_patterns VARCHAR         False           None            False          
  9               execution_flow  VARCHAR         False           None            False          
  10              prerequisites   VARCHAR         False           None            False          
  11              skills_required VARCHAR         False           None            False          
  12              resources_required VARCHAR         False           None            False          
  13              indicators      VARCHAR         False           None            False          
  14              consequences    VARCHAR         False           None            False          
  15              mitigations     VARCHAR         False           None            False          
  16              example_instances VARCHAR         False           None            False          
  17              related_weaknesses VARCHAR         False           None            False          
  18              taxonomy_mappings VARCHAR         False           None            False          
  19              notes           VARCHAR         False           None            False          
  20              created_at      TIMESTAMP WITH TIME ZONE False           None            False

Schema for table: morefixes_cve
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               cve_id          VARCHAR         False           None            False          
  1               published_date  VARCHAR         False           None            False          
  2               last_modified_date VARCHAR         False           None            False          
  3               description     VARCHAR         False           None            False          
  4               nodes           VARCHAR         False           None            False          
  5               severity        VARCHAR         False           None            False          
  6               obtain_all_privilege VARCHAR         False           None            False          
  7               obtain_user_privilege VARCHAR         False           None            False          
  8               obtain_other_privilege VARCHAR         False           None            False          
  9               user_interaction_required VARCHAR         False           None            False          
  10              cvss2_vector_string VARCHAR         False           None            False          
  11              cvss2_access_vector VARCHAR         False           None            False          
  12              cvss2_access_complexity VARCHAR         False           None            False          
  13              cvss2_authentication VARCHAR         False           None            False          
  14              cvss2_confidentiality_impact VARCHAR         False           None            False          
  15              cvss2_integrity_impact VARCHAR         False           None            False          
  16              cvss2_availability_impact VARCHAR         False           None            False          
  17              cvss2_base_score VARCHAR         False           None            False          
  18              cvss3_vector_string VARCHAR         False           None            False          
  19              cvss3_attack_vector VARCHAR         False           None            False          
  20              cvss3_attack_complexity VARCHAR         False           None            False          
  21              cvss3_privileges_required VARCHAR         False           None            False          
  22              cvss3_user_interaction VARCHAR         False           None            False          
  23              cvss3_scope     VARCHAR         False           None            False          
  24              cvss3_confidentiality_impact VARCHAR         False           None            False          
  25              cvss3_integrity_impact VARCHAR         False           None            False          
  26              cvss3_availability_impact VARCHAR         False           None            False          
  27              cvss3_base_score VARCHAR         False           None            False          
  28              cvss3_base_severity VARCHAR         False           None            False          
  29              exploitability_score VARCHAR         False           None            False          
  30              impact_score    VARCHAR         False           None            False          
  31              ac_insuf_info   VARCHAR         False           None            False          
  32              reference_json  VARCHAR         False           None            False          
  33              problemtype_json VARCHAR         False           None            False

Schema for table: morefixes_fixes
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               cve_id          VARCHAR         False           None            False          
  1               hash            VARCHAR         False           None            False          
  2               repo_url        VARCHAR         False           None            False          
  3               rel_type        VARCHAR         False           None            False          
  4               score           BIGINT          False           None            False          
  5               extraction_status VARCHAR         False           None            False

Schema for table: morefixes_commits
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               hash            VARCHAR         False           None            False          
  1               repo_url        VARCHAR         False           None            False          
  2               author          VARCHAR         False           None            False          
  3               committer       VARCHAR         False           None            False          
  4               msg             VARCHAR         False           None            False          
  5               parents         VARCHAR         False           None            False          
  6               author_timezone BIGINT          False           None            False          
  7               num_lines_added BIGINT          False           None            False          
  8               num_lines_deleted BIGINT          False           None            False          
  9               dmm_unit_complexity DOUBLE          False           None            False          
  10              dmm_unit_interfacing DOUBLE          False           None            False          
  11              dmm_unit_size   DOUBLE          False           None            False          
  12              merge           BOOLEAN         False           None            False          
  13              committer_timezone BIGINT          False           None            False          
  14              author_date     TIMESTAMP WITH TIME ZONE False           None            False          
  15              committer_date  TIMESTAMP WITH TIME ZONE False           None            False

Schema for table: morefixes_repository
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               repo_url        VARCHAR         False           None            False          
  1               repo_name       VARCHAR         False           None            False          
  2               description     VARCHAR         False           None            False          
  3               date_created    TIMESTAMP       False           None            False          
  4               date_last_push  TIMESTAMP       False           None            False          
  5               homepage        VARCHAR         False           None            False          
  6               repo_language   VARCHAR         False           None            False          
  7               owner           VARCHAR         False           None            False          
  8               forks_count     BIGINT          False           None            False          
  9               stars_count     BIGINT          False           None            False
</code></pre></div> <h3 id=execute-analysis>Execute analysis<a class=headerlink href=#execute-analysis title="Permanent link">&para;</a></h3> <h4 id=cwe-analysis-with-yearly-coverage-trends-and-detailed-change-analysis>CWE analysis with yearly coverage trends and detailed change analysis<a class=headerlink href=#cwe-analysis-with-yearly-coverage-trends-and-detailed-change-analysis title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=k>def</span><span class=w> </span><span class=nf>analyze_cwe_comparison_enhanced</span><span class=p>():</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=sd>    Enhanced CWE analysis comparing old and new datasets with actual content comparison</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=== ENHANCED CWE Comparison Analysis: Old vs New Dataset ===</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>    <span class=c1># 1. CWE Distribution - Old Database</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Analyzing CWE Distribution in Old Database...&quot;</span><span class=p>)</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>    <span class=n>old_cwe_distribution_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=s2>    WITH old_cwe_split AS (</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=s2>        SELECT </span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=s2>            &quot;CVE ID&quot; as cve_id,</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=s2>            EXTRACT(YEAR FROM &quot;Date Published&quot;) as year,</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=s2>            TRIM(UNNEST(STRING_SPLIT(cwe, &#39;,&#39;))) as cwe_id</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=s2>        FROM cve_main_old </span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=s2>        WHERE &quot;State&quot; = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=s2>            AND cwe IS NOT NULL </span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=s2>            AND cwe != &#39;&#39;</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=s2>            AND cwe NOT LIKE &#39;NVD-CWE-%&#39;</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=s2>    ),</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=s2>    old_cwe_clean AS (</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=s2>        SELECT </span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a><span class=s2>            year,</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a><span class=s2>            cwe_id</span>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a><span class=s2>        FROM old_cwe_split</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a><span class=s2>        WHERE cwe_id IS NOT NULL </span>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a><span class=s2>            AND cwe_id != &#39;&#39;</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a><span class=s2>            AND cwe_id NOT LIKE &#39;NVD-CWE-%&#39;</span>
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a><span class=s2>    )</span>
</span><span id=__span-6-33><a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a><span class=s2>    SELECT </span>
</span><span id=__span-6-34><a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a><span class=s2>        oc.cwe_id,</span>
</span><span id=__span-6-35><a id=__codelineno-6-35 name=__codelineno-6-35 href=#__codelineno-6-35></a><span class=s2>        cwe_ref.name as cwe_name,</span>
</span><span id=__span-6-36><a id=__codelineno-6-36 name=__codelineno-6-36 href=#__codelineno-6-36></a><span class=s2>        COUNT(DISTINCT oc.cve_id) as cve_count,</span>
</span><span id=__span-6-37><a id=__codelineno-6-37 name=__codelineno-6-37 href=#__codelineno-6-37></a><span class=s2>        COUNT(oc.cve_id) as total_instances,</span>
</span><span id=__span-6-38><a id=__codelineno-6-38 name=__codelineno-6-38 href=#__codelineno-6-38></a><span class=s2>        MIN(oc.year) as first_seen,</span>
</span><span id=__span-6-39><a id=__codelineno-6-39 name=__codelineno-6-39 href=#__codelineno-6-39></a><span class=s2>        MAX(oc.year) as last_seen</span>
</span><span id=__span-6-40><a id=__codelineno-6-40 name=__codelineno-6-40 href=#__codelineno-6-40></a><span class=s2>    FROM old_cwe_clean oc</span>
</span><span id=__span-6-41><a id=__codelineno-6-41 name=__codelineno-6-41 href=#__codelineno-6-41></a><span class=s2>    LEFT JOIN cwe_ref ON oc.cwe_id = cwe_ref.cwe_id</span>
</span><span id=__span-6-42><a id=__codelineno-6-42 name=__codelineno-6-42 href=#__codelineno-6-42></a><span class=s2>    GROUP BY oc.cwe_id, cwe_ref.name</span>
</span><span id=__span-6-43><a id=__codelineno-6-43 name=__codelineno-6-43 href=#__codelineno-6-43></a><span class=s2>    ORDER BY cve_count DESC</span>
</span><span id=__span-6-44><a id=__codelineno-6-44 name=__codelineno-6-44 href=#__codelineno-6-44></a><span class=s2>    LIMIT 20</span>
</span><span id=__span-6-45><a id=__codelineno-6-45 name=__codelineno-6-45 href=#__codelineno-6-45></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-6-46><a id=__codelineno-6-46 name=__codelineno-6-46 href=#__codelineno-6-46></a>
</span><span id=__span-6-47><a id=__codelineno-6-47 name=__codelineno-6-47 href=#__codelineno-6-47></a>    <span class=c1># 2. CWE Distribution - New Database</span>
</span><span id=__span-6-48><a id=__codelineno-6-48 name=__codelineno-6-48 href=#__codelineno-6-48></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Analyzing CWE Distribution in New Database...&quot;</span><span class=p>)</span>
</span><span id=__span-6-49><a id=__codelineno-6-49 name=__codelineno-6-49 href=#__codelineno-6-49></a>
</span><span id=__span-6-50><a id=__codelineno-6-50 name=__codelineno-6-50 href=#__codelineno-6-50></a>    <span class=n>new_cwe_distribution_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-6-51><a id=__codelineno-6-51 name=__codelineno-6-51 href=#__codelineno-6-51></a><span class=s2>    WITH new_cwe_split AS (</span>
</span><span id=__span-6-52><a id=__codelineno-6-52 name=__codelineno-6-52 href=#__codelineno-6-52></a><span class=s2>        SELECT </span>
</span><span id=__span-6-53><a id=__codelineno-6-53 name=__codelineno-6-53 href=#__codelineno-6-53></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-54><a id=__codelineno-6-54 name=__codelineno-6-54 href=#__codelineno-6-54></a><span class=s2>            EXTRACT(YEAR FROM date_published) as year,</span>
</span><span id=__span-6-55><a id=__codelineno-6-55 name=__codelineno-6-55 href=#__codelineno-6-55></a><span class=s2>            TRIM(UNNEST(STRING_SPLIT(cwe_ids, &#39;,&#39;))) as cwe_id</span>
</span><span id=__span-6-56><a id=__codelineno-6-56 name=__codelineno-6-56 href=#__codelineno-6-56></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-6-57><a id=__codelineno-6-57 name=__codelineno-6-57 href=#__codelineno-6-57></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-58><a id=__codelineno-6-58 name=__codelineno-6-58 href=#__codelineno-6-58></a><span class=s2>            AND cwe_ids IS NOT NULL </span>
</span><span id=__span-6-59><a id=__codelineno-6-59 name=__codelineno-6-59 href=#__codelineno-6-59></a><span class=s2>            AND cwe_ids != &#39;&#39;</span>
</span><span id=__span-6-60><a id=__codelineno-6-60 name=__codelineno-6-60 href=#__codelineno-6-60></a><span class=s2>            AND cwe_ids NOT LIKE &#39;NVD-CWE-%&#39;</span>
</span><span id=__span-6-61><a id=__codelineno-6-61 name=__codelineno-6-61 href=#__codelineno-6-61></a><span class=s2>    ),</span>
</span><span id=__span-6-62><a id=__codelineno-6-62 name=__codelineno-6-62 href=#__codelineno-6-62></a><span class=s2>    new_cwe_clean AS (</span>
</span><span id=__span-6-63><a id=__codelineno-6-63 name=__codelineno-6-63 href=#__codelineno-6-63></a><span class=s2>        SELECT </span>
</span><span id=__span-6-64><a id=__codelineno-6-64 name=__codelineno-6-64 href=#__codelineno-6-64></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-65><a id=__codelineno-6-65 name=__codelineno-6-65 href=#__codelineno-6-65></a><span class=s2>            year,</span>
</span><span id=__span-6-66><a id=__codelineno-6-66 name=__codelineno-6-66 href=#__codelineno-6-66></a><span class=s2>            cwe_id</span>
</span><span id=__span-6-67><a id=__codelineno-6-67 name=__codelineno-6-67 href=#__codelineno-6-67></a><span class=s2>        FROM new_cwe_split</span>
</span><span id=__span-6-68><a id=__codelineno-6-68 name=__codelineno-6-68 href=#__codelineno-6-68></a><span class=s2>        WHERE cwe_id IS NOT NULL </span>
</span><span id=__span-6-69><a id=__codelineno-6-69 name=__codelineno-6-69 href=#__codelineno-6-69></a><span class=s2>            AND cwe_id != &#39;&#39;</span>
</span><span id=__span-6-70><a id=__codelineno-6-70 name=__codelineno-6-70 href=#__codelineno-6-70></a><span class=s2>            AND cwe_id NOT LIKE &#39;NVD-CWE-%&#39;</span>
</span><span id=__span-6-71><a id=__codelineno-6-71 name=__codelineno-6-71 href=#__codelineno-6-71></a><span class=s2>    )</span>
</span><span id=__span-6-72><a id=__codelineno-6-72 name=__codelineno-6-72 href=#__codelineno-6-72></a><span class=s2>    SELECT </span>
</span><span id=__span-6-73><a id=__codelineno-6-73 name=__codelineno-6-73 href=#__codelineno-6-73></a><span class=s2>        nc.cwe_id,</span>
</span><span id=__span-6-74><a id=__codelineno-6-74 name=__codelineno-6-74 href=#__codelineno-6-74></a><span class=s2>        cwe_ref.name as cwe_name,</span>
</span><span id=__span-6-75><a id=__codelineno-6-75 name=__codelineno-6-75 href=#__codelineno-6-75></a><span class=s2>        COUNT(DISTINCT nc.cve_id) as cve_count,</span>
</span><span id=__span-6-76><a id=__codelineno-6-76 name=__codelineno-6-76 href=#__codelineno-6-76></a><span class=s2>        COUNT(nc.cve_id) as total_instances,</span>
</span><span id=__span-6-77><a id=__codelineno-6-77 name=__codelineno-6-77 href=#__codelineno-6-77></a><span class=s2>        MIN(nc.year) as first_seen,</span>
</span><span id=__span-6-78><a id=__codelineno-6-78 name=__codelineno-6-78 href=#__codelineno-6-78></a><span class=s2>        MAX(nc.year) as last_seen</span>
</span><span id=__span-6-79><a id=__codelineno-6-79 name=__codelineno-6-79 href=#__codelineno-6-79></a><span class=s2>    FROM new_cwe_clean nc</span>
</span><span id=__span-6-80><a id=__codelineno-6-80 name=__codelineno-6-80 href=#__codelineno-6-80></a><span class=s2>    LEFT JOIN cwe_ref ON nc.cwe_id = cwe_ref.cwe_id</span>
</span><span id=__span-6-81><a id=__codelineno-6-81 name=__codelineno-6-81 href=#__codelineno-6-81></a><span class=s2>    GROUP BY nc.cwe_id, cwe_ref.name</span>
</span><span id=__span-6-82><a id=__codelineno-6-82 name=__codelineno-6-82 href=#__codelineno-6-82></a><span class=s2>    ORDER BY cve_count DESC</span>
</span><span id=__span-6-83><a id=__codelineno-6-83 name=__codelineno-6-83 href=#__codelineno-6-83></a><span class=s2>    LIMIT 20</span>
</span><span id=__span-6-84><a id=__codelineno-6-84 name=__codelineno-6-84 href=#__codelineno-6-84></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-6-85><a id=__codelineno-6-85 name=__codelineno-6-85 href=#__codelineno-6-85></a>
</span><span id=__span-6-86><a id=__codelineno-6-86 name=__codelineno-6-86 href=#__codelineno-6-86></a>    <span class=n>old_cwe_dist</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>old_cwe_distribution_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-6-87><a id=__codelineno-6-87 name=__codelineno-6-87 href=#__codelineno-6-87></a>    <span class=n>new_cwe_dist</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>new_cwe_distribution_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-6-88><a id=__codelineno-6-88 name=__codelineno-6-88 href=#__codelineno-6-88></a>
</span><span id=__span-6-89><a id=__codelineno-6-89 name=__codelineno-6-89 href=#__codelineno-6-89></a>    <span class=c1># 3. Side-by-side comparison</span>
</span><span id=__span-6-90><a id=__codelineno-6-90 name=__codelineno-6-90 href=#__codelineno-6-90></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Creating Side-by-Side CWE Comparison...&quot;</span><span class=p>)</span>
</span><span id=__span-6-91><a id=__codelineno-6-91 name=__codelineno-6-91 href=#__codelineno-6-91></a>
</span><span id=__span-6-92><a id=__codelineno-6-92 name=__codelineno-6-92 href=#__codelineno-6-92></a>    <span class=c1># Merge old and new distributions</span>
</span><span id=__span-6-93><a id=__codelineno-6-93 name=__codelineno-6-93 href=#__codelineno-6-93></a>    <span class=n>comparison_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
</span><span id=__span-6-94><a id=__codelineno-6-94 name=__codelineno-6-94 href=#__codelineno-6-94></a>        <span class=n>old_cwe_dist</span><span class=p>[[</span><span class=s1>&#39;cwe_id&#39;</span><span class=p>,</span> <span class=s1>&#39;cwe_name&#39;</span><span class=p>,</span> <span class=s1>&#39;cve_count&#39;</span><span class=p>]],</span> 
</span><span id=__span-6-95><a id=__codelineno-6-95 name=__codelineno-6-95 href=#__codelineno-6-95></a>        <span class=n>new_cwe_dist</span><span class=p>[[</span><span class=s1>&#39;cwe_id&#39;</span><span class=p>,</span> <span class=s1>&#39;cve_count&#39;</span><span class=p>]],</span> 
</span><span id=__span-6-96><a id=__codelineno-6-96 name=__codelineno-6-96 href=#__codelineno-6-96></a>        <span class=n>on</span><span class=o>=</span><span class=s1>&#39;cwe_id&#39;</span><span class=p>,</span> 
</span><span id=__span-6-97><a id=__codelineno-6-97 name=__codelineno-6-97 href=#__codelineno-6-97></a>        <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span> 
</span><span id=__span-6-98><a id=__codelineno-6-98 name=__codelineno-6-98 href=#__codelineno-6-98></a>        <span class=n>suffixes</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;_old&#39;</span><span class=p>,</span> <span class=s1>&#39;_new&#39;</span><span class=p>)</span>
</span><span id=__span-6-99><a id=__codelineno-6-99 name=__codelineno-6-99 href=#__codelineno-6-99></a>    <span class=p>)</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-6-100><a id=__codelineno-6-100 name=__codelineno-6-100 href=#__codelineno-6-100></a>
</span><span id=__span-6-101><a id=__codelineno-6-101 name=__codelineno-6-101 href=#__codelineno-6-101></a>    <span class=n>comparison_df</span><span class=p>[</span><span class=s1>&#39;cve_difference&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>comparison_df</span><span class=p>[</span><span class=s1>&#39;cve_count_new&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>comparison_df</span><span class=p>[</span><span class=s1>&#39;cve_count_old&#39;</span><span class=p>]</span>
</span><span id=__span-6-102><a id=__codelineno-6-102 name=__codelineno-6-102 href=#__codelineno-6-102></a>    <span class=n>comparison_df</span><span class=p>[</span><span class=s1>&#39;percentage_change&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>comparison_df</span><span class=p>[</span><span class=s1>&#39;cve_difference&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>comparison_df</span><span class=p>[</span><span class=s1>&#39;cve_count_old&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span> <span class=o>*</span> <span class=mi>100</span>
</span><span id=__span-6-103><a id=__codelineno-6-103 name=__codelineno-6-103 href=#__codelineno-6-103></a>    <span class=n>comparison_df</span> <span class=o>=</span> <span class=n>comparison_df</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;cve_count_new&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-6-104><a id=__codelineno-6-104 name=__codelineno-6-104 href=#__codelineno-6-104></a>
</span><span id=__span-6-105><a id=__codelineno-6-105 name=__codelineno-6-105 href=#__codelineno-6-105></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 15 CWEs - Old vs New Comparison:&quot;</span><span class=p>)</span>
</span><span id=__span-6-106><a id=__codelineno-6-106 name=__codelineno-6-106 href=#__codelineno-6-106></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span>
</span><span id=__span-6-107><a id=__codelineno-6-107 name=__codelineno-6-107 href=#__codelineno-6-107></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;CWE ID&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CWE Name&#39;</span><span class=si>:</span><span class=s2>&lt;35</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Old CVEs&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;New CVEs&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Difference&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;% Change&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-108><a id=__codelineno-6-108 name=__codelineno-6-108 href=#__codelineno-6-108></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span>
</span><span id=__span-6-109><a id=__codelineno-6-109 name=__codelineno-6-109 href=#__codelineno-6-109></a>
</span><span id=__span-6-110><a id=__codelineno-6-110 name=__codelineno-6-110 href=#__codelineno-6-110></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>comparison_df</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>15</span><span class=p>)</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-111><a id=__codelineno-6-111 name=__codelineno-6-111 href=#__codelineno-6-111></a>        <span class=n>cwe_name</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>])[:</span><span class=mi>33</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>]))</span> <span class=o>&gt;</span> <span class=mi>35</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>])</span>
</span><span id=__span-6-112><a id=__codelineno-6-112 name=__codelineno-6-112 href=#__codelineno-6-112></a>        <span class=n>change_sign</span> <span class=o>=</span> <span class=s2>&quot;+&quot;</span> <span class=k>if</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_difference&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span>
</span><span id=__span-6-113><a id=__codelineno-6-113 name=__codelineno-6-113 href=#__codelineno-6-113></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_id&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>cwe_name</span><span class=si>:</span><span class=s2>&lt;35</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_count_old&#39;</span><span class=p>])</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_count_new&#39;</span><span class=p>])</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> &quot;</span>
</span><span id=__span-6-114><a id=__codelineno-6-114 name=__codelineno-6-114 href=#__codelineno-6-114></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>change_sign</span><span class=si>}{</span><span class=nb>int</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_difference&#39;</span><span class=p>])</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;percentage_change&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>+.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>
</span><span id=__span-6-115><a id=__codelineno-6-115 name=__codelineno-6-115 href=#__codelineno-6-115></a>
</span><span id=__span-6-116><a id=__codelineno-6-116 name=__codelineno-6-116 href=#__codelineno-6-116></a>    <span class=c1># 4. ENHANCED: Detailed CWE Content Analysis for Overlapping CVEs</span>
</span><span id=__span-6-117><a id=__codelineno-6-117 name=__codelineno-6-117 href=#__codelineno-6-117></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>4. ENHANCED: Analyzing Actual CWE Content Changes for Overlapping CVEs...&quot;</span><span class=p>)</span>
</span><span id=__span-6-118><a id=__codelineno-6-118 name=__codelineno-6-118 href=#__codelineno-6-118></a>
</span><span id=__span-6-119><a id=__codelineno-6-119 name=__codelineno-6-119 href=#__codelineno-6-119></a>    <span class=n>cwe_content_changes_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-6-120><a id=__codelineno-6-120 name=__codelineno-6-120 href=#__codelineno-6-120></a><span class=s2>    WITH old_cve_cwe AS (</span>
</span><span id=__span-6-121><a id=__codelineno-6-121 name=__codelineno-6-121 href=#__codelineno-6-121></a><span class=s2>        SELECT </span>
</span><span id=__span-6-122><a id=__codelineno-6-122 name=__codelineno-6-122 href=#__codelineno-6-122></a><span class=s2>            &quot;CVE ID&quot; as cve_id,</span>
</span><span id=__span-6-123><a id=__codelineno-6-123 name=__codelineno-6-123 href=#__codelineno-6-123></a><span class=s2>            COALESCE(cwe, &#39;&#39;) as old_cwe_string,</span>
</span><span id=__span-6-124><a id=__codelineno-6-124 name=__codelineno-6-124 href=#__codelineno-6-124></a><span class=s2>            CASE </span>
</span><span id=__span-6-125><a id=__codelineno-6-125 name=__codelineno-6-125 href=#__codelineno-6-125></a><span class=s2>                WHEN cwe IS NULL OR cwe = &#39;&#39; OR cwe NOT LIKE &#39;NVD-CWE-%&#39; THEN &#39;&#39;</span>
</span><span id=__span-6-126><a id=__codelineno-6-126 name=__codelineno-6-126 href=#__codelineno-6-126></a><span class=s2>                ELSE cwe</span>
</span><span id=__span-6-127><a id=__codelineno-6-127 name=__codelineno-6-127 href=#__codelineno-6-127></a><span class=s2>            END as old_cwe_clean</span>
</span><span id=__span-6-128><a id=__codelineno-6-128 name=__codelineno-6-128 href=#__codelineno-6-128></a><span class=s2>        FROM cve_main_old </span>
</span><span id=__span-6-129><a id=__codelineno-6-129 name=__codelineno-6-129 href=#__codelineno-6-129></a><span class=s2>        WHERE &quot;State&quot; = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-130><a id=__codelineno-6-130 name=__codelineno-6-130 href=#__codelineno-6-130></a><span class=s2>    ),</span>
</span><span id=__span-6-131><a id=__codelineno-6-131 name=__codelineno-6-131 href=#__codelineno-6-131></a><span class=s2>    new_cve_cwe AS (</span>
</span><span id=__span-6-132><a id=__codelineno-6-132 name=__codelineno-6-132 href=#__codelineno-6-132></a><span class=s2>        SELECT </span>
</span><span id=__span-6-133><a id=__codelineno-6-133 name=__codelineno-6-133 href=#__codelineno-6-133></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-134><a id=__codelineno-6-134 name=__codelineno-6-134 href=#__codelineno-6-134></a><span class=s2>            COALESCE(cwe_ids, &#39;&#39;) as new_cwe_string,</span>
</span><span id=__span-6-135><a id=__codelineno-6-135 name=__codelineno-6-135 href=#__codelineno-6-135></a><span class=s2>            CASE </span>
</span><span id=__span-6-136><a id=__codelineno-6-136 name=__codelineno-6-136 href=#__codelineno-6-136></a><span class=s2>                WHEN cwe_ids IS NULL OR cwe_ids = &#39;&#39; OR cwe_ids NOT LIKE &#39;NVD-CWE-%&#39; THEN &#39;&#39;</span>
</span><span id=__span-6-137><a id=__codelineno-6-137 name=__codelineno-6-137 href=#__codelineno-6-137></a><span class=s2>                ELSE cwe_ids</span>
</span><span id=__span-6-138><a id=__codelineno-6-138 name=__codelineno-6-138 href=#__codelineno-6-138></a><span class=s2>            END as new_cwe_clean</span>
</span><span id=__span-6-139><a id=__codelineno-6-139 name=__codelineno-6-139 href=#__codelineno-6-139></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-6-140><a id=__codelineno-6-140 name=__codelineno-6-140 href=#__codelineno-6-140></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-141><a id=__codelineno-6-141 name=__codelineno-6-141 href=#__codelineno-6-141></a><span class=s2>            AND date_published &lt;= &#39;2024-04-21&#39;</span>
</span><span id=__span-6-142><a id=__codelineno-6-142 name=__codelineno-6-142 href=#__codelineno-6-142></a><span class=s2>    ),</span>
</span><span id=__span-6-143><a id=__codelineno-6-143 name=__codelineno-6-143 href=#__codelineno-6-143></a><span class=s2>    cwe_content_comparison AS (</span>
</span><span id=__span-6-144><a id=__codelineno-6-144 name=__codelineno-6-144 href=#__codelineno-6-144></a><span class=s2>        SELECT </span>
</span><span id=__span-6-145><a id=__codelineno-6-145 name=__codelineno-6-145 href=#__codelineno-6-145></a><span class=s2>            COALESCE(o.cve_id, n.cve_id) as cve_id,</span>
</span><span id=__span-6-146><a id=__codelineno-6-146 name=__codelineno-6-146 href=#__codelineno-6-146></a><span class=s2>            o.old_cwe_clean,</span>
</span><span id=__span-6-147><a id=__codelineno-6-147 name=__codelineno-6-147 href=#__codelineno-6-147></a><span class=s2>            n.new_cwe_clean,</span>
</span><span id=__span-6-148><a id=__codelineno-6-148 name=__codelineno-6-148 href=#__codelineno-6-148></a><span class=s2>            CASE </span>
</span><span id=__span-6-149><a id=__codelineno-6-149 name=__codelineno-6-149 href=#__codelineno-6-149></a><span class=s2>                WHEN o.old_cwe_clean = &#39;&#39; AND n.new_cwe_clean = &#39;&#39; THEN &#39;Both Empty&#39;</span>
</span><span id=__span-6-150><a id=__codelineno-6-150 name=__codelineno-6-150 href=#__codelineno-6-150></a><span class=s2>                WHEN o.old_cwe_clean = &#39;&#39; AND n.new_cwe_clean != &#39;&#39; THEN &#39;Added CWEs&#39;</span>
</span><span id=__span-6-151><a id=__codelineno-6-151 name=__codelineno-6-151 href=#__codelineno-6-151></a><span class=s2>                WHEN o.old_cwe_clean != &#39;&#39; AND n.new_cwe_clean = &#39;&#39; THEN &#39;Removed CWEs&#39;</span>
</span><span id=__span-6-152><a id=__codelineno-6-152 name=__codelineno-6-152 href=#__codelineno-6-152></a><span class=s2>                WHEN o.old_cwe_clean = n.new_cwe_clean THEN &#39;Identical&#39;</span>
</span><span id=__span-6-153><a id=__codelineno-6-153 name=__codelineno-6-153 href=#__codelineno-6-153></a><span class=s2>                ELSE &#39;Content Changed&#39;</span>
</span><span id=__span-6-154><a id=__codelineno-6-154 name=__codelineno-6-154 href=#__codelineno-6-154></a><span class=s2>            END as change_type,</span>
</span><span id=__span-6-155><a id=__codelineno-6-155 name=__codelineno-6-155 href=#__codelineno-6-155></a><span class=s2>            CASE </span>
</span><span id=__span-6-156><a id=__codelineno-6-156 name=__codelineno-6-156 href=#__codelineno-6-156></a><span class=s2>                WHEN o.old_cwe_clean = &#39;&#39; THEN 0</span>
</span><span id=__span-6-157><a id=__codelineno-6-157 name=__codelineno-6-157 href=#__codelineno-6-157></a><span class=s2>                ELSE LENGTH(o.old_cwe_clean) - LENGTH(REPLACE(o.old_cwe_clean, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-6-158><a id=__codelineno-6-158 name=__codelineno-6-158 href=#__codelineno-6-158></a><span class=s2>            END as old_cwe_count,</span>
</span><span id=__span-6-159><a id=__codelineno-6-159 name=__codelineno-6-159 href=#__codelineno-6-159></a><span class=s2>            CASE </span>
</span><span id=__span-6-160><a id=__codelineno-6-160 name=__codelineno-6-160 href=#__codelineno-6-160></a><span class=s2>                WHEN n.new_cwe_clean = &#39;&#39; THEN 0</span>
</span><span id=__span-6-161><a id=__codelineno-6-161 name=__codelineno-6-161 href=#__codelineno-6-161></a><span class=s2>                ELSE LENGTH(n.new_cwe_clean) - LENGTH(REPLACE(n.new_cwe_clean, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-6-162><a id=__codelineno-6-162 name=__codelineno-6-162 href=#__codelineno-6-162></a><span class=s2>            END as new_cwe_count</span>
</span><span id=__span-6-163><a id=__codelineno-6-163 name=__codelineno-6-163 href=#__codelineno-6-163></a><span class=s2>        FROM old_cve_cwe o</span>
</span><span id=__span-6-164><a id=__codelineno-6-164 name=__codelineno-6-164 href=#__codelineno-6-164></a><span class=s2>        FULL OUTER JOIN new_cve_cwe n ON o.cve_id = n.cve_id</span>
</span><span id=__span-6-165><a id=__codelineno-6-165 name=__codelineno-6-165 href=#__codelineno-6-165></a><span class=s2>    )</span>
</span><span id=__span-6-166><a id=__codelineno-6-166 name=__codelineno-6-166 href=#__codelineno-6-166></a><span class=s2>    SELECT </span>
</span><span id=__span-6-167><a id=__codelineno-6-167 name=__codelineno-6-167 href=#__codelineno-6-167></a><span class=s2>        change_type,</span>
</span><span id=__span-6-168><a id=__codelineno-6-168 name=__codelineno-6-168 href=#__codelineno-6-168></a><span class=s2>        COUNT(*) as cve_count,</span>
</span><span id=__span-6-169><a id=__codelineno-6-169 name=__codelineno-6-169 href=#__codelineno-6-169></a><span class=s2>        ROUND(AVG(old_cwe_count), 2) as avg_old_cwe_count,</span>
</span><span id=__span-6-170><a id=__codelineno-6-170 name=__codelineno-6-170 href=#__codelineno-6-170></a><span class=s2>        ROUND(AVG(new_cwe_count), 2) as avg_new_cwe_count,</span>
</span><span id=__span-6-171><a id=__codelineno-6-171 name=__codelineno-6-171 href=#__codelineno-6-171></a><span class=s2>        ROUND(AVG(new_cwe_count - old_cwe_count), 2) as avg_cwe_change</span>
</span><span id=__span-6-172><a id=__codelineno-6-172 name=__codelineno-6-172 href=#__codelineno-6-172></a><span class=s2>    FROM cwe_content_comparison</span>
</span><span id=__span-6-173><a id=__codelineno-6-173 name=__codelineno-6-173 href=#__codelineno-6-173></a><span class=s2>    GROUP BY change_type</span>
</span><span id=__span-6-174><a id=__codelineno-6-174 name=__codelineno-6-174 href=#__codelineno-6-174></a><span class=s2>    ORDER BY cve_count DESC</span>
</span><span id=__span-6-175><a id=__codelineno-6-175 name=__codelineno-6-175 href=#__codelineno-6-175></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-6-176><a id=__codelineno-6-176 name=__codelineno-6-176 href=#__codelineno-6-176></a>
</span><span id=__span-6-177><a id=__codelineno-6-177 name=__codelineno-6-177 href=#__codelineno-6-177></a>    <span class=n>cwe_content_changes</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>cwe_content_changes_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-6-178><a id=__codelineno-6-178 name=__codelineno-6-178 href=#__codelineno-6-178></a>
</span><span id=__span-6-179><a id=__codelineno-6-179 name=__codelineno-6-179 href=#__codelineno-6-179></a>    <span class=c1># 5. Get detailed examples of CWE content changes</span>
</span><span id=__span-6-180><a id=__codelineno-6-180 name=__codelineno-6-180 href=#__codelineno-6-180></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>5. Analyzing Specific Examples of CWE Content Changes...&quot;</span><span class=p>)</span>
</span><span id=__span-6-181><a id=__codelineno-6-181 name=__codelineno-6-181 href=#__codelineno-6-181></a>
</span><span id=__span-6-182><a id=__codelineno-6-182 name=__codelineno-6-182 href=#__codelineno-6-182></a>    <span class=n>detailed_cwe_changes_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-6-183><a id=__codelineno-6-183 name=__codelineno-6-183 href=#__codelineno-6-183></a><span class=s2>    WITH old_cve_cwe AS (</span>
</span><span id=__span-6-184><a id=__codelineno-6-184 name=__codelineno-6-184 href=#__codelineno-6-184></a><span class=s2>        SELECT </span>
</span><span id=__span-6-185><a id=__codelineno-6-185 name=__codelineno-6-185 href=#__codelineno-6-185></a><span class=s2>            &quot;CVE ID&quot; as cve_id,</span>
</span><span id=__span-6-186><a id=__codelineno-6-186 name=__codelineno-6-186 href=#__codelineno-6-186></a><span class=s2>            COALESCE(cwe, &#39;&#39;) as old_cwe_string</span>
</span><span id=__span-6-187><a id=__codelineno-6-187 name=__codelineno-6-187 href=#__codelineno-6-187></a><span class=s2>        FROM cve_main_old </span>
</span><span id=__span-6-188><a id=__codelineno-6-188 name=__codelineno-6-188 href=#__codelineno-6-188></a><span class=s2>        WHERE &quot;State&quot; = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-189><a id=__codelineno-6-189 name=__codelineno-6-189 href=#__codelineno-6-189></a><span class=s2>    ),</span>
</span><span id=__span-6-190><a id=__codelineno-6-190 name=__codelineno-6-190 href=#__codelineno-6-190></a><span class=s2>    new_cve_cwe AS (</span>
</span><span id=__span-6-191><a id=__codelineno-6-191 name=__codelineno-6-191 href=#__codelineno-6-191></a><span class=s2>        SELECT </span>
</span><span id=__span-6-192><a id=__codelineno-6-192 name=__codelineno-6-192 href=#__codelineno-6-192></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-193><a id=__codelineno-6-193 name=__codelineno-6-193 href=#__codelineno-6-193></a><span class=s2>            COALESCE(cwe_ids, &#39;&#39;) as new_cwe_string</span>
</span><span id=__span-6-194><a id=__codelineno-6-194 name=__codelineno-6-194 href=#__codelineno-6-194></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-6-195><a id=__codelineno-6-195 name=__codelineno-6-195 href=#__codelineno-6-195></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-196><a id=__codelineno-6-196 name=__codelineno-6-196 href=#__codelineno-6-196></a><span class=s2>            AND date_published &lt;= &#39;2024-04-21&#39;</span>
</span><span id=__span-6-197><a id=__codelineno-6-197 name=__codelineno-6-197 href=#__codelineno-6-197></a><span class=s2>    ),</span>
</span><span id=__span-6-198><a id=__codelineno-6-198 name=__codelineno-6-198 href=#__codelineno-6-198></a><span class=s2>    content_changed_examples AS (</span>
</span><span id=__span-6-199><a id=__codelineno-6-199 name=__codelineno-6-199 href=#__codelineno-6-199></a><span class=s2>        SELECT </span>
</span><span id=__span-6-200><a id=__codelineno-6-200 name=__codelineno-6-200 href=#__codelineno-6-200></a><span class=s2>            COALESCE(o.cve_id, n.cve_id) as cve_id,</span>
</span><span id=__span-6-201><a id=__codelineno-6-201 name=__codelineno-6-201 href=#__codelineno-6-201></a><span class=s2>            o.old_cwe_string,</span>
</span><span id=__span-6-202><a id=__codelineno-6-202 name=__codelineno-6-202 href=#__codelineno-6-202></a><span class=s2>            n.new_cwe_string,</span>
</span><span id=__span-6-203><a id=__codelineno-6-203 name=__codelineno-6-203 href=#__codelineno-6-203></a><span class=s2>            CASE </span>
</span><span id=__span-6-204><a id=__codelineno-6-204 name=__codelineno-6-204 href=#__codelineno-6-204></a><span class=s2>                WHEN o.old_cwe_string = &#39;&#39; AND n.new_cwe_string != &#39;&#39; THEN &#39;Added&#39;</span>
</span><span id=__span-6-205><a id=__codelineno-6-205 name=__codelineno-6-205 href=#__codelineno-6-205></a><span class=s2>                WHEN o.old_cwe_string != &#39;&#39; AND n.new_cwe_string = &#39;&#39; THEN &#39;Removed&#39;</span>
</span><span id=__span-6-206><a id=__codelineno-6-206 name=__codelineno-6-206 href=#__codelineno-6-206></a><span class=s2>                WHEN o.old_cwe_string != n.new_cwe_string AND o.old_cwe_string != &#39;&#39; AND n.new_cwe_string != &#39;&#39; THEN &#39;Modified&#39;</span>
</span><span id=__span-6-207><a id=__codelineno-6-207 name=__codelineno-6-207 href=#__codelineno-6-207></a><span class=s2>                ELSE &#39;No Change&#39;</span>
</span><span id=__span-6-208><a id=__codelineno-6-208 name=__codelineno-6-208 href=#__codelineno-6-208></a><span class=s2>            END as change_category</span>
</span><span id=__span-6-209><a id=__codelineno-6-209 name=__codelineno-6-209 href=#__codelineno-6-209></a><span class=s2>        FROM old_cve_cwe o</span>
</span><span id=__span-6-210><a id=__codelineno-6-210 name=__codelineno-6-210 href=#__codelineno-6-210></a><span class=s2>        FULL OUTER JOIN new_cve_cwe n ON o.cve_id = n.cve_id</span>
</span><span id=__span-6-211><a id=__codelineno-6-211 name=__codelineno-6-211 href=#__codelineno-6-211></a><span class=s2>        WHERE o.old_cwe_string != n.new_cwe_string</span>
</span><span id=__span-6-212><a id=__codelineno-6-212 name=__codelineno-6-212 href=#__codelineno-6-212></a><span class=s2>            AND NOT (o.old_cwe_string IN (&#39;NVD-CWE-Other&#39;, &#39;NVD-CWE-noinfo&#39;, &#39;&#39;) </span>
</span><span id=__span-6-213><a id=__codelineno-6-213 name=__codelineno-6-213 href=#__codelineno-6-213></a><span class=s2>                    AND n.new_cwe_string IN (&#39;NVD-CWE-Other&#39;, &#39;NVD-CWE-noinfo&#39;, &#39;&#39;))</span>
</span><span id=__span-6-214><a id=__codelineno-6-214 name=__codelineno-6-214 href=#__codelineno-6-214></a><span class=s2>    )</span>
</span><span id=__span-6-215><a id=__codelineno-6-215 name=__codelineno-6-215 href=#__codelineno-6-215></a><span class=s2>    SELECT </span>
</span><span id=__span-6-216><a id=__codelineno-6-216 name=__codelineno-6-216 href=#__codelineno-6-216></a><span class=s2>        cve_id,</span>
</span><span id=__span-6-217><a id=__codelineno-6-217 name=__codelineno-6-217 href=#__codelineno-6-217></a><span class=s2>        old_cwe_string,</span>
</span><span id=__span-6-218><a id=__codelineno-6-218 name=__codelineno-6-218 href=#__codelineno-6-218></a><span class=s2>        new_cwe_string,</span>
</span><span id=__span-6-219><a id=__codelineno-6-219 name=__codelineno-6-219 href=#__codelineno-6-219></a><span class=s2>        change_category</span>
</span><span id=__span-6-220><a id=__codelineno-6-220 name=__codelineno-6-220 href=#__codelineno-6-220></a><span class=s2>    FROM content_changed_examples</span>
</span><span id=__span-6-221><a id=__codelineno-6-221 name=__codelineno-6-221 href=#__codelineno-6-221></a><span class=s2>    WHERE change_category IN (&#39;Added&#39;, &#39;Removed&#39;, &#39;Modified&#39;)</span>
</span><span id=__span-6-222><a id=__codelineno-6-222 name=__codelineno-6-222 href=#__codelineno-6-222></a><span class=s2>    ORDER BY </span>
</span><span id=__span-6-223><a id=__codelineno-6-223 name=__codelineno-6-223 href=#__codelineno-6-223></a><span class=s2>        CASE change_category </span>
</span><span id=__span-6-224><a id=__codelineno-6-224 name=__codelineno-6-224 href=#__codelineno-6-224></a><span class=s2>            WHEN &#39;Modified&#39; THEN 1 </span>
</span><span id=__span-6-225><a id=__codelineno-6-225 name=__codelineno-6-225 href=#__codelineno-6-225></a><span class=s2>            WHEN &#39;Added&#39; THEN 2 </span>
</span><span id=__span-6-226><a id=__codelineno-6-226 name=__codelineno-6-226 href=#__codelineno-6-226></a><span class=s2>            WHEN &#39;Removed&#39; THEN 3 </span>
</span><span id=__span-6-227><a id=__codelineno-6-227 name=__codelineno-6-227 href=#__codelineno-6-227></a><span class=s2>        END,</span>
</span><span id=__span-6-228><a id=__codelineno-6-228 name=__codelineno-6-228 href=#__codelineno-6-228></a><span class=s2>        cve_id</span>
</span><span id=__span-6-229><a id=__codelineno-6-229 name=__codelineno-6-229 href=#__codelineno-6-229></a><span class=s2>    LIMIT 20</span>
</span><span id=__span-6-230><a id=__codelineno-6-230 name=__codelineno-6-230 href=#__codelineno-6-230></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-6-231><a id=__codelineno-6-231 name=__codelineno-6-231 href=#__codelineno-6-231></a>
</span><span id=__span-6-232><a id=__codelineno-6-232 name=__codelineno-6-232 href=#__codelineno-6-232></a>    <span class=n>detailed_changes</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>detailed_cwe_changes_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-6-233><a id=__codelineno-6-233 name=__codelineno-6-233 href=#__codelineno-6-233></a>
</span><span id=__span-6-234><a id=__codelineno-6-234 name=__codelineno-6-234 href=#__codelineno-6-234></a>    <span class=c1># 6. ENHANCED: Coverage Analysis with both CVSS v2 and v3</span>
</span><span id=__span-6-235><a id=__codelineno-6-235 name=__codelineno-6-235 href=#__codelineno-6-235></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>6. ENHANCED: CWE Coverage Analysis with CVSS v2 and v3...&quot;</span><span class=p>)</span>
</span><span id=__span-6-236><a id=__codelineno-6-236 name=__codelineno-6-236 href=#__codelineno-6-236></a>
</span><span id=__span-6-237><a id=__codelineno-6-237 name=__codelineno-6-237 href=#__codelineno-6-237></a>    <span class=n>enhanced_coverage_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-6-238><a id=__codelineno-6-238 name=__codelineno-6-238 href=#__codelineno-6-238></a><span class=s2>    WITH old_coverage AS (</span>
</span><span id=__span-6-239><a id=__codelineno-6-239 name=__codelineno-6-239 href=#__codelineno-6-239></a><span class=s2>        SELECT </span>
</span><span id=__span-6-240><a id=__codelineno-6-240 name=__codelineno-6-240 href=#__codelineno-6-240></a><span class=s2>            COUNT(*) as total_cves,</span>
</span><span id=__span-6-241><a id=__codelineno-6-241 name=__codelineno-6-241 href=#__codelineno-6-241></a><span class=s2>            COUNT(CASE WHEN cwe IS NOT NULL AND cwe != &#39;&#39; AND cwe NOT IN (&#39;NVD-CWE-Other&#39;, &#39;NVD-CWE-noinfo&#39;) THEN 1 END) as cves_with_cwe,</span>
</span><span id=__span-6-242><a id=__codelineno-6-242 name=__codelineno-6-242 href=#__codelineno-6-242></a><span class=s2>            COUNT(CASE WHEN &quot;CVSS 3.0 Base Score&quot; IS NOT NULL AND &quot;CVSS 3.0 Base Score&quot; &gt; 0 THEN 1 END) as cves_with_cvss_v3,</span>
</span><span id=__span-6-243><a id=__codelineno-6-243 name=__codelineno-6-243 href=#__codelineno-6-243></a><span class=s2>            COUNT(CASE WHEN &quot;CVSS 2.0 Base Score&quot; IS NOT NULL AND &quot;CVSS 2.0 Base Score&quot; &gt; 0 THEN 1 END) as cves_with_cvss_v2,</span>
</span><span id=__span-6-244><a id=__codelineno-6-244 name=__codelineno-6-244 href=#__codelineno-6-244></a><span class=s2>            COUNT(CASE WHEN (&quot;CVSS 3.0 Base Score&quot; IS NOT NULL AND &quot;CVSS 3.0 Base Score&quot; &gt; 0) </span>
</span><span id=__span-6-245><a id=__codelineno-6-245 name=__codelineno-6-245 href=#__codelineno-6-245></a><span class=s2>                          OR (&quot;CVSS 2.0 Base Score&quot; IS NOT NULL AND &quot;CVSS 2.0 Base Score&quot; &gt; 0) THEN 1 END) as cves_with_any_cvss</span>
</span><span id=__span-6-246><a id=__codelineno-6-246 name=__codelineno-6-246 href=#__codelineno-6-246></a><span class=s2>        FROM cve_main_old </span>
</span><span id=__span-6-247><a id=__codelineno-6-247 name=__codelineno-6-247 href=#__codelineno-6-247></a><span class=s2>        WHERE &quot;State&quot; = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-248><a id=__codelineno-6-248 name=__codelineno-6-248 href=#__codelineno-6-248></a><span class=s2>    ),</span>
</span><span id=__span-6-249><a id=__codelineno-6-249 name=__codelineno-6-249 href=#__codelineno-6-249></a><span class=s2>    new_coverage AS (</span>
</span><span id=__span-6-250><a id=__codelineno-6-250 name=__codelineno-6-250 href=#__codelineno-6-250></a><span class=s2>        SELECT </span>
</span><span id=__span-6-251><a id=__codelineno-6-251 name=__codelineno-6-251 href=#__codelineno-6-251></a><span class=s2>            COUNT(*) as total_cves,</span>
</span><span id=__span-6-252><a id=__codelineno-6-252 name=__codelineno-6-252 href=#__codelineno-6-252></a><span class=s2>            COUNT(CASE WHEN cwe_ids IS NOT NULL AND cwe_ids != &#39;&#39; AND cwe_ids NOT IN (&#39;NVD-CWE-Other&#39;, &#39;NVD-CWE-noinfo&#39;) THEN 1 END) as cves_with_cwe,</span>
</span><span id=__span-6-253><a id=__codelineno-6-253 name=__codelineno-6-253 href=#__codelineno-6-253></a><span class=s2>            COUNT(CASE WHEN cvss_v3_score IS NOT NULL AND cvss_v3_score &gt; 0 THEN 1 END) as cves_with_cvss_v3,</span>
</span><span id=__span-6-254><a id=__codelineno-6-254 name=__codelineno-6-254 href=#__codelineno-6-254></a><span class=s2>            COUNT(CASE WHEN cvss_v2_score IS NOT NULL AND cvss_v2_score &gt; 0 THEN 1 END) as cves_with_cvss_v2,</span>
</span><span id=__span-6-255><a id=__codelineno-6-255 name=__codelineno-6-255 href=#__codelineno-6-255></a><span class=s2>            COUNT(CASE WHEN (cvss_v3_score IS NOT NULL AND cvss_v3_score &gt; 0) </span>
</span><span id=__span-6-256><a id=__codelineno-6-256 name=__codelineno-6-256 href=#__codelineno-6-256></a><span class=s2>                          OR (cvss_v2_score IS NOT NULL AND cvss_v2_score &gt; 0) THEN 1 END) as cves_with_any_cvss</span>
</span><span id=__span-6-257><a id=__codelineno-6-257 name=__codelineno-6-257 href=#__codelineno-6-257></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-6-258><a id=__codelineno-6-258 name=__codelineno-6-258 href=#__codelineno-6-258></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-259><a id=__codelineno-6-259 name=__codelineno-6-259 href=#__codelineno-6-259></a><span class=s2>    )</span>
</span><span id=__span-6-260><a id=__codelineno-6-260 name=__codelineno-6-260 href=#__codelineno-6-260></a><span class=s2>    SELECT </span>
</span><span id=__span-6-261><a id=__codelineno-6-261 name=__codelineno-6-261 href=#__codelineno-6-261></a><span class=s2>        &#39;Old Database&#39; as database_name,</span>
</span><span id=__span-6-262><a id=__codelineno-6-262 name=__codelineno-6-262 href=#__codelineno-6-262></a><span class=s2>        total_cves,</span>
</span><span id=__span-6-263><a id=__codelineno-6-263 name=__codelineno-6-263 href=#__codelineno-6-263></a><span class=s2>        cves_with_cwe,</span>
</span><span id=__span-6-264><a id=__codelineno-6-264 name=__codelineno-6-264 href=#__codelineno-6-264></a><span class=s2>        ROUND((cves_with_cwe * 100.0 / total_cves), 2) as cwe_coverage_pct,</span>
</span><span id=__span-6-265><a id=__codelineno-6-265 name=__codelineno-6-265 href=#__codelineno-6-265></a><span class=s2>        cves_with_cvss_v3,</span>
</span><span id=__span-6-266><a id=__codelineno-6-266 name=__codelineno-6-266 href=#__codelineno-6-266></a><span class=s2>        ROUND((cves_with_cvss_v3 * 100.0 / total_cves), 2) as cvss_v3_coverage_pct,</span>
</span><span id=__span-6-267><a id=__codelineno-6-267 name=__codelineno-6-267 href=#__codelineno-6-267></a><span class=s2>        cves_with_cvss_v2,</span>
</span><span id=__span-6-268><a id=__codelineno-6-268 name=__codelineno-6-268 href=#__codelineno-6-268></a><span class=s2>        ROUND((cves_with_cvss_v2 * 100.0 / total_cves), 2) as cvss_v2_coverage_pct,</span>
</span><span id=__span-6-269><a id=__codelineno-6-269 name=__codelineno-6-269 href=#__codelineno-6-269></a><span class=s2>        cves_with_any_cvss,</span>
</span><span id=__span-6-270><a id=__codelineno-6-270 name=__codelineno-6-270 href=#__codelineno-6-270></a><span class=s2>        ROUND((cves_with_any_cvss * 100.0 / total_cves), 2) as any_cvss_coverage_pct</span>
</span><span id=__span-6-271><a id=__codelineno-6-271 name=__codelineno-6-271 href=#__codelineno-6-271></a><span class=s2>    FROM old_coverage</span>
</span><span id=__span-6-272><a id=__codelineno-6-272 name=__codelineno-6-272 href=#__codelineno-6-272></a>
</span><span id=__span-6-273><a id=__codelineno-6-273 name=__codelineno-6-273 href=#__codelineno-6-273></a><span class=s2>    UNION ALL</span>
</span><span id=__span-6-274><a id=__codelineno-6-274 name=__codelineno-6-274 href=#__codelineno-6-274></a>
</span><span id=__span-6-275><a id=__codelineno-6-275 name=__codelineno-6-275 href=#__codelineno-6-275></a><span class=s2>    SELECT </span>
</span><span id=__span-6-276><a id=__codelineno-6-276 name=__codelineno-6-276 href=#__codelineno-6-276></a><span class=s2>        &#39;New Database&#39; as database_name,</span>
</span><span id=__span-6-277><a id=__codelineno-6-277 name=__codelineno-6-277 href=#__codelineno-6-277></a><span class=s2>        total_cves,</span>
</span><span id=__span-6-278><a id=__codelineno-6-278 name=__codelineno-6-278 href=#__codelineno-6-278></a><span class=s2>        cves_with_cwe,</span>
</span><span id=__span-6-279><a id=__codelineno-6-279 name=__codelineno-6-279 href=#__codelineno-6-279></a><span class=s2>        ROUND((cves_with_cwe * 100.0 / total_cves), 2) as cwe_coverage_pct,</span>
</span><span id=__span-6-280><a id=__codelineno-6-280 name=__codelineno-6-280 href=#__codelineno-6-280></a><span class=s2>        cves_with_cvss_v3,</span>
</span><span id=__span-6-281><a id=__codelineno-6-281 name=__codelineno-6-281 href=#__codelineno-6-281></a><span class=s2>        ROUND((cves_with_cvss_v3 * 100.0 / total_cves), 2) as cvss_v3_coverage_pct,</span>
</span><span id=__span-6-282><a id=__codelineno-6-282 name=__codelineno-6-282 href=#__codelineno-6-282></a><span class=s2>        cves_with_cvss_v2,</span>
</span><span id=__span-6-283><a id=__codelineno-6-283 name=__codelineno-6-283 href=#__codelineno-6-283></a><span class=s2>        ROUND((cves_with_cvss_v2 * 100.0 / total_cves), 2) as cvss_v2_coverage_pct,</span>
</span><span id=__span-6-284><a id=__codelineno-6-284 name=__codelineno-6-284 href=#__codelineno-6-284></a><span class=s2>        cves_with_any_cvss,</span>
</span><span id=__span-6-285><a id=__codelineno-6-285 name=__codelineno-6-285 href=#__codelineno-6-285></a><span class=s2>        ROUND((cves_with_any_cvss * 100.0 / total_cves), 2) as any_cvss_coverage_pct</span>
</span><span id=__span-6-286><a id=__codelineno-6-286 name=__codelineno-6-286 href=#__codelineno-6-286></a><span class=s2>    FROM new_coverage</span>
</span><span id=__span-6-287><a id=__codelineno-6-287 name=__codelineno-6-287 href=#__codelineno-6-287></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-6-288><a id=__codelineno-6-288 name=__codelineno-6-288 href=#__codelineno-6-288></a>
</span><span id=__span-6-289><a id=__codelineno-6-289 name=__codelineno-6-289 href=#__codelineno-6-289></a>    <span class=n>enhanced_coverage</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>enhanced_coverage_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-6-290><a id=__codelineno-6-290 name=__codelineno-6-290 href=#__codelineno-6-290></a>
</span><span id=__span-6-291><a id=__codelineno-6-291 name=__codelineno-6-291 href=#__codelineno-6-291></a>    <span class=c1># Print results</span>
</span><span id=__span-6-292><a id=__codelineno-6-292 name=__codelineno-6-292 href=#__codelineno-6-292></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Enhanced CWE Content Change Analysis:&quot;</span><span class=p>)</span>
</span><span id=__span-6-293><a id=__codelineno-6-293 name=__codelineno-6-293 href=#__codelineno-6-293></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>80</span><span class=p>)</span>
</span><span id=__span-6-294><a id=__codelineno-6-294 name=__codelineno-6-294 href=#__codelineno-6-294></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Change Type&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CVE Count&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg Old CWEs&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg New CWEs&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg Change&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-295><a id=__codelineno-6-295 name=__codelineno-6-295 href=#__codelineno-6-295></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>80</span><span class=p>)</span>
</span><span id=__span-6-296><a id=__codelineno-6-296 name=__codelineno-6-296 href=#__codelineno-6-296></a>
</span><span id=__span-6-297><a id=__codelineno-6-297 name=__codelineno-6-297 href=#__codelineno-6-297></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>cwe_content_changes</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-298><a id=__codelineno-6-298 name=__codelineno-6-298 href=#__codelineno-6-298></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;change_type&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;12,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_old_cwe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;12.1f</span><span class=si>}</span><span class=s2> &quot;</span>
</span><span id=__span-6-299><a id=__codelineno-6-299 name=__codelineno-6-299 href=#__codelineno-6-299></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_new_cwe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;12.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_cwe_change&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;12.1f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-300><a id=__codelineno-6-300 name=__codelineno-6-300 href=#__codelineno-6-300></a>
</span><span id=__span-6-301><a id=__codelineno-6-301 name=__codelineno-6-301 href=#__codelineno-6-301></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Detailed Examples of CWE Content Changes:&quot;</span><span class=p>)</span>
</span><span id=__span-6-302><a id=__codelineno-6-302 name=__codelineno-6-302 href=#__codelineno-6-302></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>120</span><span class=p>)</span>
</span><span id=__span-6-303><a id=__codelineno-6-303 name=__codelineno-6-303 href=#__codelineno-6-303></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;CVE ID&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Change Type&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Old CWEs&#39;</span><span class=si>:</span><span class=s2>&lt;40</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;New CWEs&#39;</span><span class=si>:</span><span class=s2>&lt;40</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-304><a id=__codelineno-6-304 name=__codelineno-6-304 href=#__codelineno-6-304></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>120</span><span class=p>)</span>
</span><span id=__span-6-305><a id=__codelineno-6-305 name=__codelineno-6-305 href=#__codelineno-6-305></a>
</span><span id=__span-6-306><a id=__codelineno-6-306 name=__codelineno-6-306 href=#__codelineno-6-306></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>detailed_changes</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>15</span><span class=p>)</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-307><a id=__codelineno-6-307 name=__codelineno-6-307 href=#__codelineno-6-307></a>        <span class=n>old_cwe</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;old_cwe_string&#39;</span><span class=p>])[:</span><span class=mi>38</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;old_cwe_string&#39;</span><span class=p>]))</span> <span class=o>&gt;</span> <span class=mi>40</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;old_cwe_string&#39;</span><span class=p>])</span>
</span><span id=__span-6-308><a id=__codelineno-6-308 name=__codelineno-6-308 href=#__codelineno-6-308></a>        <span class=n>new_cwe</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;new_cwe_string&#39;</span><span class=p>])[:</span><span class=mi>38</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;new_cwe_string&#39;</span><span class=p>]))</span> <span class=o>&gt;</span> <span class=mi>40</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;new_cwe_string&#39;</span><span class=p>])</span>
</span><span id=__span-6-309><a id=__codelineno-6-309 name=__codelineno-6-309 href=#__codelineno-6-309></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_id&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;change_category&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>old_cwe</span><span class=si>:</span><span class=s2>&lt;40</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>new_cwe</span><span class=si>:</span><span class=s2>&lt;40</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-310><a id=__codelineno-6-310 name=__codelineno-6-310 href=#__codelineno-6-310></a>
</span><span id=__span-6-311><a id=__codelineno-6-311 name=__codelineno-6-311 href=#__codelineno-6-311></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Enhanced Coverage Comparison (CWE + CVSS v2/v3):&quot;</span><span class=p>)</span>
</span><span id=__span-6-312><a id=__codelineno-6-312 name=__codelineno-6-312 href=#__codelineno-6-312></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>120</span><span class=p>)</span>
</span><span id=__span-6-313><a id=__codelineno-6-313 name=__codelineno-6-313 href=#__codelineno-6-313></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Database&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Total CVEs&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CWE %&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CVSS v3 %&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CVSS v2 %&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Any CVSS %&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-314><a id=__codelineno-6-314 name=__codelineno-6-314 href=#__codelineno-6-314></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>120</span><span class=p>)</span>
</span><span id=__span-6-315><a id=__codelineno-6-315 name=__codelineno-6-315 href=#__codelineno-6-315></a>
</span><span id=__span-6-316><a id=__codelineno-6-316 name=__codelineno-6-316 href=#__codelineno-6-316></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>enhanced_coverage</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-317><a id=__codelineno-6-317 name=__codelineno-6-317 href=#__codelineno-6-317></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;database_name&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;total_cves&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;10,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_coverage_pct&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8.1f</span><span class=si>}</span><span class=s2>% &quot;</span>
</span><span id=__span-6-318><a id=__codelineno-6-318 name=__codelineno-6-318 href=#__codelineno-6-318></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cvss_v3_coverage_pct&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;10.1f</span><span class=si>}</span><span class=s2>% </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cvss_v2_coverage_pct&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;10.1f</span><span class=si>}</span><span class=s2>% </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;any_cvss_coverage_pct&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;10.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>
</span><span id=__span-6-319><a id=__codelineno-6-319 name=__codelineno-6-319 href=#__codelineno-6-319></a>
</span><span id=__span-6-320><a id=__codelineno-6-320 name=__codelineno-6-320 href=#__codelineno-6-320></a>    <span class=c1># 8. Print Enhanced Summary Statistics</span>
</span><span id=__span-6-321><a id=__codelineno-6-321 name=__codelineno-6-321 href=#__codelineno-6-321></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>8. Enhanced Summary Statistics:&quot;</span><span class=p>)</span>
</span><span id=__span-6-322><a id=__codelineno-6-322 name=__codelineno-6-322 href=#__codelineno-6-322></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>80</span><span class=p>)</span>
</span><span id=__span-6-323><a id=__codelineno-6-323 name=__codelineno-6-323 href=#__codelineno-6-323></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>enhanced_coverage</span><span class=p>)</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
</span><span id=__span-6-324><a id=__codelineno-6-324 name=__codelineno-6-324 href=#__codelineno-6-324></a>        <span class=n>old_coverage</span> <span class=o>=</span> <span class=n>enhanced_coverage</span><span class=p>[</span><span class=n>enhanced_coverage</span><span class=p>[</span><span class=s1>&#39;database_name&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;Old Database&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-6-325><a id=__codelineno-6-325 name=__codelineno-6-325 href=#__codelineno-6-325></a>        <span class=n>new_coverage</span> <span class=o>=</span> <span class=n>enhanced_coverage</span><span class=p>[</span><span class=n>enhanced_coverage</span><span class=p>[</span><span class=s1>&#39;database_name&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;New Database&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-6-326><a id=__codelineno-6-326 name=__codelineno-6-326 href=#__codelineno-6-326></a>
</span><span id=__span-6-327><a id=__codelineno-6-327 name=__codelineno-6-327 href=#__codelineno-6-327></a>        <span class=n>cve_diff</span> <span class=o>=</span> <span class=n>new_coverage</span><span class=p>[</span><span class=s1>&#39;total_cves&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>old_coverage</span><span class=p>[</span><span class=s1>&#39;total_cves&#39;</span><span class=p>]</span>
</span><span id=__span-6-328><a id=__codelineno-6-328 name=__codelineno-6-328 href=#__codelineno-6-328></a>        <span class=n>cwe_coverage_diff</span> <span class=o>=</span> <span class=n>new_coverage</span><span class=p>[</span><span class=s1>&#39;cwe_coverage_pct&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>old_coverage</span><span class=p>[</span><span class=s1>&#39;cwe_coverage_pct&#39;</span><span class=p>]</span>
</span><span id=__span-6-329><a id=__codelineno-6-329 name=__codelineno-6-329 href=#__codelineno-6-329></a>        <span class=n>cvss_v3_diff</span> <span class=o>=</span> <span class=n>new_coverage</span><span class=p>[</span><span class=s1>&#39;cvss_v3_coverage_pct&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>old_coverage</span><span class=p>[</span><span class=s1>&#39;cvss_v3_coverage_pct&#39;</span><span class=p>]</span>
</span><span id=__span-6-330><a id=__codelineno-6-330 name=__codelineno-6-330 href=#__codelineno-6-330></a>        <span class=n>cvss_v2_diff</span> <span class=o>=</span> <span class=n>new_coverage</span><span class=p>[</span><span class=s1>&#39;cvss_v2_coverage_pct&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>old_coverage</span><span class=p>[</span><span class=s1>&#39;cvss_v2_coverage_pct&#39;</span><span class=p>]</span>
</span><span id=__span-6-331><a id=__codelineno-6-331 name=__codelineno-6-331 href=#__codelineno-6-331></a>
</span><span id=__span-6-332><a id=__codelineno-6-332 name=__codelineno-6-332 href=#__codelineno-6-332></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Database Growth: </span><span class=si>{</span><span class=n>cve_diff</span><span class=si>:</span><span class=s2>+,</span><span class=si>}</span><span class=s2> CVEs&quot;</span><span class=p>)</span>
</span><span id=__span-6-333><a id=__codelineno-6-333 name=__codelineno-6-333 href=#__codelineno-6-333></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CWE Coverage Change: </span><span class=si>{</span><span class=n>cwe_coverage_diff</span><span class=si>:</span><span class=s2>+.1f</span><span class=si>}</span><span class=s2> percentage points&quot;</span><span class=p>)</span>
</span><span id=__span-6-334><a id=__codelineno-6-334 name=__codelineno-6-334 href=#__codelineno-6-334></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CVSS v3 Coverage Change: </span><span class=si>{</span><span class=n>cvss_v3_diff</span><span class=si>:</span><span class=s2>+.1f</span><span class=si>}</span><span class=s2> percentage points&quot;</span><span class=p>)</span>
</span><span id=__span-6-335><a id=__codelineno-6-335 name=__codelineno-6-335 href=#__codelineno-6-335></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CVSS v2 Coverage Change: </span><span class=si>{</span><span class=n>cvss_v2_diff</span><span class=si>:</span><span class=s2>+.1f</span><span class=si>}</span><span class=s2> percentage points&quot;</span><span class=p>)</span>
</span><span id=__span-6-336><a id=__codelineno-6-336 name=__codelineno-6-336 href=#__codelineno-6-336></a>
</span><span id=__span-6-337><a id=__codelineno-6-337 name=__codelineno-6-337 href=#__codelineno-6-337></a>        <span class=c1># Content change analysis summary</span>
</span><span id=__span-6-338><a id=__codelineno-6-338 name=__codelineno-6-338 href=#__codelineno-6-338></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>cwe_content_changes</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-6-339><a id=__codelineno-6-339 name=__codelineno-6-339 href=#__codelineno-6-339></a>            <span class=n>total_compared</span> <span class=o>=</span> <span class=n>cwe_content_changes</span><span class=p>[</span><span class=s1>&#39;cve_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span><span id=__span-6-340><a id=__codelineno-6-340 name=__codelineno-6-340 href=#__codelineno-6-340></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>CWE Content Changes for Overlapping CVEs (</span><span class=si>{</span><span class=n>total_compared</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> total):&quot;</span><span class=p>)</span>
</span><span id=__span-6-341><a id=__codelineno-6-341 name=__codelineno-6-341 href=#__codelineno-6-341></a>            <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>cwe_content_changes</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-342><a id=__codelineno-6-342 name=__codelineno-6-342 href=#__codelineno-6-342></a>                <span class=n>percentage</span> <span class=o>=</span> <span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_count&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>total_compared</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span>
</span><span id=__span-6-343><a id=__codelineno-6-343 name=__codelineno-6-343 href=#__codelineno-6-343></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;change_type&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> CVEs (</span><span class=si>{</span><span class=n>percentage</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%)&quot;</span><span class=p>)</span>
</span><span id=__span-6-344><a id=__codelineno-6-344 name=__codelineno-6-344 href=#__codelineno-6-344></a>
</span><span id=__span-6-345><a id=__codelineno-6-345 name=__codelineno-6-345 href=#__codelineno-6-345></a>        <span class=c1># Top gainers and losers</span>
</span><span id=__span-6-346><a id=__codelineno-6-346 name=__codelineno-6-346 href=#__codelineno-6-346></a>        <span class=n>gainers</span> <span class=o>=</span> <span class=n>comparison_df</span><span class=p>[</span><span class=n>comparison_df</span><span class=p>[</span><span class=s1>&#39;cve_difference&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span><span id=__span-6-347><a id=__codelineno-6-347 name=__codelineno-6-347 href=#__codelineno-6-347></a>        <span class=n>losers</span> <span class=o>=</span> <span class=n>comparison_df</span><span class=p>[</span><span class=n>comparison_df</span><span class=p>[</span><span class=s1>&#39;cve_difference&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span><span id=__span-6-348><a id=__codelineno-6-348 name=__codelineno-6-348 href=#__codelineno-6-348></a>
</span><span id=__span-6-349><a id=__codelineno-6-349 name=__codelineno-6-349 href=#__codelineno-6-349></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 5 CWE Gainers:&quot;</span><span class=p>)</span>
</span><span id=__span-6-350><a id=__codelineno-6-350 name=__codelineno-6-350 href=#__codelineno-6-350></a>        <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>gainers</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-351><a id=__codelineno-6-351 name=__codelineno-6-351 href=#__codelineno-6-351></a>            <span class=n>cwe_name</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>])[:</span><span class=mi>30</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>]))</span> <span class=o>&gt;</span> <span class=mi>30</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>])</span>
</span><span id=__span-6-352><a id=__codelineno-6-352 name=__codelineno-6-352 href=#__codelineno-6-352></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>cwe_name</span><span class=si>}</span><span class=s2>): +</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_difference&#39;</span><span class=p>])</span><span class=si>}</span><span class=s2> CVEs (</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;percentage_change&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>+.1f</span><span class=si>}</span><span class=s2>%)&quot;</span><span class=p>)</span>
</span><span id=__span-6-353><a id=__codelineno-6-353 name=__codelineno-6-353 href=#__codelineno-6-353></a>
</span><span id=__span-6-354><a id=__codelineno-6-354 name=__codelineno-6-354 href=#__codelineno-6-354></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 5 CWE Losers:&quot;</span><span class=p>)</span>
</span><span id=__span-6-355><a id=__codelineno-6-355 name=__codelineno-6-355 href=#__codelineno-6-355></a>        <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>losers</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-356><a id=__codelineno-6-356 name=__codelineno-6-356 href=#__codelineno-6-356></a>            <span class=n>cwe_name</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>])[:</span><span class=mi>30</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>]))</span> <span class=o>&gt;</span> <span class=mi>30</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>])</span>
</span><span id=__span-6-357><a id=__codelineno-6-357 name=__codelineno-6-357 href=#__codelineno-6-357></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>cwe_name</span><span class=si>}</span><span class=s2>): </span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_difference&#39;</span><span class=p>])</span><span class=si>}</span><span class=s2> CVEs (</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;percentage_change&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>+.1f</span><span class=si>}</span><span class=s2>%)&quot;</span><span class=p>)</span>
</span><span id=__span-6-358><a id=__codelineno-6-358 name=__codelineno-6-358 href=#__codelineno-6-358></a>
</span><span id=__span-6-359><a id=__codelineno-6-359 name=__codelineno-6-359 href=#__codelineno-6-359></a>    <span class=c1># 9. Create Temporal Evolution Visualization</span>
</span><span id=__span-6-360><a id=__codelineno-6-360 name=__codelineno-6-360 href=#__codelineno-6-360></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>9. Creating Temporal Evolution Analysis...&quot;</span><span class=p>)</span>
</span><span id=__span-6-361><a id=__codelineno-6-361 name=__codelineno-6-361 href=#__codelineno-6-361></a>
</span><span id=__span-6-362><a id=__codelineno-6-362 name=__codelineno-6-362 href=#__codelineno-6-362></a>    <span class=c1># Get yearly data for both databases</span>
</span><span id=__span-6-363><a id=__codelineno-6-363 name=__codelineno-6-363 href=#__codelineno-6-363></a>    <span class=n>yearly_comparison_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-6-364><a id=__codelineno-6-364 name=__codelineno-6-364 href=#__codelineno-6-364></a><span class=s2>    WITH old_yearly AS (</span>
</span><span id=__span-6-365><a id=__codelineno-6-365 name=__codelineno-6-365 href=#__codelineno-6-365></a><span class=s2>        SELECT </span>
</span><span id=__span-6-366><a id=__codelineno-6-366 name=__codelineno-6-366 href=#__codelineno-6-366></a><span class=s2>            EXTRACT(YEAR FROM &quot;Date Published&quot;) as year,</span>
</span><span id=__span-6-367><a id=__codelineno-6-367 name=__codelineno-6-367 href=#__codelineno-6-367></a><span class=s2>            COUNT(*) as total_cves,</span>
</span><span id=__span-6-368><a id=__codelineno-6-368 name=__codelineno-6-368 href=#__codelineno-6-368></a><span class=s2>            COUNT(CASE WHEN cwe IS NOT NULL AND cwe != &#39;&#39; AND cwe NOT IN (&#39;NVD-CWE-Other&#39;, &#39;NVD-CWE-noinfo&#39;) THEN 1 END) as cves_with_cwe</span>
</span><span id=__span-6-369><a id=__codelineno-6-369 name=__codelineno-6-369 href=#__codelineno-6-369></a><span class=s2>        FROM cve_main_old </span>
</span><span id=__span-6-370><a id=__codelineno-6-370 name=__codelineno-6-370 href=#__codelineno-6-370></a><span class=s2>        WHERE &quot;State&quot; = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-371><a id=__codelineno-6-371 name=__codelineno-6-371 href=#__codelineno-6-371></a><span class=s2>            AND &quot;Date Published&quot; IS NOT NULL</span>
</span><span id=__span-6-372><a id=__codelineno-6-372 name=__codelineno-6-372 href=#__codelineno-6-372></a><span class=s2>            AND EXTRACT(YEAR FROM &quot;Date Published&quot;) &gt;= 2010</span>
</span><span id=__span-6-373><a id=__codelineno-6-373 name=__codelineno-6-373 href=#__codelineno-6-373></a><span class=s2>            AND EXTRACT(YEAR FROM &quot;Date Published&quot;) &lt;= 2024</span>
</span><span id=__span-6-374><a id=__codelineno-6-374 name=__codelineno-6-374 href=#__codelineno-6-374></a><span class=s2>        GROUP BY EXTRACT(YEAR FROM &quot;Date Published&quot;)</span>
</span><span id=__span-6-375><a id=__codelineno-6-375 name=__codelineno-6-375 href=#__codelineno-6-375></a><span class=s2>    ),</span>
</span><span id=__span-6-376><a id=__codelineno-6-376 name=__codelineno-6-376 href=#__codelineno-6-376></a><span class=s2>    new_yearly AS (</span>
</span><span id=__span-6-377><a id=__codelineno-6-377 name=__codelineno-6-377 href=#__codelineno-6-377></a><span class=s2>        SELECT </span>
</span><span id=__span-6-378><a id=__codelineno-6-378 name=__codelineno-6-378 href=#__codelineno-6-378></a><span class=s2>            EXTRACT(YEAR FROM date_published) as year,</span>
</span><span id=__span-6-379><a id=__codelineno-6-379 name=__codelineno-6-379 href=#__codelineno-6-379></a><span class=s2>            COUNT(*) as total_cves,</span>
</span><span id=__span-6-380><a id=__codelineno-6-380 name=__codelineno-6-380 href=#__codelineno-6-380></a><span class=s2>            COUNT(CASE WHEN cwe_ids IS NOT NULL AND cwe_ids != &#39;&#39; AND cwe_ids NOT IN (&#39;NVD-CWE-Other&#39;, &#39;NVD-CWE-noinfo&#39;) THEN 1 END) as cves_with_cwe</span>
</span><span id=__span-6-381><a id=__codelineno-6-381 name=__codelineno-6-381 href=#__codelineno-6-381></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-6-382><a id=__codelineno-6-382 name=__codelineno-6-382 href=#__codelineno-6-382></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-383><a id=__codelineno-6-383 name=__codelineno-6-383 href=#__codelineno-6-383></a><span class=s2>            AND date_published IS NOT NULL</span>
</span><span id=__span-6-384><a id=__codelineno-6-384 name=__codelineno-6-384 href=#__codelineno-6-384></a><span class=s2>            AND EXTRACT(YEAR FROM date_published) &gt;= 2010</span>
</span><span id=__span-6-385><a id=__codelineno-6-385 name=__codelineno-6-385 href=#__codelineno-6-385></a><span class=s2>            AND EXTRACT(YEAR FROM date_published) &lt;= 2024</span>
</span><span id=__span-6-386><a id=__codelineno-6-386 name=__codelineno-6-386 href=#__codelineno-6-386></a><span class=s2>        GROUP BY EXTRACT(YEAR FROM date_published)</span>
</span><span id=__span-6-387><a id=__codelineno-6-387 name=__codelineno-6-387 href=#__codelineno-6-387></a><span class=s2>    )</span>
</span><span id=__span-6-388><a id=__codelineno-6-388 name=__codelineno-6-388 href=#__codelineno-6-388></a><span class=s2>    SELECT </span>
</span><span id=__span-6-389><a id=__codelineno-6-389 name=__codelineno-6-389 href=#__codelineno-6-389></a><span class=s2>        COALESCE(o.year, n.year) as year,</span>
</span><span id=__span-6-390><a id=__codelineno-6-390 name=__codelineno-6-390 href=#__codelineno-6-390></a><span class=s2>        COALESCE(o.total_cves, 0) as old_total_cves,</span>
</span><span id=__span-6-391><a id=__codelineno-6-391 name=__codelineno-6-391 href=#__codelineno-6-391></a><span class=s2>        COALESCE(o.cves_with_cwe, 0) as old_cves_with_cwe,</span>
</span><span id=__span-6-392><a id=__codelineno-6-392 name=__codelineno-6-392 href=#__codelineno-6-392></a><span class=s2>        COALESCE(n.total_cves, 0) as new_total_cves,</span>
</span><span id=__span-6-393><a id=__codelineno-6-393 name=__codelineno-6-393 href=#__codelineno-6-393></a><span class=s2>        COALESCE(n.cves_with_cwe, 0) as new_cves_with_cwe,</span>
</span><span id=__span-6-394><a id=__codelineno-6-394 name=__codelineno-6-394 href=#__codelineno-6-394></a><span class=s2>        ROUND(COALESCE(o.cves_with_cwe, 0) * 100.0 / NULLIF(COALESCE(o.total_cves, 0), 0), 2) as old_coverage_pct,</span>
</span><span id=__span-6-395><a id=__codelineno-6-395 name=__codelineno-6-395 href=#__codelineno-6-395></a><span class=s2>        ROUND(COALESCE(n.cves_with_cwe, 0) * 100.0 / NULLIF(COALESCE(n.total_cves, 0), 0), 2) as new_coverage_pct</span>
</span><span id=__span-6-396><a id=__codelineno-6-396 name=__codelineno-6-396 href=#__codelineno-6-396></a><span class=s2>    FROM old_yearly o</span>
</span><span id=__span-6-397><a id=__codelineno-6-397 name=__codelineno-6-397 href=#__codelineno-6-397></a><span class=s2>    FULL OUTER JOIN new_yearly n ON o.year = n.year</span>
</span><span id=__span-6-398><a id=__codelineno-6-398 name=__codelineno-6-398 href=#__codelineno-6-398></a><span class=s2>    ORDER BY year</span>
</span><span id=__span-6-399><a id=__codelineno-6-399 name=__codelineno-6-399 href=#__codelineno-6-399></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-6-400><a id=__codelineno-6-400 name=__codelineno-6-400 href=#__codelineno-6-400></a>
</span><span id=__span-6-401><a id=__codelineno-6-401 name=__codelineno-6-401 href=#__codelineno-6-401></a>    <span class=n>yearly_data</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>yearly_comparison_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-6-402><a id=__codelineno-6-402 name=__codelineno-6-402 href=#__codelineno-6-402></a>
</span><span id=__span-6-403><a id=__codelineno-6-403 name=__codelineno-6-403 href=#__codelineno-6-403></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>yearly_data</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-6-404><a id=__codelineno-6-404 name=__codelineno-6-404 href=#__codelineno-6-404></a>        <span class=n>fig_temporal</span><span class=p>,</span> <span class=p>(</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>)</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>12</span><span class=p>))</span>
</span><span id=__span-6-405><a id=__codelineno-6-405 name=__codelineno-6-405 href=#__codelineno-6-405></a>
</span><span id=__span-6-406><a id=__codelineno-6-406 name=__codelineno-6-406 href=#__codelineno-6-406></a>        <span class=n>years</span> <span class=o>=</span> <span class=n>yearly_data</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-407><a id=__codelineno-6-407 name=__codelineno-6-407 href=#__codelineno-6-407></a>
</span><span id=__span-6-408><a id=__codelineno-6-408 name=__codelineno-6-408 href=#__codelineno-6-408></a>        <span class=c1># Plot 1: CVE Counts Evolution</span>
</span><span id=__span-6-409><a id=__codelineno-6-409 name=__codelineno-6-409 href=#__codelineno-6-409></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>years</span><span class=p>,</span> <span class=n>yearly_data</span><span class=p>[</span><span class=s1>&#39;old_total_cves&#39;</span><span class=p>],</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-6-410><a id=__codelineno-6-410 name=__codelineno-6-410 href=#__codelineno-6-410></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Old Database - Total CVEs&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#FF6B6B&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>)</span>
</span><span id=__span-6-411><a id=__codelineno-6-411 name=__codelineno-6-411 href=#__codelineno-6-411></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>years</span><span class=p>,</span> <span class=n>yearly_data</span><span class=p>[</span><span class=s1>&#39;old_cves_with_cwe&#39;</span><span class=p>],</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>6</span><span class=p>,</span>
</span><span id=__span-6-412><a id=__codelineno-6-412 name=__codelineno-6-412 href=#__codelineno-6-412></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Old Database - CVEs with CWE&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#FF6B6B&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-6-413><a id=__codelineno-6-413 name=__codelineno-6-413 href=#__codelineno-6-413></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>years</span><span class=p>,</span> <span class=n>yearly_data</span><span class=p>[</span><span class=s1>&#39;new_total_cves&#39;</span><span class=p>],</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-6-414><a id=__codelineno-6-414 name=__codelineno-6-414 href=#__codelineno-6-414></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;New Database - Total CVEs&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#4ECDC4&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>)</span>
</span><span id=__span-6-415><a id=__codelineno-6-415 name=__codelineno-6-415 href=#__codelineno-6-415></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>years</span><span class=p>,</span> <span class=n>yearly_data</span><span class=p>[</span><span class=s1>&#39;new_cves_with_cwe&#39;</span><span class=p>],</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>6</span><span class=p>,</span>
</span><span id=__span-6-416><a id=__codelineno-6-416 name=__codelineno-6-416 href=#__codelineno-6-416></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;New Database - CVEs with CWE&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#4ECDC4&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-6-417><a id=__codelineno-6-417 name=__codelineno-6-417 href=#__codelineno-6-417></a>
</span><span id=__span-6-418><a id=__codelineno-6-418 name=__codelineno-6-418 href=#__codelineno-6-418></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Year&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-419><a id=__codelineno-6-419 name=__codelineno-6-419 href=#__codelineno-6-419></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Number of CVEs&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-420><a id=__codelineno-6-420 name=__codelineno-6-420 href=#__codelineno-6-420></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;CVE Count Evolution: Old vs New Database&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-6-421><a id=__codelineno-6-421 name=__codelineno-6-421 href=#__codelineno-6-421></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-6-422><a id=__codelineno-6-422 name=__codelineno-6-422 href=#__codelineno-6-422></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-6-423><a id=__codelineno-6-423 name=__codelineno-6-423 href=#__codelineno-6-423></a>
</span><span id=__span-6-424><a id=__codelineno-6-424 name=__codelineno-6-424 href=#__codelineno-6-424></a>        <span class=c1># Plot 2: Coverage Percentage Evolution</span>
</span><span id=__span-6-425><a id=__codelineno-6-425 name=__codelineno-6-425 href=#__codelineno-6-425></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>years</span><span class=p>,</span> <span class=n>yearly_data</span><span class=p>[</span><span class=s1>&#39;old_coverage_pct&#39;</span><span class=p>],</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-6-426><a id=__codelineno-6-426 name=__codelineno-6-426 href=#__codelineno-6-426></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Old Database CWE Coverage&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#FF6B6B&#39;</span><span class=p>)</span>
</span><span id=__span-6-427><a id=__codelineno-6-427 name=__codelineno-6-427 href=#__codelineno-6-427></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>years</span><span class=p>,</span> <span class=n>yearly_data</span><span class=p>[</span><span class=s1>&#39;new_coverage_pct&#39;</span><span class=p>],</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-6-428><a id=__codelineno-6-428 name=__codelineno-6-428 href=#__codelineno-6-428></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;New Database CWE Coverage&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#4ECDC4&#39;</span><span class=p>)</span>
</span><span id=__span-6-429><a id=__codelineno-6-429 name=__codelineno-6-429 href=#__codelineno-6-429></a>
</span><span id=__span-6-430><a id=__codelineno-6-430 name=__codelineno-6-430 href=#__codelineno-6-430></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Year&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-431><a id=__codelineno-6-431 name=__codelineno-6-431 href=#__codelineno-6-431></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;CWE Coverage Percentage (%)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-432><a id=__codelineno-6-432 name=__codelineno-6-432 href=#__codelineno-6-432></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;CWE Coverage Evolution: Old vs New Database&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-6-433><a id=__codelineno-6-433 name=__codelineno-6-433 href=#__codelineno-6-433></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-6-434><a id=__codelineno-6-434 name=__codelineno-6-434 href=#__codelineno-6-434></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-6-435><a id=__codelineno-6-435 name=__codelineno-6-435 href=#__codelineno-6-435></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-6-436><a id=__codelineno-6-436 name=__codelineno-6-436 href=#__codelineno-6-436></a>
</span><span id=__span-6-437><a id=__codelineno-6-437 name=__codelineno-6-437 href=#__codelineno-6-437></a>        <span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-6-438><a id=__codelineno-6-438 name=__codelineno-6-438 href=#__codelineno-6-438></a>        <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;cwe_temporal_evolution.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span><span id=__span-6-439><a id=__codelineno-6-439 name=__codelineno-6-439 href=#__codelineno-6-439></a>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-6-440><a id=__codelineno-6-440 name=__codelineno-6-440 href=#__codelineno-6-440></a>
</span><span id=__span-6-441><a id=__codelineno-6-441 name=__codelineno-6-441 href=#__codelineno-6-441></a>    <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-6-442><a id=__codelineno-6-442 name=__codelineno-6-442 href=#__codelineno-6-442></a>        <span class=s1>&#39;old_distribution&#39;</span><span class=p>:</span> <span class=n>old_cwe_dist</span><span class=p>,</span>
</span><span id=__span-6-443><a id=__codelineno-6-443 name=__codelineno-6-443 href=#__codelineno-6-443></a>        <span class=s1>&#39;new_distribution&#39;</span><span class=p>:</span> <span class=n>new_cwe_dist</span><span class=p>,</span>
</span><span id=__span-6-444><a id=__codelineno-6-444 name=__codelineno-6-444 href=#__codelineno-6-444></a>        <span class=s1>&#39;comparison&#39;</span><span class=p>:</span> <span class=n>comparison_df</span><span class=p>,</span>
</span><span id=__span-6-445><a id=__codelineno-6-445 name=__codelineno-6-445 href=#__codelineno-6-445></a>        <span class=s1>&#39;content_changes&#39;</span><span class=p>:</span> <span class=n>cwe_content_changes</span><span class=p>,</span>
</span><span id=__span-6-446><a id=__codelineno-6-446 name=__codelineno-6-446 href=#__codelineno-6-446></a>        <span class=s1>&#39;detailed_changes&#39;</span><span class=p>:</span> <span class=n>detailed_changes</span><span class=p>,</span>
</span><span id=__span-6-447><a id=__codelineno-6-447 name=__codelineno-6-447 href=#__codelineno-6-447></a>        <span class=s1>&#39;enhanced_coverage&#39;</span><span class=p>:</span> <span class=n>enhanced_coverage</span>
</span><span id=__span-6-448><a id=__codelineno-6-448 name=__codelineno-6-448 href=#__codelineno-6-448></a>    <span class=p>}</span>
</span><span id=__span-6-449><a id=__codelineno-6-449 name=__codelineno-6-449 href=#__codelineno-6-449></a>
</span><span id=__span-6-450><a id=__codelineno-6-450 name=__codelineno-6-450 href=#__codelineno-6-450></a><span class=k>def</span><span class=w> </span><span class=nf>analyze_cwe_cpe_relationships_enhanced</span><span class=p>():</span>
</span><span id=__span-6-451><a id=__codelineno-6-451 name=__codelineno-6-451 href=#__codelineno-6-451></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-6-452><a id=__codelineno-6-452 name=__codelineno-6-452 href=#__codelineno-6-452></a><span class=sd>    Enhanced CWE-CPE relationship analysis with proper CPE type extraction and statistical measures</span>
</span><span id=__span-6-453><a id=__codelineno-6-453 name=__codelineno-6-453 href=#__codelineno-6-453></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-6-454><a id=__codelineno-6-454 name=__codelineno-6-454 href=#__codelineno-6-454></a>
</span><span id=__span-6-455><a id=__codelineno-6-455 name=__codelineno-6-455 href=#__codelineno-6-455></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n\n</span><span class=s2>=== ENHANCED CWE-CPE Relationship Analysis ===</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-456><a id=__codelineno-6-456 name=__codelineno-6-456 href=#__codelineno-6-456></a>
</span><span id=__span-6-457><a id=__codelineno-6-457 name=__codelineno-6-457 href=#__codelineno-6-457></a>    <span class=c1># 1. ENHANCED: CWE-CPE Co-occurrence with proper CPE type extraction</span>
</span><span id=__span-6-458><a id=__codelineno-6-458 name=__codelineno-6-458 href=#__codelineno-6-458></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. ENHANCED: Analyzing CWE-CPE Co-occurrence with CPE Types (h/o/a)...&quot;</span><span class=p>)</span>
</span><span id=__span-6-459><a id=__codelineno-6-459 name=__codelineno-6-459 href=#__codelineno-6-459></a>
</span><span id=__span-6-460><a id=__codelineno-6-460 name=__codelineno-6-460 href=#__codelineno-6-460></a>    <span class=n>enhanced_cooccurrence_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-6-461><a id=__codelineno-6-461 name=__codelineno-6-461 href=#__codelineno-6-461></a><span class=s2>    WITH cve_cwe_cpe AS (</span>
</span><span id=__span-6-462><a id=__codelineno-6-462 name=__codelineno-6-462 href=#__codelineno-6-462></a><span class=s2>        SELECT </span>
</span><span id=__span-6-463><a id=__codelineno-6-463 name=__codelineno-6-463 href=#__codelineno-6-463></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-464><a id=__codelineno-6-464 name=__codelineno-6-464 href=#__codelineno-6-464></a><span class=s2>            cwe_ids,</span>
</span><span id=__span-6-465><a id=__codelineno-6-465 name=__codelineno-6-465 href=#__codelineno-6-465></a><span class=s2>            cpes,</span>
</span><span id=__span-6-466><a id=__codelineno-6-466 name=__codelineno-6-466 href=#__codelineno-6-466></a><span class=s2>            CASE </span>
</span><span id=__span-6-467><a id=__codelineno-6-467 name=__codelineno-6-467 href=#__codelineno-6-467></a><span class=s2>                WHEN cpes IS NULL OR cpes = &#39;&#39; THEN 0</span>
</span><span id=__span-6-468><a id=__codelineno-6-468 name=__codelineno-6-468 href=#__codelineno-6-468></a><span class=s2>                ELSE LENGTH(cpes) - LENGTH(REPLACE(cpes, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-6-469><a id=__codelineno-6-469 name=__codelineno-6-469 href=#__codelineno-6-469></a><span class=s2>            END as cpe_count,</span>
</span><span id=__span-6-470><a id=__codelineno-6-470 name=__codelineno-6-470 href=#__codelineno-6-470></a><span class=s2>            -- FIXED: Proper CWE counting (exclude NVD-CWE but count real CWEs)</span>
</span><span id=__span-6-471><a id=__codelineno-6-471 name=__codelineno-6-471 href=#__codelineno-6-471></a><span class=s2>            CASE </span>
</span><span id=__span-6-472><a id=__codelineno-6-472 name=__codelineno-6-472 href=#__codelineno-6-472></a><span class=s2>                WHEN cwe_ids IS NULL OR cwe_ids = &#39;&#39; OR cwe_ids LIKE &#39;NVD-CWE-%&#39; THEN 0</span>
</span><span id=__span-6-473><a id=__codelineno-6-473 name=__codelineno-6-473 href=#__codelineno-6-473></a><span class=s2>                ELSE LENGTH(cwe_ids) - LENGTH(REPLACE(cwe_ids, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-6-474><a id=__codelineno-6-474 name=__codelineno-6-474 href=#__codelineno-6-474></a><span class=s2>            END as cwe_count</span>
</span><span id=__span-6-475><a id=__codelineno-6-475 name=__codelineno-6-475 href=#__codelineno-6-475></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-6-476><a id=__codelineno-6-476 name=__codelineno-6-476 href=#__codelineno-6-476></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-477><a id=__codelineno-6-477 name=__codelineno-6-477 href=#__codelineno-6-477></a><span class=s2>            AND cwe_ids IS NOT NULL </span>
</span><span id=__span-6-478><a id=__codelineno-6-478 name=__codelineno-6-478 href=#__codelineno-6-478></a><span class=s2>            AND cwe_ids != &#39;&#39;</span>
</span><span id=__span-6-479><a id=__codelineno-6-479 name=__codelineno-6-479 href=#__codelineno-6-479></a><span class=s2>            AND cwe_ids NOT LIKE &#39;NVD-CWE-%&#39;  -- Filter out NVD-CWE entries</span>
</span><span id=__span-6-480><a id=__codelineno-6-480 name=__codelineno-6-480 href=#__codelineno-6-480></a><span class=s2>            AND cpes IS NOT NULL</span>
</span><span id=__span-6-481><a id=__codelineno-6-481 name=__codelineno-6-481 href=#__codelineno-6-481></a><span class=s2>            AND cpes != &#39;&#39;</span>
</span><span id=__span-6-482><a id=__codelineno-6-482 name=__codelineno-6-482 href=#__codelineno-6-482></a><span class=s2>    ),</span>
</span><span id=__span-6-483><a id=__codelineno-6-483 name=__codelineno-6-483 href=#__codelineno-6-483></a><span class=s2>    cpe_types_extracted AS (</span>
</span><span id=__span-6-484><a id=__codelineno-6-484 name=__codelineno-6-484 href=#__codelineno-6-484></a><span class=s2>        SELECT </span>
</span><span id=__span-6-485><a id=__codelineno-6-485 name=__codelineno-6-485 href=#__codelineno-6-485></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-486><a id=__codelineno-6-486 name=__codelineno-6-486 href=#__codelineno-6-486></a><span class=s2>            cwe_count,</span>
</span><span id=__span-6-487><a id=__codelineno-6-487 name=__codelineno-6-487 href=#__codelineno-6-487></a><span class=s2>            cpe_count,</span>
</span><span id=__span-6-488><a id=__codelineno-6-488 name=__codelineno-6-488 href=#__codelineno-6-488></a><span class=s2>            cpes,</span>
</span><span id=__span-6-489><a id=__codelineno-6-489 name=__codelineno-6-489 href=#__codelineno-6-489></a><span class=s2>            -- FIXED: DuckDB-compatible CPE type counting</span>
</span><span id=__span-6-490><a id=__codelineno-6-490 name=__codelineno-6-490 href=#__codelineno-6-490></a><span class=s2>            (LENGTH(cpes) - LENGTH(REPLACE(REPLACE(cpes, &#39;cpe:/h:&#39;, &#39;&#39;), &#39;cpe:2.3:h:&#39;, &#39;&#39;))) / 8 as hardware_count,</span>
</span><span id=__span-6-491><a id=__codelineno-6-491 name=__codelineno-6-491 href=#__codelineno-6-491></a><span class=s2>            (LENGTH(cpes) - LENGTH(REPLACE(REPLACE(cpes, &#39;cpe:/o:&#39;, &#39;&#39;), &#39;cpe:2.3:o:&#39;, &#39;&#39;))) / 8 as os_count,</span>
</span><span id=__span-6-492><a id=__codelineno-6-492 name=__codelineno-6-492 href=#__codelineno-6-492></a><span class=s2>            (LENGTH(cpes) - LENGTH(REPLACE(REPLACE(cpes, &#39;cpe:/a:&#39;, &#39;&#39;), &#39;cpe:2.3:a:&#39;, &#39;&#39;))) / 8 as app_count</span>
</span><span id=__span-6-493><a id=__codelineno-6-493 name=__codelineno-6-493 href=#__codelineno-6-493></a><span class=s2>        FROM cve_cwe_cpe</span>
</span><span id=__span-6-494><a id=__codelineno-6-494 name=__codelineno-6-494 href=#__codelineno-6-494></a><span class=s2>    ),</span>
</span><span id=__span-6-495><a id=__codelineno-6-495 name=__codelineno-6-495 href=#__codelineno-6-495></a><span class=s2>    cpe_types_labeled AS (</span>
</span><span id=__span-6-496><a id=__codelineno-6-496 name=__codelineno-6-496 href=#__codelineno-6-496></a><span class=s2>        SELECT *,</span>
</span><span id=__span-6-497><a id=__codelineno-6-497 name=__codelineno-6-497 href=#__codelineno-6-497></a><span class=s2>            CASE </span>
</span><span id=__span-6-498><a id=__codelineno-6-498 name=__codelineno-6-498 href=#__codelineno-6-498></a><span class=s2>                WHEN hardware_count &gt; 0 AND os_count = 0 AND app_count = 0 THEN &#39;Hardware&#39;</span>
</span><span id=__span-6-499><a id=__codelineno-6-499 name=__codelineno-6-499 href=#__codelineno-6-499></a><span class=s2>                WHEN os_count &gt; 0 AND hardware_count = 0 AND app_count = 0 THEN &#39;Operating System&#39;</span>
</span><span id=__span-6-500><a id=__codelineno-6-500 name=__codelineno-6-500 href=#__codelineno-6-500></a><span class=s2>                WHEN app_count &gt; 0 AND hardware_count = 0 AND os_count = 0 THEN &#39;Application&#39;</span>
</span><span id=__span-6-501><a id=__codelineno-6-501 name=__codelineno-6-501 href=#__codelineno-6-501></a><span class=s2>                ELSE &#39;Mixed/Unknown&#39;</span>
</span><span id=__span-6-502><a id=__codelineno-6-502 name=__codelineno-6-502 href=#__codelineno-6-502></a><span class=s2>            END AS primary_cpe_type</span>
</span><span id=__span-6-503><a id=__codelineno-6-503 name=__codelineno-6-503 href=#__codelineno-6-503></a><span class=s2>        FROM cpe_types_extracted</span>
</span><span id=__span-6-504><a id=__codelineno-6-504 name=__codelineno-6-504 href=#__codelineno-6-504></a><span class=s2>    ),</span>
</span><span id=__span-6-505><a id=__codelineno-6-505 name=__codelineno-6-505 href=#__codelineno-6-505></a><span class=s2>    cwe_cpe_categories AS (</span>
</span><span id=__span-6-506><a id=__codelineno-6-506 name=__codelineno-6-506 href=#__codelineno-6-506></a><span class=s2>        SELECT </span>
</span><span id=__span-6-507><a id=__codelineno-6-507 name=__codelineno-6-507 href=#__codelineno-6-507></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-508><a id=__codelineno-6-508 name=__codelineno-6-508 href=#__codelineno-6-508></a><span class=s2>            CASE </span>
</span><span id=__span-6-509><a id=__codelineno-6-509 name=__codelineno-6-509 href=#__codelineno-6-509></a><span class=s2>                WHEN cwe_count = 1 THEN &#39;1 CWE&#39;</span>
</span><span id=__span-6-510><a id=__codelineno-6-510 name=__codelineno-6-510 href=#__codelineno-6-510></a><span class=s2>                WHEN cwe_count = 2 THEN &#39;2 CWEs&#39;</span>
</span><span id=__span-6-511><a id=__codelineno-6-511 name=__codelineno-6-511 href=#__codelineno-6-511></a><span class=s2>                WHEN cwe_count = 3 THEN &#39;3 CWEs&#39;</span>
</span><span id=__span-6-512><a id=__codelineno-6-512 name=__codelineno-6-512 href=#__codelineno-6-512></a><span class=s2>                WHEN cwe_count BETWEEN 4 AND 5 THEN &#39;4-5 CWEs&#39;</span>
</span><span id=__span-6-513><a id=__codelineno-6-513 name=__codelineno-6-513 href=#__codelineno-6-513></a><span class=s2>                WHEN cwe_count &gt;= 6 THEN &#39;6+ CWEs&#39;</span>
</span><span id=__span-6-514><a id=__codelineno-6-514 name=__codelineno-6-514 href=#__codelineno-6-514></a><span class=s2>                ELSE &#39;0 CWEs&#39;  -- This shouldn&#39;t happen given our filtering</span>
</span><span id=__span-6-515><a id=__codelineno-6-515 name=__codelineno-6-515 href=#__codelineno-6-515></a><span class=s2>            END as cwe_category,</span>
</span><span id=__span-6-516><a id=__codelineno-6-516 name=__codelineno-6-516 href=#__codelineno-6-516></a><span class=s2>            CASE </span>
</span><span id=__span-6-517><a id=__codelineno-6-517 name=__codelineno-6-517 href=#__codelineno-6-517></a><span class=s2>                WHEN cpe_count = 1 THEN &#39;1 CPE&#39;</span>
</span><span id=__span-6-518><a id=__codelineno-6-518 name=__codelineno-6-518 href=#__codelineno-6-518></a><span class=s2>                WHEN cpe_count BETWEEN 2 AND 5 THEN &#39;2-5 CPEs&#39;</span>
</span><span id=__span-6-519><a id=__codelineno-6-519 name=__codelineno-6-519 href=#__codelineno-6-519></a><span class=s2>                WHEN cpe_count BETWEEN 6 AND 10 THEN &#39;6-10 CPEs&#39;</span>
</span><span id=__span-6-520><a id=__codelineno-6-520 name=__codelineno-6-520 href=#__codelineno-6-520></a><span class=s2>                WHEN cpe_count BETWEEN 11 AND 50 THEN &#39;11-50 CPEs&#39;</span>
</span><span id=__span-6-521><a id=__codelineno-6-521 name=__codelineno-6-521 href=#__codelineno-6-521></a><span class=s2>                WHEN cpe_count BETWEEN 51 AND 100 THEN &#39;51-100 CPEs&#39;</span>
</span><span id=__span-6-522><a id=__codelineno-6-522 name=__codelineno-6-522 href=#__codelineno-6-522></a><span class=s2>                ELSE &#39;100+ CPEs&#39;</span>
</span><span id=__span-6-523><a id=__codelineno-6-523 name=__codelineno-6-523 href=#__codelineno-6-523></a><span class=s2>            END as cpe_category,</span>
</span><span id=__span-6-524><a id=__codelineno-6-524 name=__codelineno-6-524 href=#__codelineno-6-524></a><span class=s2>            primary_cpe_type,</span>
</span><span id=__span-6-525><a id=__codelineno-6-525 name=__codelineno-6-525 href=#__codelineno-6-525></a><span class=s2>            cwe_count,</span>
</span><span id=__span-6-526><a id=__codelineno-6-526 name=__codelineno-6-526 href=#__codelineno-6-526></a><span class=s2>            cpe_count,</span>
</span><span id=__span-6-527><a id=__codelineno-6-527 name=__codelineno-6-527 href=#__codelineno-6-527></a><span class=s2>            hardware_count,</span>
</span><span id=__span-6-528><a id=__codelineno-6-528 name=__codelineno-6-528 href=#__codelineno-6-528></a><span class=s2>            os_count,</span>
</span><span id=__span-6-529><a id=__codelineno-6-529 name=__codelineno-6-529 href=#__codelineno-6-529></a><span class=s2>            app_count</span>
</span><span id=__span-6-530><a id=__codelineno-6-530 name=__codelineno-6-530 href=#__codelineno-6-530></a><span class=s2>        FROM cpe_types_labeled</span>
</span><span id=__span-6-531><a id=__codelineno-6-531 name=__codelineno-6-531 href=#__codelineno-6-531></a><span class=s2>        WHERE cwe_count &gt; 0  -- Ensure we only include CVEs with actual CWEs</span>
</span><span id=__span-6-532><a id=__codelineno-6-532 name=__codelineno-6-532 href=#__codelineno-6-532></a><span class=s2>    )</span>
</span><span id=__span-6-533><a id=__codelineno-6-533 name=__codelineno-6-533 href=#__codelineno-6-533></a><span class=s2>    SELECT </span>
</span><span id=__span-6-534><a id=__codelineno-6-534 name=__codelineno-6-534 href=#__codelineno-6-534></a><span class=s2>        cwe_category,</span>
</span><span id=__span-6-535><a id=__codelineno-6-535 name=__codelineno-6-535 href=#__codelineno-6-535></a><span class=s2>        cpe_category,</span>
</span><span id=__span-6-536><a id=__codelineno-6-536 name=__codelineno-6-536 href=#__codelineno-6-536></a><span class=s2>        primary_cpe_type,</span>
</span><span id=__span-6-537><a id=__codelineno-6-537 name=__codelineno-6-537 href=#__codelineno-6-537></a><span class=s2>        COUNT(*) as cve_count,</span>
</span><span id=__span-6-538><a id=__codelineno-6-538 name=__codelineno-6-538 href=#__codelineno-6-538></a><span class=s2>        ROUND(AVG(cwe_count), 2) as avg_cwe_count,</span>
</span><span id=__span-6-539><a id=__codelineno-6-539 name=__codelineno-6-539 href=#__codelineno-6-539></a><span class=s2>        ROUND(AVG(cpe_count), 2) as avg_cpe_count,</span>
</span><span id=__span-6-540><a id=__codelineno-6-540 name=__codelineno-6-540 href=#__codelineno-6-540></a><span class=s2>        ROUND(AVG(hardware_count), 2) as avg_hardware_cpes,</span>
</span><span id=__span-6-541><a id=__codelineno-6-541 name=__codelineno-6-541 href=#__codelineno-6-541></a><span class=s2>        ROUND(AVG(os_count), 2) as avg_os_cpes,</span>
</span><span id=__span-6-542><a id=__codelineno-6-542 name=__codelineno-6-542 href=#__codelineno-6-542></a><span class=s2>        ROUND(AVG(app_count), 2) as avg_app_cpes</span>
</span><span id=__span-6-543><a id=__codelineno-6-543 name=__codelineno-6-543 href=#__codelineno-6-543></a><span class=s2>    FROM cwe_cpe_categories</span>
</span><span id=__span-6-544><a id=__codelineno-6-544 name=__codelineno-6-544 href=#__codelineno-6-544></a><span class=s2>    GROUP BY cwe_category, cpe_category, primary_cpe_type</span>
</span><span id=__span-6-545><a id=__codelineno-6-545 name=__codelineno-6-545 href=#__codelineno-6-545></a><span class=s2>    ORDER BY cve_count DESC</span>
</span><span id=__span-6-546><a id=__codelineno-6-546 name=__codelineno-6-546 href=#__codelineno-6-546></a><span class=s2>    LIMIT 30</span>
</span><span id=__span-6-547><a id=__codelineno-6-547 name=__codelineno-6-547 href=#__codelineno-6-547></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-6-548><a id=__codelineno-6-548 name=__codelineno-6-548 href=#__codelineno-6-548></a>
</span><span id=__span-6-549><a id=__codelineno-6-549 name=__codelineno-6-549 href=#__codelineno-6-549></a>    <span class=n>enhanced_cooccurrence</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>enhanced_cooccurrence_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-6-550><a id=__codelineno-6-550 name=__codelineno-6-550 href=#__codelineno-6-550></a>
</span><span id=__span-6-551><a id=__codelineno-6-551 name=__codelineno-6-551 href=#__codelineno-6-551></a>    <span class=c1># 2. ENHANCED: Severity Analysis with Median, Mode, and both CVSS versions</span>
</span><span id=__span-6-552><a id=__codelineno-6-552 name=__codelineno-6-552 href=#__codelineno-6-552></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>2. ENHANCED: Severity Analysis with Statistical Measures (CVSS v2 &amp; v3)...&quot;</span><span class=p>)</span>
</span><span id=__span-6-553><a id=__codelineno-6-553 name=__codelineno-6-553 href=#__codelineno-6-553></a>
</span><span id=__span-6-554><a id=__codelineno-6-554 name=__codelineno-6-554 href=#__codelineno-6-554></a>    <span class=n>enhanced_severity_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-6-555><a id=__codelineno-6-555 name=__codelineno-6-555 href=#__codelineno-6-555></a><span class=s2>    WITH cve_metrics AS (</span>
</span><span id=__span-6-556><a id=__codelineno-6-556 name=__codelineno-6-556 href=#__codelineno-6-556></a><span class=s2>        SELECT </span>
</span><span id=__span-6-557><a id=__codelineno-6-557 name=__codelineno-6-557 href=#__codelineno-6-557></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-558><a id=__codelineno-6-558 name=__codelineno-6-558 href=#__codelineno-6-558></a><span class=s2>            -- CVSS v3 analysis</span>
</span><span id=__span-6-559><a id=__codelineno-6-559 name=__codelineno-6-559 href=#__codelineno-6-559></a><span class=s2>            cvss_v3_score,</span>
</span><span id=__span-6-560><a id=__codelineno-6-560 name=__codelineno-6-560 href=#__codelineno-6-560></a><span class=s2>            CASE </span>
</span><span id=__span-6-561><a id=__codelineno-6-561 name=__codelineno-6-561 href=#__codelineno-6-561></a><span class=s2>                WHEN cvss_v3_score &gt;= 9.0 THEN &#39;Critical (9.0-10.0)&#39;</span>
</span><span id=__span-6-562><a id=__codelineno-6-562 name=__codelineno-6-562 href=#__codelineno-6-562></a><span class=s2>                WHEN cvss_v3_score &gt;= 7.0 THEN &#39;High (7.0-8.9)&#39;</span>
</span><span id=__span-6-563><a id=__codelineno-6-563 name=__codelineno-6-563 href=#__codelineno-6-563></a><span class=s2>                WHEN cvss_v3_score &gt;= 4.0 THEN &#39;Medium (4.0-6.9)&#39;</span>
</span><span id=__span-6-564><a id=__codelineno-6-564 name=__codelineno-6-564 href=#__codelineno-6-564></a><span class=s2>                WHEN cvss_v3_score &gt; 0 THEN &#39;Low (0.1-3.9)&#39;</span>
</span><span id=__span-6-565><a id=__codelineno-6-565 name=__codelineno-6-565 href=#__codelineno-6-565></a><span class=s2>                ELSE &#39;No CVSS v3&#39;</span>
</span><span id=__span-6-566><a id=__codelineno-6-566 name=__codelineno-6-566 href=#__codelineno-6-566></a><span class=s2>            END as cvss_v3_category,</span>
</span><span id=__span-6-567><a id=__codelineno-6-567 name=__codelineno-6-567 href=#__codelineno-6-567></a><span class=s2>            -- CVSS v2 analysis</span>
</span><span id=__span-6-568><a id=__codelineno-6-568 name=__codelineno-6-568 href=#__codelineno-6-568></a><span class=s2>            cvss_v2_score,</span>
</span><span id=__span-6-569><a id=__codelineno-6-569 name=__codelineno-6-569 href=#__codelineno-6-569></a><span class=s2>            CASE </span>
</span><span id=__span-6-570><a id=__codelineno-6-570 name=__codelineno-6-570 href=#__codelineno-6-570></a><span class=s2>                WHEN cvss_v2_score &gt;= 7.0 THEN &#39;High (7.0-10.0)&#39;</span>
</span><span id=__span-6-571><a id=__codelineno-6-571 name=__codelineno-6-571 href=#__codelineno-6-571></a><span class=s2>                WHEN cvss_v2_score &gt;= 4.0 THEN &#39;Medium (4.0-6.9)&#39;</span>
</span><span id=__span-6-572><a id=__codelineno-6-572 name=__codelineno-6-572 href=#__codelineno-6-572></a><span class=s2>                WHEN cvss_v2_score &gt; 0 THEN &#39;Low (0.1-3.9)&#39;</span>
</span><span id=__span-6-573><a id=__codelineno-6-573 name=__codelineno-6-573 href=#__codelineno-6-573></a><span class=s2>                ELSE &#39;No CVSS v2&#39;</span>
</span><span id=__span-6-574><a id=__codelineno-6-574 name=__codelineno-6-574 href=#__codelineno-6-574></a><span class=s2>            END as cvss_v2_category,</span>
</span><span id=__span-6-575><a id=__codelineno-6-575 name=__codelineno-6-575 href=#__codelineno-6-575></a><span class=s2>            -- Best available score</span>
</span><span id=__span-6-576><a id=__codelineno-6-576 name=__codelineno-6-576 href=#__codelineno-6-576></a><span class=s2>            COALESCE(cvss_v3_score, cvss_v2_score) as best_cvss_score,</span>
</span><span id=__span-6-577><a id=__codelineno-6-577 name=__codelineno-6-577 href=#__codelineno-6-577></a><span class=s2>            CASE </span>
</span><span id=__span-6-578><a id=__codelineno-6-578 name=__codelineno-6-578 href=#__codelineno-6-578></a><span class=s2>                WHEN COALESCE(cvss_v3_score, cvss_v2_score) &gt;= 9.0 THEN &#39;Critical (9.0-10.0)&#39;</span>
</span><span id=__span-6-579><a id=__codelineno-6-579 name=__codelineno-6-579 href=#__codelineno-6-579></a><span class=s2>                WHEN COALESCE(cvss_v3_score, cvss_v2_score) &gt;= 7.0 THEN &#39;High (7.0-8.9)&#39; </span>
</span><span id=__span-6-580><a id=__codelineno-6-580 name=__codelineno-6-580 href=#__codelineno-6-580></a><span class=s2>                WHEN COALESCE(cvss_v3_score, cvss_v2_score) &gt;= 4.0 THEN &#39;Medium (4.0-6.9)&#39;</span>
</span><span id=__span-6-581><a id=__codelineno-6-581 name=__codelineno-6-581 href=#__codelineno-6-581></a><span class=s2>                WHEN COALESCE(cvss_v3_score, cvss_v2_score) &gt; 0 THEN &#39;Low (0.1-3.9)&#39;</span>
</span><span id=__span-6-582><a id=__codelineno-6-582 name=__codelineno-6-582 href=#__codelineno-6-582></a><span class=s2>                ELSE &#39;No Score&#39;</span>
</span><span id=__span-6-583><a id=__codelineno-6-583 name=__codelineno-6-583 href=#__codelineno-6-583></a><span class=s2>            END as best_severity_category,</span>
</span><span id=__span-6-584><a id=__codelineno-6-584 name=__codelineno-6-584 href=#__codelineno-6-584></a><span class=s2>            CASE </span>
</span><span id=__span-6-585><a id=__codelineno-6-585 name=__codelineno-6-585 href=#__codelineno-6-585></a><span class=s2>                WHEN cpes IS NULL OR cpes = &#39;&#39; THEN 0</span>
</span><span id=__span-6-586><a id=__codelineno-6-586 name=__codelineno-6-586 href=#__codelineno-6-586></a><span class=s2>                ELSE LENGTH(cpes) - LENGTH(REPLACE(cpes, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-6-587><a id=__codelineno-6-587 name=__codelineno-6-587 href=#__codelineno-6-587></a><span class=s2>            END as cpe_count,</span>
</span><span id=__span-6-588><a id=__codelineno-6-588 name=__codelineno-6-588 href=#__codelineno-6-588></a><span class=s2>            CASE </span>
</span><span id=__span-6-589><a id=__codelineno-6-589 name=__codelineno-6-589 href=#__codelineno-6-589></a><span class=s2>                WHEN cwe_ids IS NULL OR cwe_ids = &#39;&#39; OR cwe_ids IN (&#39;NVD-CWE-Other&#39;, &#39;NVD-CWE-noinfo&#39;) THEN 0</span>
</span><span id=__span-6-590><a id=__codelineno-6-590 name=__codelineno-6-590 href=#__codelineno-6-590></a><span class=s2>                ELSE LENGTH(cwe_ids) - LENGTH(REPLACE(cwe_ids, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-6-591><a id=__codelineno-6-591 name=__codelineno-6-591 href=#__codelineno-6-591></a><span class=s2>            END as cwe_count</span>
</span><span id=__span-6-592><a id=__codelineno-6-592 name=__codelineno-6-592 href=#__codelineno-6-592></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-6-593><a id=__codelineno-6-593 name=__codelineno-6-593 href=#__codelineno-6-593></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-594><a id=__codelineno-6-594 name=__codelineno-6-594 href=#__codelineno-6-594></a><span class=s2>            AND cwe_ids IS NOT NULL </span>
</span><span id=__span-6-595><a id=__codelineno-6-595 name=__codelineno-6-595 href=#__codelineno-6-595></a><span class=s2>            AND cwe_ids != &#39;&#39;</span>
</span><span id=__span-6-596><a id=__codelineno-6-596 name=__codelineno-6-596 href=#__codelineno-6-596></a><span class=s2>            AND cwe_ids NOT LIKE &#39;NVD-CWE-%&#39;</span>
</span><span id=__span-6-597><a id=__codelineno-6-597 name=__codelineno-6-597 href=#__codelineno-6-597></a><span class=s2>    )</span>
</span><span id=__span-6-598><a id=__codelineno-6-598 name=__codelineno-6-598 href=#__codelineno-6-598></a><span class=s2>    SELECT </span>
</span><span id=__span-6-599><a id=__codelineno-6-599 name=__codelineno-6-599 href=#__codelineno-6-599></a><span class=s2>        best_severity_category,</span>
</span><span id=__span-6-600><a id=__codelineno-6-600 name=__codelineno-6-600 href=#__codelineno-6-600></a><span class=s2>        COUNT(*) as cve_count,</span>
</span><span id=__span-6-601><a id=__codelineno-6-601 name=__codelineno-6-601 href=#__codelineno-6-601></a><span class=s2>        -- CWE statistics</span>
</span><span id=__span-6-602><a id=__codelineno-6-602 name=__codelineno-6-602 href=#__codelineno-6-602></a><span class=s2>        ROUND(AVG(cwe_count), 2) as avg_cwe_count,</span>
</span><span id=__span-6-603><a id=__codelineno-6-603 name=__codelineno-6-603 href=#__codelineno-6-603></a><span class=s2>        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY cwe_count) as median_cwe_count,</span>
</span><span id=__span-6-604><a id=__codelineno-6-604 name=__codelineno-6-604 href=#__codelineno-6-604></a><span class=s2>        MODE() WITHIN GROUP (ORDER BY cwe_count) as mode_cwe_count,</span>
</span><span id=__span-6-605><a id=__codelineno-6-605 name=__codelineno-6-605 href=#__codelineno-6-605></a><span class=s2>        MAX(cwe_count) as max_cwe_count,</span>
</span><span id=__span-6-606><a id=__codelineno-6-606 name=__codelineno-6-606 href=#__codelineno-6-606></a><span class=s2>        -- CPE statistics  </span>
</span><span id=__span-6-607><a id=__codelineno-6-607 name=__codelineno-6-607 href=#__codelineno-6-607></a><span class=s2>        ROUND(AVG(cpe_count), 2) as avg_cpe_count,</span>
</span><span id=__span-6-608><a id=__codelineno-6-608 name=__codelineno-6-608 href=#__codelineno-6-608></a><span class=s2>        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY cpe_count) as median_cpe_count,</span>
</span><span id=__span-6-609><a id=__codelineno-6-609 name=__codelineno-6-609 href=#__codelineno-6-609></a><span class=s2>        MODE() WITHIN GROUP (ORDER BY cpe_count) as mode_cpe_count,</span>
</span><span id=__span-6-610><a id=__codelineno-6-610 name=__codelineno-6-610 href=#__codelineno-6-610></a><span class=s2>        MAX(cpe_count) as max_cpe_count,</span>
</span><span id=__span-6-611><a id=__codelineno-6-611 name=__codelineno-6-611 href=#__codelineno-6-611></a><span class=s2>        -- CVSS score statistics</span>
</span><span id=__span-6-612><a id=__codelineno-6-612 name=__codelineno-6-612 href=#__codelineno-6-612></a><span class=s2>        ROUND(AVG(best_cvss_score), 2) as avg_cvss_score,</span>
</span><span id=__span-6-613><a id=__codelineno-6-613 name=__codelineno-6-613 href=#__codelineno-6-613></a><span class=s2>        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY best_cvss_score) as median_cvss_score</span>
</span><span id=__span-6-614><a id=__codelineno-6-614 name=__codelineno-6-614 href=#__codelineno-6-614></a><span class=s2>    FROM cve_metrics</span>
</span><span id=__span-6-615><a id=__codelineno-6-615 name=__codelineno-6-615 href=#__codelineno-6-615></a><span class=s2>    WHERE best_cvss_score IS NOT NULL</span>
</span><span id=__span-6-616><a id=__codelineno-6-616 name=__codelineno-6-616 href=#__codelineno-6-616></a><span class=s2>    GROUP BY best_severity_category</span>
</span><span id=__span-6-617><a id=__codelineno-6-617 name=__codelineno-6-617 href=#__codelineno-6-617></a><span class=s2>    ORDER BY </span>
</span><span id=__span-6-618><a id=__codelineno-6-618 name=__codelineno-6-618 href=#__codelineno-6-618></a><span class=s2>        CASE best_severity_category</span>
</span><span id=__span-6-619><a id=__codelineno-6-619 name=__codelineno-6-619 href=#__codelineno-6-619></a><span class=s2>            WHEN &#39;Critical (9.0-10.0)&#39; THEN 1</span>
</span><span id=__span-6-620><a id=__codelineno-6-620 name=__codelineno-6-620 href=#__codelineno-6-620></a><span class=s2>            WHEN &#39;High (7.0-8.9)&#39; THEN 2</span>
</span><span id=__span-6-621><a id=__codelineno-6-621 name=__codelineno-6-621 href=#__codelineno-6-621></a><span class=s2>            WHEN &#39;Medium (4.0-6.9)&#39; THEN 3</span>
</span><span id=__span-6-622><a id=__codelineno-6-622 name=__codelineno-6-622 href=#__codelineno-6-622></a><span class=s2>            WHEN &#39;Low (0.1-3.9)&#39; THEN 4</span>
</span><span id=__span-6-623><a id=__codelineno-6-623 name=__codelineno-6-623 href=#__codelineno-6-623></a><span class=s2>            ELSE 5</span>
</span><span id=__span-6-624><a id=__codelineno-6-624 name=__codelineno-6-624 href=#__codelineno-6-624></a><span class=s2>        END</span>
</span><span id=__span-6-625><a id=__codelineno-6-625 name=__codelineno-6-625 href=#__codelineno-6-625></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-6-626><a id=__codelineno-6-626 name=__codelineno-6-626 href=#__codelineno-6-626></a>
</span><span id=__span-6-627><a id=__codelineno-6-627 name=__codelineno-6-627 href=#__codelineno-6-627></a>    <span class=n>enhanced_severity</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>enhanced_severity_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-6-628><a id=__codelineno-6-628 name=__codelineno-6-628 href=#__codelineno-6-628></a>
</span><span id=__span-6-629><a id=__codelineno-6-629 name=__codelineno-6-629 href=#__codelineno-6-629></a>    <span class=c1># 3. ENHANCED: CWE-CPE Type Relationship Analysis</span>
</span><span id=__span-6-630><a id=__codelineno-6-630 name=__codelineno-6-630 href=#__codelineno-6-630></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>3. ENHANCED: CWE-CPE Type Relationship Analysis...&quot;</span><span class=p>)</span>
</span><span id=__span-6-631><a id=__codelineno-6-631 name=__codelineno-6-631 href=#__codelineno-6-631></a>
</span><span id=__span-6-632><a id=__codelineno-6-632 name=__codelineno-6-632 href=#__codelineno-6-632></a>    <span class=n>cwe_cpe_type_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-6-633><a id=__codelineno-6-633 name=__codelineno-6-633 href=#__codelineno-6-633></a><span class=s2>        WITH cwe_expanded AS (</span>
</span><span id=__span-6-634><a id=__codelineno-6-634 name=__codelineno-6-634 href=#__codelineno-6-634></a><span class=s2>        SELECT </span>
</span><span id=__span-6-635><a id=__codelineno-6-635 name=__codelineno-6-635 href=#__codelineno-6-635></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-636><a id=__codelineno-6-636 name=__codelineno-6-636 href=#__codelineno-6-636></a><span class=s2>            TRIM(UNNEST(STRING_SPLIT(cwe_ids, &#39;,&#39;))) as cwe_id</span>
</span><span id=__span-6-637><a id=__codelineno-6-637 name=__codelineno-6-637 href=#__codelineno-6-637></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-6-638><a id=__codelineno-6-638 name=__codelineno-6-638 href=#__codelineno-6-638></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-639><a id=__codelineno-6-639 name=__codelineno-6-639 href=#__codelineno-6-639></a><span class=s2>            AND cwe_ids IS NOT NULL </span>
</span><span id=__span-6-640><a id=__codelineno-6-640 name=__codelineno-6-640 href=#__codelineno-6-640></a><span class=s2>            AND cwe_ids != &#39;&#39;</span>
</span><span id=__span-6-641><a id=__codelineno-6-641 name=__codelineno-6-641 href=#__codelineno-6-641></a><span class=s2>            AND cwe_ids NOT LIKE &#39;NVD-CWE-%&#39;</span>
</span><span id=__span-6-642><a id=__codelineno-6-642 name=__codelineno-6-642 href=#__codelineno-6-642></a><span class=s2>            AND cpes IS NOT NULL</span>
</span><span id=__span-6-643><a id=__codelineno-6-643 name=__codelineno-6-643 href=#__codelineno-6-643></a><span class=s2>            AND cpes != &#39;&#39;</span>
</span><span id=__span-6-644><a id=__codelineno-6-644 name=__codelineno-6-644 href=#__codelineno-6-644></a><span class=s2>    ),</span>
</span><span id=__span-6-645><a id=__codelineno-6-645 name=__codelineno-6-645 href=#__codelineno-6-645></a><span class=s2>    cpe_type_analysis AS (</span>
</span><span id=__span-6-646><a id=__codelineno-6-646 name=__codelineno-6-646 href=#__codelineno-6-646></a><span class=s2>        SELECT </span>
</span><span id=__span-6-647><a id=__codelineno-6-647 name=__codelineno-6-647 href=#__codelineno-6-647></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-648><a id=__codelineno-6-648 name=__codelineno-6-648 href=#__codelineno-6-648></a><span class=s2>            cpes,</span>
</span><span id=__span-6-649><a id=__codelineno-6-649 name=__codelineno-6-649 href=#__codelineno-6-649></a>
</span><span id=__span-6-650><a id=__codelineno-6-650 name=__codelineno-6-650 href=#__codelineno-6-650></a><span class=s2>            -- Count matches via REGEXP_REPLACE + LENGTH trick</span>
</span><span id=__span-6-651><a id=__codelineno-6-651 name=__codelineno-6-651 href=#__codelineno-6-651></a><span class=s2>            LENGTH(REGEXP_REPLACE(cpes, &#39;cpe:/h:|cpe:2</span><span class=se>\\</span><span class=s2>.3:h:&#39;, &#39;x&#39;)) </span>
</span><span id=__span-6-652><a id=__codelineno-6-652 name=__codelineno-6-652 href=#__codelineno-6-652></a><span class=s2>                - LENGTH(REPLACE(REGEXP_REPLACE(cpes, &#39;cpe:/h:|cpe:2</span><span class=se>\\</span><span class=s2>.3:h:&#39;, &#39;x&#39;), &#39;x&#39;, &#39;&#39;)) AS hardware_count,</span>
</span><span id=__span-6-653><a id=__codelineno-6-653 name=__codelineno-6-653 href=#__codelineno-6-653></a>
</span><span id=__span-6-654><a id=__codelineno-6-654 name=__codelineno-6-654 href=#__codelineno-6-654></a><span class=s2>            LENGTH(REGEXP_REPLACE(cpes, &#39;cpe:/o:|cpe:2</span><span class=se>\\</span><span class=s2>.3:o:&#39;, &#39;x&#39;)) </span>
</span><span id=__span-6-655><a id=__codelineno-6-655 name=__codelineno-6-655 href=#__codelineno-6-655></a><span class=s2>                - LENGTH(REPLACE(REGEXP_REPLACE(cpes, &#39;cpe:/o:|cpe:2</span><span class=se>\\</span><span class=s2>.3:o:&#39;, &#39;x&#39;), &#39;x&#39;, &#39;&#39;)) AS os_count,</span>
</span><span id=__span-6-656><a id=__codelineno-6-656 name=__codelineno-6-656 href=#__codelineno-6-656></a>
</span><span id=__span-6-657><a id=__codelineno-6-657 name=__codelineno-6-657 href=#__codelineno-6-657></a><span class=s2>            LENGTH(REGEXP_REPLACE(cpes, &#39;cpe:/a:|cpe:2</span><span class=se>\\</span><span class=s2>.3:a:&#39;, &#39;x&#39;)) </span>
</span><span id=__span-6-658><a id=__codelineno-6-658 name=__codelineno-6-658 href=#__codelineno-6-658></a><span class=s2>                - LENGTH(REPLACE(REGEXP_REPLACE(cpes, &#39;cpe:/a:|cpe:2</span><span class=se>\\</span><span class=s2>.3:a:&#39;, &#39;x&#39;), &#39;x&#39;, &#39;&#39;)) AS app_count,</span>
</span><span id=__span-6-659><a id=__codelineno-6-659 name=__codelineno-6-659 href=#__codelineno-6-659></a>
</span><span id=__span-6-660><a id=__codelineno-6-660 name=__codelineno-6-660 href=#__codelineno-6-660></a><span class=s2>            -- Determine primary type</span>
</span><span id=__span-6-661><a id=__codelineno-6-661 name=__codelineno-6-661 href=#__codelineno-6-661></a><span class=s2>            CASE </span>
</span><span id=__span-6-662><a id=__codelineno-6-662 name=__codelineno-6-662 href=#__codelineno-6-662></a><span class=s2>                WHEN </span>
</span><span id=__span-6-663><a id=__codelineno-6-663 name=__codelineno-6-663 href=#__codelineno-6-663></a><span class=s2>                    (LENGTH(REGEXP_REPLACE(cpes, &#39;cpe:/h:|cpe:2</span><span class=se>\\</span><span class=s2>.3:h:&#39;, &#39;x&#39;)) </span>
</span><span id=__span-6-664><a id=__codelineno-6-664 name=__codelineno-6-664 href=#__codelineno-6-664></a><span class=s2>                    - LENGTH(REPLACE(REGEXP_REPLACE(cpes, &#39;cpe:/h:|cpe:2</span><span class=se>\\</span><span class=s2>.3:h:&#39;, &#39;x&#39;), &#39;x&#39;, &#39;&#39;))) </span>
</span><span id=__span-6-665><a id=__codelineno-6-665 name=__codelineno-6-665 href=#__codelineno-6-665></a><span class=s2>                    &gt; </span>
</span><span id=__span-6-666><a id=__codelineno-6-666 name=__codelineno-6-666 href=#__codelineno-6-666></a><span class=s2>                    (LENGTH(REGEXP_REPLACE(cpes, &#39;cpe:/o:|cpe:2</span><span class=se>\\</span><span class=s2>.3:o:&#39;, &#39;x&#39;)) </span>
</span><span id=__span-6-667><a id=__codelineno-6-667 name=__codelineno-6-667 href=#__codelineno-6-667></a><span class=s2>                    - LENGTH(REPLACE(REGEXP_REPLACE(cpes, &#39;cpe:/o:|cpe:2</span><span class=se>\\</span><span class=s2>.3:o:&#39;, &#39;x&#39;), &#39;x&#39;, &#39;&#39;)))</span>
</span><span id=__span-6-668><a id=__codelineno-6-668 name=__codelineno-6-668 href=#__codelineno-6-668></a><span class=s2>                AND </span>
</span><span id=__span-6-669><a id=__codelineno-6-669 name=__codelineno-6-669 href=#__codelineno-6-669></a><span class=s2>                    (LENGTH(REGEXP_REPLACE(cpes, &#39;cpe:/h:|cpe:2</span><span class=se>\\</span><span class=s2>.3:h:&#39;, &#39;x&#39;)) </span>
</span><span id=__span-6-670><a id=__codelineno-6-670 name=__codelineno-6-670 href=#__codelineno-6-670></a><span class=s2>                    - LENGTH(REPLACE(REGEXP_REPLACE(cpes, &#39;cpe:/h:|cpe:2</span><span class=se>\\</span><span class=s2>.3:h:&#39;, &#39;x&#39;), &#39;x&#39;, &#39;&#39;)))</span>
</span><span id=__span-6-671><a id=__codelineno-6-671 name=__codelineno-6-671 href=#__codelineno-6-671></a><span class=s2>                    &gt; </span>
</span><span id=__span-6-672><a id=__codelineno-6-672 name=__codelineno-6-672 href=#__codelineno-6-672></a><span class=s2>                    (LENGTH(REGEXP_REPLACE(cpes, &#39;cpe:/a:|cpe:2</span><span class=se>\\</span><span class=s2>.3:a:&#39;, &#39;x&#39;)) </span>
</span><span id=__span-6-673><a id=__codelineno-6-673 name=__codelineno-6-673 href=#__codelineno-6-673></a><span class=s2>                    - LENGTH(REPLACE(REGEXP_REPLACE(cpes, &#39;cpe:/a:|cpe:2</span><span class=se>\\</span><span class=s2>.3:a:&#39;, &#39;x&#39;), &#39;x&#39;, &#39;&#39;)))</span>
</span><span id=__span-6-674><a id=__codelineno-6-674 name=__codelineno-6-674 href=#__codelineno-6-674></a><span class=s2>                THEN &#39;Hardware&#39;</span>
</span><span id=__span-6-675><a id=__codelineno-6-675 name=__codelineno-6-675 href=#__codelineno-6-675></a>
</span><span id=__span-6-676><a id=__codelineno-6-676 name=__codelineno-6-676 href=#__codelineno-6-676></a><span class=s2>                WHEN </span>
</span><span id=__span-6-677><a id=__codelineno-6-677 name=__codelineno-6-677 href=#__codelineno-6-677></a><span class=s2>                    (LENGTH(REGEXP_REPLACE(cpes, &#39;cpe:/o:|cpe:2</span><span class=se>\\</span><span class=s2>.3:o:&#39;, &#39;x&#39;)) </span>
</span><span id=__span-6-678><a id=__codelineno-6-678 name=__codelineno-6-678 href=#__codelineno-6-678></a><span class=s2>                    - LENGTH(REPLACE(REGEXP_REPLACE(cpes, &#39;cpe:/o:|cpe:2</span><span class=se>\\</span><span class=s2>.3:o:&#39;, &#39;x&#39;), &#39;x&#39;, &#39;&#39;)))</span>
</span><span id=__span-6-679><a id=__codelineno-6-679 name=__codelineno-6-679 href=#__codelineno-6-679></a><span class=s2>                    &gt; </span>
</span><span id=__span-6-680><a id=__codelineno-6-680 name=__codelineno-6-680 href=#__codelineno-6-680></a><span class=s2>                    (LENGTH(REGEXP_REPLACE(cpes, &#39;cpe:/a:|cpe:2</span><span class=se>\\</span><span class=s2>.3:a:&#39;, &#39;x&#39;)) </span>
</span><span id=__span-6-681><a id=__codelineno-6-681 name=__codelineno-6-681 href=#__codelineno-6-681></a><span class=s2>                    - LENGTH(REPLACE(REGEXP_REPLACE(cpes, &#39;cpe:/a:|cpe:2</span><span class=se>\\</span><span class=s2>.3:a:&#39;, &#39;x&#39;), &#39;x&#39;, &#39;&#39;)))</span>
</span><span id=__span-6-682><a id=__codelineno-6-682 name=__codelineno-6-682 href=#__codelineno-6-682></a><span class=s2>                THEN &#39;Operating System&#39;</span>
</span><span id=__span-6-683><a id=__codelineno-6-683 name=__codelineno-6-683 href=#__codelineno-6-683></a>
</span><span id=__span-6-684><a id=__codelineno-6-684 name=__codelineno-6-684 href=#__codelineno-6-684></a><span class=s2>                WHEN </span>
</span><span id=__span-6-685><a id=__codelineno-6-685 name=__codelineno-6-685 href=#__codelineno-6-685></a><span class=s2>                    (LENGTH(REGEXP_REPLACE(cpes, &#39;cpe:/a:|cpe:2</span><span class=se>\\</span><span class=s2>.3:a:&#39;, &#39;x&#39;)) </span>
</span><span id=__span-6-686><a id=__codelineno-6-686 name=__codelineno-6-686 href=#__codelineno-6-686></a><span class=s2>                    - LENGTH(REPLACE(REGEXP_REPLACE(cpes, &#39;cpe:/a:|cpe:2</span><span class=se>\\</span><span class=s2>.3:a:&#39;, &#39;x&#39;), &#39;x&#39;, &#39;&#39;)))</span>
</span><span id=__span-6-687><a id=__codelineno-6-687 name=__codelineno-6-687 href=#__codelineno-6-687></a><span class=s2>                    &gt; 0</span>
</span><span id=__span-6-688><a id=__codelineno-6-688 name=__codelineno-6-688 href=#__codelineno-6-688></a><span class=s2>                THEN &#39;Application&#39;</span>
</span><span id=__span-6-689><a id=__codelineno-6-689 name=__codelineno-6-689 href=#__codelineno-6-689></a>
</span><span id=__span-6-690><a id=__codelineno-6-690 name=__codelineno-6-690 href=#__codelineno-6-690></a><span class=s2>                ELSE &#39;Mixed/Unknown&#39;</span>
</span><span id=__span-6-691><a id=__codelineno-6-691 name=__codelineno-6-691 href=#__codelineno-6-691></a><span class=s2>            END as primary_cpe_type</span>
</span><span id=__span-6-692><a id=__codelineno-6-692 name=__codelineno-6-692 href=#__codelineno-6-692></a>
</span><span id=__span-6-693><a id=__codelineno-6-693 name=__codelineno-6-693 href=#__codelineno-6-693></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-6-694><a id=__codelineno-6-694 name=__codelineno-6-694 href=#__codelineno-6-694></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-695><a id=__codelineno-6-695 name=__codelineno-6-695 href=#__codelineno-6-695></a><span class=s2>            AND cpes IS NOT NULL</span>
</span><span id=__span-6-696><a id=__codelineno-6-696 name=__codelineno-6-696 href=#__codelineno-6-696></a><span class=s2>            AND cpes != &#39;&#39;</span>
</span><span id=__span-6-697><a id=__codelineno-6-697 name=__codelineno-6-697 href=#__codelineno-6-697></a><span class=s2>    ),</span>
</span><span id=__span-6-698><a id=__codelineno-6-698 name=__codelineno-6-698 href=#__codelineno-6-698></a><span class=s2>    cwe_cpe_type_combinations AS (</span>
</span><span id=__span-6-699><a id=__codelineno-6-699 name=__codelineno-6-699 href=#__codelineno-6-699></a><span class=s2>        SELECT </span>
</span><span id=__span-6-700><a id=__codelineno-6-700 name=__codelineno-6-700 href=#__codelineno-6-700></a><span class=s2>            ce.cwe_id,</span>
</span><span id=__span-6-701><a id=__codelineno-6-701 name=__codelineno-6-701 href=#__codelineno-6-701></a><span class=s2>            cta.primary_cpe_type,</span>
</span><span id=__span-6-702><a id=__codelineno-6-702 name=__codelineno-6-702 href=#__codelineno-6-702></a><span class=s2>            COUNT(DISTINCT ce.cve_id) as cve_count,</span>
</span><span id=__span-6-703><a id=__codelineno-6-703 name=__codelineno-6-703 href=#__codelineno-6-703></a><span class=s2>            ROUND(AVG(cta.hardware_count), 2) as avg_hardware_cpes,</span>
</span><span id=__span-6-704><a id=__codelineno-6-704 name=__codelineno-6-704 href=#__codelineno-6-704></a><span class=s2>            ROUND(AVG(cta.os_count), 2) as avg_os_cpes,</span>
</span><span id=__span-6-705><a id=__codelineno-6-705 name=__codelineno-6-705 href=#__codelineno-6-705></a><span class=s2>            ROUND(AVG(cta.app_count), 2) as avg_app_cpes,</span>
</span><span id=__span-6-706><a id=__codelineno-6-706 name=__codelineno-6-706 href=#__codelineno-6-706></a><span class=s2>            cwe_ref.name as cwe_name</span>
</span><span id=__span-6-707><a id=__codelineno-6-707 name=__codelineno-6-707 href=#__codelineno-6-707></a><span class=s2>        FROM cwe_expanded ce</span>
</span><span id=__span-6-708><a id=__codelineno-6-708 name=__codelineno-6-708 href=#__codelineno-6-708></a><span class=s2>        INNER JOIN cpe_type_analysis cta ON ce.cve_id = cta.cve_id</span>
</span><span id=__span-6-709><a id=__codelineno-6-709 name=__codelineno-6-709 href=#__codelineno-6-709></a><span class=s2>        LEFT JOIN cwe_ref ON ce.cwe_id = cwe_ref.cwe_id</span>
</span><span id=__span-6-710><a id=__codelineno-6-710 name=__codelineno-6-710 href=#__codelineno-6-710></a><span class=s2>        GROUP BY ce.cwe_id, cta.primary_cpe_type, cwe_ref.name</span>
</span><span id=__span-6-711><a id=__codelineno-6-711 name=__codelineno-6-711 href=#__codelineno-6-711></a><span class=s2>        HAVING COUNT(DISTINCT ce.cve_id) &gt;= 5</span>
</span><span id=__span-6-712><a id=__codelineno-6-712 name=__codelineno-6-712 href=#__codelineno-6-712></a><span class=s2>    )</span>
</span><span id=__span-6-713><a id=__codelineno-6-713 name=__codelineno-6-713 href=#__codelineno-6-713></a><span class=s2>    SELECT </span>
</span><span id=__span-6-714><a id=__codelineno-6-714 name=__codelineno-6-714 href=#__codelineno-6-714></a><span class=s2>        cwe_id,</span>
</span><span id=__span-6-715><a id=__codelineno-6-715 name=__codelineno-6-715 href=#__codelineno-6-715></a><span class=s2>        cwe_name,</span>
</span><span id=__span-6-716><a id=__codelineno-6-716 name=__codelineno-6-716 href=#__codelineno-6-716></a><span class=s2>        primary_cpe_type,</span>
</span><span id=__span-6-717><a id=__codelineno-6-717 name=__codelineno-6-717 href=#__codelineno-6-717></a><span class=s2>        cve_count,</span>
</span><span id=__span-6-718><a id=__codelineno-6-718 name=__codelineno-6-718 href=#__codelineno-6-718></a><span class=s2>        avg_hardware_cpes,</span>
</span><span id=__span-6-719><a id=__codelineno-6-719 name=__codelineno-6-719 href=#__codelineno-6-719></a><span class=s2>        avg_os_cpes,</span>
</span><span id=__span-6-720><a id=__codelineno-6-720 name=__codelineno-6-720 href=#__codelineno-6-720></a><span class=s2>        avg_app_cpes</span>
</span><span id=__span-6-721><a id=__codelineno-6-721 name=__codelineno-6-721 href=#__codelineno-6-721></a><span class=s2>    FROM cwe_cpe_type_combinations</span>
</span><span id=__span-6-722><a id=__codelineno-6-722 name=__codelineno-6-722 href=#__codelineno-6-722></a><span class=s2>    ORDER BY cve_count DESC</span>
</span><span id=__span-6-723><a id=__codelineno-6-723 name=__codelineno-6-723 href=#__codelineno-6-723></a><span class=s2>    LIMIT 25;</span>
</span><span id=__span-6-724><a id=__codelineno-6-724 name=__codelineno-6-724 href=#__codelineno-6-724></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-6-725><a id=__codelineno-6-725 name=__codelineno-6-725 href=#__codelineno-6-725></a>
</span><span id=__span-6-726><a id=__codelineno-6-726 name=__codelineno-6-726 href=#__codelineno-6-726></a>    <span class=n>cwe_cpe_type_data</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>cwe_cpe_type_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-6-727><a id=__codelineno-6-727 name=__codelineno-6-727 href=#__codelineno-6-727></a>
</span><span id=__span-6-728><a id=__codelineno-6-728 name=__codelineno-6-728 href=#__codelineno-6-728></a>    <span class=c1># 4. ENHANCED: Top CWE-Vendor Combinations with CPE version support</span>
</span><span id=__span-6-729><a id=__codelineno-6-729 name=__codelineno-6-729 href=#__codelineno-6-729></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>4. ENHANCED: Top CWE-Vendor Combinations (CPE v2.2 &amp; v2.3 support)...&quot;</span><span class=p>)</span>
</span><span id=__span-6-730><a id=__codelineno-6-730 name=__codelineno-6-730 href=#__codelineno-6-730></a>
</span><span id=__span-6-731><a id=__codelineno-6-731 name=__codelineno-6-731 href=#__codelineno-6-731></a>    <span class=n>enhanced_cwe_vendor_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-6-732><a id=__codelineno-6-732 name=__codelineno-6-732 href=#__codelineno-6-732></a><span class=s2>    WITH cwe_expanded AS (</span>
</span><span id=__span-6-733><a id=__codelineno-6-733 name=__codelineno-6-733 href=#__codelineno-6-733></a><span class=s2>        SELECT </span>
</span><span id=__span-6-734><a id=__codelineno-6-734 name=__codelineno-6-734 href=#__codelineno-6-734></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-735><a id=__codelineno-6-735 name=__codelineno-6-735 href=#__codelineno-6-735></a><span class=s2>            TRIM(UNNEST(STRING_SPLIT(cwe_ids, &#39;,&#39;))) as cwe_id</span>
</span><span id=__span-6-736><a id=__codelineno-6-736 name=__codelineno-6-736 href=#__codelineno-6-736></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-6-737><a id=__codelineno-6-737 name=__codelineno-6-737 href=#__codelineno-6-737></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-738><a id=__codelineno-6-738 name=__codelineno-6-738 href=#__codelineno-6-738></a><span class=s2>            AND cwe_ids IS NOT NULL </span>
</span><span id=__span-6-739><a id=__codelineno-6-739 name=__codelineno-6-739 href=#__codelineno-6-739></a><span class=s2>            AND cwe_ids != &#39;&#39;</span>
</span><span id=__span-6-740><a id=__codelineno-6-740 name=__codelineno-6-740 href=#__codelineno-6-740></a><span class=s2>            AND cwe_ids NOT LIKE &#39;NVD-CWE-%&#39;</span>
</span><span id=__span-6-741><a id=__codelineno-6-741 name=__codelineno-6-741 href=#__codelineno-6-741></a><span class=s2>            AND cpes IS NOT NULL</span>
</span><span id=__span-6-742><a id=__codelineno-6-742 name=__codelineno-6-742 href=#__codelineno-6-742></a><span class=s2>            AND cpes != &#39;&#39;</span>
</span><span id=__span-6-743><a id=__codelineno-6-743 name=__codelineno-6-743 href=#__codelineno-6-743></a><span class=s2>    ),</span>
</span><span id=__span-6-744><a id=__codelineno-6-744 name=__codelineno-6-744 href=#__codelineno-6-744></a><span class=s2>    cpe_expanded AS (</span>
</span><span id=__span-6-745><a id=__codelineno-6-745 name=__codelineno-6-745 href=#__codelineno-6-745></a><span class=s2>        SELECT </span>
</span><span id=__span-6-746><a id=__codelineno-6-746 name=__codelineno-6-746 href=#__codelineno-6-746></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-747><a id=__codelineno-6-747 name=__codelineno-6-747 href=#__codelineno-6-747></a><span class=s2>            TRIM(UNNEST(STRING_SPLIT(cpes, &#39;,&#39;))) as cpe_entry</span>
</span><span id=__span-6-748><a id=__codelineno-6-748 name=__codelineno-6-748 href=#__codelineno-6-748></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-6-749><a id=__codelineno-6-749 name=__codelineno-6-749 href=#__codelineno-6-749></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-6-750><a id=__codelineno-6-750 name=__codelineno-6-750 href=#__codelineno-6-750></a><span class=s2>            AND cpes IS NOT NULL</span>
</span><span id=__span-6-751><a id=__codelineno-6-751 name=__codelineno-6-751 href=#__codelineno-6-751></a><span class=s2>            AND cpes != &#39;&#39;</span>
</span><span id=__span-6-752><a id=__codelineno-6-752 name=__codelineno-6-752 href=#__codelineno-6-752></a><span class=s2>    ),</span>
</span><span id=__span-6-753><a id=__codelineno-6-753 name=__codelineno-6-753 href=#__codelineno-6-753></a><span class=s2>    cpe_vendors AS (</span>
</span><span id=__span-6-754><a id=__codelineno-6-754 name=__codelineno-6-754 href=#__codelineno-6-754></a><span class=s2>        SELECT </span>
</span><span id=__span-6-755><a id=__codelineno-6-755 name=__codelineno-6-755 href=#__codelineno-6-755></a><span class=s2>            cve_id,</span>
</span><span id=__span-6-756><a id=__codelineno-6-756 name=__codelineno-6-756 href=#__codelineno-6-756></a><span class=s2>            cpe_entry,</span>
</span><span id=__span-6-757><a id=__codelineno-6-757 name=__codelineno-6-757 href=#__codelineno-6-757></a><span class=s2>            -- Handle both CPE v2.2 (cpe:/) and v2.3 (cpe:2.3:) formats</span>
</span><span id=__span-6-758><a id=__codelineno-6-758 name=__codelineno-6-758 href=#__codelineno-6-758></a><span class=s2>            CASE </span>
</span><span id=__span-6-759><a id=__codelineno-6-759 name=__codelineno-6-759 href=#__codelineno-6-759></a><span class=s2>                WHEN cpe_entry LIKE &#39;cpe:/%&#39; THEN SPLIT_PART(SUBSTR(cpe_entry, 6), &#39;:&#39;, 2)</span>
</span><span id=__span-6-760><a id=__codelineno-6-760 name=__codelineno-6-760 href=#__codelineno-6-760></a><span class=s2>                WHEN cpe_entry LIKE &#39;cpe:2.3:%&#39; THEN SPLIT_PART(cpe_entry, &#39;:&#39;, 4)</span>
</span><span id=__span-6-761><a id=__codelineno-6-761 name=__codelineno-6-761 href=#__codelineno-6-761></a><span class=s2>                ELSE NULL</span>
</span><span id=__span-6-762><a id=__codelineno-6-762 name=__codelineno-6-762 href=#__codelineno-6-762></a><span class=s2>            END as vendor,</span>
</span><span id=__span-6-763><a id=__codelineno-6-763 name=__codelineno-6-763 href=#__codelineno-6-763></a><span class=s2>            -- Extract CPE type</span>
</span><span id=__span-6-764><a id=__codelineno-6-764 name=__codelineno-6-764 href=#__codelineno-6-764></a><span class=s2>            CASE </span>
</span><span id=__span-6-765><a id=__codelineno-6-765 name=__codelineno-6-765 href=#__codelineno-6-765></a><span class=s2>                WHEN cpe_entry LIKE &#39;cpe:/h:%&#39; OR cpe_entry LIKE &#39;cpe:2.3:h:%&#39; THEN &#39;Hardware&#39;</span>
</span><span id=__span-6-766><a id=__codelineno-6-766 name=__codelineno-6-766 href=#__codelineno-6-766></a><span class=s2>                WHEN cpe_entry LIKE &#39;cpe:/o:%&#39; OR cpe_entry LIKE &#39;cpe:2.3:o:%&#39; THEN &#39;Operating System&#39;</span>
</span><span id=__span-6-767><a id=__codelineno-6-767 name=__codelineno-6-767 href=#__codelineno-6-767></a><span class=s2>                WHEN cpe_entry LIKE &#39;cpe:/a:%&#39; OR cpe_entry LIKE &#39;cpe:2.3:a:%&#39; THEN &#39;Application&#39;</span>
</span><span id=__span-6-768><a id=__codelineno-6-768 name=__codelineno-6-768 href=#__codelineno-6-768></a><span class=s2>                ELSE &#39;Unknown&#39;</span>
</span><span id=__span-6-769><a id=__codelineno-6-769 name=__codelineno-6-769 href=#__codelineno-6-769></a><span class=s2>            END as cpe_type</span>
</span><span id=__span-6-770><a id=__codelineno-6-770 name=__codelineno-6-770 href=#__codelineno-6-770></a><span class=s2>        FROM cpe_expanded</span>
</span><span id=__span-6-771><a id=__codelineno-6-771 name=__codelineno-6-771 href=#__codelineno-6-771></a><span class=s2>        WHERE cpe_entry LIKE &#39;cpe:%&#39;</span>
</span><span id=__span-6-772><a id=__codelineno-6-772 name=__codelineno-6-772 href=#__codelineno-6-772></a><span class=s2>    ),</span>
</span><span id=__span-6-773><a id=__codelineno-6-773 name=__codelineno-6-773 href=#__codelineno-6-773></a><span class=s2>    cwe_vendor_combinations AS (</span>
</span><span id=__span-6-774><a id=__codelineno-6-774 name=__codelineno-6-774 href=#__codelineno-6-774></a><span class=s2>        SELECT </span>
</span><span id=__span-6-775><a id=__codelineno-6-775 name=__codelineno-6-775 href=#__codelineno-6-775></a><span class=s2>            ce.cwe_id,</span>
</span><span id=__span-6-776><a id=__codelineno-6-776 name=__codelineno-6-776 href=#__codelineno-6-776></a><span class=s2>            cv.vendor,</span>
</span><span id=__span-6-777><a id=__codelineno-6-777 name=__codelineno-6-777 href=#__codelineno-6-777></a><span class=s2>            cv.cpe_type,</span>
</span><span id=__span-6-778><a id=__codelineno-6-778 name=__codelineno-6-778 href=#__codelineno-6-778></a><span class=s2>            COUNT(DISTINCT ce.cve_id) as cve_count,</span>
</span><span id=__span-6-779><a id=__codelineno-6-779 name=__codelineno-6-779 href=#__codelineno-6-779></a><span class=s2>            COUNT(cv.cpe_entry) as total_cpe_instances,</span>
</span><span id=__span-6-780><a id=__codelineno-6-780 name=__codelineno-6-780 href=#__codelineno-6-780></a><span class=s2>            cwe_ref.name as cwe_name</span>
</span><span id=__span-6-781><a id=__codelineno-6-781 name=__codelineno-6-781 href=#__codelineno-6-781></a><span class=s2>        FROM cwe_expanded ce</span>
</span><span id=__span-6-782><a id=__codelineno-6-782 name=__codelineno-6-782 href=#__codelineno-6-782></a><span class=s2>        INNER JOIN cpe_vendors cv ON ce.cve_id = cv.cve_id</span>
</span><span id=__span-6-783><a id=__codelineno-6-783 name=__codelineno-6-783 href=#__codelineno-6-783></a><span class=s2>        LEFT JOIN cwe_ref ON ce.cwe_id = cwe_ref.cwe_id</span>
</span><span id=__span-6-784><a id=__codelineno-6-784 name=__codelineno-6-784 href=#__codelineno-6-784></a><span class=s2>        WHERE cv.vendor IS NOT NULL</span>
</span><span id=__span-6-785><a id=__codelineno-6-785 name=__codelineno-6-785 href=#__codelineno-6-785></a><span class=s2>            AND cv.vendor != &#39;&#39;</span>
</span><span id=__span-6-786><a id=__codelineno-6-786 name=__codelineno-6-786 href=#__codelineno-6-786></a><span class=s2>            AND cv.vendor != &#39;*&#39;</span>
</span><span id=__span-6-787><a id=__codelineno-6-787 name=__codelineno-6-787 href=#__codelineno-6-787></a><span class=s2>            AND LENGTH(cv.vendor) &gt; 1</span>
</span><span id=__span-6-788><a id=__codelineno-6-788 name=__codelineno-6-788 href=#__codelineno-6-788></a><span class=s2>        GROUP BY ce.cwe_id, cv.vendor, cv.cpe_type, cwe_ref.name</span>
</span><span id=__span-6-789><a id=__codelineno-6-789 name=__codelineno-6-789 href=#__codelineno-6-789></a><span class=s2>        HAVING COUNT(DISTINCT ce.cve_id) &gt;= 10</span>
</span><span id=__span-6-790><a id=__codelineno-6-790 name=__codelineno-6-790 href=#__codelineno-6-790></a><span class=s2>    )</span>
</span><span id=__span-6-791><a id=__codelineno-6-791 name=__codelineno-6-791 href=#__codelineno-6-791></a><span class=s2>    SELECT </span>
</span><span id=__span-6-792><a id=__codelineno-6-792 name=__codelineno-6-792 href=#__codelineno-6-792></a><span class=s2>        cwe_id,</span>
</span><span id=__span-6-793><a id=__codelineno-6-793 name=__codelineno-6-793 href=#__codelineno-6-793></a><span class=s2>        cwe_name,</span>
</span><span id=__span-6-794><a id=__codelineno-6-794 name=__codelineno-6-794 href=#__codelineno-6-794></a><span class=s2>        vendor,</span>
</span><span id=__span-6-795><a id=__codelineno-6-795 name=__codelineno-6-795 href=#__codelineno-6-795></a><span class=s2>        cpe_type,</span>
</span><span id=__span-6-796><a id=__codelineno-6-796 name=__codelineno-6-796 href=#__codelineno-6-796></a><span class=s2>        cve_count,</span>
</span><span id=__span-6-797><a id=__codelineno-6-797 name=__codelineno-6-797 href=#__codelineno-6-797></a><span class=s2>        total_cpe_instances</span>
</span><span id=__span-6-798><a id=__codelineno-6-798 name=__codelineno-6-798 href=#__codelineno-6-798></a><span class=s2>    FROM cwe_vendor_combinations</span>
</span><span id=__span-6-799><a id=__codelineno-6-799 name=__codelineno-6-799 href=#__codelineno-6-799></a><span class=s2>    ORDER BY cve_count DESC</span>
</span><span id=__span-6-800><a id=__codelineno-6-800 name=__codelineno-6-800 href=#__codelineno-6-800></a><span class=s2>    LIMIT 25</span>
</span><span id=__span-6-801><a id=__codelineno-6-801 name=__codelineno-6-801 href=#__codelineno-6-801></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-6-802><a id=__codelineno-6-802 name=__codelineno-6-802 href=#__codelineno-6-802></a>
</span><span id=__span-6-803><a id=__codelineno-6-803 name=__codelineno-6-803 href=#__codelineno-6-803></a>    <span class=n>enhanced_cwe_vendor</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>enhanced_cwe_vendor_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-6-804><a id=__codelineno-6-804 name=__codelineno-6-804 href=#__codelineno-6-804></a>
</span><span id=__span-6-805><a id=__codelineno-6-805 name=__codelineno-6-805 href=#__codelineno-6-805></a>    <span class=c1># 5. Create comprehensive visualizations</span>
</span><span id=__span-6-806><a id=__codelineno-6-806 name=__codelineno-6-806 href=#__codelineno-6-806></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>5. Creating Enhanced Visualizations...&quot;</span><span class=p>)</span>
</span><span id=__span-6-807><a id=__codelineno-6-807 name=__codelineno-6-807 href=#__codelineno-6-807></a>
</span><span id=__span-6-808><a id=__codelineno-6-808 name=__codelineno-6-808 href=#__codelineno-6-808></a>    <span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-6-809><a id=__codelineno-6-809 name=__codelineno-6-809 href=#__codelineno-6-809></a>    <span class=kn>import</span><span class=w> </span><span class=nn>seaborn</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>sns</span>
</span><span id=__span-6-810><a id=__codelineno-6-810 name=__codelineno-6-810 href=#__codelineno-6-810></a>    <span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-6-811><a id=__codelineno-6-811 name=__codelineno-6-811 href=#__codelineno-6-811></a>
</span><span id=__span-6-812><a id=__codelineno-6-812 name=__codelineno-6-812 href=#__codelineno-6-812></a>    <span class=c1># Create multiple figure layouts</span>
</span><span id=__span-6-813><a id=__codelineno-6-813 name=__codelineno-6-813 href=#__codelineno-6-813></a>    <span class=n>fig1</span><span class=p>,</span> <span class=p>((</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>),</span> <span class=p>(</span><span class=n>ax3</span><span class=p>,</span> <span class=n>ax4</span><span class=p>))</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>16</span><span class=p>))</span>
</span><span id=__span-6-814><a id=__codelineno-6-814 name=__codelineno-6-814 href=#__codelineno-6-814></a>
</span><span id=__span-6-815><a id=__codelineno-6-815 name=__codelineno-6-815 href=#__codelineno-6-815></a>    <span class=c1># Plot 1: Enhanced Severity Analysis with Statistical Measures</span>
</span><span id=__span-6-816><a id=__codelineno-6-816 name=__codelineno-6-816 href=#__codelineno-6-816></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>enhanced_severity</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-6-817><a id=__codelineno-6-817 name=__codelineno-6-817 href=#__codelineno-6-817></a>        <span class=n>severities</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;best_severity_category&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-818><a id=__codelineno-6-818 name=__codelineno-6-818 href=#__codelineno-6-818></a>        <span class=n>avg_cpes</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;avg_cpe_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-819><a id=__codelineno-6-819 name=__codelineno-6-819 href=#__codelineno-6-819></a>        <span class=n>median_cpes</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;median_cpe_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-820><a id=__codelineno-6-820 name=__codelineno-6-820 href=#__codelineno-6-820></a>        <span class=n>avg_cwes</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;avg_cwe_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-821><a id=__codelineno-6-821 name=__codelineno-6-821 href=#__codelineno-6-821></a>        <span class=n>median_cwes</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;median_cwe_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-822><a id=__codelineno-6-822 name=__codelineno-6-822 href=#__codelineno-6-822></a>
</span><span id=__span-6-823><a id=__codelineno-6-823 name=__codelineno-6-823 href=#__codelineno-6-823></a>        <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>severities</span><span class=p>))</span>
</span><span id=__span-6-824><a id=__codelineno-6-824 name=__codelineno-6-824 href=#__codelineno-6-824></a>        <span class=n>width</span> <span class=o>=</span> <span class=mf>0.2</span>
</span><span id=__span-6-825><a id=__codelineno-6-825 name=__codelineno-6-825 href=#__codelineno-6-825></a>
</span><span id=__span-6-826><a id=__codelineno-6-826 name=__codelineno-6-826 href=#__codelineno-6-826></a>        <span class=n>bars1</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>width</span><span class=o>*</span><span class=mf>1.5</span><span class=p>,</span> <span class=n>avg_cpes</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Avg CPEs&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;lightcoral&#39;</span><span class=p>)</span>
</span><span id=__span-6-827><a id=__codelineno-6-827 name=__codelineno-6-827 href=#__codelineno-6-827></a>        <span class=n>bars2</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>width</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=n>median_cpes</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Median CPEs&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;darkred&#39;</span><span class=p>)</span>
</span><span id=__span-6-828><a id=__codelineno-6-828 name=__codelineno-6-828 href=#__codelineno-6-828></a>        <span class=n>bars3</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>width</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=n>avg_cwes</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Avg CWEs&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;skyblue&#39;</span><span class=p>)</span>
</span><span id=__span-6-829><a id=__codelineno-6-829 name=__codelineno-6-829 href=#__codelineno-6-829></a>        <span class=n>bars4</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>width</span><span class=o>*</span><span class=mf>1.5</span><span class=p>,</span> <span class=n>median_cwes</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Median CWEs&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;navy&#39;</span><span class=p>)</span>
</span><span id=__span-6-830><a id=__codelineno-6-830 name=__codelineno-6-830 href=#__codelineno-6-830></a>
</span><span id=__span-6-831><a id=__codelineno-6-831 name=__codelineno-6-831 href=#__codelineno-6-831></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;CVSS Severity Category&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-832><a id=__codelineno-6-832 name=__codelineno-6-832 href=#__codelineno-6-832></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Count&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-833><a id=__codelineno-6-833 name=__codelineno-6-833 href=#__codelineno-6-833></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Enhanced Severity Analysis</span><span class=se>\n</span><span class=s1>(Average vs Median CWE/CPE Counts)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-6-834><a id=__codelineno-6-834 name=__codelineno-6-834 href=#__codelineno-6-834></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-6-835><a id=__codelineno-6-835 name=__codelineno-6-835 href=#__codelineno-6-835></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>(</span><span class=n>severities</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;right&#39;</span><span class=p>)</span>
</span><span id=__span-6-836><a id=__codelineno-6-836 name=__codelineno-6-836 href=#__codelineno-6-836></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-6-837><a id=__codelineno-6-837 name=__codelineno-6-837 href=#__codelineno-6-837></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-6-838><a id=__codelineno-6-838 name=__codelineno-6-838 href=#__codelineno-6-838></a>
</span><span id=__span-6-839><a id=__codelineno-6-839 name=__codelineno-6-839 href=#__codelineno-6-839></a>    <span class=c1># Plot 2: CPE Type Distribution</span>
</span><span id=__span-6-840><a id=__codelineno-6-840 name=__codelineno-6-840 href=#__codelineno-6-840></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>enhanced_cooccurrence</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-6-841><a id=__codelineno-6-841 name=__codelineno-6-841 href=#__codelineno-6-841></a>        <span class=n>cpe_type_summary</span> <span class=o>=</span> <span class=n>enhanced_cooccurrence</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;primary_cpe_type&#39;</span><span class=p>)[</span><span class=s1>&#39;cve_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-6-842><a id=__codelineno-6-842 name=__codelineno-6-842 href=#__codelineno-6-842></a>
</span><span id=__span-6-843><a id=__codelineno-6-843 name=__codelineno-6-843 href=#__codelineno-6-843></a>        <span class=n>colors</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>cm</span><span class=o>.</span><span class=n>Set3</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>cpe_type_summary</span><span class=p>)))</span>
</span><span id=__span-6-844><a id=__codelineno-6-844 name=__codelineno-6-844 href=#__codelineno-6-844></a>        <span class=n>wedges</span><span class=p>,</span> <span class=n>texts</span><span class=p>,</span> <span class=n>autotexts</span> <span class=o>=</span> <span class=n>ax2</span><span class=o>.</span><span class=n>pie</span><span class=p>(</span><span class=n>cpe_type_summary</span><span class=o>.</span><span class=n>values</span><span class=p>,</span> 
</span><span id=__span-6-845><a id=__codelineno-6-845 name=__codelineno-6-845 href=#__codelineno-6-845></a>                                          <span class=n>labels</span><span class=o>=</span><span class=n>cpe_type_summary</span><span class=o>.</span><span class=n>index</span><span class=p>,</span>
</span><span id=__span-6-846><a id=__codelineno-6-846 name=__codelineno-6-846 href=#__codelineno-6-846></a>                                          <span class=n>colors</span><span class=o>=</span><span class=n>colors</span><span class=p>,</span> <span class=n>autopct</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%1.1f%%</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>startangle</span><span class=o>=</span><span class=mi>90</span><span class=p>)</span>
</span><span id=__span-6-847><a id=__codelineno-6-847 name=__codelineno-6-847 href=#__codelineno-6-847></a>
</span><span id=__span-6-848><a id=__codelineno-6-848 name=__codelineno-6-848 href=#__codelineno-6-848></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;CVE Distribution by CPE Type</span><span class=se>\n</span><span class=s1>(Hardware/OS/Application)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-6-849><a id=__codelineno-6-849 name=__codelineno-6-849 href=#__codelineno-6-849></a>
</span><span id=__span-6-850><a id=__codelineno-6-850 name=__codelineno-6-850 href=#__codelineno-6-850></a>        <span class=k>for</span> <span class=n>autotext</span> <span class=ow>in</span> <span class=n>autotexts</span><span class=p>:</span>
</span><span id=__span-6-851><a id=__codelineno-6-851 name=__codelineno-6-851 href=#__codelineno-6-851></a>            <span class=n>autotext</span><span class=o>.</span><span class=n>set_color</span><span class=p>(</span><span class=s1>&#39;white&#39;</span><span class=p>)</span>
</span><span id=__span-6-852><a id=__codelineno-6-852 name=__codelineno-6-852 href=#__codelineno-6-852></a>            <span class=n>autotext</span><span class=o>.</span><span class=n>set_fontweight</span><span class=p>(</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-6-853><a id=__codelineno-6-853 name=__codelineno-6-853 href=#__codelineno-6-853></a>
</span><span id=__span-6-854><a id=__codelineno-6-854 name=__codelineno-6-854 href=#__codelineno-6-854></a>    <span class=c1># Plot 3: Top CWE-Vendor-CPE Type Combinations</span>
</span><span id=__span-6-855><a id=__codelineno-6-855 name=__codelineno-6-855 href=#__codelineno-6-855></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>enhanced_cwe_vendor</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-6-856><a id=__codelineno-6-856 name=__codelineno-6-856 href=#__codelineno-6-856></a>        <span class=n>top_combinations</span> <span class=o>=</span> <span class=n>enhanced_cwe_vendor</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>15</span><span class=p>)</span>
</span><span id=__span-6-857><a id=__codelineno-6-857 name=__codelineno-6-857 href=#__codelineno-6-857></a>
</span><span id=__span-6-858><a id=__codelineno-6-858 name=__codelineno-6-858 href=#__codelineno-6-858></a>        <span class=c1># Create labels combining CWE, vendor, and type</span>
</span><span id=__span-6-859><a id=__codelineno-6-859 name=__codelineno-6-859 href=#__codelineno-6-859></a>        <span class=n>labels</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=se>\n</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>title</span><span class=p>()[:</span><span class=mi>10</span><span class=p>]</span><span class=si>}</span><span class=se>\n</span><span class=s2>(</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpe_type&#39;</span><span class=p>][:</span><span class=mi>3</span><span class=p>]</span><span class=si>}</span><span class=s2>)&quot;</span> 
</span><span id=__span-6-860><a id=__codelineno-6-860 name=__codelineno-6-860 href=#__codelineno-6-860></a>                 <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>top_combinations</span><span class=o>.</span><span class=n>iterrows</span><span class=p>()]</span>
</span><span id=__span-6-861><a id=__codelineno-6-861 name=__codelineno-6-861 href=#__codelineno-6-861></a>
</span><span id=__span-6-862><a id=__codelineno-6-862 name=__codelineno-6-862 href=#__codelineno-6-862></a>        <span class=c1># Color by CPE type</span>
</span><span id=__span-6-863><a id=__codelineno-6-863 name=__codelineno-6-863 href=#__codelineno-6-863></a>        <span class=n>colors</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-6-864><a id=__codelineno-6-864 name=__codelineno-6-864 href=#__codelineno-6-864></a>        <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>top_combinations</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-865><a id=__codelineno-6-865 name=__codelineno-6-865 href=#__codelineno-6-865></a>            <span class=k>if</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpe_type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;Hardware&#39;</span><span class=p>:</span>
</span><span id=__span-6-866><a id=__codelineno-6-866 name=__codelineno-6-866 href=#__codelineno-6-866></a>                <span class=n>colors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;#FF6B6B&#39;</span><span class=p>)</span>
</span><span id=__span-6-867><a id=__codelineno-6-867 name=__codelineno-6-867 href=#__codelineno-6-867></a>            <span class=k>elif</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpe_type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;Operating System&#39;</span><span class=p>:</span>
</span><span id=__span-6-868><a id=__codelineno-6-868 name=__codelineno-6-868 href=#__codelineno-6-868></a>                <span class=n>colors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;#4ECDC4&#39;</span><span class=p>)</span> 
</span><span id=__span-6-869><a id=__codelineno-6-869 name=__codelineno-6-869 href=#__codelineno-6-869></a>            <span class=k>elif</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpe_type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;Application&#39;</span><span class=p>:</span>
</span><span id=__span-6-870><a id=__codelineno-6-870 name=__codelineno-6-870 href=#__codelineno-6-870></a>                <span class=n>colors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;#45B7D1&#39;</span><span class=p>)</span>
</span><span id=__span-6-871><a id=__codelineno-6-871 name=__codelineno-6-871 href=#__codelineno-6-871></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-6-872><a id=__codelineno-6-872 name=__codelineno-6-872 href=#__codelineno-6-872></a>                <span class=n>colors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;#FFA07A&#39;</span><span class=p>)</span>
</span><span id=__span-6-873><a id=__codelineno-6-873 name=__codelineno-6-873 href=#__codelineno-6-873></a>
</span><span id=__span-6-874><a id=__codelineno-6-874 name=__codelineno-6-874 href=#__codelineno-6-874></a>        <span class=n>bars</span> <span class=o>=</span> <span class=n>ax3</span><span class=o>.</span><span class=n>barh</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>top_combinations</span><span class=p>)),</span> <span class=n>top_combinations</span><span class=p>[</span><span class=s1>&#39;cve_count&#39;</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=n>colors</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span>
</span><span id=__span-6-875><a id=__codelineno-6-875 name=__codelineno-6-875 href=#__codelineno-6-875></a>
</span><span id=__span-6-876><a id=__codelineno-6-876 name=__codelineno-6-876 href=#__codelineno-6-876></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>top_combinations</span><span class=p>)))</span>
</span><span id=__span-6-877><a id=__codelineno-6-877 name=__codelineno-6-877 href=#__codelineno-6-877></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>(</span><span class=n>labels</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>9</span><span class=p>)</span>
</span><span id=__span-6-878><a id=__codelineno-6-878 name=__codelineno-6-878 href=#__codelineno-6-878></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Number of CVEs&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-879><a id=__codelineno-6-879 name=__codelineno-6-879 href=#__codelineno-6-879></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Top 15 CWE-Vendor-CPE Type Combinations&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-6-880><a id=__codelineno-6-880 name=__codelineno-6-880 href=#__codelineno-6-880></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-6-881><a id=__codelineno-6-881 name=__codelineno-6-881 href=#__codelineno-6-881></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>invert_yaxis</span><span class=p>()</span>
</span><span id=__span-6-882><a id=__codelineno-6-882 name=__codelineno-6-882 href=#__codelineno-6-882></a>
</span><span id=__span-6-883><a id=__codelineno-6-883 name=__codelineno-6-883 href=#__codelineno-6-883></a>        <span class=c1># Add value labels</span>
</span><span id=__span-6-884><a id=__codelineno-6-884 name=__codelineno-6-884 href=#__codelineno-6-884></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>bar</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>bars</span><span class=p>):</span>
</span><span id=__span-6-885><a id=__codelineno-6-885 name=__codelineno-6-885 href=#__codelineno-6-885></a>            <span class=n>width</span> <span class=o>=</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_width</span><span class=p>()</span>
</span><span id=__span-6-886><a id=__codelineno-6-886 name=__codelineno-6-886 href=#__codelineno-6-886></a>            <span class=n>ax3</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=n>width</span> <span class=o>+</span> <span class=nb>max</span><span class=p>(</span><span class=n>top_combinations</span><span class=p>[</span><span class=s1>&#39;cve_count&#39;</span><span class=p>])</span> <span class=o>*</span> <span class=mf>0.01</span><span class=p>,</span> 
</span><span id=__span-6-887><a id=__codelineno-6-887 name=__codelineno-6-887 href=#__codelineno-6-887></a>                    <span class=n>bar</span><span class=o>.</span><span class=n>get_y</span><span class=p>()</span> <span class=o>+</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_height</span><span class=p>()</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-6-888><a id=__codelineno-6-888 name=__codelineno-6-888 href=#__codelineno-6-888></a>                    <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>width</span><span class=p>)</span><span class=si>:</span><span class=s1>,</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>9</span><span class=p>)</span>
</span><span id=__span-6-889><a id=__codelineno-6-889 name=__codelineno-6-889 href=#__codelineno-6-889></a>
</span><span id=__span-6-890><a id=__codelineno-6-890 name=__codelineno-6-890 href=#__codelineno-6-890></a>    <span class=c1># Plot 4: CWE-CPE Type Analysis</span>
</span><span id=__span-6-891><a id=__codelineno-6-891 name=__codelineno-6-891 href=#__codelineno-6-891></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>cwe_cpe_type_data</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-6-892><a id=__codelineno-6-892 name=__codelineno-6-892 href=#__codelineno-6-892></a>        <span class=c1># Group by CWE and show distribution across CPE types</span>
</span><span id=__span-6-893><a id=__codelineno-6-893 name=__codelineno-6-893 href=#__codelineno-6-893></a>        <span class=n>cwe_type_pivot</span> <span class=o>=</span> <span class=n>cwe_cpe_type_data</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
</span><span id=__span-6-894><a id=__codelineno-6-894 name=__codelineno-6-894 href=#__codelineno-6-894></a>            <span class=n>index</span><span class=o>=</span><span class=s1>&#39;cwe_id&#39;</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;primary_cpe_type&#39;</span><span class=p>,</span> <span class=n>values</span><span class=o>=</span><span class=s1>&#39;cve_count&#39;</span><span class=p>,</span> 
</span><span id=__span-6-895><a id=__codelineno-6-895 name=__codelineno-6-895 href=#__codelineno-6-895></a>            <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=mi>0</span>
</span><span id=__span-6-896><a id=__codelineno-6-896 name=__codelineno-6-896 href=#__codelineno-6-896></a>        <span class=p>)</span>
</span><span id=__span-6-897><a id=__codelineno-6-897 name=__codelineno-6-897 href=#__codelineno-6-897></a>
</span><span id=__span-6-898><a id=__codelineno-6-898 name=__codelineno-6-898 href=#__codelineno-6-898></a>        <span class=c1># Select top CWEs by total count</span>
</span><span id=__span-6-899><a id=__codelineno-6-899 name=__codelineno-6-899 href=#__codelineno-6-899></a>        <span class=n>cwe_totals</span> <span class=o>=</span> <span class=n>cwe_type_pivot</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-6-900><a id=__codelineno-6-900 name=__codelineno-6-900 href=#__codelineno-6-900></a>        <span class=n>top_cwes_by_type</span> <span class=o>=</span> <span class=n>cwe_totals</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-901><a id=__codelineno-6-901 name=__codelineno-6-901 href=#__codelineno-6-901></a>
</span><span id=__span-6-902><a id=__codelineno-6-902 name=__codelineno-6-902 href=#__codelineno-6-902></a>        <span class=c1># Plot stacked bar chart</span>
</span><span id=__span-6-903><a id=__codelineno-6-903 name=__codelineno-6-903 href=#__codelineno-6-903></a>        <span class=n>cwe_type_subset</span> <span class=o>=</span> <span class=n>cwe_type_pivot</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>top_cwes_by_type</span><span class=o>.</span><span class=n>index</span><span class=p>]</span>
</span><span id=__span-6-904><a id=__codelineno-6-904 name=__codelineno-6-904 href=#__codelineno-6-904></a>
</span><span id=__span-6-905><a id=__codelineno-6-905 name=__codelineno-6-905 href=#__codelineno-6-905></a>        <span class=n>cwe_type_subset</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>kind</span><span class=o>=</span><span class=s1>&#39;bar&#39;</span><span class=p>,</span> <span class=n>stacked</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax4</span><span class=p>,</span> 
</span><span id=__span-6-906><a id=__codelineno-6-906 name=__codelineno-6-906 href=#__codelineno-6-906></a>                           <span class=n>colormap</span><span class=o>=</span><span class=s1>&#39;Set2&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>)</span>
</span><span id=__span-6-907><a id=__codelineno-6-907 name=__codelineno-6-907 href=#__codelineno-6-907></a>
</span><span id=__span-6-908><a id=__codelineno-6-908 name=__codelineno-6-908 href=#__codelineno-6-908></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Top 12 CWEs by CPE Type Distribution&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-6-909><a id=__codelineno-6-909 name=__codelineno-6-909 href=#__codelineno-6-909></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;CWE ID&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-910><a id=__codelineno-6-910 name=__codelineno-6-910 href=#__codelineno-6-910></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Number of CVEs&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-911><a id=__codelineno-6-911 name=__codelineno-6-911 href=#__codelineno-6-911></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s1>&#39;CPE Type&#39;</span><span class=p>,</span> <span class=n>bbox_to_anchor</span><span class=o>=</span><span class=p>(</span><span class=mf>1.05</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>loc</span><span class=o>=</span><span class=s1>&#39;upper left&#39;</span><span class=p>)</span>
</span><span id=__span-6-912><a id=__codelineno-6-912 name=__codelineno-6-912 href=#__codelineno-6-912></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-6-913><a id=__codelineno-6-913 name=__codelineno-6-913 href=#__codelineno-6-913></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-6-914><a id=__codelineno-6-914 name=__codelineno-6-914 href=#__codelineno-6-914></a>
</span><span id=__span-6-915><a id=__codelineno-6-915 name=__codelineno-6-915 href=#__codelineno-6-915></a>    <span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-6-916><a id=__codelineno-6-916 name=__codelineno-6-916 href=#__codelineno-6-916></a>    <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;enhanced_cwe_cpe_analysis.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span><span id=__span-6-917><a id=__codelineno-6-917 name=__codelineno-6-917 href=#__codelineno-6-917></a>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-6-918><a id=__codelineno-6-918 name=__codelineno-6-918 href=#__codelineno-6-918></a>
</span><span id=__span-6-919><a id=__codelineno-6-919 name=__codelineno-6-919 href=#__codelineno-6-919></a>    <span class=c1># Create second figure for detailed statistical analysis</span>
</span><span id=__span-6-920><a id=__codelineno-6-920 name=__codelineno-6-920 href=#__codelineno-6-920></a>    <span class=n>fig2</span><span class=p>,</span> <span class=p>(</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>)</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span><span id=__span-6-921><a id=__codelineno-6-921 name=__codelineno-6-921 href=#__codelineno-6-921></a>
</span><span id=__span-6-922><a id=__codelineno-6-922 name=__codelineno-6-922 href=#__codelineno-6-922></a>    <span class=c1># Detailed severity statistics comparison</span>
</span><span id=__span-6-923><a id=__codelineno-6-923 name=__codelineno-6-923 href=#__codelineno-6-923></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>enhanced_severity</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-6-924><a id=__codelineno-6-924 name=__codelineno-6-924 href=#__codelineno-6-924></a>        <span class=n>severities</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;best_severity_category&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-925><a id=__codelineno-6-925 name=__codelineno-6-925 href=#__codelineno-6-925></a>
</span><span id=__span-6-926><a id=__codelineno-6-926 name=__codelineno-6-926 href=#__codelineno-6-926></a>        <span class=c1># Plot 1: CWE Statistics (Average, Median, Mode)</span>
</span><span id=__span-6-927><a id=__codelineno-6-927 name=__codelineno-6-927 href=#__codelineno-6-927></a>        <span class=n>avg_cwes</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;avg_cwe_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-928><a id=__codelineno-6-928 name=__codelineno-6-928 href=#__codelineno-6-928></a>        <span class=n>median_cwes</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;median_cwe_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span> 
</span><span id=__span-6-929><a id=__codelineno-6-929 name=__codelineno-6-929 href=#__codelineno-6-929></a>        <span class=n>mode_cwes</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;mode_cwe_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-930><a id=__codelineno-6-930 name=__codelineno-6-930 href=#__codelineno-6-930></a>
</span><span id=__span-6-931><a id=__codelineno-6-931 name=__codelineno-6-931 href=#__codelineno-6-931></a>        <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>severities</span><span class=p>))</span>
</span><span id=__span-6-932><a id=__codelineno-6-932 name=__codelineno-6-932 href=#__codelineno-6-932></a>        <span class=n>width</span> <span class=o>=</span> <span class=mf>0.25</span>
</span><span id=__span-6-933><a id=__codelineno-6-933 name=__codelineno-6-933 href=#__codelineno-6-933></a>
</span><span id=__span-6-934><a id=__codelineno-6-934 name=__codelineno-6-934 href=#__codelineno-6-934></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>width</span><span class=p>,</span> <span class=n>avg_cwes</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Average&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;lightcoral&#39;</span><span class=p>)</span>
</span><span id=__span-6-935><a id=__codelineno-6-935 name=__codelineno-6-935 href=#__codelineno-6-935></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>median_cwes</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Median&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;skyblue&#39;</span><span class=p>)</span>
</span><span id=__span-6-936><a id=__codelineno-6-936 name=__codelineno-6-936 href=#__codelineno-6-936></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>width</span><span class=p>,</span> <span class=n>mode_cwes</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Mode&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;lightgreen&#39;</span><span class=p>)</span>
</span><span id=__span-6-937><a id=__codelineno-6-937 name=__codelineno-6-937 href=#__codelineno-6-937></a>
</span><span id=__span-6-938><a id=__codelineno-6-938 name=__codelineno-6-938 href=#__codelineno-6-938></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;CVSS Severity Category&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-939><a id=__codelineno-6-939 name=__codelineno-6-939 href=#__codelineno-6-939></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;CWE Count&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-940><a id=__codelineno-6-940 name=__codelineno-6-940 href=#__codelineno-6-940></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;CWE Count Statistics by Severity</span><span class=se>\n</span><span class=s1>(Average vs Median vs Mode)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-6-941><a id=__codelineno-6-941 name=__codelineno-6-941 href=#__codelineno-6-941></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-6-942><a id=__codelineno-6-942 name=__codelineno-6-942 href=#__codelineno-6-942></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>(</span><span class=n>severities</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;right&#39;</span><span class=p>)</span>
</span><span id=__span-6-943><a id=__codelineno-6-943 name=__codelineno-6-943 href=#__codelineno-6-943></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-6-944><a id=__codelineno-6-944 name=__codelineno-6-944 href=#__codelineno-6-944></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-6-945><a id=__codelineno-6-945 name=__codelineno-6-945 href=#__codelineno-6-945></a>
</span><span id=__span-6-946><a id=__codelineno-6-946 name=__codelineno-6-946 href=#__codelineno-6-946></a>        <span class=c1># Plot 2: CPE Statistics (Average, Median, Mode)</span>
</span><span id=__span-6-947><a id=__codelineno-6-947 name=__codelineno-6-947 href=#__codelineno-6-947></a>        <span class=n>avg_cpes</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;avg_cpe_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-948><a id=__codelineno-6-948 name=__codelineno-6-948 href=#__codelineno-6-948></a>        <span class=n>median_cpes</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;median_cpe_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-949><a id=__codelineno-6-949 name=__codelineno-6-949 href=#__codelineno-6-949></a>        <span class=n>mode_cpes</span> <span class=o>=</span> <span class=n>enhanced_severity</span><span class=p>[</span><span class=s1>&#39;mode_cpe_count&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-950><a id=__codelineno-6-950 name=__codelineno-6-950 href=#__codelineno-6-950></a>
</span><span id=__span-6-951><a id=__codelineno-6-951 name=__codelineno-6-951 href=#__codelineno-6-951></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>width</span><span class=p>,</span> <span class=n>avg_cpes</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Average&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;lightcoral&#39;</span><span class=p>)</span>
</span><span id=__span-6-952><a id=__codelineno-6-952 name=__codelineno-6-952 href=#__codelineno-6-952></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>median_cpes</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Median&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;skyblue&#39;</span><span class=p>)</span>  
</span><span id=__span-6-953><a id=__codelineno-6-953 name=__codelineno-6-953 href=#__codelineno-6-953></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>width</span><span class=p>,</span> <span class=n>mode_cpes</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Mode&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.8</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;lightgreen&#39;</span><span class=p>)</span>
</span><span id=__span-6-954><a id=__codelineno-6-954 name=__codelineno-6-954 href=#__codelineno-6-954></a>
</span><span id=__span-6-955><a id=__codelineno-6-955 name=__codelineno-6-955 href=#__codelineno-6-955></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;CVSS Severity Category&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-956><a id=__codelineno-6-956 name=__codelineno-6-956 href=#__codelineno-6-956></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;CPE Count&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-6-957><a id=__codelineno-6-957 name=__codelineno-6-957 href=#__codelineno-6-957></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;CPE Count Statistics by Severity</span><span class=se>\n</span><span class=s1>(Average vs Median vs Mode)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-6-958><a id=__codelineno-6-958 name=__codelineno-6-958 href=#__codelineno-6-958></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_xticks</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-6-959><a id=__codelineno-6-959 name=__codelineno-6-959 href=#__codelineno-6-959></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_xticklabels</span><span class=p>(</span><span class=n>severities</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>,</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;right&#39;</span><span class=p>)</span>
</span><span id=__span-6-960><a id=__codelineno-6-960 name=__codelineno-6-960 href=#__codelineno-6-960></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-6-961><a id=__codelineno-6-961 name=__codelineno-6-961 href=#__codelineno-6-961></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-6-962><a id=__codelineno-6-962 name=__codelineno-6-962 href=#__codelineno-6-962></a>
</span><span id=__span-6-963><a id=__codelineno-6-963 name=__codelineno-6-963 href=#__codelineno-6-963></a>    <span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-6-964><a id=__codelineno-6-964 name=__codelineno-6-964 href=#__codelineno-6-964></a>    <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;enhanced_severity_statistics.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span><span id=__span-6-965><a id=__codelineno-6-965 name=__codelineno-6-965 href=#__codelineno-6-965></a>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-6-966><a id=__codelineno-6-966 name=__codelineno-6-966 href=#__codelineno-6-966></a>
</span><span id=__span-6-967><a id=__codelineno-6-967 name=__codelineno-6-967 href=#__codelineno-6-967></a>    <span class=c1># Print comprehensive results</span>
</span><span id=__span-6-968><a id=__codelineno-6-968 name=__codelineno-6-968 href=#__codelineno-6-968></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Enhanced CWE-CPE Co-occurrence Analysis:&quot;</span><span class=p>)</span>
</span><span id=__span-6-969><a id=__codelineno-6-969 name=__codelineno-6-969 href=#__codelineno-6-969></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>120</span><span class=p>)</span>
</span><span id=__span-6-970><a id=__codelineno-6-970 name=__codelineno-6-970 href=#__codelineno-6-970></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;CWE Cat&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CPE Cat&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CPE Type&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CVEs&#39;</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg CWEs&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg CPEs&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;HW&#39;</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;OS&#39;</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;App&#39;</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-971><a id=__codelineno-6-971 name=__codelineno-6-971 href=#__codelineno-6-971></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>120</span><span class=p>)</span>
</span><span id=__span-6-972><a id=__codelineno-6-972 name=__codelineno-6-972 href=#__codelineno-6-972></a>
</span><span id=__span-6-973><a id=__codelineno-6-973 name=__codelineno-6-973 href=#__codelineno-6-973></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>enhanced_cooccurrence</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-974><a id=__codelineno-6-974 name=__codelineno-6-974 href=#__codelineno-6-974></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_category&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpe_category&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;primary_cpe_type&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> &quot;</span>
</span><span id=__span-6-975><a id=__codelineno-6-975 name=__codelineno-6-975 href=#__codelineno-6-975></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_cwe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_cpe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8.1f</span><span class=si>}</span><span class=s2> &quot;</span>
</span><span id=__span-6-976><a id=__codelineno-6-976 name=__codelineno-6-976 href=#__codelineno-6-976></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_hardware_cpes&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;6.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_os_cpes&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;6.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_app_cpes&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;6.1f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-977><a id=__codelineno-6-977 name=__codelineno-6-977 href=#__codelineno-6-977></a>
</span><span id=__span-6-978><a id=__codelineno-6-978 name=__codelineno-6-978 href=#__codelineno-6-978></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Enhanced Severity Analysis with Statistical Measures:&quot;</span><span class=p>)</span>
</span><span id=__span-6-979><a id=__codelineno-6-979 name=__codelineno-6-979 href=#__codelineno-6-979></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>140</span><span class=p>)</span>
</span><span id=__span-6-980><a id=__codelineno-6-980 name=__codelineno-6-980 href=#__codelineno-6-980></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Severity&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CVEs&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg CWEs&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Med CWEs&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Mode CWEs&#39;</span><span class=si>:</span><span class=s2>&lt;9</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg CPEs&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Med CPEs&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Mode CPEs&#39;</span><span class=si>:</span><span class=s2>&lt;9</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg CVSS&#39;</span><span class=si>:</span><span class=s2>&lt;9</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-981><a id=__codelineno-6-981 name=__codelineno-6-981 href=#__codelineno-6-981></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>140</span><span class=p>)</span>
</span><span id=__span-6-982><a id=__codelineno-6-982 name=__codelineno-6-982 href=#__codelineno-6-982></a>
</span><span id=__span-6-983><a id=__codelineno-6-983 name=__codelineno-6-983 href=#__codelineno-6-983></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>enhanced_severity</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-984><a id=__codelineno-6-984 name=__codelineno-6-984 href=#__codelineno-6-984></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;best_severity_category&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_cwe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8.1f</span><span class=si>}</span><span class=s2> &quot;</span>
</span><span id=__span-6-985><a id=__codelineno-6-985 name=__codelineno-6-985 href=#__codelineno-6-985></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;median_cwe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;mode_cwe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;9.0f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_cpe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8.1f</span><span class=si>}</span><span class=s2> &quot;</span>
</span><span id=__span-6-986><a id=__codelineno-6-986 name=__codelineno-6-986 href=#__codelineno-6-986></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;median_cpe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;mode_cpe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;9.0f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_cvss_score&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;9.1f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-987><a id=__codelineno-6-987 name=__codelineno-6-987 href=#__codelineno-6-987></a>
</span><span id=__span-6-988><a id=__codelineno-6-988 name=__codelineno-6-988 href=#__codelineno-6-988></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Enhanced CWE-Vendor-CPE Type Analysis:&quot;</span><span class=p>)</span>
</span><span id=__span-6-989><a id=__codelineno-6-989 name=__codelineno-6-989 href=#__codelineno-6-989></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>120</span><span class=p>)</span>
</span><span id=__span-6-990><a id=__codelineno-6-990 name=__codelineno-6-990 href=#__codelineno-6-990></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;CWE ID&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CWE Name&#39;</span><span class=si>:</span><span class=s2>&lt;35</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Vendor&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CPE Type&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CVEs&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CPE Inst.&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-991><a id=__codelineno-6-991 name=__codelineno-6-991 href=#__codelineno-6-991></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>120</span><span class=p>)</span>
</span><span id=__span-6-992><a id=__codelineno-6-992 name=__codelineno-6-992 href=#__codelineno-6-992></a>
</span><span id=__span-6-993><a id=__codelineno-6-993 name=__codelineno-6-993 href=#__codelineno-6-993></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>enhanced_cwe_vendor</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-994><a id=__codelineno-6-994 name=__codelineno-6-994 href=#__codelineno-6-994></a>        <span class=n>cwe_name</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>])[:</span><span class=mi>33</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>]))</span> <span class=o>&gt;</span> <span class=mi>35</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>])</span>
</span><span id=__span-6-995><a id=__codelineno-6-995 name=__codelineno-6-995 href=#__codelineno-6-995></a>        <span class=n>vendor_name</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>])[:</span><span class=mi>13</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>]))</span> <span class=o>&gt;</span> <span class=mi>15</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>])</span>
</span><span id=__span-6-996><a id=__codelineno-6-996 name=__codelineno-6-996 href=#__codelineno-6-996></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_id&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>cwe_name</span><span class=si>:</span><span class=s2>&lt;35</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>vendor_name</span><span class=o>.</span><span class=n>title</span><span class=p>()</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpe_type&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> &quot;</span>
</span><span id=__span-6-997><a id=__codelineno-6-997 name=__codelineno-6-997 href=#__codelineno-6-997></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;total_cpe_instances&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;10,</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-998><a id=__codelineno-6-998 name=__codelineno-6-998 href=#__codelineno-6-998></a>
</span><span id=__span-6-999><a id=__codelineno-6-999 name=__codelineno-6-999 href=#__codelineno-6-999></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>CWE-CPE Type Distribution Analysis:&quot;</span><span class=p>)</span>
</span><span id=__span-6-1000><a id=__codelineno-6-1000 name=__codelineno-6-1000 href=#__codelineno-6-1000></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span>
</span><span id=__span-6-1001><a id=__codelineno-6-1001 name=__codelineno-6-1001 href=#__codelineno-6-1001></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;CWE ID&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CWE Name&#39;</span><span class=si>:</span><span class=s2>&lt;35</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CPE Type&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CVEs&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg HW&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg OS&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg App&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-1002><a id=__codelineno-6-1002 name=__codelineno-6-1002 href=#__codelineno-6-1002></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span>
</span><span id=__span-6-1003><a id=__codelineno-6-1003 name=__codelineno-6-1003 href=#__codelineno-6-1003></a>
</span><span id=__span-6-1004><a id=__codelineno-6-1004 name=__codelineno-6-1004 href=#__codelineno-6-1004></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>cwe_cpe_type_data</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>15</span><span class=p>)</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-6-1005><a id=__codelineno-6-1005 name=__codelineno-6-1005 href=#__codelineno-6-1005></a>        <span class=n>cwe_name</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>])[:</span><span class=mi>33</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>]))</span> <span class=o>&gt;</span> <span class=mi>35</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_name&#39;</span><span class=p>])</span>
</span><span id=__span-6-1006><a id=__codelineno-6-1006 name=__codelineno-6-1006 href=#__codelineno-6-1006></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cwe_id&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>cwe_name</span><span class=si>:</span><span class=s2>&lt;35</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;primary_cpe_type&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> &quot;</span>
</span><span id=__span-6-1007><a id=__codelineno-6-1007 name=__codelineno-6-1007 href=#__codelineno-6-1007></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_hardware_cpes&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_os_cpes&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_app_cpes&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8.1f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-1008><a id=__codelineno-6-1008 name=__codelineno-6-1008 href=#__codelineno-6-1008></a>
</span><span id=__span-6-1009><a id=__codelineno-6-1009 name=__codelineno-6-1009 href=#__codelineno-6-1009></a>    <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-6-1010><a id=__codelineno-6-1010 name=__codelineno-6-1010 href=#__codelineno-6-1010></a>        <span class=s1>&#39;enhanced_cooccurrence&#39;</span><span class=p>:</span> <span class=n>enhanced_cooccurrence</span><span class=p>,</span>
</span><span id=__span-6-1011><a id=__codelineno-6-1011 name=__codelineno-6-1011 href=#__codelineno-6-1011></a>        <span class=s1>&#39;enhanced_severity&#39;</span><span class=p>:</span> <span class=n>enhanced_severity</span><span class=p>,</span>
</span><span id=__span-6-1012><a id=__codelineno-6-1012 name=__codelineno-6-1012 href=#__codelineno-6-1012></a>        <span class=s1>&#39;cwe_cpe_type_data&#39;</span><span class=p>:</span> <span class=n>cwe_cpe_type_data</span><span class=p>,</span>
</span><span id=__span-6-1013><a id=__codelineno-6-1013 name=__codelineno-6-1013 href=#__codelineno-6-1013></a>        <span class=s1>&#39;enhanced_cwe_vendor&#39;</span><span class=p>:</span> <span class=n>enhanced_cwe_vendor</span>
</span><span id=__span-6-1014><a id=__codelineno-6-1014 name=__codelineno-6-1014 href=#__codelineno-6-1014></a>    <span class=p>}</span>
</span><span id=__span-6-1015><a id=__codelineno-6-1015 name=__codelineno-6-1015 href=#__codelineno-6-1015></a>
</span><span id=__span-6-1016><a id=__codelineno-6-1016 name=__codelineno-6-1016 href=#__codelineno-6-1016></a><span class=c1># Execute both enhanced analyses</span>
</span><span id=__span-6-1017><a id=__codelineno-6-1017 name=__codelineno-6-1017 href=#__codelineno-6-1017></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Starting Enhanced CWE Analysis...&quot;</span><span class=p>)</span>
</span><span id=__span-6-1018><a id=__codelineno-6-1018 name=__codelineno-6-1018 href=#__codelineno-6-1018></a><span class=n>cwe_comparison_results</span> <span class=o>=</span> <span class=n>analyze_cwe_comparison_enhanced</span><span class=p>()</span>
</span><span id=__span-6-1019><a id=__codelineno-6-1019 name=__codelineno-6-1019 href=#__codelineno-6-1019></a><span class=n>cwe_cpe_relationship_results</span> <span class=o>=</span> <span class=n>analyze_cwe_cpe_relationships_enhanced</span><span class=p>()</span>
</span><span id=__span-6-1020><a id=__codelineno-6-1020 name=__codelineno-6-1020 href=#__codelineno-6-1020></a>
</span><span id=__span-6-1021><a id=__codelineno-6-1021 name=__codelineno-6-1021 href=#__codelineno-6-1021></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n\n</span><span class=s2>=== ENHANCED ANALYSIS COMPLETE ===&quot;</span><span class=p>)</span>
</span><span id=__span-6-1022><a id=__codelineno-6-1022 name=__codelineno-6-1022 href=#__codelineno-6-1022></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Generated visualizations:&quot;</span><span class=p>)</span>
</span><span id=__span-6-1023><a id=__codelineno-6-1023 name=__codelineno-6-1023 href=#__codelineno-6-1023></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. enhanced_cwe_cpe_analysis.png - Enhanced CWE-CPE relationship analysis&quot;</span><span class=p>)</span>
</span><span id=__span-6-1024><a id=__codelineno-6-1024 name=__codelineno-6-1024 href=#__codelineno-6-1024></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. enhanced_severity_statistics.png - Statistical measures for severity analysis&quot;</span><span class=p>)</span>
</span><span id=__span-6-1025><a id=__codelineno-6-1025 name=__codelineno-6-1025 href=#__codelineno-6-1025></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Key Enhancements:&quot;</span><span class=p>)</span>
</span><span id=__span-6-1026><a id=__codelineno-6-1026 name=__codelineno-6-1026 href=#__codelineno-6-1026></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;✅ Actual CWE content comparison (not just counts)&quot;</span><span class=p>)</span>
</span><span id=__span-6-1027><a id=__codelineno-6-1027 name=__codelineno-6-1027 href=#__codelineno-6-1027></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;✅ Support for both CPE v2.2 (cpe:/) and v2.3 (cpe:2.3:) formats&quot;</span><span class=p>)</span>
</span><span id=__span-6-1028><a id=__codelineno-6-1028 name=__codelineno-6-1028 href=#__codelineno-6-1028></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;✅ CPE types extracted from actual CPE strings (h/o/a)&quot;</span><span class=p>)</span>
</span><span id=__span-6-1029><a id=__codelineno-6-1029 name=__codelineno-6-1029 href=#__codelineno-6-1029></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;✅ Statistical measures: Average, Median, Mode for CWE/CPE counts&quot;</span><span class=p>)</span>
</span><span id=__span-6-1030><a id=__codelineno-6-1030 name=__codelineno-6-1030 href=#__codelineno-6-1030></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;✅ Both CVSS v2 and v3 analysis&quot;</span><span class=p>)</span>
</span><span id=__span-6-1031><a id=__codelineno-6-1031 name=__codelineno-6-1031 href=#__codelineno-6-1031></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;✅ Enhanced vendor-CPE type analysis&quot;</span><span class=p>)</span>
</span><span id=__span-6-1032><a id=__codelineno-6-1032 name=__codelineno-6-1032 href=#__codelineno-6-1032></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Detailed results have been displayed above for review and interpretation.&quot;</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>Starting Enhanced CWE Analysis...
=== ENHANCED CWE Comparison Analysis: Old vs New Dataset ===

1. Analyzing CWE Distribution in Old Database...
2. Analyzing CWE Distribution in New Database...
3. Creating Side-by-Side CWE Comparison...

Top 15 CWEs - Old vs New Comparison:
====================================================================================================
CWE ID       CWE Name                            Old CVEs   New CVEs   Difference   % Change  
====================================================================================================
CWE-79       Improper Neutralization of Input ... 26727      35275      +8548         +32.0%
CWE-89       Improper Neutralization of Specia... 11356      14642      +3286         +28.9%
CWE-119      Improper Restriction of Operation... 11899      12037      +138          +1.2%
CWE-20       Improper Input Validation           10441      10840      +399          +3.8%
CWE-787      Out-of-bounds Write                 10183      9849       -334         -3.3%
CWE-200      Exposure of Sensitive Information... 7852       8669       +817          +10.4%
CWE-352      Cross-Site Request Forgery (CSRF)   5630       7524       +1894         +33.6%
CWE-125      Out-of-bounds Read                  5864       6879       +1015         +17.3%
CWE-22       Improper Limitation of a Pathname... 5902       6723       +821          +13.9%
CWE-416      Use After Free                      4141       5625       +1484         +35.8%
CWE-264      0                                   5459       5444       -15          -0.3%
CWE-862      Missing Authorization               2306       4513       +2207         +95.7%
CWE-94       Improper Control of Generation of... 3268       4455       +1187         +36.3%
CWE-78       Improper Neutralization of Specia... 3460       4045       +585          +16.9%
CWE-476      NULL Pointer Dereference            2413       3724       +1311         +54.3%

4. ENHANCED: Analyzing Actual CWE Content Changes for Overlapping CVEs...

5. Analyzing Specific Examples of CWE Content Changes...

6. ENHANCED: CWE Coverage Analysis with CVSS v2 and v3...

Enhanced CWE Content Change Analysis:
================================================================================
Change Type     CVE Count    Avg Old CWEs Avg New CWEs Avg Change  
================================================================================
Both Empty      179,732      0.0          0.0          0.0         
Identical       49,599       1.0          1.0          0.0         
Removed CWEs    2,482        1.0          0.0          -1.0        
Added CWEs      451          0.0          1.0          1.0         
Content Changed 152          0.0          0.0          nan

Detailed Examples of CWE Content Changes:
========================================================================================================================
CVE ID          Change Type Old CWEs                                 New CWEs                                
========================================================================================================================
CVE-1999-0006   Modified   NVD-CWE-Other                            CWE-125, NVD-CWE-Other                  
CVE-1999-0011   Modified   NVD-CWE-Other                            CWE-1067, NVD-CWE-Other                 
CVE-1999-0012   Modified   NVD-CWE-Other                            CWE-290, NVD-CWE-Other                  
CVE-1999-0013   Modified   NVD-CWE-Other                            CWE-522, NVD-CWE-Other                  
CVE-1999-0022   Modified   NVD-CWE-Other                            CWE-125, NVD-CWE-Other                  
CVE-1999-0029   Modified   NVD-CWE-Other                            CWE-125, NVD-CWE-Other                  
CVE-1999-0036   Modified   NVD-CWE-Other                            CWE-434, NVD-CWE-Other                  
CVE-1999-0038   Modified   NVD-CWE-Other                            CWE-120, NVD-CWE-Other                  
CVE-1999-0039   Modified   NVD-CWE-Other                            CWE-77, NVD-CWE-Other                   
CVE-1999-0043   Modified   NVD-CWE-Other                            CWE-78, NVD-CWE-Other                   
CVE-1999-0052   Modified   NVD-CWE-Other                            CWE-476, NVD-CWE-Other                  
CVE-1999-0059   Modified   NVD-CWE-Other                            CWE-200, NVD-CWE-Other                  
CVE-1999-0069   Modified   NVD-CWE-Other                            CWE-119, NVD-CWE-Other                  
CVE-1999-0084   Modified   NVD-CWE-Other                            CWE-269, NVD-CWE-Other                  
CVE-1999-0236   Modified   CWE-200                                  NVD-CWE-noinfo

Enhanced Coverage Comparison (CWE + CVSS v2/v3):
========================================================================================================================
Database        Total CVEs CWE %    CVSS v3 %  CVSS v2 %  Any CVSS %
========================================================================================================================
Old Database    232,395    75.4    % 22.3      % 78.7      % 79.6      %
New Database    278,734    80.0    % 72.8      % 67.0      % 98.8      %

8. Enhanced Summary Statistics:
================================================================================
Database Growth: +46,339 CVEs
CWE Coverage Change: +4.6 percentage points
CVSS v3 Coverage Change: +50.5 percentage points
CVSS v2 Coverage Change: -11.8 percentage points

CWE Content Changes for Overlapping CVEs (232,416 total):
  Both Empty: 179,732 CVEs (77.3%)
  Identical: 49,599 CVEs (21.3%)
  Removed CWEs: 2,482 CVEs (1.1%)
  Added CWEs: 451 CVEs (0.2%)
  Content Changed: 152 CVEs (0.1%)

Top 5 CWE Gainers:
  CWE-79 (Improper Neutralization of Inp...): +8548 CVEs (+32.0%)
  CWE-89 (Improper Neutralization of Spe...): +3286 CVEs (+28.9%)
  CWE-119 (Improper Restriction of Operat...): +138 CVEs (+1.2%)
  CWE-20 (Improper Input Validation): +399 CVEs (+3.8%)
  CWE-200 (Exposure of Sensitive Informat...): +817 CVEs (+10.4%)

Top 5 CWE Losers:
  CWE-787 (Out-of-bounds Write): -334 CVEs (-3.3%)
  CWE-264 (0): -15 CVEs (-0.3%)
  CWE-399 (0): -6 CVEs (-0.2%)
  CWE-190 (Integer Overflow or Wraparound): -2326 CVEs (-100.0%)
  CWE-310 (0): -2482 CVEs (-100.0%)

9. Creating Temporal Evolution Analysis...
</code></pre></div> <p><img alt=png src=../difference_between_cwe_old_vs_new_db_files/difference_between_cwe_old_vs_new_db_8_1.png></p> <div class="language-text highlight"><pre><span></span><code>=== ENHANCED CWE-CPE Relationship Analysis ===

1. ENHANCED: Analyzing CWE-CPE Co-occurrence with CPE Types (h/o/a)...



FloatProgress(value=0.0, layout=Layout(width=&#39;auto&#39;), style=ProgressStyle(bar_color=&#39;black&#39;))



2. ENHANCED: Severity Analysis with Statistical Measures (CVSS v2 &amp; v3)...

3. ENHANCED: CWE-CPE Type Relationship Analysis...



FloatProgress(value=0.0, layout=Layout(width=&#39;auto&#39;), style=ProgressStyle(bar_color=&#39;black&#39;))



4. ENHANCED: Top CWE-Vendor Combinations (CPE v2.2 &amp; v2.3 support)...



FloatProgress(value=0.0, layout=Layout(width=&#39;auto&#39;), style=ProgressStyle(bar_color=&#39;black&#39;))



5. Creating Enhanced Visualizations...
</code></pre></div> <p><img alt=png src=../difference_between_cwe_old_vs_new_db_files/difference_between_cwe_old_vs_new_db_8_9.png></p> <p><img alt=png src=../difference_between_cwe_old_vs_new_db_files/difference_between_cwe_old_vs_new_db_8_10.png></p> <div class="language-text highlight"><pre><span></span><code>Enhanced CWE-CPE Co-occurrence Analysis:
========================================================================================================================
CWE Cat  CPE Cat      CPE Type        CVEs   Avg CWEs Avg CPEs HW     OS     App   
========================================================================================================================
1 CWE    1 CPE        Application     88554  1.0      1.0      0.0    0.0    1.2   
1 CWE    2-5 CPEs     Mixed/Unknown   22722  1.0      2.8      0.7    1.9    0.9   
1 CWE    2-5 CPEs     Application     20710  1.0      2.8      0.0    0.0    3.4   
1 CWE    11-50 CPEs   Mixed/Unknown   8896   1.0      22.4     10.0   11.9   6.0   
1 CWE    1 CPE        Operating System 8536   1.0      1.0      0.0    1.2    0.0   
1 CWE    11-50 CPEs   Application     8019   1.0      23.2     0.0    0.0    29.0  
1 CWE    6-10 CPEs    Mixed/Unknown   7756   1.0      7.4      1.6    4.7    2.9   
1 CWE    2-5 CPEs     Operating System 6171   1.0      3.3      0.0    4.1    0.0   
1 CWE    6-10 CPEs    Application     5052   1.0      7.6      0.0    0.0    9.5   
2 CWEs   1 CPE        Application     3645   2.0      1.0      0.0    0.0    1.2   
1 CWE    11-50 CPEs   Operating System 3470   1.0      19.7     0.0    24.6   0.0   
1 CWE    6-10 CPEs    Operating System 2796   1.0      7.5      0.0    9.3    0.0   
1 CWE    51-100 CPEs  Application     2150   1.0      70.1     0.0    0.0    87.7  
1 CWE    51-100 CPEs  Mixed/Unknown   2140   1.0      70.0     30.8   32.5   24.2  
1 CWE    100+ CPEs    Mixed/Unknown   2120   1.0      276.3    154.1  166.1  25.1  
1 CWE    100+ CPEs    Application     1067   1.0      149.1    0.0    0.0    186.4 
2 CWEs   2-5 CPEs     Mixed/Unknown   1015   2.0      2.7      0.8    1.9    0.8   
2 CWEs   1 CPE        Operating System 809    2.0      1.0      0.0    1.2    0.0   
2 CWEs   2-5 CPEs     Application     714    2.0      2.7      0.0    0.0    3.4   
2 CWEs   2-5 CPEs     Operating System 606    2.0      3.5      0.0    4.4    0.0

Enhanced Severity Analysis with Statistical Measures:
============================================================================================================================================
Severity             CVEs     Avg CWEs Med CWEs Mode CWEs Avg CPEs Med CPEs Mode CPEs Avg CVSS 
============================================================================================================================================
Critical (9.0-10.0)  23,735   1.1      1.0      1         7.9      1.0      1         9.7      
High (7.0-8.9)       70,379   1.1      1.0      1         9.9      1.0      1         7.9      
Medium (4.0-6.9)     79,707   1.1      1.0      1         7.1      1.0      1         5.7      
Low (0.1-3.9)        6,417    1.1      1.0      1         4.5      1.0      1         3.2      
No Score             42,708   1.0      1.0      1         15.2     2.0      1         -1.0

Enhanced CWE-Vendor-CPE Type Analysis:
========================================================================================================================
CWE ID       CWE Name                            Vendor          CPE Type        CVEs     CPE Inst. 
========================================================================================================================
CWE-119      Improper Restriction of Operation... Apple           Operating System 1,943    9,037     
CWE-119      Improper Restriction of Operation... Microsoft       Operating System 1,562    5,095     
CWE-79       Improper Neutralization of Input ... Ibm             Application     1,429    14,591    
CWE-787      Out-of-bounds Write                 Google          Operating System 1,360    3,129     
CWE-476      NULL Pointer Dereference            Linux           Operating System 1,268    3,480     
CWE-787      Out-of-bounds Write                 Microsoft       Operating System 1,245    5,346     
CWE-416      Use After Free                      Linux           Operating System 1,173    2,799     
CWE-125      Out-of-bounds Read                  Microsoft       Operating System 1,160    3,621     
CWE-416      Use After Free                      Microsoft       Operating System 1,132    4,228     
CWE-787      Out-of-bounds Write                 Apple           Operating System 1,130    4,066     
CWE-125      Out-of-bounds Read                  Apple           Operating System 1,105    2,997     
CWE-119      Improper Restriction of Operation... Microsoft       Application     1,000    3,629     
CWE-125      Out-of-bounds Read                  Adobe           Application     968      2,704     
CWE-119      Improper Restriction of Operation... Adobe           Application     948      26,249    
CWE-125      Out-of-bounds Read                  Google          Operating System 920      1,820     
CWE-416      Use After Free                      Apple           Operating System 837      1,508     
CWE-119      Improper Restriction of Operation... Apple           Application     835      18,214    
CWE-416      Use After Free                      Google          Application     821      1,807     
CWE-787      Out-of-bounds Write                 Debian          Operating System 812      1,316     
CWE-787      Out-of-bounds Write                 Adobe           Application     763      2,289

CWE-CPE Type Distribution Analysis:
====================================================================================================
CWE ID       CWE Name                            CPE Type        CVEs     Avg HW   Avg OS   Avg App 
====================================================================================================
CWE-79       Improper Neutralization of Input ... Application     28,728   1.0      1.0      1.9     
CWE-89       Improper Neutralization of Specia... Application     13,246   0.4      0.4      1.4     
CWE-119      Improper Restriction of Operation... Application     9,145    2.9      3.2      3.9     
CWE-20       Improper Input Validation           Application     7,149    2.5      2.6      3.4     
CWE-200      Exposure of Sensitive Information... Application     5,974    1.9      2.0      2.9     
CWE-787      Out-of-bounds Write                 Application     5,629    2.1      2.5      3.0     
CWE-352      Cross-Site Request Forgery (CSRF)   Application     5,576    0.5      0.5      1.5     
CWE-22       Improper Limitation of a Pathname... Application     5,494    0.8      0.9      1.8     
CWE-125      Out-of-bounds Read                  Application     4,410    1.8      2.3      2.8     
CWE-264      None                                Application     3,968    2.9      3.0      3.9     
CWE-787      Out-of-bounds Write                 Operating System 3,939    3.5      3.9      2.9     
CWE-94       Improper Control of Generation of... Application     3,556    1.8      1.9      2.8     
CWE-416      Use After Free                      Application     3,398    2.5      3.1      3.5     
CWE-20       Improper Input Validation           Operating System 3,134    17.4     17.9     16.9    
CWE-119      Improper Restriction of Operation... Operating System 2,610    15.7     16.4     15.3


=== ENHANCED ANALYSIS COMPLETE ===
Generated visualizations:
1. enhanced_cwe_cpe_analysis.png - Enhanced CWE-CPE relationship analysis
2. enhanced_severity_statistics.png - Statistical measures for severity analysis

Key Enhancements:
✅ Actual CWE content comparison (not just counts)
✅ Support for both CPE v2.2 (cpe:/) and v2.3 (cpe:2.3:) formats
✅ CPE types extracted from actual CPE strings (h/o/a)
✅ Statistical measures: Average, Median, Mode for CWE/CPE counts
✅ Both CVSS v2 and v3 analysis
✅ Enhanced vendor-CPE type analysis

Detailed results have been displayed above for review and interpretation.
</code></pre></div> <p><em>This analysis demonstrates the evolution of vulnerability classification practices and the continuous improvement in cybersecurity data quality, providing valuable insights for security professionals and researchers.</em></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../cpe-cve-old-vs-new/ class="md-footer__link md-footer__link--prev" aria-label="Previous: CVE-CPE Differences Analysis"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> CVE-CPE Differences Analysis </div> </div> </a> <a href=../exploit-discrepancies-comprehensive/ class="md-footer__link md-footer__link--next" aria-label="Next: Exploit Discrepancies Analysis"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Exploit Discrepancies Analysis </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.50899def.min.js></script> <script src=../../../javascripts/mathjax.js></script> <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?version=4.8.0"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../../javascripts/tablesort.js></script> <script src=../../../javascripts/print.js></script> </body> </html>