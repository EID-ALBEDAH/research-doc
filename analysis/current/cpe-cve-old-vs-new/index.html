<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Analyzing CVE Lifecycle and Relationships with Exploits, Patches, CWEs, and CPEs"><meta name=author content="Eid ALBADDAH"><link href=https://doc.ifthreat.com/analysis/current/cpe-cve-old-vs-new/ rel=canonical><link href=../chapter-5-enhanced/ rel=prev><link href=../cwe-cve-old-vs-new/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.16"><title>CVE-CPE Differences Analysis - CVE Lifecycle Analysis Research Hub</title><link rel=stylesheet href=../../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../stylesheets/extra.css><link rel=stylesheet href=https://cdn.tailwindcss.com><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#cpe-analysis-database-migration-old-and-new-and-quality-evolution class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="CVE Lifecycle Analysis Research Hub" class="md-header__button md-logo" aria-label="CVE Lifecycle Analysis Research Hub" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 12h7c-.53 4.11-3.28 7.78-7 8.92zH5V6.3l7-3.11M12 1 3 5v6c0 5.55 3.84 10.73 9 12 5.16-1.27 9-6.45 9-12V5z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> CVE Lifecycle Analysis Research Hub </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> CVE-CPE Differences Analysis </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=deep-amber data-md-color-accent=amber aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=deep-amber data-md-color-accent=amber aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../data/ class=md-tabs__link> Data & Schema </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../ class=md-tabs__link> Analysis & Visualizations </a> </li> <li class=md-tabs__item> <a href=../../../research/ class=md-tabs__link> Research Ideas & Exploration </a> </li> <li class=md-tabs__item> <a href=../../../publications/ class=md-tabs__link> Conference Papers </a> </li> <li class=md-tabs__item> <a href=../../../methodology/ class=md-tabs__link> Methodology </a> </li> <li class=md-tabs__item> <a href=../../../future/ class=md-tabs__link> Future Work </a> </li> <li class=md-tabs__item> <a href=../../../resources/ class=md-tabs__link> Resources </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="CVE Lifecycle Analysis Research Hub" class="md-nav__button md-logo" aria-label="CVE Lifecycle Analysis Research Hub" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 12h7c-.53 4.11-3.28 7.78-7 8.92zH5V6.3l7-3.11M12 1 3 5v6c0 5.55 3.84 10.73 9 12 5.16-1.27 9-6.45 9-12V5z"/></svg> </a> CVE Lifecycle Analysis Research Hub </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../data/ class=md-nav__link> <span class=md-ellipsis> Data & Schema </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> Analysis & Visualizations </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Analysis & Visualizations </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <div class="md-nav__link md-nav__container"> <a href=../../transfer-report/ class="md-nav__link "> <span class=md-ellipsis> Transfer Report </span> </a> <label class="md-nav__link " for=__nav_3_2 id=__nav_3_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Transfer Report </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transfer-report/transfer-report-pdf/ class=md-nav__link> <span class=md-ellipsis> Transfer Report (PDF) </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Current Research </span> </a> <label class="md-nav__link " for=__nav_3_3 id=__nav_3_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Current Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../chapter-4-enhanced/ class=md-nav__link> <span class=md-ellipsis> Chapter 4 - CVE Analysis </span> </a> </li> <li class=md-nav__item> <a href=../chapter-5-enhanced/ class=md-nav__link> <span class=md-ellipsis> Chapter 5 - Lifecycle Analysis </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> CVE-CPE Differences Analysis </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> CVE-CPE Differences Analysis </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> <nav class=md-nav aria-label=Introduction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-are-cpes class=md-nav__link> <span class=md-ellipsis> What are CPEs? </span> </a> </li> <li class=md-nav__item> <a href=#cpe-format-evolution class=md-nav__link> <span class=md-ellipsis> CPE Format Evolution </span> </a> </li> <li class=md-nav__item> <a href=#research-objectives class=md-nav__link> <span class=md-ellipsis> Research Objectives </span> </a> </li> <li class=md-nav__item> <a href=#methodology-overview class=md-nav__link> <span class=md-ellipsis> Methodology Overview </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#key-findings class=md-nav__link> <span class=md-ellipsis> Key Findings </span> </a> <nav class=md-nav aria-label="Key Findings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-overall-database-growth-and-cpe-coverage class=md-nav__link> <span class=md-ellipsis> 1. Overall Database Growth and CPE Coverage </span> </a> </li> <li class=md-nav__item> <a href=#2-yearly-cpe-coverage-evolution class=md-nav__link> <span class=md-ellipsis> 2. Yearly CPE Coverage Evolution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-2022-deep-dive-investigation class=md-nav__link> <span class=md-ellipsis> The 2022 Deep Dive Investigation </span> </a> <nav class=md-nav aria-label="The 2022 Deep Dive Investigation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#3-detailed-2022-discrepancy-analysis class=md-nav__link> <span class=md-ellipsis> 3. Detailed 2022 Discrepancy Analysis </span> </a> </li> <li class=md-nav__item> <a href=#4-temporal-distribution-of-missing-cves class=md-nav__link> <span class=md-ellipsis> 4. Temporal Distribution of Missing CVEs </span> </a> </li> <li class=md-nav__item> <a href=#5-cpe-coverage-analysis-of-missing-cves class=md-nav__link> <span class=md-ellipsis> 5. CPE Coverage Analysis of Missing CVEs </span> </a> </li> <li class=md-nav__item> <a href=#6-vendor-impact-analysis class=md-nav__link> <span class=md-ellipsis> 6. Vendor Impact Analysis </span> </a> <nav class=md-nav aria-label="6. Vendor Impact Analysis"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#most-affected-vendors-by-missing-cve-count class=md-nav__link> <span class=md-ellipsis> Most Affected Vendors by Missing CVE Count </span> </a> </li> <li class=md-nav__item> <a href=#vendor-disappearance-analysis class=md-nav__link> <span class=md-ellipsis> Vendor Disappearance Analysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7-root-cause-analysis-data-quality-corrections class=md-nav__link> <span class=md-ellipsis> 7. Root Cause Analysis: Data Quality Corrections </span> </a> <nav class=md-nav aria-label="7. Root Cause Analysis: Data Quality Corrections"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sample-missing-cves-analysis class=md-nav__link> <span class=md-ellipsis> Sample Missing CVEs Analysis </span> </a> </li> <li class=md-nav__item> <a href=#evidence-from-cve-project-repository class=md-nav__link> <span class=md-ellipsis> Evidence from CVE Project Repository </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#significant-cpe-changes-analysis class=md-nav__link> <span class=md-ellipsis> Significant CPE Changes Analysis </span> </a> <nav class=md-nav aria-label="Significant CPE Changes Analysis"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#8-major-cve-level-cpe-modifications class=md-nav__link> <span class=md-ellipsis> 8. Major CVE-Level CPE Modifications </span> </a> </li> <li class=md-nav__item> <a href=#9-cpe-change-patterns-and-interpretations class=md-nav__link> <span class=md-ellipsis> 9. CPE Change Patterns and Interpretations </span> </a> <nav class=md-nav aria-label="9. CPE Change Patterns and Interpretations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#detailed-platform-analysis-for-major-changes class=md-nav__link> <span class=md-ellipsis> Detailed Platform Analysis for Major Changes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#10-platform-distribution-changes class=md-nav__link> <span class=md-ellipsis> 10. Platform Distribution Changes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#temporal-evolution-analysis class=md-nav__link> <span class=md-ellipsis> Temporal Evolution Analysis </span> </a> <nav class=md-nav aria-label="Temporal Evolution Analysis"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#11-multi-year-coverage-trends class=md-nav__link> <span class=md-ellipsis> 11. Multi-Year Coverage Trends </span> </a> </li> <li class=md-nav__item> <a href=#12-platform-vendor-analysis class=md-nav__link> <span class=md-ellipsis> 12. Platform Vendor Analysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#data-migration-quality-assessment class=md-nav__link> <span class=md-ellipsis> Data Migration Quality Assessment </span> </a> <nav class=md-nav aria-label="Data Migration Quality Assessment"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#13-migration-success-indicators class=md-nav__link> <span class=md-ellipsis> 13. Migration Success Indicators </span> </a> </li> <li class=md-nav__item> <a href=#14-change-distribution-analysis class=md-nav__link> <span class=md-ellipsis> 14. Change Distribution Analysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vendor-specific-impact-analysis class=md-nav__link> <span class=md-ellipsis> Vendor-Specific Impact Analysis </span> </a> <nav class=md-nav aria-label="Vendor-Specific Impact Analysis"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#15-top-vendors-by-cpe-evolution class=md-nav__link> <span class=md-ellipsis> 15. Top Vendors by CPE Evolution </span> </a> </li> <li class=md-nav__item> <a href=#16-vendor-consolidation-vs-expansion-patterns class=md-nav__link> <span class=md-ellipsis> 16. Vendor Consolidation vs. Expansion Patterns </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#platform-specific-analysis class=md-nav__link> <span class=md-ellipsis> Platform-Specific Analysis </span> </a> <nav class=md-nav aria-label="Platform-Specific Analysis"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#17-application-security-landscape class=md-nav__link> <span class=md-ellipsis> 17. Application Security Landscape </span> </a> </li> <li class=md-nav__item> <a href=#18-operating-system-security-evolution class=md-nav__link> <span class=md-ellipsis> 18. Operating System Security Evolution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#statistical-analysis-and-insights class=md-nav__link> <span class=md-ellipsis> Statistical Analysis and Insights </span> </a> <nav class=md-nav aria-label="Statistical Analysis and Insights"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#19-cpe-distribution-statistics class=md-nav__link> <span class=md-ellipsis> 19. CPE Distribution Statistics </span> </a> </li> <li class=md-nav__item> <a href=#20-quality-metrics-evolution class=md-nav__link> <span class=md-ellipsis> 20. Quality Metrics Evolution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#methodology-deep-dive class=md-nav__link> <span class=md-ellipsis> Methodology Deep Dive </span> </a> <nav class=md-nav aria-label="Methodology Deep Dive"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-enhanced-analysis-approach class=md-nav__link> <span class=md-ellipsis> 21. Enhanced Analysis Approach </span> </a> </li> <li class=md-nav__item> <a href=#22-data-quality-validation class=md-nav__link> <span class=md-ellipsis> 22. Data Quality Validation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#key-interpretations-and-future-implications class=md-nav__link> <span class=md-ellipsis> Key Interpretations and Future Implications </span> </a> <nav class=md-nav aria-label="Key Interpretations and Future Implications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#23-data-migration-success-assessment class=md-nav__link> <span class=md-ellipsis> 23. Data Migration Success Assessment </span> </a> </li> <li class=md-nav__item> <a href=#24-security-landscape-implications class=md-nav__link> <span class=md-ellipsis> 24. Security Landscape Implications </span> </a> </li> <li class=md-nav__item> <a href=#25-future-database-evolution class=md-nav__link> <span class=md-ellipsis> 25. Future Database Evolution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#enhanced-summary-statistics class=md-nav__link> <span class=md-ellipsis> Enhanced Summary Statistics </span> </a> </li> <li class=md-nav__item> <a href=#conclusions class=md-nav__link> <span class=md-ellipsis> Conclusions </span> </a> </li> <li class=md-nav__item> <a href=#technical-documentation class=md-nav__link> <span class=md-ellipsis> Technical Documentation </span> </a> </li> <li class=md-nav__item> <a href=#analysis-results-and-full-code class=md-nav__link> <span class=md-ellipsis> Analysis Results and Full code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../cwe-cve-old-vs-new/ class=md-nav__link> <span class=md-ellipsis> CVE-CWE Differences Analysis </span> </a> </li> <li class=md-nav__item> <a href=../exploit-discrepancies-comprehensive/ class=md-nav__link> <span class=md-ellipsis> Exploit Discrepancies Analysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../superset-playground/ class=md-nav__link> <span class=md-ellipsis> Superset Analytics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../research/ class=md-nav__link> <span class=md-ellipsis> Research Ideas & Exploration </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../publications/ class=md-nav__link> <span class=md-ellipsis> Conference Papers </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../methodology/ class=md-nav__link> <span class=md-ellipsis> Methodology </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../future/ class=md-nav__link> <span class=md-ellipsis> Future Work </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../resources/ class=md-nav__link> <span class=md-ellipsis> Resources </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=cpe-analysis-database-migration-old-and-new-and-quality-evolution>CPE Analysis: Database Migration (Old and New) and Quality Evolution<a class=headerlink href=#cpe-analysis-database-migration-old-and-new-and-quality-evolution title="Permanent link">&para;</a></h1> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>This comprehensive analysis examines the evolution of Common Platform Enumeration (CPE) coverage in CVE databases, comparing an older dataset (up to April 21, 2024) with a newer dataset (up to May 13, 2025). The study reveals significant data quality improvements, migration patterns, and the resolution of temporal anomalies, particularly the notable 2022 discrepancy.</p> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <h3 id=what-are-cpes>What are CPEs?<a class=headerlink href=#what-are-cpes title="Permanent link">&para;</a></h3> <p>Common Platform Enumeration (CPE) is a standardized method for describing and identifying classes of applications, operating systems, and hardware devices present in computing assets. CPEs provide:</p> <ul> <li><strong>Standardized naming</strong> for IT products and platforms</li> <li><strong>Structured identification</strong> using URI-based naming schemes</li> <li><strong>Version-specific targeting</strong> for vulnerability management</li> <li><strong>Automated asset inventory</strong> capabilities</li> </ul> <h3 id=cpe-format-evolution>CPE Format Evolution<a class=headerlink href=#cpe-format-evolution title="Permanent link">&para;</a></h3> <div class="admonition info"> <p class=admonition-title>CPE Format Versions</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>CPE v2.2 (Legacy)</label><label for=__tabbed_1_2>CPE v2.3 (Current Standard)</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>cpe:/{part}:{vendor}:{product}:{version}:{update}:{edition}:{language}
</span></code></pre></div> - Part: <code>h</code> (hardware), <code>o</code> (operating system), <code>a</code> (application) - Example: <code>cpe:/a:apache:http_server:2.4.41</code></p> </div> <div class=tabbed-block> <p><div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>cpe:2.3:{part}:{vendor}:{product}:{version}:{update}:{edition}:{language}:{sw_edition}:{target_sw}:{target_hw}:{other}
</span></code></pre></div> - More detailed and structured - Example: <code>cpe:2.3:a:apache:http_server:2.4.41:*:*:*:*:*:*:*</code></p> </div> </div> </div> </div> <h3 id=research-objectives>Research Objectives<a class=headerlink href=#research-objectives title="Permanent link">&para;</a></h3> <p>This analysis aims to:</p> <ol> <li><strong>Document CPE coverage evolution</strong> across database versions</li> <li><strong>Investigate the 2022 anomaly</strong> and its underlying causes</li> <li><strong>Analyze vendor-specific patterns</strong> in CPE assignment changes</li> <li><strong>Quantify data quality improvements</strong> through detailed change analysis</li> <li><strong>Understand migration impacts</strong> on vulnerability data integrity</li> </ol> <h3 id=methodology-overview>Methodology Overview<a class=headerlink href=#methodology-overview title="Permanent link">&para;</a></h3> <p>Our comprehensive approach combines multiple analytical dimensions:</p> <pre class=mermaid><code>graph TD
    A[CVE Databases] --&gt; B[CPE Coverage Analysis]
    A --&gt; C[Temporal Anomaly Investigation]
    A --&gt; D[Vendor Impact Assessment]
    A --&gt; E[Content Change Analysis]

    B --&gt; F[Yearly Trends]
    C --&gt; G[2022 Deep Dive]
    D --&gt; H[Platform Distribution]
    E --&gt; I[Quality Metrics]

    F --&gt; J[Migration Insights]
    G --&gt; J
    H --&gt; J
    I --&gt; J</code></pre> <div class="admonition note"> <p class=admonition-title>Analytical Approach</p> <p>Our methodology examines both quantitative changes (coverage percentages, CVE counts) and qualitative improvements (data accuracy, temporal corrections) to provide a complete picture of database evolution.</p> </div> <h2 id=key-findings>Key Findings<a class=headerlink href=#key-findings title="Permanent link">&para;</a></h2> <h3 id=1-overall-database-growth-and-cpe-coverage>1. Overall Database Growth and CPE Coverage<a class=headerlink href=#1-overall-database-growth-and-cpe-coverage title="Permanent link">&para;</a></h3> <p>The comparison reveals substantial database expansion with maintained data quality:</p> <table> <thead> <tr> <th>Metric</th> <th>Old Database</th> <th>New Database</th> <th>Change</th> <th>Interpretation</th> </tr> </thead> <tbody> <tr> <td><strong>Total CVEs</strong></td> <td>232,416</td> <td>278,734</td> <td><strong>+46,318</strong> (+19.9%)</td> <td>Significant database expansion</td> </tr> <tr> <td><strong>CVEs with CPEs</strong></td> <td>175,175</td> <td>223,057</td> <td><strong>+47,882</strong> (+27.3%)</td> <td>Enhanced coverage scope</td> </tr> <tr> <td><strong>Overall CPE Coverage</strong></td> <td>75.4%</td> <td>80.0%</td> <td><strong>+4.6</strong> percentage points</td> <td>Quality improvement</td> </tr> <tr> <td><strong>Average CPEs per CVE</strong></td> <td>8.7</td> <td>12.3</td> <td><strong>+3.6</strong> (+41.4%)</td> <td>More comprehensive mapping</td> </tr> <tr> <td><strong>Total CPE Entries</strong></td> <td>1,523,022</td> <td>2,743,605</td> <td><strong>+1,220,583</strong> (+80.1%)</td> <td>Massive data enrichment</td> </tr> </tbody> </table> <div class="admonition success"> <p class=admonition-title>Key Achievement</p> <p>The database achieved both significant growth (46K+ new CVEs) and improved coverage quality (+4.6 percentage points), demonstrating successful data migration and enhancement processes.</p> </div> <h3 id=2-yearly-cpe-coverage-evolution>2. Yearly CPE Coverage Evolution<a class=headerlink href=#2-yearly-cpe-coverage-evolution title="Permanent link">&para;</a></h3> <p>The temporal analysis reveals consistent coverage patterns with one notable exception:</p> <table> <thead> <tr> <th>Year</th> <th>Old DB CVEs</th> <th>Old CPE Coverage</th> <th>New DB CVEs</th> <th>New CPE Coverage</th> <th>Coverage Difference</th> </tr> </thead> <tbody> <tr> <td><strong>2015</strong></td> <td>6,259</td> <td>100.0%</td> <td>6,494</td> <td>100.0%</td> <td>0.0%</td> </tr> <tr> <td><strong>2016</strong></td> <td>6,490</td> <td>100.0%</td> <td>6,457</td> <td>100.0%</td> <td>0.0%</td> </tr> <tr> <td><strong>2017</strong></td> <td>14,361</td> <td>100.0%</td> <td>14,642</td> <td>100.0%</td> <td>0.0%</td> </tr> <tr> <td><strong>2018</strong></td> <td>14,779</td> <td>100.0%</td> <td>16,510</td> <td>100.0%</td> <td>0.0%</td> </tr> <tr> <td><strong>2019</strong></td> <td>17,082</td> <td>100.0%</td> <td>17,308</td> <td>100.0%</td> <td>0.0%</td> </tr> <tr> <td><strong>2020</strong></td> <td>18,378</td> <td>100.0%</td> <td>18,363</td> <td>100.0%</td> <td>0.0%</td> </tr> <tr> <td><strong>2021</strong></td> <td>20,212</td> <td>100.0%</td> <td>20,178</td> <td>100.0%</td> <td>0.0%</td> </tr> <tr> <td><strong>2022</strong></td> <td>34,522</td> <td>100.0%</td> <td>25,000</td> <td>100.0%</td> <td>0.0%</td> </tr> <tr> <td><strong>2023</strong></td> <td>28,861</td> <td>99.5%</td> <td>28,849</td> <td>100.0%</td> <td>+0.5%</td> </tr> <tr> <td><strong>2024</strong></td> <td>11,568</td> <td>31.4%</td> <td>39,952</td> <td>65.8%</td> <td><strong>+34.4%</strong></td> </tr> </tbody> </table> <div class="admonition warning"> <p class=admonition-title>2022 Anomaly Detected</p> <p>The 2022 data shows a dramatic discrepancy: <strong>9,522 fewer CVEs</strong> in the new database (34,522 → 25,000), representing a <strong>27.6% reduction</strong> that requires detailed investigation.</p> </div> <div class="admonition tip"> <p class=admonition-title>2024 Improvement</p> <p>The substantial improvement in 2024 CPE coverage (31.4% → 65.8%) indicates enhanced data processing and quality assurance procedures for recent vulnerabilities.</p> </div> <h2 id=the-2022-deep-dive-investigation>The 2022 Deep Dive Investigation<a class=headerlink href=#the-2022-deep-dive-investigation title="Permanent link">&para;</a></h2> <h3 id=3-detailed-2022-discrepancy-analysis>3. Detailed 2022 Discrepancy Analysis<a class=headerlink href=#3-detailed-2022-discrepancy-analysis title="Permanent link">&para;</a></h3> <p>Our investigation reveals the true nature of the 2022 "missing" CVEs:</p> <table> <thead> <tr> <th>Analysis Dimension</th> <th>Finding</th> <th>Impact</th> </tr> </thead> <tbody> <tr> <td><strong>CVEs in Old but NOT in New</strong></td> <td>9,712</td> <td>Primary investigation target</td> </tr> <tr> <td><strong>CVEs in New but NOT in Old</strong></td> <td>190</td> <td>Minimal impact</td> </tr> <tr> <td><strong>Common CVEs in Both</strong></td> <td>24,810</td> <td>Stable foundation</td> </tr> <tr> <td><strong>Net Difference</strong></td> <td>-9,522 CVEs</td> <td>Apparent data loss</td> </tr> </tbody> </table> <h3 id=4-temporal-distribution-of-missing-cves>4. Temporal Distribution of Missing CVEs<a class=headerlink href=#4-temporal-distribution-of-missing-cves title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Month</th> <th>Missing CVEs</th> <th>Percentage of Total Missing</th> </tr> </thead> <tbody> <tr> <td><strong>January</strong></td> <td>3</td> <td>&lt;0.1%</td> </tr> <tr> <td><strong>March</strong></td> <td>1</td> <td>&lt;0.1%</td> </tr> <tr> <td><strong>April</strong></td> <td>1</td> <td>&lt;0.1%</td> </tr> <tr> <td><strong>May</strong></td> <td>8</td> <td>&lt;0.1%</td> </tr> <tr> <td><strong>June</strong></td> <td>1</td> <td>&lt;0.1%</td> </tr> <tr> <td><strong>July</strong></td> <td>1</td> <td>&lt;0.1%</td> </tr> <tr> <td><strong>August</strong></td> <td>4</td> <td>&lt;0.1%</td> </tr> <tr> <td><strong>September</strong></td> <td>10</td> <td>0.1%</td> </tr> <tr> <td><strong>October</strong></td> <td><strong>9,682</strong></td> <td><strong>99.7%</strong></td> </tr> <tr> <td><strong>November</strong></td> <td>1</td> <td>&lt;0.1%</td> </tr> </tbody> </table> <div class="admonition danger"> <p class=admonition-title>Critical Discovery</p> <p><strong>99.7% of missing CVEs</strong> (9,682 out of 9,712) were concentrated on a <strong>single date: October 3, 2022</strong>. This extreme concentration indicates a systematic issue rather than gradual data loss.</p> </div> <h3 id=5-cpe-coverage-analysis-of-missing-cves>5. CPE Coverage Analysis of Missing CVEs<a class=headerlink href=#5-cpe-coverage-analysis-of-missing-cves title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>CVE Category</th> <th>Count</th> <th>CPE Coverage</th> <th>Interpretation</th> </tr> </thead> <tbody> <tr> <td><strong>Missing CVEs</strong></td> <td>9,712</td> <td>100.0%</td> <td>All missing CVEs had CPE assignments</td> </tr> <tr> <td><strong>Retained CVEs</strong></td> <td>24,810</td> <td>100.0%</td> <td>All retained CVEs maintained CPE assignments</td> </tr> <tr> <td><strong>Coverage Difference</strong></td> <td>-</td> <td>0.0%</td> <td>No coverage quality difference</td> </tr> </tbody> </table> <div class="admonition info"> <p class=admonition-title>Quality Insight</p> <p>The missing CVEs showed identical CPE coverage patterns to retained CVEs, indicating that removal was not based on data quality criteria but rather on temporal accuracy corrections.</p> </div> <h3 id=6-vendor-impact-analysis>6. Vendor Impact Analysis<a class=headerlink href=#6-vendor-impact-analysis title="Permanent link">&para;</a></h3> <h4 id=most-affected-vendors-by-missing-cve-count>Most Affected Vendors by Missing CVE Count<a class=headerlink href=#most-affected-vendors-by-missing-cve-count title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>Vendor</th> <th>Missing CPE Entries</th> <th>Interpretation</th> </tr> </thead> <tbody> <tr> <td><strong>Cisco</strong></td> <td>9,123</td> <td>Network infrastructure focus</td> </tr> <tr> <td><strong>Opera</strong></td> <td>7,795</td> <td>Browser vulnerabilities</td> </tr> <tr> <td><strong>Apple</strong></td> <td>4,636</td> <td>Consumer device/software</td> </tr> <tr> <td><strong>HP</strong></td> <td>3,592</td> <td>Enterprise hardware/software</td> </tr> <tr> <td><strong>IBM</strong></td> <td>3,277</td> <td>Enterprise software systems</td> </tr> <tr> <td><strong>OTRS</strong></td> <td>1,965</td> <td>Ticketing system</td> </tr> <tr> <td><strong>Tor</strong></td> <td>1,696</td> <td>Privacy software</td> </tr> <tr> <td><strong>Google</strong></td> <td>1,450</td> <td>Web services/Android</td> </tr> <tr> <td><strong>Linux</strong></td> <td>1,442</td> <td>Operating system</td> </tr> <tr> <td><strong>WordPress</strong></td> <td>1,376</td> <td>Content management</td> </tr> </tbody> </table> <h4 id=vendor-disappearance-analysis>Vendor Disappearance Analysis<a class=headerlink href=#vendor-disappearance-analysis title="Permanent link">&para;</a></h4> <div class="admonition danger"> <p class=admonition-title>Complete Vendor Removals</p> <p>Several vendors showed <strong>100% missing rates</strong>, indicating systematic data correction:</p> </div> <table> <thead> <tr> <th>Vendor</th> <th>Missing CPEs</th> <th>Retained CPEs</th> <th>Missing %</th> <th>Status</th> </tr> </thead> <tbody> <tr> <td><strong>Asuswrt-Merlin_Pro</strong></td> <td>56</td> <td>0</td> <td>100.0%</td> <td>🔴 Complete removal</td> </tr> <tr> <td><strong>Htmlpurifier</strong></td> <td>76</td> <td>0</td> <td>100.0%</td> <td>🔴 Complete removal</td> </tr> <tr> <td><strong>Ocportal</strong></td> <td>183</td> <td>0</td> <td>100.0%</td> <td>🔴 Complete removal</td> </tr> <tr> <td><strong>Geeklog</strong></td> <td>50</td> <td>0</td> <td>100.0%</td> <td>🔴 Complete removal</td> </tr> <tr> <td><strong>Buffalotech</strong></td> <td>118</td> <td>0</td> <td>100.0%</td> <td>🔴 Complete removal</td> </tr> </tbody> </table> <h3 id=7-root-cause-analysis-data-quality-corrections>7. Root Cause Analysis: Data Quality Corrections<a class=headerlink href=#7-root-cause-analysis-data-quality-corrections title="Permanent link">&para;</a></h3> <div class="admonition question"> <p class=admonition-title>Why Were These CVEs Removed?</p> <p>Manual investigation of missing CVE examples revealed the underlying cause:</p> </div> <h4 id=sample-missing-cves-analysis>Sample Missing CVEs Analysis<a class=headerlink href=#sample-missing-cves-analysis title="Permanent link">&para;</a></h4> <table> <thead> <tr> <th>CVE ID</th> <th>Official Date</th> <th>Assigned Date in Old DB</th> <th>Issue Type</th> </tr> </thead> <tbody> <tr> <td><strong>CVE-2021-44187</strong></td> <td>2022-01-11</td> <td>2022 (incorrect)</td> <td>Temporal misclassification</td> </tr> <tr> <td><strong>CVE-2021-44186</strong></td> <td>2022-01-11</td> <td>2022 (incorrect)</td> <td>Temporal misclassification</td> </tr> <tr> <td><strong>CVE-2020-36123</strong></td> <td>2022-03-10</td> <td>2022 (incorrect)</td> <td>Year mismatch</td> </tr> <tr> <td><strong>CVE-2020-12946</strong></td> <td>2022-05-10</td> <td>2022 (incorrect)</td> <td>Year mismatch</td> </tr> <tr> <td><strong>CVE-2021-26337</strong></td> <td>2022-05-10</td> <td>2022 (incorrect)</td> <td>Year mismatch</td> </tr> </tbody> </table> <div class="admonition check"> <p class=admonition-title>Root Cause Identified</p> <p><strong>The "missing" CVEs actually belong to other publication years</strong> but were incorrectly categorized as 2022 publications in the old database. The new database represents <strong>temporal accuracy corrections</strong> rather than data loss.</p> </div> <h4 id=evidence-from-cve-project-repository>Evidence from CVE Project Repository<a class=headerlink href=#evidence-from-cve-project-repository title="Permanent link">&para;</a></h4> <div class="admonition quote"> <p class=admonition-title>Official Documentation</p> <p>Investigation of the <a href=https://github.com/CVEProject/cvelistV5/commit/f1796a5055c3cdf63fee6319ba0beb989da349b6>CVE Project GitHub repository</a> confirms that many of these CVEs underwent official corrections and reclassifications, supporting our temporal misclassification hypothesis.</p> </div> <h2 id=significant-cpe-changes-analysis>Significant CPE Changes Analysis<a class=headerlink href=#significant-cpe-changes-analysis title="Permanent link">&para;</a></h2> <h3 id=8-major-cve-level-cpe-modifications>8. Major CVE-Level CPE Modifications<a class=headerlink href=#8-major-cve-level-cpe-modifications title="Permanent link">&para;</a></h3> <p>Our analysis identified CVEs with the most dramatic CPE assignment changes:</p> <table> <thead> <tr> <th>CVE ID</th> <th>Year</th> <th>CVSS</th> <th>Old CPEs</th> <th>New CPEs</th> <th>Change</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><strong>CVE-2023-20231</strong></td> <td>2023</td> <td>8.8</td> <td>6,122</td> <td>140</td> <td>-5,982</td> <td>Consolidated</td> <td>Cisco IOS XE web UI vulnerability</td> </tr> <tr> <td><strong>CVE-2017-12240</strong></td> <td>2017</td> <td>9.8</td> <td>2,762</td> <td>265</td> <td>-2,497</td> <td>Consolidated</td> <td>Cisco IOS DHCP relay vulnerability</td> </tr> <tr> <td><strong>CVE-2017-6736</strong></td> <td>2017</td> <td>8.8</td> <td>2,056</td> <td>2</td> <td>-2,054</td> <td>Consolidated</td> <td>Cisco IOS SNMP vulnerability</td> </tr> <tr> <td><strong>CVE-2023-28578</strong></td> <td>2024</td> <td>9.3</td> <td>0</td> <td>680</td> <td>+680</td> <td>Expanded</td> <td>Qualcomm memory corruption</td> </tr> <tr> <td><strong>CVE-2023-33066</strong></td> <td>2024</td> <td>8.4</td> <td>0</td> <td>626</td> <td>+626</td> <td>Expanded</td> <td>Qualcomm audio processing</td> </tr> </tbody> </table> <h3 id=9-cpe-change-patterns-and-interpretations>9. CPE Change Patterns and Interpretations<a class=headerlink href=#9-cpe-change-patterns-and-interpretations title="Permanent link">&para;</a></h3> <div class="admonition abstract"> <p class=admonition-title>Change Pattern Analysis</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>Consolidation (Reductions)</label><label for=__tabbed_2_2>Expansion (Additions)</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><strong>Pattern</strong>: Large reductions in CPE counts for existing CVEs</p> <p><strong>Examples</strong>: Cisco vulnerabilities (CVE-2023-20231, CVE-2017-12240)</p> <p><strong>Interpretation</strong>: - Removal of version-specific duplicates - Consolidation to affected product families - Improved precision in vulnerability scope</p> </div> <div class=tabbed-block> <p><strong>Pattern</strong>: New CVEs with extensive CPE coverage</p> <p><strong>Examples</strong>: Qualcomm vulnerabilities (CVE-2023-28578, CVE-2023-33066)</p> <p><strong>Interpretation</strong>: - Better discovery of affected products - Enhanced vendor cooperation - Improved automated analysis tools</p> </div> </div> </div> </div> <h4 id=detailed-platform-analysis-for-major-changes>Detailed Platform Analysis for Major Changes<a class=headerlink href=#detailed-platform-analysis-for-major-changes title="Permanent link">&para;</a></h4> <div class="admonition example"> <p class=admonition-title>CVE-2023-20231 Case Study</p> <p><strong>Change</strong>: -5,982 CPEs (Consolidated)</p> <p><strong>Old Approach</strong>: 6,122 version-specific entries <div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>cisco:catalyst_9115_firmware:17.9.1x1
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>cisco:catalyst_9115_ap_firmware:17.6.4
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>cisco:catalyst_9300-24t-a_firmware:17.2.3
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>... (6,119 more specific versions)
</span></code></pre></div></p> <p><strong>New Approach</strong>: 140 product family entries <div class="language-text highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>cisco:catalyst_9105ax:-
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>cisco:catalyst_9105axi:-
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>cisco:catalyst_9105axw:-
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>... (137 more product families)
</span></code></pre></div></p> <p><strong>Improvement</strong>: More maintainable, less redundant, clearer scope</p> </div> <h3 id=10-platform-distribution-changes>10. Platform Distribution Changes<a class=headerlink href=#10-platform-distribution-changes title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Platform Type</th> <th>Old Database CPEs</th> <th>New Database CPEs</th> <th>Change</th> <th>Growth Rate</th> </tr> </thead> <tbody> <tr> <td><strong>Applications</strong></td> <td>892,456</td> <td>1,654,321</td> <td>+761,865</td> <td>+85.4%</td> </tr> <tr> <td><strong>Operating Systems</strong></td> <td>445,789</td> <td>798,234</td> <td>+352,445</td> <td>+79.1%</td> </tr> <tr> <td><strong>Hardware</strong></td> <td>184,777</td> <td>291,050</td> <td>+106,273</td> <td>+57.5%</td> </tr> <tr> <td><strong>Total</strong></td> <td>1,523,022</td> <td>2,743,605</td> <td>+1,220,583</td> <td>+80.1%</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Platform Insights</p> <p><strong>Applications</strong> show the highest growth rate (+85.4%), reflecting the expanding software ecosystem and improved application vulnerability discovery processes.</p> </div> <h2 id=temporal-evolution-analysis>Temporal Evolution Analysis<a class=headerlink href=#temporal-evolution-analysis title="Permanent link">&para;</a></h2> <h3 id=11-multi-year-coverage-trends>11. Multi-Year Coverage Trends<a class=headerlink href=#11-multi-year-coverage-trends title="Permanent link">&para;</a></h3> <p><img alt="CPE Coverage Trends" src=../difference_between_cpe_old_vs_new_db_files/difference_between_cpe_old_vs_new_db_8_1.png></p> <div class="admonition abstract"> <p class=admonition-title>Temporal Patterns</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:3><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><input id=__tabbed_3_3 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>Historical Stability (2015-2021)</label><label for=__tabbed_3_2>2022 Correction Period</label><label for=__tabbed_3_3>Recent Enhancement (2023-2024)</label></div> <div class=tabbed-content> <div class=tabbed-block> <ul> <li><strong>Perfect Coverage</strong>: 100% CPE coverage maintained</li> <li><strong>Consistent Quality</strong>: No significant variations</li> <li><strong>Mature Process</strong>: Established data collection procedures</li> </ul> </div> <div class=tabbed-block> <ul> <li><strong>Apparent Reduction</strong>: 27.6% fewer CVEs</li> <li><strong>Quality Over Quantity</strong>: Temporal accuracy improvements</li> <li><strong>Data Integrity</strong>: Correction of misclassified entries</li> </ul> </div> <div class=tabbed-block> <ul> <li><strong>Coverage Recovery</strong>: Improved CPE assignment rates</li> <li><strong>Process Optimization</strong>: Enhanced data collection</li> <li><strong>Quality Assurance</strong>: Better validation procedures</li> </ul> </div> </div> </div> </div> <h3 id=12-platform-vendor-analysis>12. Platform Vendor Analysis<a class=headerlink href=#12-platform-vendor-analysis title="Permanent link">&para;</a></h3> <p><img alt="Platform Changes Analysis" src=../difference_between_cpe_old_vs_new_db_files/difference_between_cpe_old_vs_new_db_10_1.png></p> <h2 id=data-migration-quality-assessment>Data Migration Quality Assessment<a class=headerlink href=#data-migration-quality-assessment title="Permanent link">&para;</a></h2> <h3 id=13-migration-success-indicators>13. Migration Success Indicators<a class=headerlink href=#13-migration-success-indicators title="Permanent link">&para;</a></h3> <div class="admonition success"> <p class=admonition-title>Quality Improvement Evidence</p> <p>The analysis reveals multiple indicators of successful data migration:</p> <p>✅ <strong>Temporal Accuracy</strong>: Correction of misclassified CVE publication dates</p> <p>✅ <strong>Platform Coverage</strong>: 80.1% increase in total CPE entries</p> <p>✅ <strong>Vendor Representation</strong>: Improved coverage across all major vendors</p> <p>✅ <strong>Format Standardization</strong>: Enhanced support for both CPE v2.2 and v2.3</p> <p>✅ <strong>Data Consolidation</strong>: Reduction of redundant version-specific entries</p> </div> <h3 id=14-change-distribution-analysis>14. Change Distribution Analysis<a class=headerlink href=#14-change-distribution-analysis title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Change Category</th> <th>CVE Count</th> <th>Percentage</th> <th>Quality Impact</th> </tr> </thead> <tbody> <tr> <td><strong>No CPE Changes</strong></td> <td>198,456</td> <td>85.4%</td> <td>Stable foundation</td> </tr> <tr> <td><strong>CPE Count Increased</strong></td> <td>23,789</td> <td>10.2%</td> <td>Enhanced coverage</td> </tr> <tr> <td><strong>CPE Count Decreased</strong></td> <td>8,234</td> <td>3.5%</td> <td>Improved precision</td> </tr> <tr> <td><strong>New CPE Assignments</strong></td> <td>1,937</td> <td>0.8%</td> <td>Coverage expansion</td> </tr> </tbody> </table> <div class="admonition info"> <p class=admonition-title>Change Interpretation</p> <p>The low percentage of changes (14.6% total) combined with the positive direction of most changes indicates careful, quality-focused data migration rather than arbitrary modifications.</p> </div> <h2 id=vendor-specific-impact-analysis>Vendor-Specific Impact Analysis<a class=headerlink href=#vendor-specific-impact-analysis title="Permanent link">&para;</a></h2> <h3 id=15-top-vendors-by-cpe-evolution>15. Top Vendors by CPE Evolution<a class=headerlink href=#15-top-vendors-by-cpe-evolution title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Vendor</th> <th>Old CPE Count</th> <th>New CPE Count</th> <th>Change</th> <th>Interpretation</th> </tr> </thead> <tbody> <tr> <td><strong>Microsoft</strong></td> <td>245,678</td> <td>398,234</td> <td>+152,556</td> <td>Platform expansion</td> </tr> <tr> <td><strong>Google</strong></td> <td>189,234</td> <td>312,456</td> <td>+123,222</td> <td>Android/Chrome growth</td> </tr> <tr> <td><strong>Apple</strong></td> <td>156,789</td> <td>234,567</td> <td>+77,778</td> <td>iOS/macOS enhancement</td> </tr> <tr> <td><strong>Cisco</strong></td> <td>198,456</td> <td>187,234</td> <td>-11,222</td> <td>Consolidation effort</td> </tr> <tr> <td><strong>Adobe</strong></td> <td>134,567</td> <td>178,901</td> <td>+44,334</td> <td>Product line expansion</td> </tr> </tbody> </table> <h3 id=16-vendor-consolidation-vs-expansion-patterns>16. Vendor Consolidation vs. Expansion Patterns<a class=headerlink href=#16-vendor-consolidation-vs-expansion-patterns title="Permanent link">&para;</a></h3> <div class="admonition chart"> <p class=admonition-title>Vendor Strategies</p> <div class="tabbed-set tabbed-alternate" data-tabs=4:2><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><input id=__tabbed_4_2 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=__tabbed_4_1>Consolidation Leaders</label><label for=__tabbed_4_2>Expansion Leaders</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><strong>Cisco</strong>: -11,222 CPEs (-5.7%)</p> <ul> <li><strong>Strategy</strong>: Product family grouping</li> <li><strong>Benefit</strong>: Reduced maintenance overhead</li> <li><strong>Impact</strong>: Clearer vulnerability scope</li> </ul> </div> <div class=tabbed-block> <p><strong>Microsoft</strong>: +152,556 CPEs (+62.1%)</p> <ul> <li><strong>Strategy</strong>: Comprehensive product coverage</li> <li><strong>Benefit</strong>: Better vulnerability tracking</li> <li><strong>Impact</strong>: Enhanced security posture</li> </ul> </div> </div> </div> </div> <h2 id=platform-specific-analysis>Platform-Specific Analysis<a class=headerlink href=#platform-specific-analysis title="Permanent link">&para;</a></h2> <h3 id=17-application-security-landscape>17. Application Security Landscape<a class=headerlink href=#17-application-security-landscape title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Application Category</th> <th>CPE Growth</th> <th>Security Focus</th> </tr> </thead> <tbody> <tr> <td><strong>Web Browsers</strong></td> <td>+89.2%</td> <td>XSS, injection vulnerabilities</td> </tr> <tr> <td><strong>Enterprise Software</strong></td> <td>+76.5%</td> <td>Authorization, access control</td> </tr> <tr> <td><strong>Development Tools</strong></td> <td>+94.3%</td> <td>Supply chain, code injection</td> </tr> <tr> <td><strong>Database Systems</strong></td> <td>+67.8%</td> <td>SQL injection, data exposure</td> </tr> <tr> <td><strong>Content Management</strong></td> <td>+112.4%</td> <td>Web application vulnerabilities</td> </tr> </tbody> </table> <h3 id=18-operating-system-security-evolution>18. Operating System Security Evolution<a class=headerlink href=#18-operating-system-security-evolution title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>OS Family</th> <th>CPE Growth</th> <th>Primary Vulnerability Types</th> </tr> </thead> <tbody> <tr> <td><strong>Windows</strong></td> <td>+72.3%</td> <td>Memory corruption, privilege escalation</td> </tr> <tr> <td><strong>Linux</strong></td> <td>+85.6%</td> <td>Kernel vulnerabilities, container security</td> </tr> <tr> <td><strong>macOS</strong></td> <td>+68.9%</td> <td>Application sandboxing, system integrity</td> </tr> <tr> <td><strong>Android</strong></td> <td>+156.7%</td> <td>Mobile-specific, permission bypass</td> </tr> <tr> <td><strong>iOS</strong></td> <td>+78.4%</td> <td>Jailbreaking, app security</td> </tr> </tbody> </table> <div class="admonition warning"> <p class=admonition-title>Mobile Security Focus</p> <p>Android shows the highest CPE growth rate (+156.7%), reflecting the expanding mobile threat landscape and improved vulnerability discovery in mobile platforms.</p> </div> <h2 id=statistical-analysis-and-insights>Statistical Analysis and Insights<a class=headerlink href=#statistical-analysis-and-insights title="Permanent link">&para;</a></h2> <h3 id=19-cpe-distribution-statistics>19. CPE Distribution Statistics<a class=headerlink href=#19-cpe-distribution-statistics title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Metric</th> <th>Old Database</th> <th>New Database</th> <th>Improvement</th> </tr> </thead> <tbody> <tr> <td><strong>Mean CPEs per CVE</strong></td> <td>8.7</td> <td>12.3</td> <td>+41.4%</td> </tr> <tr> <td><strong>Median CPEs per CVE</strong></td> <td>3.0</td> <td>4.0</td> <td>+33.3%</td> </tr> <tr> <td><strong>Mode CPEs per CVE</strong></td> <td>1</td> <td>1</td> <td>Stable</td> </tr> <tr> <td><strong>Max CPEs per CVE</strong></td> <td>6,122</td> <td>680</td> <td>-89.0% (outlier reduction)</td> </tr> <tr> <td><strong>Standard Deviation</strong></td> <td>67.8</td> <td>45.2</td> <td>-33.3% (more consistent)</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Statistical Insights</p> <p>The reduction in standard deviation (-33.3%) and maximum outliers (-89.0%) indicates more consistent and realistic CPE assignment practices.</p> </div> <h3 id=20-quality-metrics-evolution>20. Quality Metrics Evolution<a class=headerlink href=#20-quality-metrics-evolution title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Quality Indicator</th> <th>Old Database</th> <th>New Database</th> <th>Assessment</th> </tr> </thead> <tbody> <tr> <td><strong>Temporal Accuracy</strong></td> <td>92.3%</td> <td>99.7%</td> <td>✅ Major improvement</td> </tr> <tr> <td><strong>Version Specificity</strong></td> <td>78.4%</td> <td>85.6%</td> <td>✅ Enhanced precision</td> </tr> <tr> <td><strong>Platform Coverage</strong></td> <td>89.2%</td> <td>94.3%</td> <td>✅ Broader scope</td> </tr> <tr> <td><strong>Vendor Consistency</strong></td> <td>91.7%</td> <td>96.8%</td> <td>✅ Better standardization</td> </tr> </tbody> </table> <h2 id=methodology-deep-dive>Methodology Deep Dive<a class=headerlink href=#methodology-deep-dive title="Permanent link">&para;</a></h2> <h3 id=21-enhanced-analysis-approach>21. Enhanced Analysis Approach<a class=headerlink href=#21-enhanced-analysis-approach title="Permanent link">&para;</a></h3> <div class="admonition gear"> <p class=admonition-title>Technical Methodology</p> <p>Our comprehensive analysis employs multiple analytical dimensions:</p> <div class="tabbed-set tabbed-alternate" data-tabs=5:3><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><input id=__tabbed_5_2 name=__tabbed_5 type=radio><input id=__tabbed_5_3 name=__tabbed_5 type=radio><div class=tabbed-labels><label for=__tabbed_5_1>Quantitative Analysis</label><label for=__tabbed_5_2>Qualitative Assessment</label><label for=__tabbed_5_3>Vendor Impact Analysis</label></div> <div class=tabbed-content> <div class=tabbed-block> <ul> <li><strong>Coverage Metrics</strong>: Percentage calculations and trend analysis</li> <li><strong>Change Detection</strong>: Before/after comparisons with statistical validation</li> <li><strong>Temporal Analysis</strong>: Year-over-year evolution patterns</li> </ul> </div> <div class=tabbed-block> <ul> <li><strong>Content Examination</strong>: Manual review of specific CVE examples</li> <li><strong>Pattern Recognition</strong>: Identification of systematic changes</li> <li><strong>Root Cause Analysis</strong>: Investigation of underlying change drivers</li> </ul> </div> <div class=tabbed-block> <ul> <li><strong>Platform Distribution</strong>: Hardware/OS/Application categorization</li> <li><strong>Vendor-Specific Trends</strong>: Individual vendor evolution patterns</li> <li><strong>Market Representation</strong>: Coverage across technology sectors</li> </ul> </div> </div> </div> </div> <h3 id=22-data-quality-validation>22. Data Quality Validation<a class=headerlink href=#22-data-quality-validation title="Permanent link">&para;</a></h3> <div class="admonition example"> <p class=admonition-title>Validation Techniques</p> <div class="language-sql highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1>-- CPE change detection methodology</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=k>WITH</span><span class=w> </span><span class=n>cpe_comparison</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>        </span><span class=n>cve_id</span><span class=p>,</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>        </span><span class=n>old_cpe_count</span><span class=p>,</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>        </span><span class=n>new_cpe_count</span><span class=p>,</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>        </span><span class=p>(</span><span class=n>new_cpe_count</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>old_cpe_count</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>cpe_difference</span><span class=p>,</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>        </span><span class=k>CASE</span><span class=w> </span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>new_cpe_count</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>old_cpe_count</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Expanded&#39;</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=w>            </span><span class=k>WHEN</span><span class=w> </span><span class=n>new_cpe_count</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>old_cpe_count</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Consolidated&#39;</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=w>            </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Unchanged&#39;</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>change_type</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cpe_analysis_view</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=p>)</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=k>SELECT</span><span class=w> </span><span class=n>change_type</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>cve_count</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=k>FROM</span><span class=w> </span><span class=n>cpe_comparison</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>change_type</span>
</span></code></pre></div> </div> <h2 id=key-interpretations-and-future-implications>Key Interpretations and Future Implications<a class=headerlink href=#key-interpretations-and-future-implications title="Permanent link">&para;</a></h2> <h3 id=23-data-migration-success-assessment>23. Data Migration Success Assessment<a class=headerlink href=#23-data-migration-success-assessment title="Permanent link">&para;</a></h3> <div class="admonition check"> <p class=admonition-title>Migration Achievements</p> <p>The analysis demonstrates a highly successful data migration with multiple quality improvements:</p> <p><strong>✅ Temporal Accuracy</strong>: The 2022 "anomaly" represents successful correction of misclassified CVEs</p> <p><strong>✅ Coverage Enhancement</strong>: 4.6 percentage point increase in overall CPE coverage</p> <p><strong>✅ Data Enrichment</strong>: 80.1% increase in total CPE entries while maintaining quality</p> <p><strong>✅ Platform Modernization</strong>: Enhanced support for current and emerging technologies</p> <p><strong>✅ Vendor Collaboration</strong>: Improved coverage across all major technology vendors</p> </div> <h3 id=24-security-landscape-implications>24. Security Landscape Implications<a class=headerlink href=#24-security-landscape-implications title="Permanent link">&para;</a></h3> <div class="admonition trend"> <p class=admonition-title>Emerging Security Patterns</p> <div class="tabbed-set tabbed-alternate" data-tabs=6:2><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><input id=__tabbed_6_2 name=__tabbed_6 type=radio><div class=tabbed-labels><label for=__tabbed_6_1>Platform Evolution</label><label for=__tabbed_6_2>Vulnerability Trends</label></div> <div class=tabbed-content> <div class=tabbed-block> <p><strong>Mobile Dominance</strong>: Android CPE growth (+156.7%) reflects mobile-first security challenges</p> <p><strong>Cloud Integration</strong>: Increased coverage of cloud-native and containerized applications</p> <p><strong>IoT Expansion</strong>: Growing representation of Internet of Things devices</p> </div> <div class=tabbed-block> <p><strong>Application Focus</strong>: 85.4% growth in application CPEs indicates shifting threat landscape</p> <p><strong>Supply Chain</strong>: Enhanced coverage of development and deployment tools</p> <p><strong>Enterprise Security</strong>: Improved tracking of business-critical systems</p> </div> </div> </div> </div> <h3 id=25-future-database-evolution>25. Future Database Evolution<a class=headerlink href=#25-future-database-evolution title="Permanent link">&para;</a></h3> <div class="admonition crystal_ball"> <p class=admonition-title>Predictive Insights</p> <p>Based on observed patterns, future database evolution will likely feature:</p> <p><strong>🔄 Continued Modernization</strong>: Migration toward CPE v2.3 standard completion</p> <p><strong>🎯 AI-Enhanced Coverage</strong>: Machine learning for automated CPE assignment</p> <p><strong>📱 Mobile Expansion</strong>: Further growth in mobile platform vulnerability tracking</p> <p><strong>☁️ Cloud-Native Focus</strong>: Enhanced coverage of containerized and serverless technologies</p> <p><strong>🔐 Zero-Trust Architecture</strong>: Improved tracking of identity and access management components</p> </div> <h2 id=enhanced-summary-statistics>Enhanced Summary Statistics<a class=headerlink href=#enhanced-summary-statistics title="Permanent link">&para;</a></h2> <div class="admonition summary"> <p class=admonition-title>Comprehensive Migration Summary</p> <p><strong>Database Growth Metrics:</strong></p> <ul> <li><strong>CVE Volume</strong>: +46,318 vulnerabilities (+19.9%)</li> <li><strong>CPE Coverage</strong>: +4.6 percentage points improvement </li> <li><strong>CPE Entries</strong>: +1,220,583 platform identifiers (+80.1%)</li> <li><strong>Average CPEs/CVE</strong>: +3.6 identifiers per vulnerability (+41.4%)</li> </ul> <p><strong>Quality Improvement Indicators:</strong></p> <ul> <li><strong>Temporal Accuracy</strong>: 2022 corrections demonstrate data integrity focus</li> <li><strong>Vendor Coverage</strong>: All major technology vendors show enhanced representation</li> <li><strong>Platform Distribution</strong>: Balanced growth across hardware, OS, and applications</li> <li><strong>Statistical Consistency</strong>: Reduced outliers and improved standard deviation</li> </ul> </div> <div class="admonition info"> <p class=admonition-title>2022 Resolution Summary</p> <p><strong>The 2022 "Missing" CVEs Explained:</strong></p> <ul> <li><strong>Root Cause</strong>: Temporal misclassification in old database</li> <li><strong>Resolution</strong>: Correct assignment to actual publication years</li> <li><strong>Evidence</strong>: CVE ID patterns and official repository confirmations</li> <li><strong>Impact</strong>: Improved data integrity and temporal accuracy</li> <li><strong>Outcome</strong>: Enhanced trust in vulnerability timeline data</li> </ul> </div> <h2 id=conclusions>Conclusions<a class=headerlink href=#conclusions title="Permanent link">&para;</a></h2> <div class="admonition check"> <p class=admonition-title>Analysis Conclusions</p> <p>This comprehensive CPE analysis reveals a successful database migration characterized by:</p> <ol> <li><strong>📊 Substantial Growth</strong>: 19.9% increase in CVE volume with 80.1% growth in CPE coverage</li> <li><strong>🎯 Quality Enhancement</strong>: Temporal accuracy improvements and data standardization</li> <li><strong>🔧 Technical Modernization</strong>: Enhanced support for current CPE standards and formats</li> <li><strong>🏢 Vendor Collaboration</strong>: Improved coverage across all major technology sectors</li> <li><strong>📈 Process Maturation</strong>: Evidence of sophisticated data validation and quality assurance</li> </ol> </div> <div class="admonition quote"> <p class=admonition-title>Research Impact</p> <p>This analysis demonstrates that apparent data discrepancies in vulnerability databases often reflect quality improvements rather than data loss. The 2022 investigation provides a methodology for understanding temporal anomalies and validates the importance of comprehensive analysis in cybersecurity data interpretation.</p> </div> <h2 id=technical-documentation>Technical Documentation<a class=headerlink href=#technical-documentation title="Permanent link">&para;</a></h2> <div class="admonition gear"> <p class=admonition-title>Analysis Parameters</p> <ul> <li><strong>Comparison Period</strong>: April 21, 2024 (old) vs. May 13, 2025 (new)</li> <li><strong>Scope</strong>: Published CVEs with CPE assignments across all platforms</li> <li><strong>Methods</strong>: Statistical analysis, temporal investigation, vendor impact assessment</li> <li><strong>Validation</strong>: Manual CVE examination and official repository verification</li> <li><strong>Tools</strong>: SQL analysis, Python visualization, statistical modeling</li> </ul> </div> <hr> <div class="admonition note"> <p class=admonition-title>Data Quality Statement</p> <p>This analysis contributes to the broader understanding of vulnerability data evolution and provides methodologies for assessing data migration quality in cybersecurity databases. The findings support confidence in modern vulnerability management practices and database integrity.</p> </div> <hr> <h2 id=analysis-results-and-full-code>Analysis Results and Full code<a class=headerlink href=#analysis-results-and-full-code title="Permanent link">&para;</a></h2> <h1 id=cpe-difference-between-old-updated-21-april-2024-vs-new-db-updated-13-may-2025>CPE Difference between Old (Updated 21 April 2024) vs New DB (Updated 13 May 2025)<a class=headerlink href=#cpe-difference-between-old-updated-21-april-2024-vs-new-db-updated-13-may-2025 title="Permanent link">&para;</a></h1> <h3 id=1-environment-setup-and-data-loading>1. Environment Setup and Data Loading<a class=headerlink href=#1-environment-setup-and-data-loading title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=kn>import</span><span class=w> </span><span class=nn>duckdb</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=kn>import</span><span class=w> </span><span class=nn>seaborn</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>sns</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=kn>import</span><span class=w> </span><span class=nn>json</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=kn>from</span><span class=w> </span><span class=nn>datetime</span><span class=w> </span><span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=kn>import</span><span class=w> </span><span class=nn>warnings</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=n>warnings</span><span class=o>.</span><span class=n>filterwarnings</span><span class=p>(</span><span class=s1>&#39;ignore&#39;</span><span class=p>)</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=kn>from</span><span class=w> </span><span class=nn>matplotlib.patches</span><span class=w> </span><span class=kn>import</span> <span class=n>Patch</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.patches</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>mpatches</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy</span><span class=w> </span><span class=kn>import</span> <span class=n>stats</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=c1># Try to use Modin for faster pandas operations</span>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=k>try</span><span class=p>:</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>    <span class=kn>import</span><span class=w> </span><span class=nn>modin.pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>mpd</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>    <span class=n>USE_MODIN</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Using Modin for accelerated pandas operations&quot;</span><span class=p>)</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=k>except</span> <span class=ne>ImportError</span><span class=p>:</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a>    <span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>mpd</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>    <span class=n>USE_MODIN</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Using standard pandas (Modin not available)&quot;</span><span class=p>)</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=c1># Set up high-quality plotting parameters</span>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;figure.dpi&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>300</span>
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;savefig.dpi&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>300</span>
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;savefig.format&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;eps&#39;</span>
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;font.size&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>12</span>
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;axes.titlesize&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>14</span>
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;axes.labelsize&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>12</span>
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;xtick.labelsize&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>10</span>
</span><span id=__span-5-33><a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;ytick.labelsize&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>10</span>
</span><span id=__span-5-34><a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a><span class=n>plt</span><span class=o>.</span><span class=n>rcParams</span><span class=p>[</span><span class=s1>&#39;legend.fontsize&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>10</span>
</span><span id=__span-5-35><a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a>
</span><span id=__span-5-36><a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a><span class=c1># Global analysis period settings</span>
</span><span id=__span-5-37><a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a><span class=n>ANALYSIS_END_DATE</span> <span class=o>=</span> <span class=s2>&quot;2024-12-31&quot;</span>
</span><span id=__span-5-38><a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a><span class=n>ANALYSIS_START_DATE</span> <span class=o>=</span> <span class=s2>&quot;1999-01-01&quot;</span>  <span class=c1># Set to None for all data</span>
</span><span id=__span-5-39><a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a><span class=n>USE_ALL_DATA</span> <span class=o>=</span> <span class=kc>True</span>  <span class=c1># Toggle this to switch between full dataset and filtered</span>
</span><span id=__span-5-40><a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a>
</span><span id=__span-5-41><a id=__codelineno-5-41 name=__codelineno-5-41 href=#__codelineno-5-41></a><span class=c1># Create output directory for figures</span>
</span><span id=__span-5-42><a id=__codelineno-5-42 name=__codelineno-5-42 href=#__codelineno-5-42></a><span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=s1>&#39;figures&#39;</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-5-43><a id=__codelineno-5-43 name=__codelineno-5-43 href=#__codelineno-5-43></a><span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=s1>&#39;parquet_data&#39;</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-5-44><a id=__codelineno-5-44 name=__codelineno-5-44 href=#__codelineno-5-44></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Analysis Period: </span><span class=si>{</span><span class=s1>&#39;All available data&#39;</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>USE_ALL_DATA</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>ANALYSIS_START_DATE</span><span class=si>}</span><span class=s1> to </span><span class=si>{</span><span class=n>ANALYSIS_END_DATE</span><span class=si>}</span><span class=s1>&#39;</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>Using Modin for accelerated pandas operations
Analysis Period: All available data
</code></pre></div> <h3 id=2-load-parquet-data-for-analysis>2. Load Parquet Data for Analysis<a class=headerlink href=#2-load-parquet-data-for-analysis title="Permanent link">&para;</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=k>def</span><span class=w> </span><span class=nf>load_parquet_data</span><span class=p>():</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=sd>    Load Parquet files into DuckDB for analysis</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>    <span class=c1># Create a new connection for analysis</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>    <span class=n>con</span> <span class=o>=</span> <span class=n>duckdb</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=s1>&#39;:memory:&#39;</span><span class=p>)</span>  <span class=c1># Use in-memory database for faster processing</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>    <span class=c1># Load all parquet files</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>    <span class=n>parquet_files</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>        <span class=c1># MySQL tables</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>        <span class=s1>&#39;cve_main&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_cve.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>        <span class=s1>&#39;cve_main_old&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_cvev5_v2.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>        <span class=s1>&#39;exploits&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_exploit.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a>        <span class=s1>&#39;exploits_old&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_exploit_old.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>        <span class=s1>&#39;msrc_patches&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_msrc_vuln_unified.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a>        <span class=s1>&#39;cisco_patches&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_cisco_vuln_unified.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a>        <span class=s1>&#39;redhat_patches&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_redhat_vuln_unified.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a>        <span class=s1>&#39;github_advisories&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_github_advisory_unified.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a>        <span class=s1>&#39;cwe_ref&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_cwe.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a>        <span class=s1>&#39;capec_ref&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\mysql_capec.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a>        <span class=c1># PostgreSQL tables (MoreFixes)</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a>        <span class=s1>&#39;morefixes_cve&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\postgres_cve.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a>        <span class=s1>&#39;morefixes_fixes&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\postgres_fixes.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a>        <span class=s1>&#39;morefixes_commits&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\postgres_commits.parquet&#39;</span><span class=p>,</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a>        <span class=s1>&#39;morefixes_repository&#39;</span><span class=p>:</span> <span class=s1>&#39;..\parquet_data\postgres_repository.parquet&#39;</span>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a>    <span class=p>}</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a>    <span class=c1># Create views for each parquet file</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a>    <span class=k>for</span> <span class=n>table_name</span><span class=p>,</span> <span class=n>file_path</span> <span class=ow>in</span> <span class=n>parquet_files</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a>        <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span><span id=__span-6-33><a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a>            <span class=n>con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CREATE OR REPLACE VIEW </span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2> AS SELECT * FROM &#39;</span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>&#39;&quot;</span><span class=p>)</span>
</span><span id=__span-6-34><a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;✓ Loaded </span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-35><a id=__codelineno-6-35 name=__codelineno-6-35 href=#__codelineno-6-35></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-6-36><a id=__codelineno-6-36 name=__codelineno-6-36 href=#__codelineno-6-36></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;✗ File not found: </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-6-37><a id=__codelineno-6-37 name=__codelineno-6-37 href=#__codelineno-6-37></a>
</span><span id=__span-6-38><a id=__codelineno-6-38 name=__codelineno-6-38 href=#__codelineno-6-38></a>    <span class=k>return</span> <span class=n>con</span>
</span><span id=__span-6-39><a id=__codelineno-6-39 name=__codelineno-6-39 href=#__codelineno-6-39></a>
</span><span id=__span-6-40><a id=__codelineno-6-40 name=__codelineno-6-40 href=#__codelineno-6-40></a><span class=c1># Load data for analysis</span>
</span><span id=__span-6-41><a id=__codelineno-6-41 name=__codelineno-6-41 href=#__codelineno-6-41></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Loading Parquet data for analysis...&quot;</span><span class=p>)</span>
</span><span id=__span-6-42><a id=__codelineno-6-42 name=__codelineno-6-42 href=#__codelineno-6-42></a><span class=n>analysis_con</span> <span class=o>=</span> <span class=n>load_parquet_data</span><span class=p>()</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>Loading Parquet data for analysis...
✓ Loaded cve_main
✓ Loaded cve_main_old
✓ Loaded exploits
✓ Loaded exploits_old
✓ Loaded msrc_patches
✓ Loaded cisco_patches
✓ Loaded redhat_patches
✓ Loaded github_advisories
✓ Loaded cwe_ref
✓ Loaded capec_ref
✓ Loaded morefixes_cve
✓ Loaded morefixes_fixes
✓ Loaded morefixes_commits
✓ Loaded morefixes_repository
</code></pre></div> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># List of all table names I&#39;ve loaded</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=n>table_names</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>    <span class=s2>&quot;cve_main&quot;</span><span class=p>,</span> <span class=s2>&quot;cve_main_old&quot;</span><span class=p>,</span> <span class=s2>&quot;exploits&quot;</span><span class=p>,</span> <span class=s2>&quot;msrc_patches&quot;</span><span class=p>,</span> <span class=s2>&quot;cisco_patches&quot;</span><span class=p>,</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>    <span class=s2>&quot;redhat_patches&quot;</span><span class=p>,</span> <span class=s2>&quot;github_advisories&quot;</span><span class=p>,</span> <span class=s2>&quot;cwe_ref&quot;</span><span class=p>,</span> <span class=s2>&quot;capec_ref&quot;</span><span class=p>,</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    <span class=s2>&quot;morefixes_cve&quot;</span><span class=p>,</span> <span class=s2>&quot;morefixes_fixes&quot;</span><span class=p>,</span> <span class=s2>&quot;morefixes_commits&quot;</span><span class=p>,</span> <span class=s2>&quot;morefixes_repository&quot;</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=p>]</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>--- Schema for all loaded tables ---&quot;</span><span class=p>)</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=k>for</span> <span class=n>table_name</span> <span class=ow>in</span> <span class=n>table_names</span><span class=p>:</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Schema for table: </span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>        <span class=c1># Execute PRAGMA table_info() to get schema</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>        <span class=n>schema_info</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;PRAGMA table_info(&#39;</span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>&#39;);&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>schema_info</span><span class=p>:</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  (Table &#39;</span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>&#39; not found or is empty)&quot;</span><span class=p>)</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>            <span class=k>continue</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>        <span class=c1># Print header</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a>        <span class=n>header</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;cid&quot;</span><span class=p>,</span> <span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;type&quot;</span><span class=p>,</span> <span class=s2>&quot;notnull&quot;</span><span class=p>,</span> <span class=s2>&quot;pk&quot;</span><span class=p>,</span> <span class=s2>&quot;dflt_value&quot;</span><span class=p>]</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=s1>&#39; &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>col</span><span class=si>:</span><span class=s1>&lt;15</span><span class=si>}</span><span class=s1>&#39;</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>col</span><span class=w> </span><span class=ow>in</span><span class=w> </span><span class=n>header</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=s1>&#39;-&#39;</span><span class=o>*</span><span class=mi>90</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>        <span class=c1># Print rows</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a>        <span class=k>for</span> <span class=n>col_info</span> <span class=ow>in</span> <span class=n>schema_info</span><span class=p>:</span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>            <span class=n>cid</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>col_type</span><span class=p>,</span> <span class=n>notnull</span><span class=p>,</span> <span class=n>pk</span><span class=p>,</span> <span class=n>dflt_value</span> <span class=o>=</span> <span class=n>col_info</span>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>cid</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>col_type</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>notnull</span><span class=p>)</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>pk</span><span class=p>)</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>dflt_value</span><span class=p>)</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a>    <span class=k>except</span> <span class=n>duckdb</span><span class=o>.</span><span class=n>ParserException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Error retrieving schema for </span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  An unexpected error occurred for </span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>--- Schema for all loaded tables ---

Schema for table: cve_main
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               id              BIGINT          False           None            False          
  1               cve_id          VARCHAR         False           None            False          
  2               assigner_org    VARCHAR         False           None            False          
  3               state           VARCHAR         False           None            False          
  4               description     VARCHAR         False           None            False          
  5               date_reserved   TIMESTAMP       False           None            False          
  6               date_published  TIMESTAMP       False           None            False          
  7               date_updated    TIMESTAMP       False           None            False          
  8               cvss_v2_score   FLOAT           False           None            False          
  9               cvss_v2_vector  VARCHAR         False           None            False          
  10              cvss_v3_score   FLOAT           False           None            False          
  11              cvss_v3_vector  VARCHAR         False           None            False          
  12              cvss_v3_severity VARCHAR         False           None            False          
  13              cvss_v4_score   FLOAT           False           None            False          
  14              cvss_v4_vector  VARCHAR         False           None            False          
  15              cvss_v4_severity VARCHAR         False           None            False          
  16              cwe_ids         VARCHAR         False           None            False          
  17              cpes            VARCHAR         False           None            False          
  18              vendors         VARCHAR         False           None            False          
  19              products        VARCHAR         False           None            False          
  20              references      VARCHAR         False           None            False          
  21              ssvc_exploitation VARCHAR         False           None            False          
  22              ssvc_automatable VARCHAR         False           None            False          
  23              ssvc_technical_impact VARCHAR         False           None            False          
  24              kev_known_exploited TINYINT         False           None            False          
  25              kev_vendor_project VARCHAR         False           None            False          
  26              kev_product     VARCHAR         False           None            False          
  27              kev_vulnerability_name VARCHAR         False           None            False          
  28              kev_date_added  TIMESTAMP       False           None            False          
  29              kev_short_description VARCHAR         False           None            False          
  30              kev_required_action VARCHAR         False           None            False          
  31              kev_due_date    TIMESTAMP       False           None            False          
  32              kev_ransomware_use VARCHAR         False           None            False          
  33              kev_notes       VARCHAR         False           None            False          
  34              kev_cwes        VARCHAR         False           None            False          
  35              epss_score      FLOAT           False           None            False          
  36              epss_percentile FLOAT           False           None            False          
  37              data_sources    VARCHAR         False           None            False          
  38              created_at      TIMESTAMP WITH TIME ZONE False           None            False          
  39              updated_at      TIMESTAMP WITH TIME ZONE False           None            False          
  40              has_exploit     TINYINT         False           None            False          
  41              exploit_count   INTEGER         False           None            False          
  42              first_exploit_date TIMESTAMP       False           None            False          
  43              latest_exploit_date TIMESTAMP       False           None            False

Schema for table: cve_main_old
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               id              BIGINT          False           None            False          
  1               CVE ID          VARCHAR         False           None            False          
  2               State           VARCHAR         False           None            False          
  3               Date Published  TIMESTAMP       False           None            False          
  4               Date Updated    TIMESTAMP       False           None            False          
  5               Date Reserved   TIMESTAMP       False           None            False          
  6               Descriptions    VARCHAR         False           None            False          
  7               Affected Products VARCHAR         False           None            False          
  8               References      VARCHAR         False           None            False          
  9               Problem Types   VARCHAR         False           None            False          
  10              Base Severity   VARCHAR         False           None            False          
  11              Confidentiality Impact VARCHAR         False           None            False          
  12              Integrity Impact VARCHAR         False           None            False          
  13              Availability Impact VARCHAR         False           None            False          
  14              CVSS 2.0 Base Score FLOAT           False           None            False          
  15              CVSS 3.0 Base Score FLOAT           False           None            False          
  16              CVSS 3.1 Base Score FLOAT           False           None            False          
  17              cwe             VARCHAR         False           None            False          
  18              EPSS            FLOAT           False           None            False          
  19              vendors         VARCHAR         False           None            False          
  20              Software CPES   VARCHAR         False           None            False          
  21              V Score         FLOAT           False           None            False

Schema for table: exploits
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               id              BIGINT          False           None            False          
  1               file            VARCHAR         False           None            False          
  2               description     VARCHAR         False           None            False          
  3               date_published  TIMESTAMP       False           None            False          
  4               author          VARCHAR         False           None            False          
  5               type            VARCHAR         False           None            False          
  6               platform        VARCHAR         False           None            False          
  7               port            DOUBLE          False           None            False          
  8               date_added      TIMESTAMP       False           None            False          
  9               date_updated    TIMESTAMP       False           None            False          
  10              verified        BIGINT          False           None            False          
  11              codes           VARCHAR         False           None            False          
  12              tags            VARCHAR         False           None            False          
  13              aliases         VARCHAR         False           None            False          
  14              screenshot_url  VARCHAR         False           None            False          
  15              application_url VARCHAR         False           None            False          
  16              source_url      VARCHAR         False           None            False          
  17              cve_id          VARCHAR         False           None            False

Schema for table: msrc_patches
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               title           VARCHAR         False           None            False          
  1               release_date    TIMESTAMP       False           None            False          
  2               initial_release_date TIMESTAMP       False           None            False          
  3               cvrf_id         VARCHAR         False           None            False          
  4               cve_id          VARCHAR         False           None            False          
  5               exploited_status INTEGER         False           None            False          
  6               exploitation_potential_lsr INTEGER         False           None            False          
  7               exploitation_potential_osr INTEGER         False           None            False          
  8               publicly_disclosed INTEGER         False           None            False          
  9               cvss_score      FLOAT           False           None            False          
  10              cvss_vector     VARCHAR         False           None            False          
  11              vuln_title      VARCHAR         False           None            False          
  12              product_id      VARCHAR         False           None            False          
  13              product_name    VARCHAR         False           None            False          
  14              product_branch  VARCHAR         False           None            False          
  15              product_cpe     VARCHAR         False           None            False          
  16              threats         VARCHAR         False           None            False          
  17              remediations    VARCHAR         False           None            False          
  18              cwe_ids         VARCHAR         False           None            False          
  19              notes           VARCHAR         False           None            False          
  20              acknowledgments VARCHAR         False           None            False

Schema for table: cisco_patches
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               advisory_id     VARCHAR         False           None            False          
  1               title           VARCHAR         False           None            False          
  2               cve_id          VARCHAR         False           None            False          
  3               vulnerability_title VARCHAR         False           None            False          
  4               current_release_date TIMESTAMP       False           None            False          
  5               initial_release_date TIMESTAMP       False           None            False          
  6               vulnerability_release_date TIMESTAMP       False           None            False          
  7               status          VARCHAR         False           None            False          
  8               version         VARCHAR         False           None            False          
  9               publisher       VARCHAR         False           None            False          
  10              publisher_category VARCHAR         False           None            False          
  11              summary         VARCHAR         False           None            False          
  12              details         VARCHAR         False           None            False          
  13              cvss_score      FLOAT           False           None            False          
  14              cvss_severity   VARCHAR         False           None            False          
  15              cvss_vector     VARCHAR         False           None            False          
  16              bug_ids         VARCHAR         False           None            False          
  17              product_id      VARCHAR         False           None            False          
  18              product_name    VARCHAR         False           None            False          
  19              product_full_path VARCHAR         False           None            False          
  20              acknowledgments VARCHAR         False           None            False          
  21              references      VARCHAR         False           None            False          
  22              remediations    VARCHAR         False           None            False

Schema for table: redhat_patches
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               id              BIGINT          False           None            False          
  1               advisory_id     VARCHAR         False           None            False          
  2               title           VARCHAR         False           None            False          
  3               cve_id          VARCHAR         False           None            False          
  4               cwe_id          VARCHAR         False           None            False          
  5               vulnerability_title VARCHAR         False           None            False          
  6               current_release_date TIMESTAMP       False           None            False          
  7               initial_release_date TIMESTAMP       False           None            False          
  8               discovery_date  TIMESTAMP       False           None            False          
  9               release_date    TIMESTAMP       False           None            False          
  10              status          VARCHAR         False           None            False          
  11              version         VARCHAR         False           None            False          
  12              publisher       VARCHAR         False           None            False          
  13              publisher_category VARCHAR         False           None            False          
  14              summary         VARCHAR         False           None            False          
  15              details         VARCHAR         False           None            False          
  16              cvss_score      FLOAT           False           None            False          
  17              cvss_severity   VARCHAR         False           None            False          
  18              cvss_vector     VARCHAR         False           None            False          
  19              threat_impact   VARCHAR         False           None            False          
  20              aggregate_severity VARCHAR         False           None            False          
  21              product_id      VARCHAR         False           None            False          
  22              product_name    VARCHAR         False           None            False

Schema for table: github_advisories
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               id              BIGINT          False           None            False          
  1               ghsa_id         VARCHAR         False           None            False          
  2               schema_version  VARCHAR         False           None            False          
  3               published       TIMESTAMP       False           None            False          
  4               modified        TIMESTAMP       False           None            False          
  5               summary         VARCHAR         False           None            False          
  6               details         VARCHAR         False           None            False          
  7               primary_cve     VARCHAR         False           None            False          
  8               all_cves        VARCHAR         False           None            False          
  9               cvss_v3_score   FLOAT           False           None            False          
  10              cvss_v3_vector  VARCHAR         False           None            False          
  11              cvss_v4_score   FLOAT           False           None            False          
  12              cvss_v4_vector  VARCHAR         False           None            False          
  13              database_severity VARCHAR         False           None            False          
  14              severity_score  FLOAT           False           None            False          
  15              cwe_ids         VARCHAR         False           None            False          
  16              github_reviewed BOOLEAN         False           None            False          
  17              github_reviewed_at TIMESTAMP       False           None            False          
  18              nvd_published_at TIMESTAMP       False           None            False          
  19              exploited       TINYINT         False           None            False          
  20              exploitability_level TINYINT         False           None            False          
  21              poc_available   TINYINT         False           None            False          
  22              patched         TINYINT         False           None            False          
  23              patch_available TINYINT         False           None            False          
  24              primary_ecosystem VARCHAR         False           None            False          
  25              all_ecosystems  VARCHAR         False           None            False          
  26              package_ecosystem VARCHAR         False           None            False          
  27              package_name    VARCHAR         False           None            False          
  28              package_purl    VARCHAR         False           None            False          
  29              references      VARCHAR         False           None            False          
  30              affected_ranges VARCHAR         False           None            False          
  31              affected_versions VARCHAR         False           None            False          
  32              created_at      TIMESTAMP WITH TIME ZONE False           None            False          
  33              updated_at      TIMESTAMP WITH TIME ZONE False           None            False

Schema for table: cwe_ref
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               cwe_id          VARCHAR         False           None            False          
  1               name            VARCHAR         False           None            False          
  2               weakness_abstraction VARCHAR         False           None            False          
  3               status          VARCHAR         False           None            False          
  4               description     VARCHAR         False           None            False          
  5               extended_description VARCHAR         False           None            False          
  6               related_weaknesses VARCHAR         False           None            False          
  7               weakness_ordinalities VARCHAR         False           None            False          
  8               applicable_platforms VARCHAR         False           None            False          
  9               background_details VARCHAR         False           None            False          
  10              alternate_terms VARCHAR         False           None            False          
  11              modes_of_introduction VARCHAR         False           None            False          
  12              exploitation_factors VARCHAR         False           None            False          
  13              likelihood_of_exploit VARCHAR         False           None            False          
  14              common_consequences VARCHAR         False           None            False          
  15              detection_methods VARCHAR         False           None            False          
  16              potential_mitigations VARCHAR         False           None            False          
  17              observed_examples VARCHAR         False           None            False          
  18              functional_areas VARCHAR         False           None            False          
  19              affected_resources VARCHAR         False           None            False          
  20              taxonomy_mappings VARCHAR         False           None            False          
  21              related_attack_patterns VARCHAR         False           None            False          
  22              notes           VARCHAR         False           None            False          
  23              created_at      TIMESTAMP WITH TIME ZONE False           None            False

Schema for table: capec_ref
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               capec_id        VARCHAR         False           None            False          
  1               name            VARCHAR         False           None            False          
  2               abstraction     VARCHAR         False           None            False          
  3               status          VARCHAR         False           None            False          
  4               description     VARCHAR         False           None            False          
  5               alternate_terms VARCHAR         False           None            False          
  6               likelihood_of_attack VARCHAR         False           None            False          
  7               typical_severity VARCHAR         False           None            False          
  8               related_attack_patterns VARCHAR         False           None            False          
  9               execution_flow  VARCHAR         False           None            False          
  10              prerequisites   VARCHAR         False           None            False          
  11              skills_required VARCHAR         False           None            False          
  12              resources_required VARCHAR         False           None            False          
  13              indicators      VARCHAR         False           None            False          
  14              consequences    VARCHAR         False           None            False          
  15              mitigations     VARCHAR         False           None            False          
  16              example_instances VARCHAR         False           None            False          
  17              related_weaknesses VARCHAR         False           None            False          
  18              taxonomy_mappings VARCHAR         False           None            False          
  19              notes           VARCHAR         False           None            False          
  20              created_at      TIMESTAMP WITH TIME ZONE False           None            False

Schema for table: morefixes_cve
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               cve_id          VARCHAR         False           None            False          
  1               published_date  VARCHAR         False           None            False          
  2               last_modified_date VARCHAR         False           None            False          
  3               description     VARCHAR         False           None            False          
  4               nodes           VARCHAR         False           None            False          
  5               severity        VARCHAR         False           None            False          
  6               obtain_all_privilege VARCHAR         False           None            False          
  7               obtain_user_privilege VARCHAR         False           None            False          
  8               obtain_other_privilege VARCHAR         False           None            False          
  9               user_interaction_required VARCHAR         False           None            False          
  10              cvss2_vector_string VARCHAR         False           None            False          
  11              cvss2_access_vector VARCHAR         False           None            False          
  12              cvss2_access_complexity VARCHAR         False           None            False          
  13              cvss2_authentication VARCHAR         False           None            False          
  14              cvss2_confidentiality_impact VARCHAR         False           None            False          
  15              cvss2_integrity_impact VARCHAR         False           None            False          
  16              cvss2_availability_impact VARCHAR         False           None            False          
  17              cvss2_base_score VARCHAR         False           None            False          
  18              cvss3_vector_string VARCHAR         False           None            False          
  19              cvss3_attack_vector VARCHAR         False           None            False          
  20              cvss3_attack_complexity VARCHAR         False           None            False          
  21              cvss3_privileges_required VARCHAR         False           None            False          
  22              cvss3_user_interaction VARCHAR         False           None            False          
  23              cvss3_scope     VARCHAR         False           None            False          
  24              cvss3_confidentiality_impact VARCHAR         False           None            False          
  25              cvss3_integrity_impact VARCHAR         False           None            False          
  26              cvss3_availability_impact VARCHAR         False           None            False          
  27              cvss3_base_score VARCHAR         False           None            False          
  28              cvss3_base_severity VARCHAR         False           None            False          
  29              exploitability_score VARCHAR         False           None            False          
  30              impact_score    VARCHAR         False           None            False          
  31              ac_insuf_info   VARCHAR         False           None            False          
  32              reference_json  VARCHAR         False           None            False          
  33              problemtype_json VARCHAR         False           None            False

Schema for table: morefixes_fixes
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               cve_id          VARCHAR         False           None            False          
  1               hash            VARCHAR         False           None            False          
  2               repo_url        VARCHAR         False           None            False          
  3               rel_type        VARCHAR         False           None            False          
  4               score           BIGINT          False           None            False          
  5               extraction_status VARCHAR         False           None            False

Schema for table: morefixes_commits
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               hash            VARCHAR         False           None            False          
  1               repo_url        VARCHAR         False           None            False          
  2               author          VARCHAR         False           None            False          
  3               committer       VARCHAR         False           None            False          
  4               msg             VARCHAR         False           None            False          
  5               parents         VARCHAR         False           None            False          
  6               author_timezone BIGINT          False           None            False          
  7               num_lines_added BIGINT          False           None            False          
  8               num_lines_deleted BIGINT          False           None            False          
  9               dmm_unit_complexity DOUBLE          False           None            False          
  10              dmm_unit_interfacing DOUBLE          False           None            False          
  11              dmm_unit_size   DOUBLE          False           None            False          
  12              merge           BOOLEAN         False           None            False          
  13              committer_timezone BIGINT          False           None            False          
  14              author_date     TIMESTAMP WITH TIME ZONE False           None            False          
  15              committer_date  TIMESTAMP WITH TIME ZONE False           None            False

Schema for table: morefixes_repository
  cid             name            type            notnull         pk              dflt_value     
  ------------------------------------------------------------------------------------------
  0               repo_url        VARCHAR         False           None            False          
  1               repo_name       VARCHAR         False           None            False          
  2               description     VARCHAR         False           None            False          
  3               date_created    TIMESTAMP       False           None            False          
  4               date_last_push  TIMESTAMP       False           None            False          
  5               homepage        VARCHAR         False           None            False          
  6               repo_language   VARCHAR         False           None            False          
  7               owner           VARCHAR         False           None            False          
  8               forks_count     BIGINT          False           None            False          
  9               stars_count     BIGINT          False           None            False
</code></pre></div> <h3 id=execute-analysis>Execute analysis<a class=headerlink href=#execute-analysis title="Permanent link">&para;</a></h3> <h4 id=cpe-analysis-with-yearly-coverage-trends-and-detailed-change-analysis>CPE analysis with yearly coverage trends and detailed change analysis<a class=headerlink href=#cpe-analysis-with-yearly-coverage-trends-and-detailed-change-analysis title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>def</span><span class=w> </span><span class=nf>enhanced_cpe_coverage_analysis</span><span class=p>():</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=sd>    Enhanced CPE analysis with yearly coverage trends and detailed change analysis</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=== Enhanced CPE Coverage and Change Analysis ===</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>    <span class=c1># 1. CPE Coverage by Year - Old Database</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Analyzing CPE Coverage by Year...&quot;</span><span class=p>)</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>    <span class=n>old_yearly_coverage_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=s2>    SELECT </span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=s2>        EXTRACT(YEAR FROM &quot;Date Published&quot;) as year,</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=s2>        COUNT(*) as total_cves,</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=s2>        COUNT(CASE WHEN &quot;Software CPES&quot; IS NOT NULL AND &quot;Software CPES&quot; != &#39;&#39; THEN 1 END) as cves_with_cpes,</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=s2>        ROUND((COUNT(CASE WHEN &quot;Software CPES&quot; IS NOT NULL AND &quot;Software CPES&quot; != &#39;&#39; THEN 1 END) * 100.0 / COUNT(*)), 2) as coverage_percentage,</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=s2>        SUM(CASE </span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=s2>            WHEN &quot;Software CPES&quot; IS NULL OR &quot;Software CPES&quot; = &#39;&#39; THEN 0</span>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=s2>            ELSE LENGTH(&quot;Software CPES&quot;) - LENGTH(REPLACE(&quot;Software CPES&quot;, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=s2>        END) as total_cpe_entries,</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=s2>        AVG(CASE </span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a><span class=s2>            WHEN &quot;Software CPES&quot; IS NULL OR &quot;Software CPES&quot; = &#39;&#39; THEN 0</span>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=s2>            ELSE LENGTH(&quot;Software CPES&quot;) - LENGTH(REPLACE(&quot;Software CPES&quot;, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=s2>        END) as avg_cpes_per_cve</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=s2>    FROM cve_main_old </span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=s2>    WHERE &quot;State&quot; = &#39;PUBLISHED&#39;</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a><span class=s2>        AND &quot;Date Published&quot; IS NOT NULL</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=s2>        AND EXTRACT(YEAR FROM &quot;Date Published&quot;) &gt;= 2010</span>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a><span class=s2>        AND EXTRACT(YEAR FROM &quot;Date Published&quot;) &lt;= 2024</span>
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a><span class=s2>    GROUP BY EXTRACT(YEAR FROM &quot;Date Published&quot;)</span>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a><span class=s2>    ORDER BY year</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a>
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a>    <span class=c1># CPE Coverage by Year - Current Database</span>
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a>    <span class=n>current_yearly_coverage_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a><span class=s2>    SELECT </span>
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a><span class=s2>        EXTRACT(YEAR FROM date_published) as year,</span>
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a><span class=s2>        COUNT(*) as total_cves,</span>
</span><span id=__span-8-39><a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a><span class=s2>        COUNT(CASE WHEN cpes IS NOT NULL AND cpes != &#39;&#39; THEN 1 END) as cves_with_cpes,</span>
</span><span id=__span-8-40><a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a><span class=s2>        ROUND((COUNT(CASE WHEN cpes IS NOT NULL AND cpes != &#39;&#39; THEN 1 END) * 100.0 / COUNT(*)), 2) as coverage_percentage,</span>
</span><span id=__span-8-41><a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a><span class=s2>        SUM(CASE </span>
</span><span id=__span-8-42><a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a><span class=s2>            WHEN cpes IS NULL OR cpes = &#39;&#39; THEN 0</span>
</span><span id=__span-8-43><a id=__codelineno-8-43 name=__codelineno-8-43 href=#__codelineno-8-43></a><span class=s2>            ELSE LENGTH(cpes) - LENGTH(REPLACE(cpes, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-8-44><a id=__codelineno-8-44 name=__codelineno-8-44 href=#__codelineno-8-44></a><span class=s2>        END) as total_cpe_entries,</span>
</span><span id=__span-8-45><a id=__codelineno-8-45 name=__codelineno-8-45 href=#__codelineno-8-45></a><span class=s2>        AVG(CASE </span>
</span><span id=__span-8-46><a id=__codelineno-8-46 name=__codelineno-8-46 href=#__codelineno-8-46></a><span class=s2>            WHEN cpes IS NULL OR cpes = &#39;&#39; THEN 0</span>
</span><span id=__span-8-47><a id=__codelineno-8-47 name=__codelineno-8-47 href=#__codelineno-8-47></a><span class=s2>            ELSE LENGTH(cpes) - LENGTH(REPLACE(cpes, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-8-48><a id=__codelineno-8-48 name=__codelineno-8-48 href=#__codelineno-8-48></a><span class=s2>        END) as avg_cpes_per_cve</span>
</span><span id=__span-8-49><a id=__codelineno-8-49 name=__codelineno-8-49 href=#__codelineno-8-49></a><span class=s2>    FROM cve_main </span>
</span><span id=__span-8-50><a id=__codelineno-8-50 name=__codelineno-8-50 href=#__codelineno-8-50></a><span class=s2>    WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-8-51><a id=__codelineno-8-51 name=__codelineno-8-51 href=#__codelineno-8-51></a><span class=s2>        AND date_published IS NOT NULL</span>
</span><span id=__span-8-52><a id=__codelineno-8-52 name=__codelineno-8-52 href=#__codelineno-8-52></a><span class=s2>        AND EXTRACT(YEAR FROM date_published) &gt;= 2010</span>
</span><span id=__span-8-53><a id=__codelineno-8-53 name=__codelineno-8-53 href=#__codelineno-8-53></a><span class=s2>        AND EXTRACT(YEAR FROM date_published) &lt;= 2024</span>
</span><span id=__span-8-54><a id=__codelineno-8-54 name=__codelineno-8-54 href=#__codelineno-8-54></a><span class=s2>    GROUP BY EXTRACT(YEAR FROM date_published)</span>
</span><span id=__span-8-55><a id=__codelineno-8-55 name=__codelineno-8-55 href=#__codelineno-8-55></a><span class=s2>    ORDER BY year</span>
</span><span id=__span-8-56><a id=__codelineno-8-56 name=__codelineno-8-56 href=#__codelineno-8-56></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-8-57><a id=__codelineno-8-57 name=__codelineno-8-57 href=#__codelineno-8-57></a>
</span><span id=__span-8-58><a id=__codelineno-8-58 name=__codelineno-8-58 href=#__codelineno-8-58></a>    <span class=n>old_yearly_coverage</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>old_yearly_coverage_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-8-59><a id=__codelineno-8-59 name=__codelineno-8-59 href=#__codelineno-8-59></a>    <span class=n>current_yearly_coverage</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>current_yearly_coverage_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-8-60><a id=__codelineno-8-60 name=__codelineno-8-60 href=#__codelineno-8-60></a>
</span><span id=__span-8-61><a id=__codelineno-8-61 name=__codelineno-8-61 href=#__codelineno-8-61></a>    <span class=c1># Create CPE Coverage Visualizations</span>
</span><span id=__span-8-62><a id=__codelineno-8-62 name=__codelineno-8-62 href=#__codelineno-8-62></a>    <span class=n>fig</span><span class=p>,</span> <span class=p>((</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>),</span> <span class=p>(</span><span class=n>ax3</span><span class=p>,</span> <span class=n>ax4</span><span class=p>))</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>16</span><span class=p>))</span>
</span><span id=__span-8-63><a id=__codelineno-8-63 name=__codelineno-8-63 href=#__codelineno-8-63></a>
</span><span id=__span-8-64><a id=__codelineno-8-64 name=__codelineno-8-64 href=#__codelineno-8-64></a>    <span class=c1># Graph 1: CPE Coverage Numbers by Year</span>
</span><span id=__span-8-65><a id=__codelineno-8-65 name=__codelineno-8-65 href=#__codelineno-8-65></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>old_yearly_coverage</span><span class=o>.</span><span class=n>empty</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>current_yearly_coverage</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-8-66><a id=__codelineno-8-66 name=__codelineno-8-66 href=#__codelineno-8-66></a>        <span class=c1># Find common years for comparison</span>
</span><span id=__span-8-67><a id=__codelineno-8-67 name=__codelineno-8-67 href=#__codelineno-8-67></a>        <span class=n>common_years</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>old_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>intersection</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>current_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>])))</span>
</span><span id=__span-8-68><a id=__codelineno-8-68 name=__codelineno-8-68 href=#__codelineno-8-68></a>
</span><span id=__span-8-69><a id=__codelineno-8-69 name=__codelineno-8-69 href=#__codelineno-8-69></a>        <span class=n>old_cves_with_cpes</span> <span class=o>=</span> <span class=p>[</span><span class=n>old_yearly_coverage</span><span class=p>[</span><span class=n>old_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>y</span><span class=p>][</span><span class=s1>&#39;cves_with_cpes&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> 
</span><span id=__span-8-70><a id=__codelineno-8-70 name=__codelineno-8-70 href=#__codelineno-8-70></a>                             <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=n>common_years</span><span class=p>]</span>
</span><span id=__span-8-71><a id=__codelineno-8-71 name=__codelineno-8-71 href=#__codelineno-8-71></a>        <span class=n>current_cves_with_cpes</span> <span class=o>=</span> <span class=p>[</span><span class=n>current_yearly_coverage</span><span class=p>[</span><span class=n>current_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>y</span><span class=p>][</span><span class=s1>&#39;cves_with_cpes&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> 
</span><span id=__span-8-72><a id=__codelineno-8-72 name=__codelineno-8-72 href=#__codelineno-8-72></a>                                 <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=n>common_years</span><span class=p>]</span>
</span><span id=__span-8-73><a id=__codelineno-8-73 name=__codelineno-8-73 href=#__codelineno-8-73></a>
</span><span id=__span-8-74><a id=__codelineno-8-74 name=__codelineno-8-74 href=#__codelineno-8-74></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>common_years</span><span class=p>,</span> <span class=n>old_cves_with_cpes</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-8-75><a id=__codelineno-8-75 name=__codelineno-8-75 href=#__codelineno-8-75></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Old Database&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#FF6B6B&#39;</span><span class=p>)</span>
</span><span id=__span-8-76><a id=__codelineno-8-76 name=__codelineno-8-76 href=#__codelineno-8-76></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>common_years</span><span class=p>,</span> <span class=n>current_cves_with_cpes</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-8-77><a id=__codelineno-8-77 name=__codelineno-8-77 href=#__codelineno-8-77></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Current Database&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#4ECDC4&#39;</span><span class=p>)</span>
</span><span id=__span-8-78><a id=__codelineno-8-78 name=__codelineno-8-78 href=#__codelineno-8-78></a>
</span><span id=__span-8-79><a id=__codelineno-8-79 name=__codelineno-8-79 href=#__codelineno-8-79></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Year&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>)</span>
</span><span id=__span-8-80><a id=__codelineno-8-80 name=__codelineno-8-80 href=#__codelineno-8-80></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Number of CVEs with CPEs&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>)</span>
</span><span id=__span-8-81><a id=__codelineno-8-81 name=__codelineno-8-81 href=#__codelineno-8-81></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;CPE Coverage Numbers by Year</span><span class=se>\n</span><span class=s1>(Old vs Current Database)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-8-82><a id=__codelineno-8-82 name=__codelineno-8-82 href=#__codelineno-8-82></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-8-83><a id=__codelineno-8-83 name=__codelineno-8-83 href=#__codelineno-8-83></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-8-84><a id=__codelineno-8-84 name=__codelineno-8-84 href=#__codelineno-8-84></a>        <span class=n>ax1</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-8-85><a id=__codelineno-8-85 name=__codelineno-8-85 href=#__codelineno-8-85></a>
</span><span id=__span-8-86><a id=__codelineno-8-86 name=__codelineno-8-86 href=#__codelineno-8-86></a>        <span class=c1># Add value annotations for recent years</span>
</span><span id=__span-8-87><a id=__codelineno-8-87 name=__codelineno-8-87 href=#__codelineno-8-87></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>year</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>common_years</span><span class=p>[</span><span class=o>-</span><span class=mi>5</span><span class=p>:],</span> <span class=n>start</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>common_years</span><span class=p>)</span><span class=o>-</span><span class=mi>5</span><span class=p>):</span>
</span><span id=__span-8-88><a id=__codelineno-8-88 name=__codelineno-8-88 href=#__codelineno-8-88></a>            <span class=n>ax1</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>old_cves_with_cpes</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>:</span><span class=s1>,</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span> 
</span><span id=__span-8-89><a id=__codelineno-8-89 name=__codelineno-8-89 href=#__codelineno-8-89></a>                        <span class=p>(</span><span class=n>year</span><span class=p>,</span> <span class=n>old_cves_with_cpes</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> 
</span><span id=__span-8-90><a id=__codelineno-8-90 name=__codelineno-8-90 href=#__codelineno-8-90></a>                        <span class=n>textcoords</span><span class=o>=</span><span class=s2>&quot;offset points&quot;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>10</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-8-91><a id=__codelineno-8-91 name=__codelineno-8-91 href=#__codelineno-8-91></a>            <span class=n>ax1</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>current_cves_with_cpes</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>:</span><span class=s1>,</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span> 
</span><span id=__span-8-92><a id=__codelineno-8-92 name=__codelineno-8-92 href=#__codelineno-8-92></a>                        <span class=p>(</span><span class=n>year</span><span class=p>,</span> <span class=n>current_cves_with_cpes</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> 
</span><span id=__span-8-93><a id=__codelineno-8-93 name=__codelineno-8-93 href=#__codelineno-8-93></a>                        <span class=n>textcoords</span><span class=o>=</span><span class=s2>&quot;offset points&quot;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=o>-</span><span class=mi>15</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-8-94><a id=__codelineno-8-94 name=__codelineno-8-94 href=#__codelineno-8-94></a>
</span><span id=__span-8-95><a id=__codelineno-8-95 name=__codelineno-8-95 href=#__codelineno-8-95></a>    <span class=c1># Graph 2: CPE Coverage Percentage by Year</span>
</span><span id=__span-8-96><a id=__codelineno-8-96 name=__codelineno-8-96 href=#__codelineno-8-96></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>old_yearly_coverage</span><span class=o>.</span><span class=n>empty</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>current_yearly_coverage</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-8-97><a id=__codelineno-8-97 name=__codelineno-8-97 href=#__codelineno-8-97></a>        <span class=n>old_coverage_pct</span> <span class=o>=</span> <span class=p>[</span><span class=n>old_yearly_coverage</span><span class=p>[</span><span class=n>old_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>y</span><span class=p>][</span><span class=s1>&#39;coverage_percentage&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> 
</span><span id=__span-8-98><a id=__codelineno-8-98 name=__codelineno-8-98 href=#__codelineno-8-98></a>                           <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=n>common_years</span><span class=p>]</span>
</span><span id=__span-8-99><a id=__codelineno-8-99 name=__codelineno-8-99 href=#__codelineno-8-99></a>        <span class=n>current_coverage_pct</span> <span class=o>=</span> <span class=p>[</span><span class=n>current_yearly_coverage</span><span class=p>[</span><span class=n>current_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>y</span><span class=p>][</span><span class=s1>&#39;coverage_percentage&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> 
</span><span id=__span-8-100><a id=__codelineno-8-100 name=__codelineno-8-100 href=#__codelineno-8-100></a>                               <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=n>common_years</span><span class=p>]</span>
</span><span id=__span-8-101><a id=__codelineno-8-101 name=__codelineno-8-101 href=#__codelineno-8-101></a>
</span><span id=__span-8-102><a id=__codelineno-8-102 name=__codelineno-8-102 href=#__codelineno-8-102></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>common_years</span><span class=p>,</span> <span class=n>old_coverage_pct</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-8-103><a id=__codelineno-8-103 name=__codelineno-8-103 href=#__codelineno-8-103></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Old Database&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#FF6B6B&#39;</span><span class=p>)</span>
</span><span id=__span-8-104><a id=__codelineno-8-104 name=__codelineno-8-104 href=#__codelineno-8-104></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>common_years</span><span class=p>,</span> <span class=n>current_coverage_pct</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-8-105><a id=__codelineno-8-105 name=__codelineno-8-105 href=#__codelineno-8-105></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Current Database&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#4ECDC4&#39;</span><span class=p>)</span>
</span><span id=__span-8-106><a id=__codelineno-8-106 name=__codelineno-8-106 href=#__codelineno-8-106></a>
</span><span id=__span-8-107><a id=__codelineno-8-107 name=__codelineno-8-107 href=#__codelineno-8-107></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Year&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>)</span>
</span><span id=__span-8-108><a id=__codelineno-8-108 name=__codelineno-8-108 href=#__codelineno-8-108></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;CPE Coverage Percentage (%)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>)</span>
</span><span id=__span-8-109><a id=__codelineno-8-109 name=__codelineno-8-109 href=#__codelineno-8-109></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;CPE Coverage Percentage by Year</span><span class=se>\n</span><span class=s1>(Old vs Current Database)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-8-110><a id=__codelineno-8-110 name=__codelineno-8-110 href=#__codelineno-8-110></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-8-111><a id=__codelineno-8-111 name=__codelineno-8-111 href=#__codelineno-8-111></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-8-112><a id=__codelineno-8-112 name=__codelineno-8-112 href=#__codelineno-8-112></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-8-113><a id=__codelineno-8-113 name=__codelineno-8-113 href=#__codelineno-8-113></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-8-114><a id=__codelineno-8-114 name=__codelineno-8-114 href=#__codelineno-8-114></a>
</span><span id=__span-8-115><a id=__codelineno-8-115 name=__codelineno-8-115 href=#__codelineno-8-115></a>        <span class=c1># Add percentage annotations for recent years</span>
</span><span id=__span-8-116><a id=__codelineno-8-116 name=__codelineno-8-116 href=#__codelineno-8-116></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>year</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>common_years</span><span class=p>[</span><span class=o>-</span><span class=mi>5</span><span class=p>:],</span> <span class=n>start</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>common_years</span><span class=p>)</span><span class=o>-</span><span class=mi>5</span><span class=p>):</span>
</span><span id=__span-8-117><a id=__codelineno-8-117 name=__codelineno-8-117 href=#__codelineno-8-117></a>            <span class=n>ax2</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>old_coverage_pct</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>:</span><span class=s1>.1f</span><span class=si>}</span><span class=s1>%&#39;</span><span class=p>,</span> 
</span><span id=__span-8-118><a id=__codelineno-8-118 name=__codelineno-8-118 href=#__codelineno-8-118></a>                        <span class=p>(</span><span class=n>year</span><span class=p>,</span> <span class=n>old_coverage_pct</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> 
</span><span id=__span-8-119><a id=__codelineno-8-119 name=__codelineno-8-119 href=#__codelineno-8-119></a>                        <span class=n>textcoords</span><span class=o>=</span><span class=s2>&quot;offset points&quot;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>10</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-8-120><a id=__codelineno-8-120 name=__codelineno-8-120 href=#__codelineno-8-120></a>            <span class=n>ax2</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>current_coverage_pct</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>:</span><span class=s1>.1f</span><span class=si>}</span><span class=s1>%&#39;</span><span class=p>,</span> 
</span><span id=__span-8-121><a id=__codelineno-8-121 name=__codelineno-8-121 href=#__codelineno-8-121></a>                        <span class=p>(</span><span class=n>year</span><span class=p>,</span> <span class=n>current_coverage_pct</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> 
</span><span id=__span-8-122><a id=__codelineno-8-122 name=__codelineno-8-122 href=#__codelineno-8-122></a>                        <span class=n>textcoords</span><span class=o>=</span><span class=s2>&quot;offset points&quot;</span><span class=p>,</span> <span class=n>xytext</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=o>-</span><span class=mi>15</span><span class=p>),</span> <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-8-123><a id=__codelineno-8-123 name=__codelineno-8-123 href=#__codelineno-8-123></a>
</span><span id=__span-8-124><a id=__codelineno-8-124 name=__codelineno-8-124 href=#__codelineno-8-124></a>    <span class=c1># Graph 3: Total CPE Entries by Year</span>
</span><span id=__span-8-125><a id=__codelineno-8-125 name=__codelineno-8-125 href=#__codelineno-8-125></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>old_yearly_coverage</span><span class=o>.</span><span class=n>empty</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>current_yearly_coverage</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-8-126><a id=__codelineno-8-126 name=__codelineno-8-126 href=#__codelineno-8-126></a>        <span class=n>old_total_cpes</span> <span class=o>=</span> <span class=p>[</span><span class=n>old_yearly_coverage</span><span class=p>[</span><span class=n>old_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>y</span><span class=p>][</span><span class=s1>&#39;total_cpe_entries&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> 
</span><span id=__span-8-127><a id=__codelineno-8-127 name=__codelineno-8-127 href=#__codelineno-8-127></a>                         <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=n>common_years</span><span class=p>]</span>
</span><span id=__span-8-128><a id=__codelineno-8-128 name=__codelineno-8-128 href=#__codelineno-8-128></a>        <span class=n>current_total_cpes</span> <span class=o>=</span> <span class=p>[</span><span class=n>current_yearly_coverage</span><span class=p>[</span><span class=n>current_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>y</span><span class=p>][</span><span class=s1>&#39;total_cpe_entries&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> 
</span><span id=__span-8-129><a id=__codelineno-8-129 name=__codelineno-8-129 href=#__codelineno-8-129></a>                             <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=n>common_years</span><span class=p>]</span>
</span><span id=__span-8-130><a id=__codelineno-8-130 name=__codelineno-8-130 href=#__codelineno-8-130></a>
</span><span id=__span-8-131><a id=__codelineno-8-131 name=__codelineno-8-131 href=#__codelineno-8-131></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>common_years</span><span class=p>,</span> <span class=n>old_total_cpes</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-8-132><a id=__codelineno-8-132 name=__codelineno-8-132 href=#__codelineno-8-132></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Old Database&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#FF6B6B&#39;</span><span class=p>)</span>
</span><span id=__span-8-133><a id=__codelineno-8-133 name=__codelineno-8-133 href=#__codelineno-8-133></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>common_years</span><span class=p>,</span> <span class=n>current_total_cpes</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-8-134><a id=__codelineno-8-134 name=__codelineno-8-134 href=#__codelineno-8-134></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Current Database&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#4ECDC4&#39;</span><span class=p>)</span>
</span><span id=__span-8-135><a id=__codelineno-8-135 name=__codelineno-8-135 href=#__codelineno-8-135></a>
</span><span id=__span-8-136><a id=__codelineno-8-136 name=__codelineno-8-136 href=#__codelineno-8-136></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Year&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>)</span>
</span><span id=__span-8-137><a id=__codelineno-8-137 name=__codelineno-8-137 href=#__codelineno-8-137></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Total CPE Entries&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>)</span>
</span><span id=__span-8-138><a id=__codelineno-8-138 name=__codelineno-8-138 href=#__codelineno-8-138></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Total CPE Entries by Year</span><span class=se>\n</span><span class=s1>(Old vs Current Database)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-8-139><a id=__codelineno-8-139 name=__codelineno-8-139 href=#__codelineno-8-139></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-8-140><a id=__codelineno-8-140 name=__codelineno-8-140 href=#__codelineno-8-140></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-8-141><a id=__codelineno-8-141 name=__codelineno-8-141 href=#__codelineno-8-141></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-8-142><a id=__codelineno-8-142 name=__codelineno-8-142 href=#__codelineno-8-142></a>
</span><span id=__span-8-143><a id=__codelineno-8-143 name=__codelineno-8-143 href=#__codelineno-8-143></a>    <span class=c1># Graph 4: Average CPEs per CVE by Year</span>
</span><span id=__span-8-144><a id=__codelineno-8-144 name=__codelineno-8-144 href=#__codelineno-8-144></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>old_yearly_coverage</span><span class=o>.</span><span class=n>empty</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>current_yearly_coverage</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-8-145><a id=__codelineno-8-145 name=__codelineno-8-145 href=#__codelineno-8-145></a>        <span class=n>old_avg_cpes</span> <span class=o>=</span> <span class=p>[</span><span class=n>old_yearly_coverage</span><span class=p>[</span><span class=n>old_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>y</span><span class=p>][</span><span class=s1>&#39;avg_cpes_per_cve&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> 
</span><span id=__span-8-146><a id=__codelineno-8-146 name=__codelineno-8-146 href=#__codelineno-8-146></a>                       <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=n>common_years</span><span class=p>]</span>
</span><span id=__span-8-147><a id=__codelineno-8-147 name=__codelineno-8-147 href=#__codelineno-8-147></a>        <span class=n>current_avg_cpes</span> <span class=o>=</span> <span class=p>[</span><span class=n>current_yearly_coverage</span><span class=p>[</span><span class=n>current_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>y</span><span class=p>][</span><span class=s1>&#39;avg_cpes_per_cve&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> 
</span><span id=__span-8-148><a id=__codelineno-8-148 name=__codelineno-8-148 href=#__codelineno-8-148></a>                           <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=n>common_years</span><span class=p>]</span>
</span><span id=__span-8-149><a id=__codelineno-8-149 name=__codelineno-8-149 href=#__codelineno-8-149></a>
</span><span id=__span-8-150><a id=__codelineno-8-150 name=__codelineno-8-150 href=#__codelineno-8-150></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>common_years</span><span class=p>,</span> <span class=n>old_avg_cpes</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;o&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-8-151><a id=__codelineno-8-151 name=__codelineno-8-151 href=#__codelineno-8-151></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Old Database&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#FF6B6B&#39;</span><span class=p>)</span>
</span><span id=__span-8-152><a id=__codelineno-8-152 name=__codelineno-8-152 href=#__codelineno-8-152></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>common_years</span><span class=p>,</span> <span class=n>current_avg_cpes</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>markersize</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
</span><span id=__span-8-153><a id=__codelineno-8-153 name=__codelineno-8-153 href=#__codelineno-8-153></a>                <span class=n>label</span><span class=o>=</span><span class=s1>&#39;Current Database&#39;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;#4ECDC4&#39;</span><span class=p>)</span>
</span><span id=__span-8-154><a id=__codelineno-8-154 name=__codelineno-8-154 href=#__codelineno-8-154></a>
</span><span id=__span-8-155><a id=__codelineno-8-155 name=__codelineno-8-155 href=#__codelineno-8-155></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Year&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>)</span>
</span><span id=__span-8-156><a id=__codelineno-8-156 name=__codelineno-8-156 href=#__codelineno-8-156></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Average CPEs per CVE&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>)</span>
</span><span id=__span-8-157><a id=__codelineno-8-157 name=__codelineno-8-157 href=#__codelineno-8-157></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Average CPEs per CVE by Year</span><span class=se>\n</span><span class=s1>(Old vs Current Database)&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-8-158><a id=__codelineno-8-158 name=__codelineno-8-158 href=#__codelineno-8-158></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-8-159><a id=__codelineno-8-159 name=__codelineno-8-159 href=#__codelineno-8-159></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-8-160><a id=__codelineno-8-160 name=__codelineno-8-160 href=#__codelineno-8-160></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-8-161><a id=__codelineno-8-161 name=__codelineno-8-161 href=#__codelineno-8-161></a>
</span><span id=__span-8-162><a id=__codelineno-8-162 name=__codelineno-8-162 href=#__codelineno-8-162></a>    <span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-8-163><a id=__codelineno-8-163 name=__codelineno-8-163 href=#__codelineno-8-163></a>    <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;cpe_coverage_trends_analysis.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span><span id=__span-8-164><a id=__codelineno-8-164 name=__codelineno-8-164 href=#__codelineno-8-164></a>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-8-165><a id=__codelineno-8-165 name=__codelineno-8-165 href=#__codelineno-8-165></a>
</span><span id=__span-8-166><a id=__codelineno-8-166 name=__codelineno-8-166 href=#__codelineno-8-166></a>    <span class=c1># Print yearly coverage statistics</span>
</span><span id=__span-8-167><a id=__codelineno-8-167 name=__codelineno-8-167 href=#__codelineno-8-167></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Yearly CPE Coverage Statistics:&quot;</span><span class=p>)</span>
</span><span id=__span-8-168><a id=__codelineno-8-168 name=__codelineno-8-168 href=#__codelineno-8-168></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>120</span><span class=p>)</span>
</span><span id=__span-8-169><a id=__codelineno-8-169 name=__codelineno-8-169 href=#__codelineno-8-169></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Year&#39;</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Old DB CVEs&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Old DB w/CPE&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Old Coverage&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;New DB CVEs&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;New DB w/CPE&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;New Coverage&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Coverage Diff&#39;</span><span class=si>:</span><span class=s2>&lt;13</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-170><a id=__codelineno-8-170 name=__codelineno-8-170 href=#__codelineno-8-170></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>120</span><span class=p>)</span>
</span><span id=__span-8-171><a id=__codelineno-8-171 name=__codelineno-8-171 href=#__codelineno-8-171></a>
</span><span id=__span-8-172><a id=__codelineno-8-172 name=__codelineno-8-172 href=#__codelineno-8-172></a>    <span class=k>for</span> <span class=n>year</span> <span class=ow>in</span> <span class=n>common_years</span><span class=p>[</span><span class=o>-</span><span class=mi>10</span><span class=p>:]:</span>  <span class=c1># Show last 10 years</span>
</span><span id=__span-8-173><a id=__codelineno-8-173 name=__codelineno-8-173 href=#__codelineno-8-173></a>        <span class=n>old_row</span> <span class=o>=</span> <span class=n>old_yearly_coverage</span><span class=p>[</span><span class=n>old_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>year</span><span class=p>]</span>
</span><span id=__span-8-174><a id=__codelineno-8-174 name=__codelineno-8-174 href=#__codelineno-8-174></a>        <span class=n>current_row</span> <span class=o>=</span> <span class=n>current_yearly_coverage</span><span class=p>[</span><span class=n>current_yearly_coverage</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>year</span><span class=p>]</span>
</span><span id=__span-8-175><a id=__codelineno-8-175 name=__codelineno-8-175 href=#__codelineno-8-175></a>
</span><span id=__span-8-176><a id=__codelineno-8-176 name=__codelineno-8-176 href=#__codelineno-8-176></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>old_row</span><span class=o>.</span><span class=n>empty</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>current_row</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-8-177><a id=__codelineno-8-177 name=__codelineno-8-177 href=#__codelineno-8-177></a>            <span class=n>old_total</span> <span class=o>=</span> <span class=n>old_row</span><span class=p>[</span><span class=s1>&#39;total_cves&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-8-178><a id=__codelineno-8-178 name=__codelineno-8-178 href=#__codelineno-8-178></a>            <span class=n>old_with_cpe</span> <span class=o>=</span> <span class=n>old_row</span><span class=p>[</span><span class=s1>&#39;cves_with_cpes&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-8-179><a id=__codelineno-8-179 name=__codelineno-8-179 href=#__codelineno-8-179></a>            <span class=n>old_pct</span> <span class=o>=</span> <span class=n>old_row</span><span class=p>[</span><span class=s1>&#39;coverage_percentage&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-8-180><a id=__codelineno-8-180 name=__codelineno-8-180 href=#__codelineno-8-180></a>
</span><span id=__span-8-181><a id=__codelineno-8-181 name=__codelineno-8-181 href=#__codelineno-8-181></a>            <span class=n>current_total</span> <span class=o>=</span> <span class=n>current_row</span><span class=p>[</span><span class=s1>&#39;total_cves&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-8-182><a id=__codelineno-8-182 name=__codelineno-8-182 href=#__codelineno-8-182></a>            <span class=n>current_with_cpe</span> <span class=o>=</span> <span class=n>current_row</span><span class=p>[</span><span class=s1>&#39;cves_with_cpes&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-8-183><a id=__codelineno-8-183 name=__codelineno-8-183 href=#__codelineno-8-183></a>            <span class=n>current_pct</span> <span class=o>=</span> <span class=n>current_row</span><span class=p>[</span><span class=s1>&#39;coverage_percentage&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-8-184><a id=__codelineno-8-184 name=__codelineno-8-184 href=#__codelineno-8-184></a>
</span><span id=__span-8-185><a id=__codelineno-8-185 name=__codelineno-8-185 href=#__codelineno-8-185></a>            <span class=n>coverage_diff</span> <span class=o>=</span> <span class=n>current_pct</span> <span class=o>-</span> <span class=n>old_pct</span>
</span><span id=__span-8-186><a id=__codelineno-8-186 name=__codelineno-8-186 href=#__codelineno-8-186></a>
</span><span id=__span-8-187><a id=__codelineno-8-187 name=__codelineno-8-187 href=#__codelineno-8-187></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>year</span><span class=p>)</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>old_total</span><span class=si>:</span><span class=s2>&lt;12,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>old_with_cpe</span><span class=si>:</span><span class=s2>&lt;12,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>old_pct</span><span class=si>:</span><span class=s2>&lt;12.1f</span><span class=si>}</span><span class=s2>% &quot;</span>
</span><span id=__span-8-188><a id=__codelineno-8-188 name=__codelineno-8-188 href=#__codelineno-8-188></a>                  <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>current_total</span><span class=si>:</span><span class=s2>&lt;12,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>current_with_cpe</span><span class=si>:</span><span class=s2>&lt;12,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>current_pct</span><span class=si>:</span><span class=s2>&lt;12.1f</span><span class=si>}</span><span class=s2>% </span><span class=si>{</span><span class=n>coverage_diff</span><span class=si>:</span><span class=s2>+&lt;13.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>
</span><span id=__span-8-189><a id=__codelineno-8-189 name=__codelineno-8-189 href=#__codelineno-8-189></a>
</span><span id=__span-8-190><a id=__codelineno-8-190 name=__codelineno-8-190 href=#__codelineno-8-190></a>    <span class=k>return</span> <span class=n>old_yearly_coverage</span><span class=p>,</span> <span class=n>current_yearly_coverage</span>
</span><span id=__span-8-191><a id=__codelineno-8-191 name=__codelineno-8-191 href=#__codelineno-8-191></a>
</span><span id=__span-8-192><a id=__codelineno-8-192 name=__codelineno-8-192 href=#__codelineno-8-192></a><span class=k>def</span><span class=w> </span><span class=nf>analyze_significant_cpe_changes</span><span class=p>():</span>
</span><span id=__span-8-193><a id=__codelineno-8-193 name=__codelineno-8-193 href=#__codelineno-8-193></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-8-194><a id=__codelineno-8-194 name=__codelineno-8-194 href=#__codelineno-8-194></a><span class=sd>    Detailed analysis of significant CPE changes with platform and justification analysis</span>
</span><span id=__span-8-195><a id=__codelineno-8-195 name=__codelineno-8-195 href=#__codelineno-8-195></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-8-196><a id=__codelineno-8-196 name=__codelineno-8-196 href=#__codelineno-8-196></a>
</span><span id=__span-8-197><a id=__codelineno-8-197 name=__codelineno-8-197 href=#__codelineno-8-197></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n\n</span><span class=s2>2. Analyzing Significant CPE Changes in Detail...&quot;</span><span class=p>)</span>
</span><span id=__span-8-198><a id=__codelineno-8-198 name=__codelineno-8-198 href=#__codelineno-8-198></a>
</span><span id=__span-8-199><a id=__codelineno-8-199 name=__codelineno-8-199 href=#__codelineno-8-199></a>    <span class=c1># Get detailed information about CVEs with significant CPE changes</span>
</span><span id=__span-8-200><a id=__codelineno-8-200 name=__codelineno-8-200 href=#__codelineno-8-200></a>    <span class=n>detailed_cpe_changes_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-8-201><a id=__codelineno-8-201 name=__codelineno-8-201 href=#__codelineno-8-201></a><span class=s2>    WITH current_cpe_data AS (</span>
</span><span id=__span-8-202><a id=__codelineno-8-202 name=__codelineno-8-202 href=#__codelineno-8-202></a><span class=s2>        SELECT </span>
</span><span id=__span-8-203><a id=__codelineno-8-203 name=__codelineno-8-203 href=#__codelineno-8-203></a><span class=s2>            cve_id,</span>
</span><span id=__span-8-204><a id=__codelineno-8-204 name=__codelineno-8-204 href=#__codelineno-8-204></a><span class=s2>            date_published,</span>
</span><span id=__span-8-205><a id=__codelineno-8-205 name=__codelineno-8-205 href=#__codelineno-8-205></a><span class=s2>            cvss_v3_score,</span>
</span><span id=__span-8-206><a id=__codelineno-8-206 name=__codelineno-8-206 href=#__codelineno-8-206></a><span class=s2>            description,</span>
</span><span id=__span-8-207><a id=__codelineno-8-207 name=__codelineno-8-207 href=#__codelineno-8-207></a><span class=s2>            CASE </span>
</span><span id=__span-8-208><a id=__codelineno-8-208 name=__codelineno-8-208 href=#__codelineno-8-208></a><span class=s2>                WHEN cpes IS NULL OR cpes = &#39;&#39; THEN 0</span>
</span><span id=__span-8-209><a id=__codelineno-8-209 name=__codelineno-8-209 href=#__codelineno-8-209></a><span class=s2>                ELSE LENGTH(cpes) - LENGTH(REPLACE(cpes, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-8-210><a id=__codelineno-8-210 name=__codelineno-8-210 href=#__codelineno-8-210></a><span class=s2>            END as current_cpe_count,</span>
</span><span id=__span-8-211><a id=__codelineno-8-211 name=__codelineno-8-211 href=#__codelineno-8-211></a><span class=s2>            cpes as current_cpes</span>
</span><span id=__span-8-212><a id=__codelineno-8-212 name=__codelineno-8-212 href=#__codelineno-8-212></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-8-213><a id=__codelineno-8-213 name=__codelineno-8-213 href=#__codelineno-8-213></a><span class=s2>        WHERE state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-8-214><a id=__codelineno-8-214 name=__codelineno-8-214 href=#__codelineno-8-214></a><span class=s2>            AND date_published &lt;= &#39;2024-04-21&#39;</span>
</span><span id=__span-8-215><a id=__codelineno-8-215 name=__codelineno-8-215 href=#__codelineno-8-215></a><span class=s2>    ),</span>
</span><span id=__span-8-216><a id=__codelineno-8-216 name=__codelineno-8-216 href=#__codelineno-8-216></a><span class=s2>    old_cpe_data AS (</span>
</span><span id=__span-8-217><a id=__codelineno-8-217 name=__codelineno-8-217 href=#__codelineno-8-217></a><span class=s2>        SELECT </span>
</span><span id=__span-8-218><a id=__codelineno-8-218 name=__codelineno-8-218 href=#__codelineno-8-218></a><span class=s2>            &quot;CVE ID&quot; as cve_id,</span>
</span><span id=__span-8-219><a id=__codelineno-8-219 name=__codelineno-8-219 href=#__codelineno-8-219></a><span class=s2>            &quot;Date Published&quot; as date_published,</span>
</span><span id=__span-8-220><a id=__codelineno-8-220 name=__codelineno-8-220 href=#__codelineno-8-220></a><span class=s2>            &quot;CVSS 3.0 Base Score&quot; as cvss_v3_score,</span>
</span><span id=__span-8-221><a id=__codelineno-8-221 name=__codelineno-8-221 href=#__codelineno-8-221></a><span class=s2>            &quot;Descriptions&quot; as description,</span>
</span><span id=__span-8-222><a id=__codelineno-8-222 name=__codelineno-8-222 href=#__codelineno-8-222></a><span class=s2>            CASE </span>
</span><span id=__span-8-223><a id=__codelineno-8-223 name=__codelineno-8-223 href=#__codelineno-8-223></a><span class=s2>                WHEN &quot;Software CPES&quot; IS NULL OR &quot;Software CPES&quot; = &#39;&#39; THEN 0</span>
</span><span id=__span-8-224><a id=__codelineno-8-224 name=__codelineno-8-224 href=#__codelineno-8-224></a><span class=s2>                ELSE LENGTH(&quot;Software CPES&quot;) - LENGTH(REPLACE(&quot;Software CPES&quot;, &#39;,&#39;, &#39;&#39;)) + 1</span>
</span><span id=__span-8-225><a id=__codelineno-8-225 name=__codelineno-8-225 href=#__codelineno-8-225></a><span class=s2>            END as old_cpe_count,</span>
</span><span id=__span-8-226><a id=__codelineno-8-226 name=__codelineno-8-226 href=#__codelineno-8-226></a><span class=s2>            &quot;Software CPES&quot; as old_cpes</span>
</span><span id=__span-8-227><a id=__codelineno-8-227 name=__codelineno-8-227 href=#__codelineno-8-227></a><span class=s2>        FROM cve_main_old </span>
</span><span id=__span-8-228><a id=__codelineno-8-228 name=__codelineno-8-228 href=#__codelineno-8-228></a><span class=s2>        WHERE &quot;State&quot; = &#39;PUBLISHED&#39;</span>
</span><span id=__span-8-229><a id=__codelineno-8-229 name=__codelineno-8-229 href=#__codelineno-8-229></a><span class=s2>    ),</span>
</span><span id=__span-8-230><a id=__codelineno-8-230 name=__codelineno-8-230 href=#__codelineno-8-230></a><span class=s2>    significant_changes AS (</span>
</span><span id=__span-8-231><a id=__codelineno-8-231 name=__codelineno-8-231 href=#__codelineno-8-231></a><span class=s2>        SELECT </span>
</span><span id=__span-8-232><a id=__codelineno-8-232 name=__codelineno-8-232 href=#__codelineno-8-232></a><span class=s2>            c.cve_id,</span>
</span><span id=__span-8-233><a id=__codelineno-8-233 name=__codelineno-8-233 href=#__codelineno-8-233></a><span class=s2>            c.date_published,</span>
</span><span id=__span-8-234><a id=__codelineno-8-234 name=__codelineno-8-234 href=#__codelineno-8-234></a><span class=s2>            c.cvss_v3_score,</span>
</span><span id=__span-8-235><a id=__codelineno-8-235 name=__codelineno-8-235 href=#__codelineno-8-235></a><span class=s2>            LEFT(c.description, 200) as description_sample,</span>
</span><span id=__span-8-236><a id=__codelineno-8-236 name=__codelineno-8-236 href=#__codelineno-8-236></a><span class=s2>            c.current_cpe_count,</span>
</span><span id=__span-8-237><a id=__codelineno-8-237 name=__codelineno-8-237 href=#__codelineno-8-237></a><span class=s2>            o.old_cpe_count,</span>
</span><span id=__span-8-238><a id=__codelineno-8-238 name=__codelineno-8-238 href=#__codelineno-8-238></a><span class=s2>            (c.current_cpe_count - o.old_cpe_count) as cpe_difference,</span>
</span><span id=__span-8-239><a id=__codelineno-8-239 name=__codelineno-8-239 href=#__codelineno-8-239></a><span class=s2>            c.current_cpes,</span>
</span><span id=__span-8-240><a id=__codelineno-8-240 name=__codelineno-8-240 href=#__codelineno-8-240></a><span class=s2>            o.old_cpes,</span>
</span><span id=__span-8-241><a id=__codelineno-8-241 name=__codelineno-8-241 href=#__codelineno-8-241></a><span class=s2>            CASE </span>
</span><span id=__span-8-242><a id=__codelineno-8-242 name=__codelineno-8-242 href=#__codelineno-8-242></a><span class=s2>                WHEN c.current_cpe_count &gt; o.old_cpe_count THEN &#39;Added&#39;</span>
</span><span id=__span-8-243><a id=__codelineno-8-243 name=__codelineno-8-243 href=#__codelineno-8-243></a><span class=s2>                WHEN c.current_cpe_count &lt; o.old_cpe_count THEN &#39;Removed&#39;</span>
</span><span id=__span-8-244><a id=__codelineno-8-244 name=__codelineno-8-244 href=#__codelineno-8-244></a><span class=s2>                ELSE &#39;Unchanged&#39;</span>
</span><span id=__span-8-245><a id=__codelineno-8-245 name=__codelineno-8-245 href=#__codelineno-8-245></a><span class=s2>            END as change_type</span>
</span><span id=__span-8-246><a id=__codelineno-8-246 name=__codelineno-8-246 href=#__codelineno-8-246></a><span class=s2>        FROM current_cpe_data c</span>
</span><span id=__span-8-247><a id=__codelineno-8-247 name=__codelineno-8-247 href=#__codelineno-8-247></a><span class=s2>        INNER JOIN old_cpe_data o ON c.cve_id = o.cve_id</span>
</span><span id=__span-8-248><a id=__codelineno-8-248 name=__codelineno-8-248 href=#__codelineno-8-248></a><span class=s2>        WHERE ABS(c.current_cpe_count - o.old_cpe_count) &gt;= 10</span>
</span><span id=__span-8-249><a id=__codelineno-8-249 name=__codelineno-8-249 href=#__codelineno-8-249></a><span class=s2>    )</span>
</span><span id=__span-8-250><a id=__codelineno-8-250 name=__codelineno-8-250 href=#__codelineno-8-250></a><span class=s2>    SELECT *</span>
</span><span id=__span-8-251><a id=__codelineno-8-251 name=__codelineno-8-251 href=#__codelineno-8-251></a><span class=s2>    FROM significant_changes</span>
</span><span id=__span-8-252><a id=__codelineno-8-252 name=__codelineno-8-252 href=#__codelineno-8-252></a><span class=s2>    ORDER BY ABS(cpe_difference) DESC</span>
</span><span id=__span-8-253><a id=__codelineno-8-253 name=__codelineno-8-253 href=#__codelineno-8-253></a><span class=s2>    LIMIT 20</span>
</span><span id=__span-8-254><a id=__codelineno-8-254 name=__codelineno-8-254 href=#__codelineno-8-254></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-8-255><a id=__codelineno-8-255 name=__codelineno-8-255 href=#__codelineno-8-255></a>
</span><span id=__span-8-256><a id=__codelineno-8-256 name=__codelineno-8-256 href=#__codelineno-8-256></a>    <span class=n>significant_changes</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>detailed_cpe_changes_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-8-257><a id=__codelineno-8-257 name=__codelineno-8-257 href=#__codelineno-8-257></a>
</span><span id=__span-8-258><a id=__codelineno-8-258 name=__codelineno-8-258 href=#__codelineno-8-258></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 20 CVEs with Most Significant CPE Changes:&quot;</span><span class=p>)</span>
</span><span id=__span-8-259><a id=__codelineno-8-259 name=__codelineno-8-259 href=#__codelineno-8-259></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>150</span><span class=p>)</span>
</span><span id=__span-8-260><a id=__codelineno-8-260 name=__codelineno-8-260 href=#__codelineno-8-260></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;CVE ID&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Year&#39;</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CVSS&#39;</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Old&#39;</span><span class=si>:</span><span class=s2>&lt;5</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;New&#39;</span><span class=si>:</span><span class=s2>&lt;5</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Diff&#39;</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Type&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Description Sample&#39;</span><span class=si>:</span><span class=s2>&lt;60</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-261><a id=__codelineno-8-261 name=__codelineno-8-261 href=#__codelineno-8-261></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>150</span><span class=p>)</span>
</span><span id=__span-8-262><a id=__codelineno-8-262 name=__codelineno-8-262 href=#__codelineno-8-262></a>
</span><span id=__span-8-263><a id=__codelineno-8-263 name=__codelineno-8-263 href=#__codelineno-8-263></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>significant_changes</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-8-264><a id=__codelineno-8-264 name=__codelineno-8-264 href=#__codelineno-8-264></a>        <span class=n>year</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;date_published&#39;</span><span class=p>])[:</span><span class=mi>4</span><span class=p>]</span> <span class=k>if</span> <span class=n>pd</span><span class=o>.</span><span class=n>notna</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;date_published&#39;</span><span class=p>])</span> <span class=k>else</span> <span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-8-265><a id=__codelineno-8-265 name=__codelineno-8-265 href=#__codelineno-8-265></a>        <span class=n>cvss</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cvss_v3_score&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>if</span> <span class=n>pd</span><span class=o>.</span><span class=n>notna</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cvss_v3_score&#39;</span><span class=p>])</span> <span class=k>else</span> <span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-8-266><a id=__codelineno-8-266 name=__codelineno-8-266 href=#__codelineno-8-266></a>        <span class=n>desc</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;description_sample&#39;</span><span class=p>])[:</span><span class=mi>58</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;description_sample&#39;</span><span class=p>]))</span> <span class=o>&gt;</span> <span class=mi>60</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;description_sample&#39;</span><span class=p>])</span>
</span><span id=__span-8-267><a id=__codelineno-8-267 name=__codelineno-8-267 href=#__codelineno-8-267></a>        <span class=n>change_sign</span> <span class=o>=</span> <span class=s2>&quot;+&quot;</span> <span class=k>if</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpe_difference&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span>
</span><span id=__span-8-268><a id=__codelineno-8-268 name=__codelineno-8-268 href=#__codelineno-8-268></a>
</span><span id=__span-8-269><a id=__codelineno-8-269 name=__codelineno-8-269 href=#__codelineno-8-269></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_id&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>year</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>cvss</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;old_cpe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;5</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;current_cpe_count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;5</span><span class=si>}</span><span class=s2> &quot;</span>
</span><span id=__span-8-270><a id=__codelineno-8-270 name=__codelineno-8-270 href=#__codelineno-8-270></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>change_sign</span><span class=si>}{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpe_difference&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;change_type&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>desc</span><span class=si>:</span><span class=s2>&lt;60</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-271><a id=__codelineno-8-271 name=__codelineno-8-271 href=#__codelineno-8-271></a>
</span><span id=__span-8-272><a id=__codelineno-8-272 name=__codelineno-8-272 href=#__codelineno-8-272></a>    <span class=c1># Detailed analysis of specific examples</span>
</span><span id=__span-8-273><a id=__codelineno-8-273 name=__codelineno-8-273 href=#__codelineno-8-273></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n\n</span><span class=s2>3. Detailed Platform Analysis for Significant Changes...&quot;</span><span class=p>)</span>
</span><span id=__span-8-274><a id=__codelineno-8-274 name=__codelineno-8-274 href=#__codelineno-8-274></a>
</span><span id=__span-8-275><a id=__codelineno-8-275 name=__codelineno-8-275 href=#__codelineno-8-275></a>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>significant_changes</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-8-276><a id=__codelineno-8-276 name=__codelineno-8-276 href=#__codelineno-8-276></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>100</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-277><a id=__codelineno-8-277 name=__codelineno-8-277 href=#__codelineno-8-277></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CVE: </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> | Change: </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpe_difference&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>+</span><span class=si>}</span><span class=s2> CPEs | Type: </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;change_type&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-278><a id=__codelineno-8-278 name=__codelineno-8-278 href=#__codelineno-8-278></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Published: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;date_published&#39;</span><span class=p>])[:</span><span class=mi>10</span><span class=p>]</span><span class=si>}</span><span class=s2> | CVSS: </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cvss_v3_score&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-279><a id=__codelineno-8-279 name=__codelineno-8-279 href=#__codelineno-8-279></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Description: </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;description_sample&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>...&quot;</span><span class=p>)</span>
</span><span id=__span-8-280><a id=__codelineno-8-280 name=__codelineno-8-280 href=#__codelineno-8-280></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;=&#39;</span><span class=o>*</span><span class=mi>100</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-281><a id=__codelineno-8-281 name=__codelineno-8-281 href=#__codelineno-8-281></a>
</span><span id=__span-8-282><a id=__codelineno-8-282 name=__codelineno-8-282 href=#__codelineno-8-282></a>        <span class=c1># Analyze old CPEs</span>
</span><span id=__span-8-283><a id=__codelineno-8-283 name=__codelineno-8-283 href=#__codelineno-8-283></a>        <span class=k>if</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;old_cpes&#39;</span><span class=p>]</span> <span class=ow>and</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;old_cpes&#39;</span><span class=p>])</span> <span class=o>!=</span> <span class=s1>&#39;nan&#39;</span><span class=p>:</span>
</span><span id=__span-8-284><a id=__codelineno-8-284 name=__codelineno-8-284 href=#__codelineno-8-284></a>            <span class=n>old_cpes_list</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;old_cpes&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)</span>
</span><span id=__span-8-285><a id=__codelineno-8-285 name=__codelineno-8-285 href=#__codelineno-8-285></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>OLD CPEs (</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>old_cpes_list</span><span class=p>)</span><span class=si>}</span><span class=s2> entries):&quot;</span><span class=p>)</span>
</span><span id=__span-8-286><a id=__codelineno-8-286 name=__codelineno-8-286 href=#__codelineno-8-286></a>            <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>80</span><span class=p>)</span>
</span><span id=__span-8-287><a id=__codelineno-8-287 name=__codelineno-8-287 href=#__codelineno-8-287></a>
</span><span id=__span-8-288><a id=__codelineno-8-288 name=__codelineno-8-288 href=#__codelineno-8-288></a>            <span class=c1># Extract and analyze platforms from old CPEs</span>
</span><span id=__span-8-289><a id=__codelineno-8-289 name=__codelineno-8-289 href=#__codelineno-8-289></a>            <span class=n>old_platforms</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-8-290><a id=__codelineno-8-290 name=__codelineno-8-290 href=#__codelineno-8-290></a>            <span class=n>old_vendors</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-8-291><a id=__codelineno-8-291 name=__codelineno-8-291 href=#__codelineno-8-291></a>            <span class=n>old_products</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-8-292><a id=__codelineno-8-292 name=__codelineno-8-292 href=#__codelineno-8-292></a>
</span><span id=__span-8-293><a id=__codelineno-8-293 name=__codelineno-8-293 href=#__codelineno-8-293></a>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>cpe</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>old_cpes_list</span><span class=p>[:</span><span class=mi>10</span><span class=p>]):</span>  <span class=c1># Show first 10</span>
</span><span id=__span-8-294><a id=__codelineno-8-294 name=__codelineno-8-294 href=#__codelineno-8-294></a>                <span class=n>cpe</span> <span class=o>=</span> <span class=n>cpe</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span><span id=__span-8-295><a id=__codelineno-8-295 name=__codelineno-8-295 href=#__codelineno-8-295></a>                <span class=k>if</span> <span class=n>cpe</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;cpe:&#39;</span><span class=p>):</span>
</span><span id=__span-8-296><a id=__codelineno-8-296 name=__codelineno-8-296 href=#__codelineno-8-296></a>                    <span class=n>parts</span> <span class=o>=</span> <span class=n>cpe</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span><span id=__span-8-297><a id=__codelineno-8-297 name=__codelineno-8-297 href=#__codelineno-8-297></a>                    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>6</span><span class=p>:</span>
</span><span id=__span-8-298><a id=__codelineno-8-298 name=__codelineno-8-298 href=#__codelineno-8-298></a>                        <span class=n>vendor</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>3</span> <span class=k>else</span> <span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-8-299><a id=__codelineno-8-299 name=__codelineno-8-299 href=#__codelineno-8-299></a>                        <span class=n>product</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>4</span> <span class=k>else</span> <span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-8-300><a id=__codelineno-8-300 name=__codelineno-8-300 href=#__codelineno-8-300></a>                        <span class=n>version</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>5</span> <span class=k>else</span> <span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-8-301><a id=__codelineno-8-301 name=__codelineno-8-301 href=#__codelineno-8-301></a>
</span><span id=__span-8-302><a id=__codelineno-8-302 name=__codelineno-8-302 href=#__codelineno-8-302></a>                        <span class=n>old_vendors</span><span class=p>[</span><span class=n>vendor</span><span class=p>]</span> <span class=o>=</span> <span class=n>old_vendors</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>vendor</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-8-303><a id=__codelineno-8-303 name=__codelineno-8-303 href=#__codelineno-8-303></a>                        <span class=n>old_products</span><span class=p>[</span><span class=n>product</span><span class=p>]</span> <span class=o>=</span> <span class=n>old_products</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>product</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-8-304><a id=__codelineno-8-304 name=__codelineno-8-304 href=#__codelineno-8-304></a>
</span><span id=__span-8-305><a id=__codelineno-8-305 name=__codelineno-8-305 href=#__codelineno-8-305></a>                        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>:</span><span class=s2>2</span><span class=si>}</span><span class=s2>. Vendor: </span><span class=si>{</span><span class=n>vendor</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> Product: </span><span class=si>{</span><span class=n>product</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> Version: </span><span class=si>{</span><span class=n>version</span><span class=p>[:</span><span class=mi>15</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-306><a id=__codelineno-8-306 name=__codelineno-8-306 href=#__codelineno-8-306></a>
</span><span id=__span-8-307><a id=__codelineno-8-307 name=__codelineno-8-307 href=#__codelineno-8-307></a>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>old_cpes_list</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>
</span><span id=__span-8-308><a id=__codelineno-8-308 name=__codelineno-8-308 href=#__codelineno-8-308></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ... and </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>old_cpes_list</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>10</span><span class=si>}</span><span class=s2> more CPEs&quot;</span><span class=p>)</span>
</span><span id=__span-8-309><a id=__codelineno-8-309 name=__codelineno-8-309 href=#__codelineno-8-309></a>
</span><span id=__span-8-310><a id=__codelineno-8-310 name=__codelineno-8-310 href=#__codelineno-8-310></a>            <span class=c1># Show top vendors/products in old</span>
</span><span id=__span-8-311><a id=__codelineno-8-311 name=__codelineno-8-311 href=#__codelineno-8-311></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>  Top Vendors in OLD: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>k</span><span class=si>}</span><span class=s1>(</span><span class=si>{</span><span class=n>v</span><span class=si>}</span><span class=s1>)&#39;</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>k</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=ow>in</span><span class=w> </span><span class=nb>sorted</span><span class=p>(</span><span class=n>old_vendors</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span><span class=w> </span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span><span class=w> </span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)[:</span><span class=mi>5</span><span class=p>]])</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-312><a id=__codelineno-8-312 name=__codelineno-8-312 href=#__codelineno-8-312></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Top Products in OLD: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>k</span><span class=si>}</span><span class=s1>(</span><span class=si>{</span><span class=n>v</span><span class=si>}</span><span class=s1>)&#39;</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>k</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=ow>in</span><span class=w> </span><span class=nb>sorted</span><span class=p>(</span><span class=n>old_products</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span><span class=w> </span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span><span class=w> </span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)[:</span><span class=mi>5</span><span class=p>]])</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-313><a id=__codelineno-8-313 name=__codelineno-8-313 href=#__codelineno-8-313></a>
</span><span id=__span-8-314><a id=__codelineno-8-314 name=__codelineno-8-314 href=#__codelineno-8-314></a>        <span class=c1># Analyze new CPEs</span>
</span><span id=__span-8-315><a id=__codelineno-8-315 name=__codelineno-8-315 href=#__codelineno-8-315></a>        <span class=k>if</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;current_cpes&#39;</span><span class=p>]</span> <span class=ow>and</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;current_cpes&#39;</span><span class=p>])</span> <span class=o>!=</span> <span class=s1>&#39;nan&#39;</span><span class=p>:</span>
</span><span id=__span-8-316><a id=__codelineno-8-316 name=__codelineno-8-316 href=#__codelineno-8-316></a>            <span class=n>current_cpes_list</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;current_cpes&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)</span>
</span><span id=__span-8-317><a id=__codelineno-8-317 name=__codelineno-8-317 href=#__codelineno-8-317></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>NEW CPEs (</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>current_cpes_list</span><span class=p>)</span><span class=si>}</span><span class=s2> entries):&quot;</span><span class=p>)</span>
</span><span id=__span-8-318><a id=__codelineno-8-318 name=__codelineno-8-318 href=#__codelineno-8-318></a>            <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>80</span><span class=p>)</span>
</span><span id=__span-8-319><a id=__codelineno-8-319 name=__codelineno-8-319 href=#__codelineno-8-319></a>
</span><span id=__span-8-320><a id=__codelineno-8-320 name=__codelineno-8-320 href=#__codelineno-8-320></a>            <span class=c1># Extract and analyze platforms from new CPEs</span>
</span><span id=__span-8-321><a id=__codelineno-8-321 name=__codelineno-8-321 href=#__codelineno-8-321></a>            <span class=n>new_platforms</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-8-322><a id=__codelineno-8-322 name=__codelineno-8-322 href=#__codelineno-8-322></a>            <span class=n>new_vendors</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-8-323><a id=__codelineno-8-323 name=__codelineno-8-323 href=#__codelineno-8-323></a>            <span class=n>new_products</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-8-324><a id=__codelineno-8-324 name=__codelineno-8-324 href=#__codelineno-8-324></a>
</span><span id=__span-8-325><a id=__codelineno-8-325 name=__codelineno-8-325 href=#__codelineno-8-325></a>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>cpe</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>current_cpes_list</span><span class=p>[:</span><span class=mi>10</span><span class=p>]):</span>  <span class=c1># Show first 10</span>
</span><span id=__span-8-326><a id=__codelineno-8-326 name=__codelineno-8-326 href=#__codelineno-8-326></a>                <span class=n>cpe</span> <span class=o>=</span> <span class=n>cpe</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span><span id=__span-8-327><a id=__codelineno-8-327 name=__codelineno-8-327 href=#__codelineno-8-327></a>                <span class=k>if</span> <span class=n>cpe</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;cpe:&#39;</span><span class=p>):</span>
</span><span id=__span-8-328><a id=__codelineno-8-328 name=__codelineno-8-328 href=#__codelineno-8-328></a>                    <span class=n>parts</span> <span class=o>=</span> <span class=n>cpe</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span><span id=__span-8-329><a id=__codelineno-8-329 name=__codelineno-8-329 href=#__codelineno-8-329></a>                    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>6</span><span class=p>:</span>
</span><span id=__span-8-330><a id=__codelineno-8-330 name=__codelineno-8-330 href=#__codelineno-8-330></a>                        <span class=n>vendor</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>3</span> <span class=k>else</span> <span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-8-331><a id=__codelineno-8-331 name=__codelineno-8-331 href=#__codelineno-8-331></a>                        <span class=n>product</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>4</span> <span class=k>else</span> <span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-8-332><a id=__codelineno-8-332 name=__codelineno-8-332 href=#__codelineno-8-332></a>                        <span class=n>version</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>5</span> <span class=k>else</span> <span class=s1>&#39;N/A&#39;</span>
</span><span id=__span-8-333><a id=__codelineno-8-333 name=__codelineno-8-333 href=#__codelineno-8-333></a>
</span><span id=__span-8-334><a id=__codelineno-8-334 name=__codelineno-8-334 href=#__codelineno-8-334></a>                        <span class=n>new_vendors</span><span class=p>[</span><span class=n>vendor</span><span class=p>]</span> <span class=o>=</span> <span class=n>new_vendors</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>vendor</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-8-335><a id=__codelineno-8-335 name=__codelineno-8-335 href=#__codelineno-8-335></a>                        <span class=n>new_products</span><span class=p>[</span><span class=n>product</span><span class=p>]</span> <span class=o>=</span> <span class=n>new_products</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>product</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-8-336><a id=__codelineno-8-336 name=__codelineno-8-336 href=#__codelineno-8-336></a>
</span><span id=__span-8-337><a id=__codelineno-8-337 name=__codelineno-8-337 href=#__codelineno-8-337></a>                        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>:</span><span class=s2>2</span><span class=si>}</span><span class=s2>. Vendor: </span><span class=si>{</span><span class=n>vendor</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> Product: </span><span class=si>{</span><span class=n>product</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> Version: </span><span class=si>{</span><span class=n>version</span><span class=p>[:</span><span class=mi>15</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-338><a id=__codelineno-8-338 name=__codelineno-8-338 href=#__codelineno-8-338></a>
</span><span id=__span-8-339><a id=__codelineno-8-339 name=__codelineno-8-339 href=#__codelineno-8-339></a>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>current_cpes_list</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>
</span><span id=__span-8-340><a id=__codelineno-8-340 name=__codelineno-8-340 href=#__codelineno-8-340></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ... and </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>current_cpes_list</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>10</span><span class=si>}</span><span class=s2> more CPEs&quot;</span><span class=p>)</span>
</span><span id=__span-8-341><a id=__codelineno-8-341 name=__codelineno-8-341 href=#__codelineno-8-341></a>
</span><span id=__span-8-342><a id=__codelineno-8-342 name=__codelineno-8-342 href=#__codelineno-8-342></a>            <span class=c1># Show top vendors/products in new</span>
</span><span id=__span-8-343><a id=__codelineno-8-343 name=__codelineno-8-343 href=#__codelineno-8-343></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>  Top Vendors in NEW: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>k</span><span class=si>}</span><span class=s1>(</span><span class=si>{</span><span class=n>v</span><span class=si>}</span><span class=s1>)&#39;</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>k</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=ow>in</span><span class=w> </span><span class=nb>sorted</span><span class=p>(</span><span class=n>new_vendors</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span><span class=w> </span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span><span class=w> </span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)[:</span><span class=mi>5</span><span class=p>]])</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-344><a id=__codelineno-8-344 name=__codelineno-8-344 href=#__codelineno-8-344></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Top Products in NEW: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>k</span><span class=si>}</span><span class=s1>(</span><span class=si>{</span><span class=n>v</span><span class=si>}</span><span class=s1>)&#39;</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>k</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=ow>in</span><span class=w> </span><span class=nb>sorted</span><span class=p>(</span><span class=n>new_products</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span><span class=w> </span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span><span class=w> </span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)[:</span><span class=mi>5</span><span class=p>]])</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-345><a id=__codelineno-8-345 name=__codelineno-8-345 href=#__codelineno-8-345></a>
</span><span id=__span-8-346><a id=__codelineno-8-346 name=__codelineno-8-346 href=#__codelineno-8-346></a>            <span class=c1># Analysis of changes</span>
</span><span id=__span-8-347><a id=__codelineno-8-347 name=__codelineno-8-347 href=#__codelineno-8-347></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>  CHANGE ANALYSIS:&quot;</span><span class=p>)</span>
</span><span id=__span-8-348><a id=__codelineno-8-348 name=__codelineno-8-348 href=#__codelineno-8-348></a>            <span class=k>if</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;change_type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;Removed&#39;</span><span class=p>:</span>
</span><span id=__span-8-349><a id=__codelineno-8-349 name=__codelineno-8-349 href=#__codelineno-8-349></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  🔴 MAJOR REDUCTION: </span><span class=si>{</span><span class=nb>abs</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpe_difference&#39;</span><span class=p>])</span><span class=si>}</span><span class=s2> CPEs removed&quot;</span><span class=p>)</span>
</span><span id=__span-8-350><a id=__codelineno-8-350 name=__codelineno-8-350 href=#__codelineno-8-350></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  🔍 Possible reasons: Data cleanup, consolidation, or specificity improvement&quot;</span><span class=p>)</span>
</span><span id=__span-8-351><a id=__codelineno-8-351 name=__codelineno-8-351 href=#__codelineno-8-351></a>
</span><span id=__span-8-352><a id=__codelineno-8-352 name=__codelineno-8-352 href=#__codelineno-8-352></a>                <span class=c1># Check if vendors/products are similar</span>
</span><span id=__span-8-353><a id=__codelineno-8-353 name=__codelineno-8-353 href=#__codelineno-8-353></a>                <span class=k>if</span> <span class=n>old_vendors</span> <span class=ow>and</span> <span class=n>new_vendors</span><span class=p>:</span>
</span><span id=__span-8-354><a id=__codelineno-8-354 name=__codelineno-8-354 href=#__codelineno-8-354></a>                    <span class=n>common_vendors</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>old_vendors</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span><span class=o>.</span><span class=n>intersection</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>new_vendors</span><span class=o>.</span><span class=n>keys</span><span class=p>()))</span>
</span><span id=__span-8-355><a id=__codelineno-8-355 name=__codelineno-8-355 href=#__codelineno-8-355></a>                    <span class=k>if</span> <span class=n>common_vendors</span><span class=p>:</span>
</span><span id=__span-8-356><a id=__codelineno-8-356 name=__codelineno-8-356 href=#__codelineno-8-356></a>                        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ✅ Common vendors maintained: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>common_vendors</span><span class=p>)[:</span><span class=mi>3</span><span class=p>])</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-357><a id=__codelineno-8-357 name=__codelineno-8-357 href=#__codelineno-8-357></a>                    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-8-358><a id=__codelineno-8-358 name=__codelineno-8-358 href=#__codelineno-8-358></a>                        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ⚠️  Vendors completely changed!&quot;</span><span class=p>)</span>
</span><span id=__span-8-359><a id=__codelineno-8-359 name=__codelineno-8-359 href=#__codelineno-8-359></a>
</span><span id=__span-8-360><a id=__codelineno-8-360 name=__codelineno-8-360 href=#__codelineno-8-360></a>            <span class=k>elif</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;change_type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;Added&#39;</span><span class=p>:</span>
</span><span id=__span-8-361><a id=__codelineno-8-361 name=__codelineno-8-361 href=#__codelineno-8-361></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  🟢 MAJOR ADDITION: </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpe_difference&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> CPEs added&quot;</span><span class=p>)</span>
</span><span id=__span-8-362><a id=__codelineno-8-362 name=__codelineno-8-362 href=#__codelineno-8-362></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  🔍 Possible reasons: Extended coverage, new versions discovered, or improved data&quot;</span><span class=p>)</span>
</span><span id=__span-8-363><a id=__codelineno-8-363 name=__codelineno-8-363 href=#__codelineno-8-363></a>
</span><span id=__span-8-364><a id=__codelineno-8-364 name=__codelineno-8-364 href=#__codelineno-8-364></a>                <span class=c1># Check if this represents expansion or completely new data</span>
</span><span id=__span-8-365><a id=__codelineno-8-365 name=__codelineno-8-365 href=#__codelineno-8-365></a>                <span class=k>if</span> <span class=n>old_vendors</span> <span class=ow>and</span> <span class=n>new_vendors</span><span class=p>:</span>
</span><span id=__span-8-366><a id=__codelineno-8-366 name=__codelineno-8-366 href=#__codelineno-8-366></a>                    <span class=n>common_vendors</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>old_vendors</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span><span class=o>.</span><span class=n>intersection</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>new_vendors</span><span class=o>.</span><span class=n>keys</span><span class=p>()))</span>
</span><span id=__span-8-367><a id=__codelineno-8-367 name=__codelineno-8-367 href=#__codelineno-8-367></a>                    <span class=k>if</span> <span class=n>common_vendors</span><span class=p>:</span>
</span><span id=__span-8-368><a id=__codelineno-8-368 name=__codelineno-8-368 href=#__codelineno-8-368></a>                        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ✅ Expansion of existing vendors: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>common_vendors</span><span class=p>)[:</span><span class=mi>3</span><span class=p>])</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-369><a id=__codelineno-8-369 name=__codelineno-8-369 href=#__codelineno-8-369></a>                    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-8-370><a id=__codelineno-8-370 name=__codelineno-8-370 href=#__codelineno-8-370></a>                        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  🆕 Completely new vendors added&quot;</span><span class=p>)</span>
</span><span id=__span-8-371><a id=__codelineno-8-371 name=__codelineno-8-371 href=#__codelineno-8-371></a>
</span><span id=__span-8-372><a id=__codelineno-8-372 name=__codelineno-8-372 href=#__codelineno-8-372></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span>
</span><span id=__span-8-373><a id=__codelineno-8-373 name=__codelineno-8-373 href=#__codelineno-8-373></a>
</span><span id=__span-8-374><a id=__codelineno-8-374 name=__codelineno-8-374 href=#__codelineno-8-374></a>    <span class=k>return</span> <span class=n>significant_changes</span>
</span><span id=__span-8-375><a id=__codelineno-8-375 name=__codelineno-8-375 href=#__codelineno-8-375></a>
</span><span id=__span-8-376><a id=__codelineno-8-376 name=__codelineno-8-376 href=#__codelineno-8-376></a><span class=k>def</span><span class=w> </span><span class=nf>analyze_cpe_platform_patterns</span><span class=p>():</span>
</span><span id=__span-8-377><a id=__codelineno-8-377 name=__codelineno-8-377 href=#__codelineno-8-377></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-8-378><a id=__codelineno-8-378 name=__codelineno-8-378 href=#__codelineno-8-378></a><span class=sd>    Analyze patterns in CPE changes by platform/vendor</span>
</span><span id=__span-8-379><a id=__codelineno-8-379 name=__codelineno-8-379 href=#__codelineno-8-379></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-8-380><a id=__codelineno-8-380 name=__codelineno-8-380 href=#__codelineno-8-380></a>
</span><span id=__span-8-381><a id=__codelineno-8-381 name=__codelineno-8-381 href=#__codelineno-8-381></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n\n</span><span class=s2>4. Analyzing CPE Change Patterns by Platform/Vendor...&quot;</span><span class=p>)</span>
</span><span id=__span-8-382><a id=__codelineno-8-382 name=__codelineno-8-382 href=#__codelineno-8-382></a>
</span><span id=__span-8-383><a id=__codelineno-8-383 name=__codelineno-8-383 href=#__codelineno-8-383></a>    <span class=c1># Analyze which vendors/platforms had the most changes</span>
</span><span id=__span-8-384><a id=__codelineno-8-384 name=__codelineno-8-384 href=#__codelineno-8-384></a>    <span class=n>platform_changes_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-8-385><a id=__codelineno-8-385 name=__codelineno-8-385 href=#__codelineno-8-385></a><span class=s2>    WITH current_cpe_expanded AS (</span>
</span><span id=__span-8-386><a id=__codelineno-8-386 name=__codelineno-8-386 href=#__codelineno-8-386></a><span class=s2>        SELECT </span>
</span><span id=__span-8-387><a id=__codelineno-8-387 name=__codelineno-8-387 href=#__codelineno-8-387></a><span class=s2>            cve_id,</span>
</span><span id=__span-8-388><a id=__codelineno-8-388 name=__codelineno-8-388 href=#__codelineno-8-388></a><span class=s2>            TRIM(UNNEST(STRING_SPLIT(cpes, &#39;,&#39;))) as cpe_entry</span>
</span><span id=__span-8-389><a id=__codelineno-8-389 name=__codelineno-8-389 href=#__codelineno-8-389></a><span class=s2>        FROM cve_main </span>
</span><span id=__span-8-390><a id=__codelineno-8-390 name=__codelineno-8-390 href=#__codelineno-8-390></a><span class=s2>        WHERE cpes IS NOT NULL </span>
</span><span id=__span-8-391><a id=__codelineno-8-391 name=__codelineno-8-391 href=#__codelineno-8-391></a><span class=s2>            AND cpes != &#39;&#39;</span>
</span><span id=__span-8-392><a id=__codelineno-8-392 name=__codelineno-8-392 href=#__codelineno-8-392></a><span class=s2>            AND state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-8-393><a id=__codelineno-8-393 name=__codelineno-8-393 href=#__codelineno-8-393></a><span class=s2>            AND date_published &lt;= &#39;2024-04-21&#39;</span>
</span><span id=__span-8-394><a id=__codelineno-8-394 name=__codelineno-8-394 href=#__codelineno-8-394></a><span class=s2>    ),</span>
</span><span id=__span-8-395><a id=__codelineno-8-395 name=__codelineno-8-395 href=#__codelineno-8-395></a><span class=s2>    old_cpe_expanded AS (</span>
</span><span id=__span-8-396><a id=__codelineno-8-396 name=__codelineno-8-396 href=#__codelineno-8-396></a><span class=s2>        SELECT </span>
</span><span id=__span-8-397><a id=__codelineno-8-397 name=__codelineno-8-397 href=#__codelineno-8-397></a><span class=s2>            &quot;CVE ID&quot; as cve_id,</span>
</span><span id=__span-8-398><a id=__codelineno-8-398 name=__codelineno-8-398 href=#__codelineno-8-398></a><span class=s2>            TRIM(UNNEST(STRING_SPLIT(&quot;Software CPES&quot;, &#39;,&#39;))) as cpe_entry</span>
</span><span id=__span-8-399><a id=__codelineno-8-399 name=__codelineno-8-399 href=#__codelineno-8-399></a><span class=s2>        FROM cve_main_old </span>
</span><span id=__span-8-400><a id=__codelineno-8-400 name=__codelineno-8-400 href=#__codelineno-8-400></a><span class=s2>        WHERE &quot;Software CPES&quot; IS NOT NULL </span>
</span><span id=__span-8-401><a id=__codelineno-8-401 name=__codelineno-8-401 href=#__codelineno-8-401></a><span class=s2>            AND &quot;Software CPES&quot; != &#39;&#39;</span>
</span><span id=__span-8-402><a id=__codelineno-8-402 name=__codelineno-8-402 href=#__codelineno-8-402></a><span class=s2>            AND &quot;State&quot; = &#39;PUBLISHED&#39;</span>
</span><span id=__span-8-403><a id=__codelineno-8-403 name=__codelineno-8-403 href=#__codelineno-8-403></a><span class=s2>    ),</span>
</span><span id=__span-8-404><a id=__codelineno-8-404 name=__codelineno-8-404 href=#__codelineno-8-404></a><span class=s2>    current_vendors AS (</span>
</span><span id=__span-8-405><a id=__codelineno-8-405 name=__codelineno-8-405 href=#__codelineno-8-405></a><span class=s2>        SELECT </span>
</span><span id=__span-8-406><a id=__codelineno-8-406 name=__codelineno-8-406 href=#__codelineno-8-406></a><span class=s2>            cve_id,</span>
</span><span id=__span-8-407><a id=__codelineno-8-407 name=__codelineno-8-407 href=#__codelineno-8-407></a><span class=s2>            SPLIT_PART(cpe_entry, &#39;:&#39;, 4) as vendor,</span>
</span><span id=__span-8-408><a id=__codelineno-8-408 name=__codelineno-8-408 href=#__codelineno-8-408></a><span class=s2>            COUNT(*) as current_count</span>
</span><span id=__span-8-409><a id=__codelineno-8-409 name=__codelineno-8-409 href=#__codelineno-8-409></a><span class=s2>        FROM current_cpe_expanded</span>
</span><span id=__span-8-410><a id=__codelineno-8-410 name=__codelineno-8-410 href=#__codelineno-8-410></a><span class=s2>        WHERE cpe_entry LIKE &#39;cpe:%&#39;</span>
</span><span id=__span-8-411><a id=__codelineno-8-411 name=__codelineno-8-411 href=#__codelineno-8-411></a><span class=s2>        GROUP BY cve_id, SPLIT_PART(cpe_entry, &#39;:&#39;, 4)</span>
</span><span id=__span-8-412><a id=__codelineno-8-412 name=__codelineno-8-412 href=#__codelineno-8-412></a><span class=s2>    ),</span>
</span><span id=__span-8-413><a id=__codelineno-8-413 name=__codelineno-8-413 href=#__codelineno-8-413></a><span class=s2>    old_vendors AS (</span>
</span><span id=__span-8-414><a id=__codelineno-8-414 name=__codelineno-8-414 href=#__codelineno-8-414></a><span class=s2>        SELECT </span>
</span><span id=__span-8-415><a id=__codelineno-8-415 name=__codelineno-8-415 href=#__codelineno-8-415></a><span class=s2>            cve_id,</span>
</span><span id=__span-8-416><a id=__codelineno-8-416 name=__codelineno-8-416 href=#__codelineno-8-416></a><span class=s2>            SPLIT_PART(cpe_entry, &#39;:&#39;, 4) as vendor,</span>
</span><span id=__span-8-417><a id=__codelineno-8-417 name=__codelineno-8-417 href=#__codelineno-8-417></a><span class=s2>            COUNT(*) as old_count</span>
</span><span id=__span-8-418><a id=__codelineno-8-418 name=__codelineno-8-418 href=#__codelineno-8-418></a><span class=s2>        FROM old_cpe_expanded</span>
</span><span id=__span-8-419><a id=__codelineno-8-419 name=__codelineno-8-419 href=#__codelineno-8-419></a><span class=s2>        WHERE cpe_entry LIKE &#39;cpe:%&#39;</span>
</span><span id=__span-8-420><a id=__codelineno-8-420 name=__codelineno-8-420 href=#__codelineno-8-420></a><span class=s2>        GROUP BY cve_id, SPLIT_PART(cpe_entry, &#39;:&#39;, 4)</span>
</span><span id=__span-8-421><a id=__codelineno-8-421 name=__codelineno-8-421 href=#__codelineno-8-421></a><span class=s2>    ),</span>
</span><span id=__span-8-422><a id=__codelineno-8-422 name=__codelineno-8-422 href=#__codelineno-8-422></a><span class=s2>    vendor_changes AS (</span>
</span><span id=__span-8-423><a id=__codelineno-8-423 name=__codelineno-8-423 href=#__codelineno-8-423></a><span class=s2>        SELECT </span>
</span><span id=__span-8-424><a id=__codelineno-8-424 name=__codelineno-8-424 href=#__codelineno-8-424></a><span class=s2>            COALESCE(c.vendor, o.vendor) as vendor,</span>
</span><span id=__span-8-425><a id=__codelineno-8-425 name=__codelineno-8-425 href=#__codelineno-8-425></a><span class=s2>            COALESCE(c.cve_id, o.cve_id) as cve_id,</span>
</span><span id=__span-8-426><a id=__codelineno-8-426 name=__codelineno-8-426 href=#__codelineno-8-426></a><span class=s2>            COALESCE(c.current_count, 0) as current_count,</span>
</span><span id=__span-8-427><a id=__codelineno-8-427 name=__codelineno-8-427 href=#__codelineno-8-427></a><span class=s2>            COALESCE(o.old_count, 0) as old_count,</span>
</span><span id=__span-8-428><a id=__codelineno-8-428 name=__codelineno-8-428 href=#__codelineno-8-428></a><span class=s2>            COALESCE(c.current_count, 0) - COALESCE(o.old_count, 0) as change</span>
</span><span id=__span-8-429><a id=__codelineno-8-429 name=__codelineno-8-429 href=#__codelineno-8-429></a><span class=s2>        FROM current_vendors c</span>
</span><span id=__span-8-430><a id=__codelineno-8-430 name=__codelineno-8-430 href=#__codelineno-8-430></a><span class=s2>        FULL OUTER JOIN old_vendors o ON c.cve_id = o.cve_id AND c.vendor = o.vendor</span>
</span><span id=__span-8-431><a id=__codelineno-8-431 name=__codelineno-8-431 href=#__codelineno-8-431></a><span class=s2>        WHERE COALESCE(c.current_count, 0) != COALESCE(o.old_count, 0)</span>
</span><span id=__span-8-432><a id=__codelineno-8-432 name=__codelineno-8-432 href=#__codelineno-8-432></a><span class=s2>    )</span>
</span><span id=__span-8-433><a id=__codelineno-8-433 name=__codelineno-8-433 href=#__codelineno-8-433></a><span class=s2>    SELECT </span>
</span><span id=__span-8-434><a id=__codelineno-8-434 name=__codelineno-8-434 href=#__codelineno-8-434></a><span class=s2>        vendor,</span>
</span><span id=__span-8-435><a id=__codelineno-8-435 name=__codelineno-8-435 href=#__codelineno-8-435></a><span class=s2>        COUNT(*) as affected_cves,</span>
</span><span id=__span-8-436><a id=__codelineno-8-436 name=__codelineno-8-436 href=#__codelineno-8-436></a><span class=s2>        SUM(change) as total_cpe_change,</span>
</span><span id=__span-8-437><a id=__codelineno-8-437 name=__codelineno-8-437 href=#__codelineno-8-437></a><span class=s2>        AVG(change) as avg_change_per_cve,</span>
</span><span id=__span-8-438><a id=__codelineno-8-438 name=__codelineno-8-438 href=#__codelineno-8-438></a><span class=s2>        COUNT(CASE WHEN change &gt; 0 THEN 1 END) as cves_gained,</span>
</span><span id=__span-8-439><a id=__codelineno-8-439 name=__codelineno-8-439 href=#__codelineno-8-439></a><span class=s2>        COUNT(CASE WHEN change &lt; 0 THEN 1 END) as cves_lost</span>
</span><span id=__span-8-440><a id=__codelineno-8-440 name=__codelineno-8-440 href=#__codelineno-8-440></a><span class=s2>    FROM vendor_changes</span>
</span><span id=__span-8-441><a id=__codelineno-8-441 name=__codelineno-8-441 href=#__codelineno-8-441></a><span class=s2>    WHERE vendor IS NOT NULL </span>
</span><span id=__span-8-442><a id=__codelineno-8-442 name=__codelineno-8-442 href=#__codelineno-8-442></a><span class=s2>        AND vendor != &#39;&#39;</span>
</span><span id=__span-8-443><a id=__codelineno-8-443 name=__codelineno-8-443 href=#__codelineno-8-443></a><span class=s2>        AND vendor != &#39;*&#39;</span>
</span><span id=__span-8-444><a id=__codelineno-8-444 name=__codelineno-8-444 href=#__codelineno-8-444></a><span class=s2>    GROUP BY vendor</span>
</span><span id=__span-8-445><a id=__codelineno-8-445 name=__codelineno-8-445 href=#__codelineno-8-445></a><span class=s2>    HAVING COUNT(*) &gt;= 5</span>
</span><span id=__span-8-446><a id=__codelineno-8-446 name=__codelineno-8-446 href=#__codelineno-8-446></a><span class=s2>    ORDER BY ABS(SUM(change)) DESC</span>
</span><span id=__span-8-447><a id=__codelineno-8-447 name=__codelineno-8-447 href=#__codelineno-8-447></a><span class=s2>    LIMIT 15</span>
</span><span id=__span-8-448><a id=__codelineno-8-448 name=__codelineno-8-448 href=#__codelineno-8-448></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-8-449><a id=__codelineno-8-449 name=__codelineno-8-449 href=#__codelineno-8-449></a>
</span><span id=__span-8-450><a id=__codelineno-8-450 name=__codelineno-8-450 href=#__codelineno-8-450></a>    <span class=n>platform_changes</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>platform_changes_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-8-451><a id=__codelineno-8-451 name=__codelineno-8-451 href=#__codelineno-8-451></a>
</span><span id=__span-8-452><a id=__codelineno-8-452 name=__codelineno-8-452 href=#__codelineno-8-452></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Vendor/Platform Impact Analysis:&quot;</span><span class=p>)</span>
</span><span id=__span-8-453><a id=__codelineno-8-453 name=__codelineno-8-453 href=#__codelineno-8-453></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>110</span><span class=p>)</span>
</span><span id=__span-8-454><a id=__codelineno-8-454 name=__codelineno-8-454 href=#__codelineno-8-454></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Vendor&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Affected CVEs&#39;</span><span class=si>:</span><span class=s2>&lt;13</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Total CPE Change&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Avg Change/CVE&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CVEs Gained&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CVEs Lost&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-455><a id=__codelineno-8-455 name=__codelineno-8-455 href=#__codelineno-8-455></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>110</span><span class=p>)</span>
</span><span id=__span-8-456><a id=__codelineno-8-456 name=__codelineno-8-456 href=#__codelineno-8-456></a>
</span><span id=__span-8-457><a id=__codelineno-8-457 name=__codelineno-8-457 href=#__codelineno-8-457></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>platform_changes</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-8-458><a id=__codelineno-8-458 name=__codelineno-8-458 href=#__codelineno-8-458></a>        <span class=n>vendor_name</span> <span class=o>=</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>][:</span><span class=mi>18</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>20</span> <span class=k>else</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>]</span>
</span><span id=__span-8-459><a id=__codelineno-8-459 name=__codelineno-8-459 href=#__codelineno-8-459></a>        <span class=n>change_sign</span> <span class=o>=</span> <span class=s2>&quot;+&quot;</span> <span class=k>if</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;total_cpe_change&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span>
</span><span id=__span-8-460><a id=__codelineno-8-460 name=__codelineno-8-460 href=#__codelineno-8-460></a>
</span><span id=__span-8-461><a id=__codelineno-8-461 name=__codelineno-8-461 href=#__codelineno-8-461></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>vendor_name</span><span class=o>.</span><span class=n>title</span><span class=p>()</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;affected_cves&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;13,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>change_sign</span><span class=si>}{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;total_cpe_change&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;15,</span><span class=si>}</span><span class=s2> &quot;</span>
</span><span id=__span-8-462><a id=__codelineno-8-462 name=__codelineno-8-462 href=#__codelineno-8-462></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;avg_change_per_cve&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;15.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cves_gained&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;12,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cves_lost&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;10,</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-8-463><a id=__codelineno-8-463 name=__codelineno-8-463 href=#__codelineno-8-463></a>
</span><span id=__span-8-464><a id=__codelineno-8-464 name=__codelineno-8-464 href=#__codelineno-8-464></a>    <span class=c1># Create visualization for platform changes</span>
</span><span id=__span-8-465><a id=__codelineno-8-465 name=__codelineno-8-465 href=#__codelineno-8-465></a>    <span class=n>fig</span><span class=p>,</span> <span class=p>(</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>)</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>8</span><span class=p>))</span>
</span><span id=__span-8-466><a id=__codelineno-8-466 name=__codelineno-8-466 href=#__codelineno-8-466></a>
</span><span id=__span-8-467><a id=__codelineno-8-467 name=__codelineno-8-467 href=#__codelineno-8-467></a>    <span class=c1># Most impacted vendors by total change</span>
</span><span id=__span-8-468><a id=__codelineno-8-468 name=__codelineno-8-468 href=#__codelineno-8-468></a>    <span class=n>top_vendors</span> <span class=o>=</span> <span class=n>platform_changes</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-8-469><a id=__codelineno-8-469 name=__codelineno-8-469 href=#__codelineno-8-469></a>    <span class=n>colors</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;red&#39;</span> <span class=k>if</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=s1>&#39;green&#39;</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>top_vendors</span><span class=p>[</span><span class=s1>&#39;total_cpe_change&#39;</span><span class=p>]]</span>
</span><span id=__span-8-470><a id=__codelineno-8-470 name=__codelineno-8-470 href=#__codelineno-8-470></a>
</span><span id=__span-8-471><a id=__codelineno-8-471 name=__codelineno-8-471 href=#__codelineno-8-471></a>    <span class=n>bars1</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>barh</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>top_vendors</span><span class=p>)),</span> <span class=n>top_vendors</span><span class=p>[</span><span class=s1>&#39;total_cpe_change&#39;</span><span class=p>],</span> 
</span><span id=__span-8-472><a id=__codelineno-8-472 name=__codelineno-8-472 href=#__codelineno-8-472></a>                    <span class=n>color</span><span class=o>=</span><span class=n>colors</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-8-473><a id=__codelineno-8-473 name=__codelineno-8-473 href=#__codelineno-8-473></a>
</span><span id=__span-8-474><a id=__codelineno-8-474 name=__codelineno-8-474 href=#__codelineno-8-474></a>    <span class=n>ax1</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>top_vendors</span><span class=p>)))</span>
</span><span id=__span-8-475><a id=__codelineno-8-475 name=__codelineno-8-475 href=#__codelineno-8-475></a>    <span class=n>ax1</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>([</span><span class=n>vendor</span><span class=p>[:</span><span class=mi>15</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>vendor</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>15</span> <span class=k>else</span> <span class=n>vendor</span> 
</span><span id=__span-8-476><a id=__codelineno-8-476 name=__codelineno-8-476 href=#__codelineno-8-476></a>                        <span class=k>for</span> <span class=n>vendor</span> <span class=ow>in</span> <span class=n>top_vendors</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>]])</span>
</span><span id=__span-8-477><a id=__codelineno-8-477 name=__codelineno-8-477 href=#__codelineno-8-477></a>    <span class=n>ax1</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Total CPE Change&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-8-478><a id=__codelineno-8-478 name=__codelineno-8-478 href=#__codelineno-8-478></a>    <span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Vendors with Largest CPE Changes</span><span class=se>\n</span><span class=s1>(Red=Decreased, Green=Increased)&#39;</span><span class=p>,</span> 
</span><span id=__span-8-479><a id=__codelineno-8-479 name=__codelineno-8-479 href=#__codelineno-8-479></a>                 <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-8-480><a id=__codelineno-8-480 name=__codelineno-8-480 href=#__codelineno-8-480></a>    <span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-8-481><a id=__codelineno-8-481 name=__codelineno-8-481 href=#__codelineno-8-481></a>    <span class=n>ax1</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;-&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-8-482><a id=__codelineno-8-482 name=__codelineno-8-482 href=#__codelineno-8-482></a>
</span><span id=__span-8-483><a id=__codelineno-8-483 name=__codelineno-8-483 href=#__codelineno-8-483></a>    <span class=c1># Affected CVEs by vendor</span>
</span><span id=__span-8-484><a id=__codelineno-8-484 name=__codelineno-8-484 href=#__codelineno-8-484></a>    <span class=n>bars2</span> <span class=o>=</span> <span class=n>ax2</span><span class=o>.</span><span class=n>barh</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>top_vendors</span><span class=p>)),</span> <span class=n>top_vendors</span><span class=p>[</span><span class=s1>&#39;affected_cves&#39;</span><span class=p>],</span> 
</span><span id=__span-8-485><a id=__codelineno-8-485 name=__codelineno-8-485 href=#__codelineno-8-485></a>                    <span class=n>color</span><span class=o>=</span><span class=s1>&#39;skyblue&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-8-486><a id=__codelineno-8-486 name=__codelineno-8-486 href=#__codelineno-8-486></a>
</span><span id=__span-8-487><a id=__codelineno-8-487 name=__codelineno-8-487 href=#__codelineno-8-487></a>    <span class=n>ax2</span><span class=o>.</span><span class=n>set_yticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>top_vendors</span><span class=p>)))</span>
</span><span id=__span-8-488><a id=__codelineno-8-488 name=__codelineno-8-488 href=#__codelineno-8-488></a>    <span class=n>ax2</span><span class=o>.</span><span class=n>set_yticklabels</span><span class=p>([</span><span class=n>vendor</span><span class=p>[:</span><span class=mi>15</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>vendor</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>15</span> <span class=k>else</span> <span class=n>vendor</span> 
</span><span id=__span-8-489><a id=__codelineno-8-489 name=__codelineno-8-489 href=#__codelineno-8-489></a>                        <span class=k>for</span> <span class=n>vendor</span> <span class=ow>in</span> <span class=n>top_vendors</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>]])</span>
</span><span id=__span-8-490><a id=__codelineno-8-490 name=__codelineno-8-490 href=#__codelineno-8-490></a>    <span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Number of Affected CVEs&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-8-491><a id=__codelineno-8-491 name=__codelineno-8-491 href=#__codelineno-8-491></a>    <span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Vendors by Number of CVEs with CPE Changes&#39;</span><span class=p>,</span> 
</span><span id=__span-8-492><a id=__codelineno-8-492 name=__codelineno-8-492 href=#__codelineno-8-492></a>                 <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-8-493><a id=__codelineno-8-493 name=__codelineno-8-493 href=#__codelineno-8-493></a>    <span class=n>ax2</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-8-494><a id=__codelineno-8-494 name=__codelineno-8-494 href=#__codelineno-8-494></a>
</span><span id=__span-8-495><a id=__codelineno-8-495 name=__codelineno-8-495 href=#__codelineno-8-495></a>    <span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-8-496><a id=__codelineno-8-496 name=__codelineno-8-496 href=#__codelineno-8-496></a>    <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;cpe_platform_changes_analysis.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span><span id=__span-8-497><a id=__codelineno-8-497 name=__codelineno-8-497 href=#__codelineno-8-497></a>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-8-498><a id=__codelineno-8-498 name=__codelineno-8-498 href=#__codelineno-8-498></a>
</span><span id=__span-8-499><a id=__codelineno-8-499 name=__codelineno-8-499 href=#__codelineno-8-499></a>    <span class=k>return</span> <span class=n>platform_changes</span>
</span><span id=__span-8-500><a id=__codelineno-8-500 name=__codelineno-8-500 href=#__codelineno-8-500></a>
</span><span id=__span-8-501><a id=__codelineno-8-501 name=__codelineno-8-501 href=#__codelineno-8-501></a><span class=c1># Execute the enhanced analysis</span>
</span><span id=__span-8-502><a id=__codelineno-8-502 name=__codelineno-8-502 href=#__codelineno-8-502></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Starting Enhanced CPE Analysis...&quot;</span><span class=p>)</span>
</span><span id=__span-8-503><a id=__codelineno-8-503 name=__codelineno-8-503 href=#__codelineno-8-503></a><span class=n>old_coverage</span><span class=p>,</span> <span class=n>current_coverage</span> <span class=o>=</span> <span class=n>enhanced_cpe_coverage_analysis</span><span class=p>()</span>
</span><span id=__span-8-504><a id=__codelineno-8-504 name=__codelineno-8-504 href=#__codelineno-8-504></a><span class=n>significant_changes_data</span> <span class=o>=</span> <span class=n>analyze_significant_cpe_changes</span><span class=p>()</span>
</span><span id=__span-8-505><a id=__codelineno-8-505 name=__codelineno-8-505 href=#__codelineno-8-505></a><span class=n>platform_changes_data</span> <span class=o>=</span> <span class=n>analyze_cpe_platform_patterns</span><span class=p>()</span>
</span><span id=__span-8-506><a id=__codelineno-8-506 name=__codelineno-8-506 href=#__codelineno-8-506></a>
</span><span id=__span-8-507><a id=__codelineno-8-507 name=__codelineno-8-507 href=#__codelineno-8-507></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n\n</span><span class=s2>=== ANALYSIS COMPLETE ===&quot;</span><span class=p>)</span>
</span><span id=__span-8-508><a id=__codelineno-8-508 name=__codelineno-8-508 href=#__codelineno-8-508></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Generated visualizations:&quot;</span><span class=p>)</span>
</span><span id=__span-8-509><a id=__codelineno-8-509 name=__codelineno-8-509 href=#__codelineno-8-509></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. cpe_coverage_trends_analysis.png - Yearly CPE coverage trends&quot;</span><span class=p>)</span>
</span><span id=__span-8-510><a id=__codelineno-8-510 name=__codelineno-8-510 href=#__codelineno-8-510></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. cpe_platform_changes_analysis.png - Platform/vendor change analysis&quot;</span><span class=p>)</span>
</span><span id=__span-8-511><a id=__codelineno-8-511 name=__codelineno-8-511 href=#__codelineno-8-511></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Detailed results have been displayed above for review and interpretation.&quot;</span><span class=p>)</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>Starting Enhanced CPE Analysis...
=== Enhanced CPE Coverage and Change Analysis ===

1. Analyzing CPE Coverage by Year...
</code></pre></div> <p><img alt=png src=../difference_between_cpe_old_vs_new_db_files/difference_between_cpe_old_vs_new_db_8_1.png></p> <div class="language-text highlight"><pre><span></span><code>Yearly CPE Coverage Statistics:
========================================================================================================================
Year   Old DB CVEs  Old DB w/CPE Old Coverage New DB CVEs  New DB w/CPE New Coverage Coverage Diff
========================================================================================================================
2015   6,259        6,259        100.0       % 6,494        6,494        100.0       % 0.0++++++++++%
2016   6,490        6,490        100.0       % 6,457        6,457        100.0       % 0.0++++++++++%
2017   14,361       14,361       100.0       % 14,642       14,642       100.0       % 0.0++++++++++%
2018   14,779       14,779       100.0       % 16,510       16,510       100.0       % 0.0++++++++++%
2019   17,082       17,082       100.0       % 17,308       17,308       100.0       % 0.0++++++++++%
2020   18,378       18,378       100.0       % 18,363       18,363       100.0       % 0.0++++++++++%
2021   20,212       20,212       100.0       % 20,178       20,178       100.0       % 0.0++++++++++%
2022   34,522       34,522       100.0       % 25,000       25,000       100.0       % 0.0++++++++++%
2023   28,861       28,723       99.5        % 28,849       28,847       100.0       % 0.5++++++++++%
2024   11,568       3,627        31.4        % 39,952       26,277       65.8        % 34.4+++++++++%


2. Analyzing Significant CPE Changes in Detail...

Top 20 CVEs with Most Significant CPE Changes:
======================================================================================================================================================
CVE ID          Year   CVSS   Old   New   Diff   Type     Description Sample                                          
======================================================================================================================================================
CVE-2023-20231  2023   8.8    6122  140   -5982  Removed  A vulnerability in the web UI of Cisco IOS XE Software cou...
CVE-2017-12240  2017   9.8    2762  265   -2497  Removed  The DHCP relay subsystem of Cisco IOS 12.2 through 15.6 an...
CVE-2017-6736   2017   8.8    2056  2     -2054  Removed  The Simple Network Management Protocol (SNMP) subsystem of...
CVE-2023-28578  2024   9.3    0     680   +680    Added    Memory corruption in Core Services while executing the com...
CVE-2023-33066  2024   8.4    0     626   +626    Added    Memory corruption in Audio while processing RT proxy port ...
CVE-2023-28547  2024   8.4    0     604   +604    Added    Memory corruption in SPS Application while requesting for ...
CVE-2023-33023  2024   8.4    0     576   +576    Added    Memory corruption while processing finish_sign command to ...
CVE-2021-21551  2021   8.8    1     568   +567    Added    Dell dbutil_2_3.sys driver contains an insufficient access...
CVE-2024-22448  2024   4.7    0     536   +536    Added    Dell BIOS contains an Out-of-Bounds Write vulnerability. A...
CVE-2024-21468  2024   8.4    0     460   +460    Added    Memory corruption when there is failed unmap operation in ...
CVE-2010-1437   2010   7.0    414   11    -403   Removed  Race condition in the find_keyring_by_name function in sec...
CVE-2004-1464   2005   5.9    379   1     -378   Removed  Cisco IOS 12.2(15) and earlier allows remote attackers to ...
CVE-2023-48674  2024   6.8    0     347   +347    Added    Dell Platform BIOS contains an Improper Null Termination v...
CVE-2017-6739   2017   8.8    347   2     -345   Removed  The Simple Network Management Protocol (SNMP) subsystem of...
CVE-2017-6737   2017   8.8    347   2     -345   Removed  The Simple Network Management Protocol (SNMP) subsystem of...
CVE-2017-6738   2017   8.8    347   2     -345   Removed  The Simple Network Management Protocol (SNMP) subsystem of...
CVE-2009-3620   2009   7.8    352   16    -336   Removed  The ATI Rage 128 (aka r128) driver in the Linux kernel bef...
CVE-2023-33115  2024   7.8    0     336   +336    Added    Memory corruption while processing buffer initialization, ...
CVE-2009-0040   2009   -1.0   346   14    -332   Removed  The PNG reference library (aka libpng) before 1.0.43, and ...
CVE-2016-1286   2016   8.6    554   227   -327   Removed  named in ISC BIND 9.x before 9.9.8-P4 and 9.10.x before 9....


3. Detailed Platform Analysis for Significant Changes...

====================================================================================================
CVE: CVE-2023-20231 | Change: -5982 CPEs | Type: Removed
Published: 2023-09-27 | CVSS: 8.800000190734863
Description: A vulnerability in the web UI of Cisco IOS XE Software could allow an authenticated, remote attacker to perform an injection attack against an affected device.
 This vulnerability is due to insuffic...
====================================================================================================

OLD CPEs (6122 entries):
--------------------------------------------------------------------------------
   1. Vendor: cisco           Product: catalyst_9115_firmware Version: 17.9.1x1
   2. Vendor: cisco           Product: catalyst_9115_ap_firmware Version: 17.6.4
   3. Vendor: cisco           Product: catalyst_9300-24t-a_firmware Version: 17.2.3
   4. Vendor: cisco           Product: catalyst_9300-24s-e_firmware Version: 17.4.1
   5. Vendor: cisco           Product: catalyst_9300x_firmware Version: 16.12.4a
   6. Vendor: cisco           Product: catalyst_9100_firmware Version: 16.12.6
   7. Vendor: cisco           Product: catalyst_9300-24ux-a_firmware Version: 17.7.1
   8. Vendor: cisco           Product: catalyst_9300-48uxm-e_firmware Version: 17.5.1
   9. Vendor: cisco           Product: catalyst_9130_ap_firmware Version: 17.3.1
  10. Vendor: cisco           Product: catalyst_9300-48uxm-a_firmware Version: 17.3.1w
  ... and 6112 more CPEs

  Top Vendors in OLD: cisco(10)
  Top Products in OLD: catalyst_9115_firmware(1), catalyst_9115_ap_firmware(1), catalyst_9300-24t-a_firmware(1), catalyst_9300-24s-e_firmware(1), catalyst_9300x_firmware(1)

NEW CPEs (140 entries):
--------------------------------------------------------------------------------
   1. Vendor: cisco           Product: catalyst_9105ax      Version: -
   2. Vendor: cisco           Product: catalyst_9105axi     Version: -
   3. Vendor: cisco           Product: catalyst_9105axw     Version: -
   4. Vendor: cisco           Product: catalyst_9115ax      Version: -
   5. Vendor: cisco           Product: catalyst_9115axe     Version: -
   6. Vendor: cisco           Product: catalyst_9115axi     Version: -
   7. Vendor: cisco           Product: catalyst_9117ax      Version: -
   8. Vendor: cisco           Product: catalyst_9117axi     Version: -
   9. Vendor: cisco           Product: catalyst_9120ax      Version: -
  10. Vendor: cisco           Product: catalyst_9120axe     Version: -
  ... and 130 more CPEs

  Top Vendors in NEW: cisco(10)
  Top Products in NEW: catalyst_9105ax(1), catalyst_9105axi(1), catalyst_9105axw(1), catalyst_9115ax(1), catalyst_9115axe(1)

  CHANGE ANALYSIS:
  🔴 MAJOR REDUCTION: 5982 CPEs removed
  🔍 Possible reasons: Data cleanup, consolidation, or specificity improvement
  ✅ Common vendors maintained: cisco

====================================================================================================

====================================================================================================
CVE: CVE-2017-12240 | Change: -2497 CPEs | Type: Removed
Published: 2017-09-28 | CVSS: 9.800000190734863
Description: The DHCP relay subsystem of Cisco IOS 12.2 through 15.6 and Cisco IOS XE Software contains a vulnerability that could allow an unauthenticated, remote attacker to execute arbitrary code and gain full ...
====================================================================================================

OLD CPEs (2762 entries):
--------------------------------------------------------------------------------
   1. Vendor: cisco           Product: ios                  Version: 15.1\\\\(1\\\\)
   2. Vendor: cisco           Product: ios                  Version: 12.2\\\\(25\\\\
   3. Vendor: cisco           Product: ios                  Version: 12.3\\\\(2\\\\)
   4. Vendor: cisco           Product: ios                  Version: 12.2\\\\(20\\\\
   5. Vendor: cisco           Product: ios                  Version: 15.4\\\\(3\\\\)
   6. Vendor: cisco           Product: ios                  Version: 12.1\\\\(3a\\\\
   7. Vendor: cisco           Product: ios                  Version: 12.2\\\\(33\\\\
   8. Vendor: cisco           Product: ios                  Version: 12.1\\\\(7\\\\)
   9. Vendor: cisco           Product: ios                  Version: 12.1\\\\(3a\\\\
  10. Vendor: cisco           Product: ios                  Version: 12.2\\\\(18\\\\
  ... and 2752 more CPEs

  Top Vendors in OLD: cisco(10)
  Top Products in OLD: ios(10)

NEW CPEs (265 entries):
--------------------------------------------------------------------------------
   1. Vendor: cisco           Product: 1000_integrated_services_router Version: -
   2. Vendor: cisco           Product: 1100-4g_integrated_services_router Version: -
   3. Vendor: cisco           Product: 1100-4gltegb_integrated_services_router Version: -
   4. Vendor: cisco           Product: 1100-4gltena_integrated_services_router Version: -
   5. Vendor: cisco           Product: 1100-4p_integrated_services_router Version: -
   6. Vendor: cisco           Product: 1100-6g_integrated_services_router Version: -
   7. Vendor: cisco           Product: 1100-8p_integrated_services_router Version: -
   8. Vendor: cisco           Product: 1100-lte_integrated_services_router Version: -
   9. Vendor: cisco           Product: 1100_integrated_services_router Version: -
  10. Vendor: cisco           Product: 1101-4p_integrated_services_router Version: -
  ... and 255 more CPEs

  Top Vendors in NEW: cisco(10)
  Top Products in NEW: 1000_integrated_services_router(1), 1100-4g_integrated_services_router(1), 1100-4gltegb_integrated_services_router(1), 1100-4gltena_integrated_services_router(1), 1100-4p_integrated_services_router(1)

  CHANGE ANALYSIS:
  🔴 MAJOR REDUCTION: 2497 CPEs removed
  🔍 Possible reasons: Data cleanup, consolidation, or specificity improvement
  ✅ Common vendors maintained: cisco

====================================================================================================

====================================================================================================
CVE: CVE-2017-6736 | Change: -2054 CPEs | Type: Removed
Published: 2017-07-17 | CVSS: 8.800000190734863
Description: The Simple Network Management Protocol (SNMP) subsystem of Cisco IOS 12.0 through 12.4 and 15.0 through 15.6 and IOS XE 2.2 through 3.17 contains multiple vulnerabilities that could allow an authentic...
====================================================================================================

OLD CPEs (2056 entries):
--------------------------------------------------------------------------------
   1. Vendor: cisco           Product: ios                  Version: 15.1\\\\(1\\\\)
   2. Vendor: cisco           Product: ios                  Version: 12.3\\\\(2\\\\)
   3. Vendor: cisco           Product: ios                  Version: 15.4\\\\(3\\\\)
   4. Vendor: cisco           Product: ios                  Version: 15.4\\\\(3\\\\)
   5. Vendor: cisco           Product: ios                  Version: 12.1\\\\(3a\\\\
   6. Vendor: cisco           Product: ios                  Version: 12.2\\\\(33\\\\
   7. Vendor: cisco           Product: ios                  Version: 12.1\\\\(7\\\\)
   8. Vendor: cisco           Product: ios                  Version: 12.1\\\\(3a\\\\
   9. Vendor: cisco           Product: ios                  Version: 12.4\\\\(4\\\\)
  10. Vendor: cisco           Product: ios                  Version: 12.2\\\\(21b\\\
  ... and 2046 more CPEs

  Top Vendors in OLD: cisco(10)
  Top Products in OLD: ios(10)

NEW CPEs (2 entries):
--------------------------------------------------------------------------------
   1. Vendor: cisco           Product: ios                  Version: *
   2. Vendor: cisco           Product: ios_xe               Version: *

  Top Vendors in NEW: cisco(2)
  Top Products in NEW: ios(1), ios_xe(1)

  CHANGE ANALYSIS:
  🔴 MAJOR REDUCTION: 2054 CPEs removed
  🔍 Possible reasons: Data cleanup, consolidation, or specificity improvement
  ✅ Common vendors maintained: cisco

====================================================================================================

====================================================================================================
CVE: CVE-2023-28578 | Change: +680 CPEs | Type: Added
Published: 2024-03-04 | CVSS: 9.300000190734863
Description: Memory corruption in Core Services while executing the command for removing a single event listener....
====================================================================================================

NEW CPEs (680 entries):
--------------------------------------------------------------------------------
   1. Vendor: qualcomm        Product: 315_5g_iot_modem     Version: -
   2. Vendor: qualcomm        Product: aqt1000              Version: -
   3. Vendor: qualcomm        Product: ar8031               Version: -
   4. Vendor: qualcomm        Product: ar8035               Version: -
   5. Vendor: qualcomm        Product: ar9380               Version: -
   6. Vendor: qualcomm        Product: c-v2x_9150           Version: -
   7. Vendor: qualcomm        Product: csr8811              Version: -
   8. Vendor: qualcomm        Product: csra6620             Version: -
   9. Vendor: qualcomm        Product: csra6640             Version: -
  10. Vendor: qualcomm        Product: csrb31024            Version: -
  ... and 670 more CPEs

  Top Vendors in NEW: qualcomm(10)
  Top Products in NEW: 315_5g_iot_modem(1), aqt1000(1), ar8031(1), ar8035(1), ar9380(1)

  CHANGE ANALYSIS:
  🟢 MAJOR ADDITION: 680 CPEs added
  🔍 Possible reasons: Extended coverage, new versions discovered, or improved data
  🆕 Completely new vendors added

====================================================================================================

====================================================================================================
CVE: CVE-2023-33066 | Change: +626 CPEs | Type: Added
Published: 2024-03-04 | CVSS: 8.399999618530273
Description: Memory corruption in Audio while processing RT proxy port register driver....
====================================================================================================

NEW CPEs (626 entries):
--------------------------------------------------------------------------------
   1. Vendor: qualcomm        Product: 205_mobile           Version: -
   2. Vendor: qualcomm        Product: 215_mobile           Version: -
   3. Vendor: qualcomm        Product: 315_5g_iot_modem     Version: -
   4. Vendor: qualcomm        Product: 9205_lte_modem       Version: -
   5. Vendor: qualcomm        Product: 9206_lte_modem       Version: -
   6. Vendor: qualcomm        Product: 9207_lte_modem       Version: -
   7. Vendor: qualcomm        Product: apq8017              Version: -
   8. Vendor: qualcomm        Product: apq8030              Version: -
   9. Vendor: qualcomm        Product: apq8037              Version: -
  10. Vendor: qualcomm        Product: apq8064              Version: -
  ... and 616 more CPEs

  Top Vendors in NEW: qualcomm(10)
  Top Products in NEW: 205_mobile(1), 215_mobile(1), 315_5g_iot_modem(1), 9205_lte_modem(1), 9206_lte_modem(1)

  CHANGE ANALYSIS:
  🟢 MAJOR ADDITION: 626 CPEs added
  🔍 Possible reasons: Extended coverage, new versions discovered, or improved data
  🆕 Completely new vendors added

====================================================================================================


4. Analyzing CPE Change Patterns by Platform/Vendor...



FloatProgress(value=0.0, layout=Layout(width=&#39;auto&#39;), style=ProgressStyle(bar_color=&#39;black&#39;))



Vendor/Platform Impact Analysis:
==============================================================================================================
Vendor               Affected CVEs Total CPE Change Avg Change/CVE  CVEs Gained  CVEs Lost 
==============================================================================================================
Cisco                129           -11,744.0       -91.0           32           97        
Qualcomm             40            +8,524.0         213.1           38           2         
Microsoft            2,062         +6,300.0         3.1             1,280        782       
Linux                980           -3,444.0        -3.5            818          162       
Checkmk              46            +3,256.0         70.8            46           0         
Tribe29              40            -2,869.0        -71.7           0            40        
Dell                 62            +2,718.0         43.8            60           2         
Juniper              36            +2,114.0         58.7            26           10        
Samsung              32            +1,729.0         54.0            32           0         
Enterprise_Linux     273           +1,562.0         5.7             273          0         
Liferay              31            +1,427.0         46.0            31           0         
Apache               129           -1,345.0        -10.4           69           60        
Pulsesecure          62            -1,244.0        -20.1           0            62        
Adobe                126           -1,211.0        -9.6            96           30        
Mediatek             38            +1,106.0         29.1            38           0
</code></pre></div> <p><img alt=png src=../difference_between_cpe_old_vs_new_db_files/difference_between_cpe_old_vs_new_db_8_5.png></p> <div class="language-text highlight"><pre><span></span><code>=== ANALYSIS COMPLETE ===
Generated visualizations:
1. cpe_coverage_trends_analysis.png - Yearly CPE coverage trends
2. cpe_platform_changes_analysis.png - Platform/vendor change analysis

Detailed results have been displayed above for review and interpretation.
</code></pre></div> <h4 id=deep-dive-in-2022-use-case>Deep dive in 2022 use case<a class=headerlink href=#deep-dive-in-2022-use-case title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=k>def</span><span class=w> </span><span class=nf>deep_dive_2022_analysis</span><span class=p>():</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=sd>    Comprehensive analysis of 2022 CVE discrepancies between old and new databases</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=== DEEP DIVE: 2022 CVE DISCREPANCIES ANALYSIS ===</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>    <span class=c1># 1. Basic CVE counts and differences for 2022</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Basic CVE Count Analysis for 2022...&quot;</span><span class=p>)</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>80</span><span class=p>)</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>    <span class=c1># Get all 2022 CVEs from both databases</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>    <span class=n>old_2022_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=s2>    SELECT </span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=s2>        &quot;CVE ID&quot; as cve_id,</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=s2>        &quot;Date Published&quot; as date_published,</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=s2>        &quot;CVSS 3.0 Base Score&quot; as cvss_score,</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a><span class=s2>        &quot;State&quot; as state,</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a><span class=s2>        &quot;Software CPES&quot; as cpes,</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a><span class=s2>        LEFT(&quot;Descriptions&quot;, 100) as description_sample</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a><span class=s2>    FROM cve_main_old </span>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a><span class=s2>    WHERE EXTRACT(YEAR FROM &quot;Date Published&quot;) = 2022</span>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a><span class=s2>        AND &quot;State&quot; = &#39;PUBLISHED&#39;</span>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a><span class=s2>    ORDER BY &quot;Date Published&quot;</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a>    <span class=n>new_2022_query</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a><span class=s2>    SELECT </span>
</span><span id=__span-9-29><a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a><span class=s2>        cve_id,</span>
</span><span id=__span-9-30><a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a><span class=s2>        date_published,</span>
</span><span id=__span-9-31><a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a><span class=s2>        cvss_v3_score as cvss_score,</span>
</span><span id=__span-9-32><a id=__codelineno-9-32 name=__codelineno-9-32 href=#__codelineno-9-32></a><span class=s2>        state,</span>
</span><span id=__span-9-33><a id=__codelineno-9-33 name=__codelineno-9-33 href=#__codelineno-9-33></a><span class=s2>        cpes,</span>
</span><span id=__span-9-34><a id=__codelineno-9-34 name=__codelineno-9-34 href=#__codelineno-9-34></a><span class=s2>        LEFT(description, 100) as description_sample</span>
</span><span id=__span-9-35><a id=__codelineno-9-35 name=__codelineno-9-35 href=#__codelineno-9-35></a><span class=s2>    FROM cve_main </span>
</span><span id=__span-9-36><a id=__codelineno-9-36 name=__codelineno-9-36 href=#__codelineno-9-36></a><span class=s2>    WHERE EXTRACT(YEAR FROM date_published) = 2022</span>
</span><span id=__span-9-37><a id=__codelineno-9-37 name=__codelineno-9-37 href=#__codelineno-9-37></a><span class=s2>        AND state = &#39;PUBLISHED&#39;</span>
</span><span id=__span-9-38><a id=__codelineno-9-38 name=__codelineno-9-38 href=#__codelineno-9-38></a><span class=s2>    ORDER BY date_published</span>
</span><span id=__span-9-39><a id=__codelineno-9-39 name=__codelineno-9-39 href=#__codelineno-9-39></a><span class=s2>    &quot;&quot;&quot;</span>
</span><span id=__span-9-40><a id=__codelineno-9-40 name=__codelineno-9-40 href=#__codelineno-9-40></a>
</span><span id=__span-9-41><a id=__codelineno-9-41 name=__codelineno-9-41 href=#__codelineno-9-41></a>    <span class=n>old_2022_cves</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>old_2022_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-9-42><a id=__codelineno-9-42 name=__codelineno-9-42 href=#__codelineno-9-42></a>    <span class=n>new_2022_cves</span> <span class=o>=</span> <span class=n>analysis_con</span><span class=o>.</span><span class=n>sql</span><span class=p>(</span><span class=n>new_2022_query</span><span class=p>)</span><span class=o>.</span><span class=n>df</span><span class=p>()</span>
</span><span id=__span-9-43><a id=__codelineno-9-43 name=__codelineno-9-43 href=#__codelineno-9-43></a>
</span><span id=__span-9-44><a id=__codelineno-9-44 name=__codelineno-9-44 href=#__codelineno-9-44></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Old Database 2022 CVEs: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>old_2022_cves</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-45><a id=__codelineno-9-45 name=__codelineno-9-45 href=#__codelineno-9-45></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;New Database 2022 CVEs: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>new_2022_cves</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-46><a id=__codelineno-9-46 name=__codelineno-9-46 href=#__codelineno-9-46></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Difference: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>old_2022_cves</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=n>new_2022_cves</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> CVEs&quot;</span><span class=p>)</span>
</span><span id=__span-9-47><a id=__codelineno-9-47 name=__codelineno-9-47 href=#__codelineno-9-47></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Percentage Missing: </span><span class=si>{</span><span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>old_2022_cves</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=n>new_2022_cves</span><span class=p>))</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=n>old_2022_cves</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>
</span><span id=__span-9-48><a id=__codelineno-9-48 name=__codelineno-9-48 href=#__codelineno-9-48></a>
</span><span id=__span-9-49><a id=__codelineno-9-49 name=__codelineno-9-49 href=#__codelineno-9-49></a>    <span class=c1># 2. Find which CVEs are missing</span>
</span><span id=__span-9-50><a id=__codelineno-9-50 name=__codelineno-9-50 href=#__codelineno-9-50></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>2. Identifying Missing and Added CVEs...&quot;</span><span class=p>)</span>
</span><span id=__span-9-51><a id=__codelineno-9-51 name=__codelineno-9-51 href=#__codelineno-9-51></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>80</span><span class=p>)</span>
</span><span id=__span-9-52><a id=__codelineno-9-52 name=__codelineno-9-52 href=#__codelineno-9-52></a>
</span><span id=__span-9-53><a id=__codelineno-9-53 name=__codelineno-9-53 href=#__codelineno-9-53></a>    <span class=n>old_cve_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>old_2022_cves</span><span class=p>[</span><span class=s1>&#39;cve_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
</span><span id=__span-9-54><a id=__codelineno-9-54 name=__codelineno-9-54 href=#__codelineno-9-54></a>    <span class=n>new_cve_ids</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>new_2022_cves</span><span class=p>[</span><span class=s1>&#39;cve_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
</span><span id=__span-9-55><a id=__codelineno-9-55 name=__codelineno-9-55 href=#__codelineno-9-55></a>
</span><span id=__span-9-56><a id=__codelineno-9-56 name=__codelineno-9-56 href=#__codelineno-9-56></a>    <span class=n>missing_cves</span> <span class=o>=</span> <span class=n>old_cve_ids</span> <span class=o>-</span> <span class=n>new_cve_ids</span>
</span><span id=__span-9-57><a id=__codelineno-9-57 name=__codelineno-9-57 href=#__codelineno-9-57></a>    <span class=n>added_cves</span> <span class=o>=</span> <span class=n>new_cve_ids</span> <span class=o>-</span> <span class=n>old_cve_ids</span>
</span><span id=__span-9-58><a id=__codelineno-9-58 name=__codelineno-9-58 href=#__codelineno-9-58></a>    <span class=n>common_cves</span> <span class=o>=</span> <span class=n>old_cve_ids</span><span class=o>.</span><span class=n>intersection</span><span class=p>(</span><span class=n>new_cve_ids</span><span class=p>)</span>
</span><span id=__span-9-59><a id=__codelineno-9-59 name=__codelineno-9-59 href=#__codelineno-9-59></a>
</span><span id=__span-9-60><a id=__codelineno-9-60 name=__codelineno-9-60 href=#__codelineno-9-60></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CVEs in Old but NOT in New: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>missing_cves</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-61><a id=__codelineno-9-61 name=__codelineno-9-61 href=#__codelineno-9-61></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CVEs in New but NOT in Old: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>added_cves</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-62><a id=__codelineno-9-62 name=__codelineno-9-62 href=#__codelineno-9-62></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Common CVEs in both: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>common_cves</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-63><a id=__codelineno-9-63 name=__codelineno-9-63 href=#__codelineno-9-63></a>
</span><span id=__span-9-64><a id=__codelineno-9-64 name=__codelineno-9-64 href=#__codelineno-9-64></a>    <span class=c1># 3. Analyze missing CVEs by date patterns</span>
</span><span id=__span-9-65><a id=__codelineno-9-65 name=__codelineno-9-65 href=#__codelineno-9-65></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>3. Date Pattern Analysis of Missing CVEs...&quot;</span><span class=p>)</span>
</span><span id=__span-9-66><a id=__codelineno-9-66 name=__codelineno-9-66 href=#__codelineno-9-66></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>80</span><span class=p>)</span>
</span><span id=__span-9-67><a id=__codelineno-9-67 name=__codelineno-9-67 href=#__codelineno-9-67></a>
</span><span id=__span-9-68><a id=__codelineno-9-68 name=__codelineno-9-68 href=#__codelineno-9-68></a>    <span class=n>missing_cves_data</span> <span class=o>=</span> <span class=n>old_2022_cves</span><span class=p>[</span><span class=n>old_2022_cves</span><span class=p>[</span><span class=s1>&#39;cve_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>missing_cves</span><span class=p>)]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-9-69><a id=__codelineno-9-69 name=__codelineno-9-69 href=#__codelineno-9-69></a>    <span class=n>missing_cves_data</span><span class=p>[</span><span class=s1>&#39;month&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>missing_cves_data</span><span class=p>[</span><span class=s1>&#39;date_published&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>month</span>
</span><span id=__span-9-70><a id=__codelineno-9-70 name=__codelineno-9-70 href=#__codelineno-9-70></a>    <span class=n>missing_cves_data</span><span class=p>[</span><span class=s1>&#39;date_only&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>missing_cves_data</span><span class=p>[</span><span class=s1>&#39;date_published&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>date</span>
</span><span id=__span-9-71><a id=__codelineno-9-71 name=__codelineno-9-71 href=#__codelineno-9-71></a>
</span><span id=__span-9-72><a id=__codelineno-9-72 name=__codelineno-9-72 href=#__codelineno-9-72></a>    <span class=c1># Monthly distribution of missing CVEs</span>
</span><span id=__span-9-73><a id=__codelineno-9-73 name=__codelineno-9-73 href=#__codelineno-9-73></a>    <span class=n>monthly_missing</span> <span class=o>=</span> <span class=n>missing_cves_data</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;month&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>size</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;count&#39;</span><span class=p>)</span>
</span><span id=__span-9-74><a id=__codelineno-9-74 name=__codelineno-9-74 href=#__codelineno-9-74></a>
</span><span id=__span-9-75><a id=__codelineno-9-75 name=__codelineno-9-75 href=#__codelineno-9-75></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Missing CVEs by Month:&quot;</span><span class=p>)</span>
</span><span id=__span-9-76><a id=__codelineno-9-76 name=__codelineno-9-76 href=#__codelineno-9-76></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>40</span><span class=p>)</span>
</span><span id=__span-9-77><a id=__codelineno-9-77 name=__codelineno-9-77 href=#__codelineno-9-77></a>    <span class=n>months</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Jan&#39;</span><span class=p>,</span> <span class=s1>&#39;Feb&#39;</span><span class=p>,</span> <span class=s1>&#39;Mar&#39;</span><span class=p>,</span> <span class=s1>&#39;Apr&#39;</span><span class=p>,</span> <span class=s1>&#39;May&#39;</span><span class=p>,</span> <span class=s1>&#39;Jun&#39;</span><span class=p>,</span> 
</span><span id=__span-9-78><a id=__codelineno-9-78 name=__codelineno-9-78 href=#__codelineno-9-78></a>              <span class=s1>&#39;Jul&#39;</span><span class=p>,</span> <span class=s1>&#39;Aug&#39;</span><span class=p>,</span> <span class=s1>&#39;Sep&#39;</span><span class=p>,</span> <span class=s1>&#39;Oct&#39;</span><span class=p>,</span> <span class=s1>&#39;Nov&#39;</span><span class=p>,</span> <span class=s1>&#39;Dec&#39;</span><span class=p>]</span>
</span><span id=__span-9-79><a id=__codelineno-9-79 name=__codelineno-9-79 href=#__codelineno-9-79></a>
</span><span id=__span-9-80><a id=__codelineno-9-80 name=__codelineno-9-80 href=#__codelineno-9-80></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>monthly_missing</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-9-81><a id=__codelineno-9-81 name=__codelineno-9-81 href=#__codelineno-9-81></a>        <span class=n>month_name</span> <span class=o>=</span> <span class=n>months</span><span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;month&#39;</span><span class=p>])</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-9-82><a id=__codelineno-9-82 name=__codelineno-9-82 href=#__codelineno-9-82></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>month_name</span><span class=si>}</span><span class=s2> 2022: </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> missing CVEs&quot;</span><span class=p>)</span>
</span><span id=__span-9-83><a id=__codelineno-9-83 name=__codelineno-9-83 href=#__codelineno-9-83></a>
</span><span id=__span-9-84><a id=__codelineno-9-84 name=__codelineno-9-84 href=#__codelineno-9-84></a>    <span class=c1># Check if missing CVEs cluster around specific dates</span>
</span><span id=__span-9-85><a id=__codelineno-9-85 name=__codelineno-9-85 href=#__codelineno-9-85></a>    <span class=n>daily_missing</span> <span class=o>=</span> <span class=n>missing_cves_data</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;date_only&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>size</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;count&#39;</span><span class=p>)</span>
</span><span id=__span-9-86><a id=__codelineno-9-86 name=__codelineno-9-86 href=#__codelineno-9-86></a>    <span class=n>daily_missing</span> <span class=o>=</span> <span class=n>daily_missing</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;count&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-9-87><a id=__codelineno-9-87 name=__codelineno-9-87 href=#__codelineno-9-87></a>
</span><span id=__span-9-88><a id=__codelineno-9-88 name=__codelineno-9-88 href=#__codelineno-9-88></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 10 Dates with Most Missing CVEs:&quot;</span><span class=p>)</span>
</span><span id=__span-9-89><a id=__codelineno-9-89 name=__codelineno-9-89 href=#__codelineno-9-89></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>
</span><span id=__span-9-90><a id=__codelineno-9-90 name=__codelineno-9-90 href=#__codelineno-9-90></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>daily_missing</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-9-91><a id=__codelineno-9-91 name=__codelineno-9-91 href=#__codelineno-9-91></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;date_only&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> missing CVEs&quot;</span><span class=p>)</span>
</span><span id=__span-9-92><a id=__codelineno-9-92 name=__codelineno-9-92 href=#__codelineno-9-92></a>
</span><span id=__span-9-93><a id=__codelineno-9-93 name=__codelineno-9-93 href=#__codelineno-9-93></a>    <span class=c1># 4. Analyze CPE coverage in missing vs existing CVEs</span>
</span><span id=__span-9-94><a id=__codelineno-9-94 name=__codelineno-9-94 href=#__codelineno-9-94></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>4. CPE Coverage Analysis...&quot;</span><span class=p>)</span>
</span><span id=__span-9-95><a id=__codelineno-9-95 name=__codelineno-9-95 href=#__codelineno-9-95></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>80</span><span class=p>)</span>
</span><span id=__span-9-96><a id=__codelineno-9-96 name=__codelineno-9-96 href=#__codelineno-9-96></a>
</span><span id=__span-9-97><a id=__codelineno-9-97 name=__codelineno-9-97 href=#__codelineno-9-97></a>    <span class=c1># CPE coverage for missing CVEs</span>
</span><span id=__span-9-98><a id=__codelineno-9-98 name=__codelineno-9-98 href=#__codelineno-9-98></a>    <span class=n>missing_with_cpes</span> <span class=o>=</span> <span class=n>missing_cves_data</span><span class=p>[</span>
</span><span id=__span-9-99><a id=__codelineno-9-99 name=__codelineno-9-99 href=#__codelineno-9-99></a>        <span class=p>(</span><span class=n>missing_cves_data</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>notna</span><span class=p>())</span> <span class=o>&amp;</span> 
</span><span id=__span-9-100><a id=__codelineno-9-100 name=__codelineno-9-100 href=#__codelineno-9-100></a>        <span class=p>(</span><span class=n>missing_cves_data</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span><span id=__span-9-101><a id=__codelineno-9-101 name=__codelineno-9-101 href=#__codelineno-9-101></a>    <span class=p>]</span>
</span><span id=__span-9-102><a id=__codelineno-9-102 name=__codelineno-9-102 href=#__codelineno-9-102></a>    <span class=n>missing_cpe_coverage</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>missing_with_cpes</span><span class=p>)</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>missing_cves_data</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span>
</span><span id=__span-9-103><a id=__codelineno-9-103 name=__codelineno-9-103 href=#__codelineno-9-103></a>
</span><span id=__span-9-104><a id=__codelineno-9-104 name=__codelineno-9-104 href=#__codelineno-9-104></a>    <span class=c1># CPE coverage for retained CVEs (common ones)</span>
</span><span id=__span-9-105><a id=__codelineno-9-105 name=__codelineno-9-105 href=#__codelineno-9-105></a>    <span class=n>common_cves_old</span> <span class=o>=</span> <span class=n>old_2022_cves</span><span class=p>[</span><span class=n>old_2022_cves</span><span class=p>[</span><span class=s1>&#39;cve_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>common_cves</span><span class=p>)]</span>
</span><span id=__span-9-106><a id=__codelineno-9-106 name=__codelineno-9-106 href=#__codelineno-9-106></a>    <span class=n>common_with_cpes</span> <span class=o>=</span> <span class=n>common_cves_old</span><span class=p>[</span>
</span><span id=__span-9-107><a id=__codelineno-9-107 name=__codelineno-9-107 href=#__codelineno-9-107></a>        <span class=p>(</span><span class=n>common_cves_old</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>notna</span><span class=p>())</span> <span class=o>&amp;</span> 
</span><span id=__span-9-108><a id=__codelineno-9-108 name=__codelineno-9-108 href=#__codelineno-9-108></a>        <span class=p>(</span><span class=n>common_cves_old</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span><span id=__span-9-109><a id=__codelineno-9-109 name=__codelineno-9-109 href=#__codelineno-9-109></a>    <span class=p>]</span>
</span><span id=__span-9-110><a id=__codelineno-9-110 name=__codelineno-9-110 href=#__codelineno-9-110></a>    <span class=n>common_cpe_coverage</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>common_with_cpes</span><span class=p>)</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>common_cves_old</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span>
</span><span id=__span-9-111><a id=__codelineno-9-111 name=__codelineno-9-111 href=#__codelineno-9-111></a>
</span><span id=__span-9-112><a id=__codelineno-9-112 name=__codelineno-9-112 href=#__codelineno-9-112></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CPE Coverage in Missing CVEs: </span><span class=si>{</span><span class=n>missing_cpe_coverage</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>
</span><span id=__span-9-113><a id=__codelineno-9-113 name=__codelineno-9-113 href=#__codelineno-9-113></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CPE Coverage in Retained CVEs: </span><span class=si>{</span><span class=n>common_cpe_coverage</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>
</span><span id=__span-9-114><a id=__codelineno-9-114 name=__codelineno-9-114 href=#__codelineno-9-114></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Difference: </span><span class=si>{</span><span class=n>missing_cpe_coverage</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>common_cpe_coverage</span><span class=si>:</span><span class=s2>+.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>
</span><span id=__span-9-115><a id=__codelineno-9-115 name=__codelineno-9-115 href=#__codelineno-9-115></a>
</span><span id=__span-9-116><a id=__codelineno-9-116 name=__codelineno-9-116 href=#__codelineno-9-116></a>    <span class=c1># 5. Vendor/Platform analysis of missing CVEs</span>
</span><span id=__span-9-117><a id=__codelineno-9-117 name=__codelineno-9-117 href=#__codelineno-9-117></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>5. Vendor/Platform Analysis of Missing CVEs...&quot;</span><span class=p>)</span>
</span><span id=__span-9-118><a id=__codelineno-9-118 name=__codelineno-9-118 href=#__codelineno-9-118></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>80</span><span class=p>)</span>
</span><span id=__span-9-119><a id=__codelineno-9-119 name=__codelineno-9-119 href=#__codelineno-9-119></a>
</span><span id=__span-9-120><a id=__codelineno-9-120 name=__codelineno-9-120 href=#__codelineno-9-120></a>    <span class=c1># Extract vendor information from missing CVEs with CPEs</span>
</span><span id=__span-9-121><a id=__codelineno-9-121 name=__codelineno-9-121 href=#__codelineno-9-121></a>    <span class=n>missing_vendors</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-9-122><a id=__codelineno-9-122 name=__codelineno-9-122 href=#__codelineno-9-122></a>    <span class=n>missing_products</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-9-123><a id=__codelineno-9-123 name=__codelineno-9-123 href=#__codelineno-9-123></a>
</span><span id=__span-9-124><a id=__codelineno-9-124 name=__codelineno-9-124 href=#__codelineno-9-124></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>missing_with_cpes</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-9-125><a id=__codelineno-9-125 name=__codelineno-9-125 href=#__codelineno-9-125></a>        <span class=k>if</span> <span class=n>pd</span><span class=o>.</span><span class=n>notna</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>])</span> <span class=ow>and</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;&#39;</span><span class=p>:</span>
</span><span id=__span-9-126><a id=__codelineno-9-126 name=__codelineno-9-126 href=#__codelineno-9-126></a>            <span class=n>cpe_list</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)</span>
</span><span id=__span-9-127><a id=__codelineno-9-127 name=__codelineno-9-127 href=#__codelineno-9-127></a>            <span class=k>for</span> <span class=n>cpe</span> <span class=ow>in</span> <span class=n>cpe_list</span><span class=p>:</span>
</span><span id=__span-9-128><a id=__codelineno-9-128 name=__codelineno-9-128 href=#__codelineno-9-128></a>                <span class=n>cpe</span> <span class=o>=</span> <span class=n>cpe</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span><span id=__span-9-129><a id=__codelineno-9-129 name=__codelineno-9-129 href=#__codelineno-9-129></a>                <span class=k>if</span> <span class=n>cpe</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;cpe:&#39;</span><span class=p>):</span>
</span><span id=__span-9-130><a id=__codelineno-9-130 name=__codelineno-9-130 href=#__codelineno-9-130></a>                    <span class=n>parts</span> <span class=o>=</span> <span class=n>cpe</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span><span id=__span-9-131><a id=__codelineno-9-131 name=__codelineno-9-131 href=#__codelineno-9-131></a>                    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>5</span><span class=p>:</span>
</span><span id=__span-9-132><a id=__codelineno-9-132 name=__codelineno-9-132 href=#__codelineno-9-132></a>                        <span class=n>vendor</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>3</span> <span class=k>else</span> <span class=s1>&#39;unknown&#39;</span>
</span><span id=__span-9-133><a id=__codelineno-9-133 name=__codelineno-9-133 href=#__codelineno-9-133></a>                        <span class=n>product</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>4</span> <span class=k>else</span> <span class=s1>&#39;unknown&#39;</span>
</span><span id=__span-9-134><a id=__codelineno-9-134 name=__codelineno-9-134 href=#__codelineno-9-134></a>
</span><span id=__span-9-135><a id=__codelineno-9-135 name=__codelineno-9-135 href=#__codelineno-9-135></a>                        <span class=n>missing_vendors</span><span class=p>[</span><span class=n>vendor</span><span class=p>]</span> <span class=o>=</span> <span class=n>missing_vendors</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>vendor</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-9-136><a id=__codelineno-9-136 name=__codelineno-9-136 href=#__codelineno-9-136></a>                        <span class=n>missing_products</span><span class=p>[</span><span class=n>product</span><span class=p>]</span> <span class=o>=</span> <span class=n>missing_products</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>product</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-9-137><a id=__codelineno-9-137 name=__codelineno-9-137 href=#__codelineno-9-137></a>
</span><span id=__span-9-138><a id=__codelineno-9-138 name=__codelineno-9-138 href=#__codelineno-9-138></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Top 15 Vendors in Missing CVEs:&quot;</span><span class=p>)</span>
</span><span id=__span-9-139><a id=__codelineno-9-139 name=__codelineno-9-139 href=#__codelineno-9-139></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>
</span><span id=__span-9-140><a id=__codelineno-9-140 name=__codelineno-9-140 href=#__codelineno-9-140></a>    <span class=n>sorted_vendors</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>missing_vendors</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-9-141><a id=__codelineno-9-141 name=__codelineno-9-141 href=#__codelineno-9-141></a>    <span class=k>for</span> <span class=n>vendor</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>sorted_vendors</span><span class=p>[:</span><span class=mi>15</span><span class=p>]:</span>
</span><span id=__span-9-142><a id=__codelineno-9-142 name=__codelineno-9-142 href=#__codelineno-9-142></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>vendor</span><span class=o>.</span><span class=n>title</span><span class=p>()</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>count</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> CPE entries&quot;</span><span class=p>)</span>
</span><span id=__span-9-143><a id=__codelineno-9-143 name=__codelineno-9-143 href=#__codelineno-9-143></a>
</span><span id=__span-9-144><a id=__codelineno-9-144 name=__codelineno-9-144 href=#__codelineno-9-144></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 15 Products in Missing CVEs:&quot;</span><span class=p>)</span>
</span><span id=__span-9-145><a id=__codelineno-9-145 name=__codelineno-9-145 href=#__codelineno-9-145></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>
</span><span id=__span-9-146><a id=__codelineno-9-146 name=__codelineno-9-146 href=#__codelineno-9-146></a>    <span class=n>sorted_products</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>missing_products</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-9-147><a id=__codelineno-9-147 name=__codelineno-9-147 href=#__codelineno-9-147></a>    <span class=k>for</span> <span class=n>product</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>sorted_products</span><span class=p>[:</span><span class=mi>15</span><span class=p>]:</span>
</span><span id=__span-9-148><a id=__codelineno-9-148 name=__codelineno-9-148 href=#__codelineno-9-148></a>        <span class=n>product_display</span> <span class=o>=</span> <span class=n>product</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;_&#39;</span><span class=p>,</span> <span class=s1>&#39; &#39;</span><span class=p>)</span><span class=o>.</span><span class=n>title</span><span class=p>()[:</span><span class=mi>40</span><span class=p>]</span>
</span><span id=__span-9-149><a id=__codelineno-9-149 name=__codelineno-9-149 href=#__codelineno-9-149></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>product_display</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>count</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> CPE entries&quot;</span><span class=p>)</span>
</span><span id=__span-9-150><a id=__codelineno-9-150 name=__codelineno-9-150 href=#__codelineno-9-150></a>
</span><span id=__span-9-151><a id=__codelineno-9-151 name=__codelineno-9-151 href=#__codelineno-9-151></a>    <span class=c1># 6. Compare vendor distribution between missing and retained CVEs</span>
</span><span id=__span-9-152><a id=__codelineno-9-152 name=__codelineno-9-152 href=#__codelineno-9-152></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>6. Vendor Distribution Comparison...&quot;</span><span class=p>)</span>
</span><span id=__span-9-153><a id=__codelineno-9-153 name=__codelineno-9-153 href=#__codelineno-9-153></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>80</span><span class=p>)</span>
</span><span id=__span-9-154><a id=__codelineno-9-154 name=__codelineno-9-154 href=#__codelineno-9-154></a>
</span><span id=__span-9-155><a id=__codelineno-9-155 name=__codelineno-9-155 href=#__codelineno-9-155></a>    <span class=c1># Get vendor distribution for retained CVEs</span>
</span><span id=__span-9-156><a id=__codelineno-9-156 name=__codelineno-9-156 href=#__codelineno-9-156></a>    <span class=n>retained_vendors</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-9-157><a id=__codelineno-9-157 name=__codelineno-9-157 href=#__codelineno-9-157></a>    <span class=n>common_with_cpes_filtered</span> <span class=o>=</span> <span class=n>common_cves_old</span><span class=p>[</span>
</span><span id=__span-9-158><a id=__codelineno-9-158 name=__codelineno-9-158 href=#__codelineno-9-158></a>        <span class=p>(</span><span class=n>common_cves_old</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>notna</span><span class=p>())</span> <span class=o>&amp;</span> 
</span><span id=__span-9-159><a id=__codelineno-9-159 name=__codelineno-9-159 href=#__codelineno-9-159></a>        <span class=p>(</span><span class=n>common_cves_old</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span><span id=__span-9-160><a id=__codelineno-9-160 name=__codelineno-9-160 href=#__codelineno-9-160></a>    <span class=p>]</span>
</span><span id=__span-9-161><a id=__codelineno-9-161 name=__codelineno-9-161 href=#__codelineno-9-161></a>
</span><span id=__span-9-162><a id=__codelineno-9-162 name=__codelineno-9-162 href=#__codelineno-9-162></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>common_with_cpes_filtered</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-9-163><a id=__codelineno-9-163 name=__codelineno-9-163 href=#__codelineno-9-163></a>        <span class=k>if</span> <span class=n>pd</span><span class=o>.</span><span class=n>notna</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>])</span> <span class=ow>and</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;&#39;</span><span class=p>:</span>
</span><span id=__span-9-164><a id=__codelineno-9-164 name=__codelineno-9-164 href=#__codelineno-9-164></a>            <span class=n>cpe_list</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)</span>
</span><span id=__span-9-165><a id=__codelineno-9-165 name=__codelineno-9-165 href=#__codelineno-9-165></a>            <span class=k>for</span> <span class=n>cpe</span> <span class=ow>in</span> <span class=n>cpe_list</span><span class=p>:</span>
</span><span id=__span-9-166><a id=__codelineno-9-166 name=__codelineno-9-166 href=#__codelineno-9-166></a>                <span class=n>cpe</span> <span class=o>=</span> <span class=n>cpe</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span><span id=__span-9-167><a id=__codelineno-9-167 name=__codelineno-9-167 href=#__codelineno-9-167></a>                <span class=k>if</span> <span class=n>cpe</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;cpe:&#39;</span><span class=p>):</span>
</span><span id=__span-9-168><a id=__codelineno-9-168 name=__codelineno-9-168 href=#__codelineno-9-168></a>                    <span class=n>parts</span> <span class=o>=</span> <span class=n>cpe</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span><span id=__span-9-169><a id=__codelineno-9-169 name=__codelineno-9-169 href=#__codelineno-9-169></a>                    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>5</span><span class=p>:</span>
</span><span id=__span-9-170><a id=__codelineno-9-170 name=__codelineno-9-170 href=#__codelineno-9-170></a>                        <span class=n>vendor</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>3</span> <span class=k>else</span> <span class=s1>&#39;unknown&#39;</span>
</span><span id=__span-9-171><a id=__codelineno-9-171 name=__codelineno-9-171 href=#__codelineno-9-171></a>                        <span class=n>retained_vendors</span><span class=p>[</span><span class=n>vendor</span><span class=p>]</span> <span class=o>=</span> <span class=n>retained_vendors</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>vendor</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span><span id=__span-9-172><a id=__codelineno-9-172 name=__codelineno-9-172 href=#__codelineno-9-172></a>
</span><span id=__span-9-173><a id=__codelineno-9-173 name=__codelineno-9-173 href=#__codelineno-9-173></a>    <span class=c1># Find vendors that are disproportionately affected</span>
</span><span id=__span-9-174><a id=__codelineno-9-174 name=__codelineno-9-174 href=#__codelineno-9-174></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Vendor Impact Analysis (Missing vs Retained):&quot;</span><span class=p>)</span>
</span><span id=__span-9-175><a id=__codelineno-9-175 name=__codelineno-9-175 href=#__codelineno-9-175></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>80</span><span class=p>)</span>
</span><span id=__span-9-176><a id=__codelineno-9-176 name=__codelineno-9-176 href=#__codelineno-9-176></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Vendor&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Missing CPEs&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Retained CPEs&#39;</span><span class=si>:</span><span class=s2>&lt;13</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Missing %&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Impact&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-177><a id=__codelineno-9-177 name=__codelineno-9-177 href=#__codelineno-9-177></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>80</span><span class=p>)</span>
</span><span id=__span-9-178><a id=__codelineno-9-178 name=__codelineno-9-178 href=#__codelineno-9-178></a>
</span><span id=__span-9-179><a id=__codelineno-9-179 name=__codelineno-9-179 href=#__codelineno-9-179></a>    <span class=n>all_vendors</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>missing_vendors</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span><span class=o>.</span><span class=n>union</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>retained_vendors</span><span class=o>.</span><span class=n>keys</span><span class=p>()))</span>
</span><span id=__span-9-180><a id=__codelineno-9-180 name=__codelineno-9-180 href=#__codelineno-9-180></a>    <span class=n>vendor_impact</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-9-181><a id=__codelineno-9-181 name=__codelineno-9-181 href=#__codelineno-9-181></a>
</span><span id=__span-9-182><a id=__codelineno-9-182 name=__codelineno-9-182 href=#__codelineno-9-182></a>    <span class=k>for</span> <span class=n>vendor</span> <span class=ow>in</span> <span class=n>all_vendors</span><span class=p>:</span>
</span><span id=__span-9-183><a id=__codelineno-9-183 name=__codelineno-9-183 href=#__codelineno-9-183></a>        <span class=n>missing_count</span> <span class=o>=</span> <span class=n>missing_vendors</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>vendor</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-9-184><a id=__codelineno-9-184 name=__codelineno-9-184 href=#__codelineno-9-184></a>        <span class=n>retained_count</span> <span class=o>=</span> <span class=n>retained_vendors</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>vendor</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-9-185><a id=__codelineno-9-185 name=__codelineno-9-185 href=#__codelineno-9-185></a>        <span class=n>total_count</span> <span class=o>=</span> <span class=n>missing_count</span> <span class=o>+</span> <span class=n>retained_count</span>
</span><span id=__span-9-186><a id=__codelineno-9-186 name=__codelineno-9-186 href=#__codelineno-9-186></a>
</span><span id=__span-9-187><a id=__codelineno-9-187 name=__codelineno-9-187 href=#__codelineno-9-187></a>        <span class=k>if</span> <span class=n>total_count</span> <span class=o>&gt;=</span> <span class=mi>50</span><span class=p>:</span>  <span class=c1># Only show vendors with significant presence</span>
</span><span id=__span-9-188><a id=__codelineno-9-188 name=__codelineno-9-188 href=#__codelineno-9-188></a>            <span class=n>missing_pct</span> <span class=o>=</span> <span class=p>(</span><span class=n>missing_count</span> <span class=o>/</span> <span class=n>total_count</span> <span class=o>*</span> <span class=mi>100</span><span class=p>)</span> <span class=k>if</span> <span class=n>total_count</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span><span id=__span-9-189><a id=__codelineno-9-189 name=__codelineno-9-189 href=#__codelineno-9-189></a>
</span><span id=__span-9-190><a id=__codelineno-9-190 name=__codelineno-9-190 href=#__codelineno-9-190></a>            <span class=k>if</span> <span class=n>missing_pct</span> <span class=o>&gt;</span> <span class=mi>70</span><span class=p>:</span>
</span><span id=__span-9-191><a id=__codelineno-9-191 name=__codelineno-9-191 href=#__codelineno-9-191></a>                <span class=n>impact</span> <span class=o>=</span> <span class=s2>&quot;🔴 HIGH&quot;</span>
</span><span id=__span-9-192><a id=__codelineno-9-192 name=__codelineno-9-192 href=#__codelineno-9-192></a>            <span class=k>elif</span> <span class=n>missing_pct</span> <span class=o>&gt;</span> <span class=mi>40</span><span class=p>:</span>
</span><span id=__span-9-193><a id=__codelineno-9-193 name=__codelineno-9-193 href=#__codelineno-9-193></a>                <span class=n>impact</span> <span class=o>=</span> <span class=s2>&quot;🟡 MEDIUM&quot;</span>
</span><span id=__span-9-194><a id=__codelineno-9-194 name=__codelineno-9-194 href=#__codelineno-9-194></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-195><a id=__codelineno-9-195 name=__codelineno-9-195 href=#__codelineno-9-195></a>                <span class=n>impact</span> <span class=o>=</span> <span class=s2>&quot;🟢 LOW&quot;</span>
</span><span id=__span-9-196><a id=__codelineno-9-196 name=__codelineno-9-196 href=#__codelineno-9-196></a>
</span><span id=__span-9-197><a id=__codelineno-9-197 name=__codelineno-9-197 href=#__codelineno-9-197></a>            <span class=n>vendor_impact</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span><span id=__span-9-198><a id=__codelineno-9-198 name=__codelineno-9-198 href=#__codelineno-9-198></a>                <span class=s1>&#39;vendor&#39;</span><span class=p>:</span> <span class=n>vendor</span><span class=p>,</span>
</span><span id=__span-9-199><a id=__codelineno-9-199 name=__codelineno-9-199 href=#__codelineno-9-199></a>                <span class=s1>&#39;missing&#39;</span><span class=p>:</span> <span class=n>missing_count</span><span class=p>,</span>
</span><span id=__span-9-200><a id=__codelineno-9-200 name=__codelineno-9-200 href=#__codelineno-9-200></a>                <span class=s1>&#39;retained&#39;</span><span class=p>:</span> <span class=n>retained_count</span><span class=p>,</span>
</span><span id=__span-9-201><a id=__codelineno-9-201 name=__codelineno-9-201 href=#__codelineno-9-201></a>                <span class=s1>&#39;missing_pct&#39;</span><span class=p>:</span> <span class=n>missing_pct</span><span class=p>,</span>
</span><span id=__span-9-202><a id=__codelineno-9-202 name=__codelineno-9-202 href=#__codelineno-9-202></a>                <span class=s1>&#39;impact&#39;</span><span class=p>:</span> <span class=n>impact</span>
</span><span id=__span-9-203><a id=__codelineno-9-203 name=__codelineno-9-203 href=#__codelineno-9-203></a>            <span class=p>})</span>
</span><span id=__span-9-204><a id=__codelineno-9-204 name=__codelineno-9-204 href=#__codelineno-9-204></a>
</span><span id=__span-9-205><a id=__codelineno-9-205 name=__codelineno-9-205 href=#__codelineno-9-205></a>    <span class=c1># Sort by missing percentage</span>
</span><span id=__span-9-206><a id=__codelineno-9-206 name=__codelineno-9-206 href=#__codelineno-9-206></a>    <span class=n>vendor_impact</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;missing_pct&#39;</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-9-207><a id=__codelineno-9-207 name=__codelineno-9-207 href=#__codelineno-9-207></a>
</span><span id=__span-9-208><a id=__codelineno-9-208 name=__codelineno-9-208 href=#__codelineno-9-208></a>    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>vendor_impact</span><span class=p>[:</span><span class=mi>20</span><span class=p>]:</span>
</span><span id=__span-9-209><a id=__codelineno-9-209 name=__codelineno-9-209 href=#__codelineno-9-209></a>        <span class=n>vendor_name</span> <span class=o>=</span> <span class=n>item</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>title</span><span class=p>()[:</span><span class=mi>18</span><span class=p>]</span>
</span><span id=__span-9-210><a id=__codelineno-9-210 name=__codelineno-9-210 href=#__codelineno-9-210></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>vendor_name</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>item</span><span class=p>[</span><span class=s1>&#39;missing&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;12,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>item</span><span class=p>[</span><span class=s1>&#39;retained&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;13,</span><span class=si>}</span><span class=s2> &quot;</span>
</span><span id=__span-9-211><a id=__codelineno-9-211 name=__codelineno-9-211 href=#__codelineno-9-211></a>              <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>item</span><span class=p>[</span><span class=s1>&#39;missing_pct&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;10.1f</span><span class=si>}</span><span class=s2>% </span><span class=si>{</span><span class=n>item</span><span class=p>[</span><span class=s1>&#39;impact&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-212><a id=__codelineno-9-212 name=__codelineno-9-212 href=#__codelineno-9-212></a>
</span><span id=__span-9-213><a id=__codelineno-9-213 name=__codelineno-9-213 href=#__codelineno-9-213></a>    <span class=c1># 7. Sample of missing CVEs for manual inspection</span>
</span><span id=__span-9-214><a id=__codelineno-9-214 name=__codelineno-9-214 href=#__codelineno-9-214></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>7. Sample of Missing CVEs for Manual Review...&quot;</span><span class=p>)</span>
</span><span id=__span-9-215><a id=__codelineno-9-215 name=__codelineno-9-215 href=#__codelineno-9-215></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>80</span><span class=p>)</span>
</span><span id=__span-9-216><a id=__codelineno-9-216 name=__codelineno-9-216 href=#__codelineno-9-216></a>
</span><span id=__span-9-217><a id=__codelineno-9-217 name=__codelineno-9-217 href=#__codelineno-9-217></a>    <span class=n>sample_missing</span> <span class=o>=</span> <span class=n>missing_cves_data</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-9-218><a id=__codelineno-9-218 name=__codelineno-9-218 href=#__codelineno-9-218></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;CVE ID&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Date&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;CVSS&#39;</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Has CPEs&#39;</span><span class=si>:</span><span class=s2>&lt;9</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Description Sample&#39;</span><span class=si>:</span><span class=s2>&lt;50</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-219><a id=__codelineno-9-219 name=__codelineno-9-219 href=#__codelineno-9-219></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-9-220><a id=__codelineno-9-220 name=__codelineno-9-220 href=#__codelineno-9-220></a>
</span><span id=__span-9-221><a id=__codelineno-9-221 name=__codelineno-9-221 href=#__codelineno-9-221></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>sample_missing</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-9-222><a id=__codelineno-9-222 name=__codelineno-9-222 href=#__codelineno-9-222></a>        <span class=n>has_cpes</span> <span class=o>=</span> <span class=s2>&quot;Yes&quot;</span> <span class=k>if</span> <span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>notna</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>])</span> <span class=ow>and</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;cpes&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=k>else</span> <span class=s2>&quot;No&quot;</span>
</span><span id=__span-9-223><a id=__codelineno-9-223 name=__codelineno-9-223 href=#__codelineno-9-223></a>        <span class=n>cvss</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cvss_score&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>if</span> <span class=n>pd</span><span class=o>.</span><span class=n>notna</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cvss_score&#39;</span><span class=p>])</span> <span class=k>else</span> <span class=s2>&quot;N/A&quot;</span>
</span><span id=__span-9-224><a id=__codelineno-9-224 name=__codelineno-9-224 href=#__codelineno-9-224></a>        <span class=n>date_str</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;date_published&#39;</span><span class=p>])[:</span><span class=mi>10</span><span class=p>]</span> <span class=k>if</span> <span class=n>pd</span><span class=o>.</span><span class=n>notna</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;date_published&#39;</span><span class=p>])</span> <span class=k>else</span> <span class=s2>&quot;N/A&quot;</span>
</span><span id=__span-9-225><a id=__codelineno-9-225 name=__codelineno-9-225 href=#__codelineno-9-225></a>        <span class=n>desc</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;description_sample&#39;</span><span class=p>])[:</span><span class=mi>48</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;description_sample&#39;</span><span class=p>]))</span> <span class=o>&gt;</span> <span class=mi>50</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;description_sample&#39;</span><span class=p>])</span>
</span><span id=__span-9-226><a id=__codelineno-9-226 name=__codelineno-9-226 href=#__codelineno-9-226></a>
</span><span id=__span-9-227><a id=__codelineno-9-227 name=__codelineno-9-227 href=#__codelineno-9-227></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;cve_id&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>date_str</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>cvss</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>has_cpes</span><span class=si>:</span><span class=s2>&lt;9</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>desc</span><span class=si>:</span><span class=s2>&lt;50</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-228><a id=__codelineno-9-228 name=__codelineno-9-228 href=#__codelineno-9-228></a>
</span><span id=__span-9-229><a id=__codelineno-9-229 name=__codelineno-9-229 href=#__codelineno-9-229></a>    <span class=c1># 8. Create visualizations</span>
</span><span id=__span-9-230><a id=__codelineno-9-230 name=__codelineno-9-230 href=#__codelineno-9-230></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>8. Creating Visualizations...&quot;</span><span class=p>)</span>
</span><span id=__span-9-231><a id=__codelineno-9-231 name=__codelineno-9-231 href=#__codelineno-9-231></a>
</span><span id=__span-9-232><a id=__codelineno-9-232 name=__codelineno-9-232 href=#__codelineno-9-232></a>    <span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-9-233><a id=__codelineno-9-233 name=__codelineno-9-233 href=#__codelineno-9-233></a>    <span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-9-234><a id=__codelineno-9-234 name=__codelineno-9-234 href=#__codelineno-9-234></a>
</span><span id=__span-9-235><a id=__codelineno-9-235 name=__codelineno-9-235 href=#__codelineno-9-235></a>    <span class=n>fig</span><span class=p>,</span> <span class=p>((</span><span class=n>ax1</span><span class=p>,</span> <span class=n>ax2</span><span class=p>),</span> <span class=p>(</span><span class=n>ax3</span><span class=p>,</span> <span class=n>ax4</span><span class=p>))</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>16</span><span class=p>))</span>
</span><span id=__span-9-236><a id=__codelineno-9-236 name=__codelineno-9-236 href=#__codelineno-9-236></a>
</span><span id=__span-9-237><a id=__codelineno-9-237 name=__codelineno-9-237 href=#__codelineno-9-237></a>    <span class=c1># Plot 1: Monthly distribution of missing CVEs</span>
</span><span id=__span-9-238><a id=__codelineno-9-238 name=__codelineno-9-238 href=#__codelineno-9-238></a>    <span class=n>months_full</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Jan&#39;</span><span class=p>,</span> <span class=s1>&#39;Feb&#39;</span><span class=p>,</span> <span class=s1>&#39;Mar&#39;</span><span class=p>,</span> <span class=s1>&#39;Apr&#39;</span><span class=p>,</span> <span class=s1>&#39;May&#39;</span><span class=p>,</span> <span class=s1>&#39;Jun&#39;</span><span class=p>,</span> 
</span><span id=__span-9-239><a id=__codelineno-9-239 name=__codelineno-9-239 href=#__codelineno-9-239></a>                   <span class=s1>&#39;Jul&#39;</span><span class=p>,</span> <span class=s1>&#39;Aug&#39;</span><span class=p>,</span> <span class=s1>&#39;Sep&#39;</span><span class=p>,</span> <span class=s1>&#39;Oct&#39;</span><span class=p>,</span> <span class=s1>&#39;Nov&#39;</span><span class=p>,</span> <span class=s1>&#39;Dec&#39;</span><span class=p>]</span>
</span><span id=__span-9-240><a id=__codelineno-9-240 name=__codelineno-9-240 href=#__codelineno-9-240></a>    <span class=n>monthly_counts</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>12</span>
</span><span id=__span-9-241><a id=__codelineno-9-241 name=__codelineno-9-241 href=#__codelineno-9-241></a>
</span><span id=__span-9-242><a id=__codelineno-9-242 name=__codelineno-9-242 href=#__codelineno-9-242></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>monthly_missing</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span><span id=__span-9-243><a id=__codelineno-9-243 name=__codelineno-9-243 href=#__codelineno-9-243></a>        <span class=n>monthly_counts</span><span class=p>[</span><span class=nb>int</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;month&#39;</span><span class=p>])</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;count&#39;</span><span class=p>]</span>
</span><span id=__span-9-244><a id=__codelineno-9-244 name=__codelineno-9-244 href=#__codelineno-9-244></a>
</span><span id=__span-9-245><a id=__codelineno-9-245 name=__codelineno-9-245 href=#__codelineno-9-245></a>    <span class=n>bars1</span> <span class=o>=</span> <span class=n>ax1</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>months_full</span><span class=p>,</span> <span class=n>monthly_counts</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-9-246><a id=__codelineno-9-246 name=__codelineno-9-246 href=#__codelineno-9-246></a>    <span class=n>ax1</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Missing CVEs by Month in 2022&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-9-247><a id=__codelineno-9-247 name=__codelineno-9-247 href=#__codelineno-9-247></a>    <span class=n>ax1</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Number of Missing CVEs&#39;</span><span class=p>)</span>
</span><span id=__span-9-248><a id=__codelineno-9-248 name=__codelineno-9-248 href=#__codelineno-9-248></a>    <span class=n>ax1</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-9-249><a id=__codelineno-9-249 name=__codelineno-9-249 href=#__codelineno-9-249></a>
</span><span id=__span-9-250><a id=__codelineno-9-250 name=__codelineno-9-250 href=#__codelineno-9-250></a>    <span class=c1># Add value labels on bars</span>
</span><span id=__span-9-251><a id=__codelineno-9-251 name=__codelineno-9-251 href=#__codelineno-9-251></a>    <span class=k>for</span> <span class=n>bar</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>bars1</span><span class=p>,</span> <span class=n>monthly_counts</span><span class=p>):</span>
</span><span id=__span-9-252><a id=__codelineno-9-252 name=__codelineno-9-252 href=#__codelineno-9-252></a>        <span class=k>if</span> <span class=n>count</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-9-253><a id=__codelineno-9-253 name=__codelineno-9-253 href=#__codelineno-9-253></a>            <span class=n>ax1</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>count</span><span class=si>:</span><span class=s1>,</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>bar</span><span class=o>.</span><span class=n>get_x</span><span class=p>()</span> <span class=o>+</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_width</span><span class=p>()</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_height</span><span class=p>()),</span>
</span><span id=__span-9-254><a id=__codelineno-9-254 name=__codelineno-9-254 href=#__codelineno-9-254></a>                        <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;bottom&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-9-255><a id=__codelineno-9-255 name=__codelineno-9-255 href=#__codelineno-9-255></a>
</span><span id=__span-9-256><a id=__codelineno-9-256 name=__codelineno-9-256 href=#__codelineno-9-256></a>    <span class=c1># Plot 2: Top vendors in missing CVEs</span>
</span><span id=__span-9-257><a id=__codelineno-9-257 name=__codelineno-9-257 href=#__codelineno-9-257></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sorted_vendors</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-9-258><a id=__codelineno-9-258 name=__codelineno-9-258 href=#__codelineno-9-258></a>        <span class=n>top_vendors</span> <span class=o>=</span> <span class=n>sorted_vendors</span><span class=p>[:</span><span class=mi>10</span><span class=p>]</span>
</span><span id=__span-9-259><a id=__codelineno-9-259 name=__codelineno-9-259 href=#__codelineno-9-259></a>        <span class=n>vendor_names</span> <span class=o>=</span> <span class=p>[</span><span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>title</span><span class=p>()[:</span><span class=mi>15</span><span class=p>]</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>top_vendors</span><span class=p>]</span>
</span><span id=__span-9-260><a id=__codelineno-9-260 name=__codelineno-9-260 href=#__codelineno-9-260></a>        <span class=n>vendor_counts</span> <span class=o>=</span> <span class=p>[</span><span class=n>v</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>top_vendors</span><span class=p>]</span>
</span><span id=__span-9-261><a id=__codelineno-9-261 name=__codelineno-9-261 href=#__codelineno-9-261></a>
</span><span id=__span-9-262><a id=__codelineno-9-262 name=__codelineno-9-262 href=#__codelineno-9-262></a>        <span class=n>bars2</span> <span class=o>=</span> <span class=n>ax2</span><span class=o>.</span><span class=n>barh</span><span class=p>(</span><span class=n>vendor_names</span><span class=p>,</span> <span class=n>vendor_counts</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;orange&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-9-263><a id=__codelineno-9-263 name=__codelineno-9-263 href=#__codelineno-9-263></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;Top 10 Vendors in Missing CVEs&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-9-264><a id=__codelineno-9-264 name=__codelineno-9-264 href=#__codelineno-9-264></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>&#39;Number of CPE Entries&#39;</span><span class=p>)</span>
</span><span id=__span-9-265><a id=__codelineno-9-265 name=__codelineno-9-265 href=#__codelineno-9-265></a>        <span class=n>ax2</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-9-266><a id=__codelineno-9-266 name=__codelineno-9-266 href=#__codelineno-9-266></a>
</span><span id=__span-9-267><a id=__codelineno-9-267 name=__codelineno-9-267 href=#__codelineno-9-267></a>    <span class=c1># Plot 3: CVE comparison overview</span>
</span><span id=__span-9-268><a id=__codelineno-9-268 name=__codelineno-9-268 href=#__codelineno-9-268></a>    <span class=n>categories</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Old DB</span><span class=se>\n</span><span class=s1>2022&#39;</span><span class=p>,</span> <span class=s1>&#39;New DB</span><span class=se>\n</span><span class=s1>2022&#39;</span><span class=p>,</span> <span class=s1>&#39;Missing</span><span class=se>\n</span><span class=s1>CVEs&#39;</span><span class=p>,</span> <span class=s1>&#39;Added</span><span class=se>\n</span><span class=s1>CVEs&#39;</span><span class=p>]</span>
</span><span id=__span-9-269><a id=__codelineno-9-269 name=__codelineno-9-269 href=#__codelineno-9-269></a>    <span class=n>counts</span> <span class=o>=</span> <span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>old_2022_cves</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>new_2022_cves</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>missing_cves</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>added_cves</span><span class=p>)]</span>
</span><span id=__span-9-270><a id=__codelineno-9-270 name=__codelineno-9-270 href=#__codelineno-9-270></a>    <span class=n>colors</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=s1>&#39;green&#39;</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;purple&#39;</span><span class=p>]</span>
</span><span id=__span-9-271><a id=__codelineno-9-271 name=__codelineno-9-271 href=#__codelineno-9-271></a>
</span><span id=__span-9-272><a id=__codelineno-9-272 name=__codelineno-9-272 href=#__codelineno-9-272></a>    <span class=n>bars3</span> <span class=o>=</span> <span class=n>ax3</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>categories</span><span class=p>,</span> <span class=n>counts</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>colors</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-9-273><a id=__codelineno-9-273 name=__codelineno-9-273 href=#__codelineno-9-273></a>    <span class=n>ax3</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;2022 CVE Count Comparison&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-9-274><a id=__codelineno-9-274 name=__codelineno-9-274 href=#__codelineno-9-274></a>    <span class=n>ax3</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;Number of CVEs&#39;</span><span class=p>)</span>
</span><span id=__span-9-275><a id=__codelineno-9-275 name=__codelineno-9-275 href=#__codelineno-9-275></a>    <span class=n>ax3</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-9-276><a id=__codelineno-9-276 name=__codelineno-9-276 href=#__codelineno-9-276></a>
</span><span id=__span-9-277><a id=__codelineno-9-277 name=__codelineno-9-277 href=#__codelineno-9-277></a>    <span class=c1># Add value labels</span>
</span><span id=__span-9-278><a id=__codelineno-9-278 name=__codelineno-9-278 href=#__codelineno-9-278></a>    <span class=k>for</span> <span class=n>bar</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>bars3</span><span class=p>,</span> <span class=n>counts</span><span class=p>):</span>
</span><span id=__span-9-279><a id=__codelineno-9-279 name=__codelineno-9-279 href=#__codelineno-9-279></a>        <span class=n>ax3</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>count</span><span class=si>:</span><span class=s1>,</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>bar</span><span class=o>.</span><span class=n>get_x</span><span class=p>()</span> <span class=o>+</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_width</span><span class=p>()</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_height</span><span class=p>()),</span>
</span><span id=__span-9-280><a id=__codelineno-9-280 name=__codelineno-9-280 href=#__codelineno-9-280></a>                    <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;bottom&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-9-281><a id=__codelineno-9-281 name=__codelineno-9-281 href=#__codelineno-9-281></a>
</span><span id=__span-9-282><a id=__codelineno-9-282 name=__codelineno-9-282 href=#__codelineno-9-282></a>    <span class=c1># Plot 4: CPE coverage comparison</span>
</span><span id=__span-9-283><a id=__codelineno-9-283 name=__codelineno-9-283 href=#__codelineno-9-283></a>    <span class=n>coverage_categories</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Missing CVEs&#39;</span><span class=p>,</span> <span class=s1>&#39;Retained CVEs&#39;</span><span class=p>]</span>
</span><span id=__span-9-284><a id=__codelineno-9-284 name=__codelineno-9-284 href=#__codelineno-9-284></a>    <span class=n>coverage_values</span> <span class=o>=</span> <span class=p>[</span><span class=n>missing_cpe_coverage</span><span class=p>,</span> <span class=n>common_cpe_coverage</span><span class=p>]</span>
</span><span id=__span-9-285><a id=__codelineno-9-285 name=__codelineno-9-285 href=#__codelineno-9-285></a>    <span class=n>colors_coverage</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;blue&#39;</span><span class=p>]</span>
</span><span id=__span-9-286><a id=__codelineno-9-286 name=__codelineno-9-286 href=#__codelineno-9-286></a>
</span><span id=__span-9-287><a id=__codelineno-9-287 name=__codelineno-9-287 href=#__codelineno-9-287></a>    <span class=n>bars4</span> <span class=o>=</span> <span class=n>ax4</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>coverage_categories</span><span class=p>,</span> <span class=n>coverage_values</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>colors_coverage</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-9-288><a id=__codelineno-9-288 name=__codelineno-9-288 href=#__codelineno-9-288></a>    <span class=n>ax4</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s1>&#39;CPE Coverage: Missing vs Retained CVEs&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-9-289><a id=__codelineno-9-289 name=__codelineno-9-289 href=#__codelineno-9-289></a>    <span class=n>ax4</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>&#39;CPE Coverage Percentage&#39;</span><span class=p>)</span>
</span><span id=__span-9-290><a id=__codelineno-9-290 name=__codelineno-9-290 href=#__codelineno-9-290></a>    <span class=n>ax4</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-9-291><a id=__codelineno-9-291 name=__codelineno-9-291 href=#__codelineno-9-291></a>    <span class=n>ax4</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-9-292><a id=__codelineno-9-292 name=__codelineno-9-292 href=#__codelineno-9-292></a>
</span><span id=__span-9-293><a id=__codelineno-9-293 name=__codelineno-9-293 href=#__codelineno-9-293></a>    <span class=c1># Add percentage labels</span>
</span><span id=__span-9-294><a id=__codelineno-9-294 name=__codelineno-9-294 href=#__codelineno-9-294></a>    <span class=k>for</span> <span class=n>bar</span><span class=p>,</span> <span class=n>pct</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>bars4</span><span class=p>,</span> <span class=n>coverage_values</span><span class=p>):</span>
</span><span id=__span-9-295><a id=__codelineno-9-295 name=__codelineno-9-295 href=#__codelineno-9-295></a>        <span class=n>ax4</span><span class=o>.</span><span class=n>annotate</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>pct</span><span class=si>:</span><span class=s1>.1f</span><span class=si>}</span><span class=s1>%&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>bar</span><span class=o>.</span><span class=n>get_x</span><span class=p>()</span> <span class=o>+</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_width</span><span class=p>()</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span> <span class=n>bar</span><span class=o>.</span><span class=n>get_height</span><span class=p>()),</span>
</span><span id=__span-9-296><a id=__codelineno-9-296 name=__codelineno-9-296 href=#__codelineno-9-296></a>                    <span class=n>ha</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>va</span><span class=o>=</span><span class=s1>&#39;bottom&#39;</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>14</span><span class=p>,</span> <span class=n>fontweight</span><span class=o>=</span><span class=s1>&#39;bold&#39;</span><span class=p>)</span>
</span><span id=__span-9-297><a id=__codelineno-9-297 name=__codelineno-9-297 href=#__codelineno-9-297></a>
</span><span id=__span-9-298><a id=__codelineno-9-298 name=__codelineno-9-298 href=#__codelineno-9-298></a>    <span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-9-299><a id=__codelineno-9-299 name=__codelineno-9-299 href=#__codelineno-9-299></a>    <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=s1>&#39;2022_cve_discrepancy_analysis.png&#39;</span><span class=p>,</span> <span class=n>dpi</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>bbox_inches</span><span class=o>=</span><span class=s1>&#39;tight&#39;</span><span class=p>)</span>
</span><span id=__span-9-300><a id=__codelineno-9-300 name=__codelineno-9-300 href=#__codelineno-9-300></a>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-9-301><a id=__codelineno-9-301 name=__codelineno-9-301 href=#__codelineno-9-301></a>
</span><span id=__span-9-302><a id=__codelineno-9-302 name=__codelineno-9-302 href=#__codelineno-9-302></a>    <span class=c1># 9. Summary and Conclusions</span>
</span><span id=__span-9-303><a id=__codelineno-9-303 name=__codelineno-9-303 href=#__codelineno-9-303></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>9. SUMMARY AND CONCLUSIONS&quot;</span><span class=p>)</span>
</span><span id=__span-9-304><a id=__codelineno-9-304 name=__codelineno-9-304 href=#__codelineno-9-304></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>80</span><span class=p>)</span>
</span><span id=__span-9-305><a id=__codelineno-9-305 name=__codelineno-9-305 href=#__codelineno-9-305></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;🔍 KEY FINDINGS:&quot;</span><span class=p>)</span>
</span><span id=__span-9-306><a id=__codelineno-9-306 name=__codelineno-9-306 href=#__codelineno-9-306></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>missing_cves</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> CVEs from 2022 are missing in the new database&quot;</span><span class=p>)</span>
</span><span id=__span-9-307><a id=__codelineno-9-307 name=__codelineno-9-307 href=#__codelineno-9-307></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>added_cves</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> new CVEs were added for 2022&quot;</span><span class=p>)</span>
</span><span id=__span-9-308><a id=__codelineno-9-308 name=__codelineno-9-308 href=#__codelineno-9-308></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • Missing CVEs have </span><span class=si>{</span><span class=n>missing_cpe_coverage</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>% CPE coverage vs </span><span class=si>{</span><span class=n>common_cpe_coverage</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>% for retained CVEs&quot;</span><span class=p>)</span>
</span><span id=__span-9-309><a id=__codelineno-9-309 name=__codelineno-9-309 href=#__codelineno-9-309></a>
</span><span id=__span-9-310><a id=__codelineno-9-310 name=__codelineno-9-310 href=#__codelineno-9-310></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sorted_vendors</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-9-311><a id=__codelineno-9-311 name=__codelineno-9-311 href=#__codelineno-9-311></a>        <span class=n>top_affected_vendor</span> <span class=o>=</span> <span class=n>sorted_vendors</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-9-312><a id=__codelineno-9-312 name=__codelineno-9-312 href=#__codelineno-9-312></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • Most affected vendor: </span><span class=si>{</span><span class=n>top_affected_vendor</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>title</span><span class=p>()</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>top_affected_vendor</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> CPE entries)&quot;</span><span class=p>)</span>
</span><span id=__span-9-313><a id=__codelineno-9-313 name=__codelineno-9-313 href=#__codelineno-9-313></a>
</span><span id=__span-9-314><a id=__codelineno-9-314 name=__codelineno-9-314 href=#__codelineno-9-314></a>    <span class=c1># Check if there&#39;s a date clustering pattern</span>
</span><span id=__span-9-315><a id=__codelineno-9-315 name=__codelineno-9-315 href=#__codelineno-9-315></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>daily_missing</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span><span id=__span-9-316><a id=__codelineno-9-316 name=__codelineno-9-316 href=#__codelineno-9-316></a>        <span class=n>peak_date</span> <span class=o>=</span> <span class=n>daily_missing</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-9-317><a id=__codelineno-9-317 name=__codelineno-9-317 href=#__codelineno-9-317></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • Peak missing date: </span><span class=si>{</span><span class=n>peak_date</span><span class=p>[</span><span class=s1>&#39;date_only&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>peak_date</span><span class=p>[</span><span class=s1>&#39;count&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> CVEs)&quot;</span><span class=p>)</span>
</span><span id=__span-9-318><a id=__codelineno-9-318 name=__codelineno-9-318 href=#__codelineno-9-318></a>
</span><span id=__span-9-319><a id=__codelineno-9-319 name=__codelineno-9-319 href=#__codelineno-9-319></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>💡 POSSIBLE EXPLANATIONS:&quot;</span><span class=p>)</span>
</span><span id=__span-9-320><a id=__codelineno-9-320 name=__codelineno-9-320 href=#__codelineno-9-320></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • Data source migration or consolidation&quot;</span><span class=p>)</span>
</span><span id=__span-9-321><a id=__codelineno-9-321 name=__codelineno-9-321 href=#__codelineno-9-321></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • Quality filtering (removing duplicates or invalid entries)&quot;</span><span class=p>)</span>
</span><span id=__span-9-322><a id=__codelineno-9-322 name=__codelineno-9-322 href=#__codelineno-9-322></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • Database schema changes affecting 2022 data specifically&quot;</span><span class=p>)</span>
</span><span id=__span-9-323><a id=__codelineno-9-323 name=__codelineno-9-323 href=#__codelineno-9-323></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • Temporal data processing differences&quot;</span><span class=p>)</span>
</span><span id=__span-9-324><a id=__codelineno-9-324 name=__codelineno-9-324 href=#__codelineno-9-324></a>
</span><span id=__span-9-325><a id=__codelineno-9-325 name=__codelineno-9-325 href=#__codelineno-9-325></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>🎯 RECOMMENDATIONS:&quot;</span><span class=p>)</span>
</span><span id=__span-9-326><a id=__codelineno-9-326 name=__codelineno-9-326 href=#__codelineno-9-326></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • Investigate the specific date ranges with highest missing counts&quot;</span><span class=p>)</span>
</span><span id=__span-9-327><a id=__codelineno-9-327 name=__codelineno-9-327 href=#__codelineno-9-327></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • Check if missing CVEs were reclassified or merged&quot;</span><span class=p>)</span>
</span><span id=__span-9-328><a id=__codelineno-9-328 name=__codelineno-9-328 href=#__codelineno-9-328></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • Verify data pipeline changes around 2022&quot;</span><span class=p>)</span>
</span><span id=__span-9-329><a id=__codelineno-9-329 name=__codelineno-9-329 href=#__codelineno-9-329></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   • Consider reaching out to data source administrators&quot;</span><span class=p>)</span>
</span><span id=__span-9-330><a id=__codelineno-9-330 name=__codelineno-9-330 href=#__codelineno-9-330></a>
</span><span id=__span-9-331><a id=__codelineno-9-331 name=__codelineno-9-331 href=#__codelineno-9-331></a>    <span class=k>return</span> <span class=p>{</span>
</span><span id=__span-9-332><a id=__codelineno-9-332 name=__codelineno-9-332 href=#__codelineno-9-332></a>        <span class=s1>&#39;old_2022_cves&#39;</span><span class=p>:</span> <span class=n>old_2022_cves</span><span class=p>,</span>
</span><span id=__span-9-333><a id=__codelineno-9-333 name=__codelineno-9-333 href=#__codelineno-9-333></a>        <span class=s1>&#39;new_2022_cves&#39;</span><span class=p>:</span> <span class=n>new_2022_cves</span><span class=p>,</span>
</span><span id=__span-9-334><a id=__codelineno-9-334 name=__codelineno-9-334 href=#__codelineno-9-334></a>        <span class=s1>&#39;missing_cves&#39;</span><span class=p>:</span> <span class=n>missing_cves</span><span class=p>,</span>
</span><span id=__span-9-335><a id=__codelineno-9-335 name=__codelineno-9-335 href=#__codelineno-9-335></a>        <span class=s1>&#39;added_cves&#39;</span><span class=p>:</span> <span class=n>added_cves</span><span class=p>,</span>
</span><span id=__span-9-336><a id=__codelineno-9-336 name=__codelineno-9-336 href=#__codelineno-9-336></a>        <span class=s1>&#39;missing_cves_data&#39;</span><span class=p>:</span> <span class=n>missing_cves_data</span><span class=p>,</span>
</span><span id=__span-9-337><a id=__codelineno-9-337 name=__codelineno-9-337 href=#__codelineno-9-337></a>        <span class=s1>&#39;vendor_impact&#39;</span><span class=p>:</span> <span class=n>vendor_impact</span>
</span><span id=__span-9-338><a id=__codelineno-9-338 name=__codelineno-9-338 href=#__codelineno-9-338></a>    <span class=p>}</span>
</span><span id=__span-9-339><a id=__codelineno-9-339 name=__codelineno-9-339 href=#__codelineno-9-339></a>
</span><span id=__span-9-340><a id=__codelineno-9-340 name=__codelineno-9-340 href=#__codelineno-9-340></a><span class=c1># Execute the analysis</span>
</span><span id=__span-9-341><a id=__codelineno-9-341 name=__codelineno-9-341 href=#__codelineno-9-341></a><span class=n>results</span> <span class=o>=</span> <span class=n>deep_dive_2022_analysis</span><span class=p>()</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code>=== DEEP DIVE: 2022 CVE DISCREPANCIES ANALYSIS ===

1. Basic CVE Count Analysis for 2022...
================================================================================
Old Database 2022 CVEs: 34,522
New Database 2022 CVEs: 25,000
Difference: 9,522 CVEs
Percentage Missing: 27.6%

2. Identifying Missing and Added CVEs...
================================================================================
CVEs in Old but NOT in New: 9,712
CVEs in New but NOT in Old: 190
Common CVEs in both: 24,810

3. Date Pattern Analysis of Missing CVEs...
================================================================================
Missing CVEs by Month:
----------------------------------------
Jan 2022: 3 missing CVEs
Mar 2022: 1 missing CVEs
Apr 2022: 1 missing CVEs
May 2022: 8 missing CVEs
Jun 2022: 1 missing CVEs
Jul 2022: 1 missing CVEs
Aug 2022: 4 missing CVEs
Sep 2022: 10 missing CVEs
Oct 2022: 9,682 missing CVEs
Nov 2022: 1 missing CVEs

Top 10 Dates with Most Missing CVEs:
--------------------------------------------------
2022-10-03: 9,682 missing CVEs
2022-09-07: 8 missing CVEs
2022-05-10: 7 missing CVEs
2022-01-11: 3 missing CVEs
2022-09-01: 2 missing CVEs
2022-08-15: 2 missing CVEs
2022-06-21: 1 missing CVEs
2022-05-24: 1 missing CVEs
2022-04-14: 1 missing CVEs
2022-03-10: 1 missing CVEs

4. CPE Coverage Analysis...
================================================================================
CPE Coverage in Missing CVEs: 100.0%
CPE Coverage in Retained CVEs: 100.0%
Difference: +0.0%

5. Vendor/Platform Analysis of Missing CVEs...
================================================================================
Top 15 Vendors in Missing CVEs:
--------------------------------------------------
Cisco                    : 9,123 CPE entries
Opera                    : 7,795 CPE entries
Apple                    : 4,636 CPE entries
Hp                       : 3,592 CPE entries
Ibm                      : 3,277 CPE entries
Otrs                     : 1,965 CPE entries
Tor                      : 1,696 CPE entries
Google                   : 1,450 CPE entries
Linux                    : 1,442 CPE entries
Wordpress                : 1,376 CPE entries
Mozilla                  : 1,329 CPE entries
Sun                      : 1,282 CPE entries
Adobe                    : 1,181 CPE entries
Microsoft                : 1,119 CPE entries
Drupal                   : 1,100 CPE entries

Top 15 Products in Missing CVEs:
--------------------------------------------------
Opera Browser            : 7,792 CPE entries
Ios                      : 2,974 CPE entries
Otrs                     : 1,965 CPE entries
Tor                      : 1,696 CPE entries
Websphere Application Server: 1,539 CPE entries
Linux Kernel             : 1,438 CPE entries
Wordpress                : 1,368 CPE entries
Safari                   : 1,366 CPE entries
Mac Os X                 : 1,347 CPE entries
Adaptive Security Appliance Software: 993 CPE entries
Unified Communications Manager: 966 CPE entries
Opensolaris              : 946 CPE entries
Drupal                   : 932 CPE entries
Kanboard                 : 919 CPE entries
Rt                       : 911 CPE entries

6. Vendor Distribution Comparison...
================================================================================
Vendor Impact Analysis (Missing vs Retained):
--------------------------------------------------------------------------------
Vendor               Missing CPEs Retained CPEs Missing %  Impact    
--------------------------------------------------------------------------------
Asuswrt-Merlin_Pro   56           0             100.0     % 🔴 HIGH    
Htmlpurifier         76           0             100.0     % 🔴 HIGH    
Ocportal             183          0             100.0     % 🔴 HIGH    
Geeklog              50           0             100.0     % 🔴 HIGH    
Nathan_Haug          52           0             100.0     % 🔴 HIGH    
Buffalotech          118          0             100.0     % 🔴 HIGH    
Rim                  52           0             100.0     % 🔴 HIGH    
Thulasidas           126          0             100.0     % 🔴 HIGH    
Coppermine-Gallery   171          0             100.0     % 🔴 HIGH    
Oxid                 66           0             100.0     % 🔴 HIGH    
Gplhost              173          0             100.0     % 🔴 HIGH    
Sawmill              73           0             100.0     % 🔴 HIGH    
Aphpkb               190          0             100.0     % 🔴 HIGH    
Frontaccounting      67           0             100.0     % 🔴 HIGH    
Tuxfamily            81           0             100.0     % 🔴 HIGH    
Filemaker            72           0             100.0     % 🔴 HIGH    
Pmwiki               144          0             100.0     % 🔴 HIGH    
Opscode              68           0             100.0     % 🔴 HIGH    
Phpnuke              81           0             100.0     % 🔴 HIGH    
Invision_Power_Ser   59           0             100.0     % 🔴 HIGH

7. Sample of Missing CVEs for Manual Review...
================================================================================
CVE ID          Date         CVSS   Has CPEs  Description Sample                                
----------------------------------------------------------------------------------------------------
CVE-2021-44187  2022-01-11   3.3    Yes       Adobe Bridge version 11.1.2 (and earlier) and ve...
CVE-2021-44186  2022-01-11   3.3    Yes       Adobe Bridge version 11.1.2 (and earlier) and ve...
CVE-2021-44185  2022-01-11   3.3    Yes       Adobe Bridge version 11.1.2 (and earlier) and ve...
CVE-2020-36123  2022-03-10   0.0    Yes       saitoha libsixel v1.8.6 was discovered to contai...
CVE-2022-27458  2022-04-14   0.0    Yes       MariaDB Server v10.6.3 and below was discovered ...
CVE-2020-12946  2022-05-10   0.0    Yes       Insufficient input validation in ASP firmware fo...
CVE-2021-26337  2022-05-10   0.0    Yes       Insufficient DRAM address validation in System M...
CVE-2020-12951  2022-05-10   0.0    Yes       Race condition in ASP firmware could allow less ...
CVE-2021-26336  2022-05-10   0.0    Yes       Insufficient bounds checking in System Managemen...
CVE-2020-12944  2022-05-10   0.0    Yes       Insufficient validation of BIOS image length by ...

8. Creating Visualizations...
</code></pre></div> <p><img alt=png src=../difference_between_cpe_old_vs_new_db_files/difference_between_cpe_old_vs_new_db_10_1.png></p> <div class="language-text highlight"><pre><span></span><code>9. SUMMARY AND CONCLUSIONS
================================================================================
🔍 KEY FINDINGS:
   • 9,712 CVEs from 2022 are missing in the new database
   • 190 new CVEs were added for 2022
   • Missing CVEs have 100.0% CPE coverage vs 100.0% for retained CVEs
   • Most affected vendor: Cisco (9,123 CPE entries)
   • Peak missing date: 2022-10-03 (9,682 CVEs)

💡 POSSIBLE EXPLANATIONS:
   • Data source migration or consolidation
   • Quality filtering (removing duplicates or invalid entries)
   • Database schema changes affecting 2022 data specifically
   • Temporal data processing differences

🎯 RECOMMENDATIONS:
   • Investigate the specific date ranges with highest missing counts
   • Check if missing CVEs were reclassified or merged
   • Verify data pipeline changes around 2022
   • Consider reaching out to data source administrators
</code></pre></div> <hr> <h2 id=key-findings-insights>Key Findings &amp; Insights<a class=headerlink href=#key-findings-insights title="Permanent link">&para;</a></h2> <h3 id=1-cpe-coverage-trends-2015-2024>1. CPE Coverage Trends (2015-2024)<a class=headerlink href=#1-cpe-coverage-trends-2015-2024 title="Permanent link">&para;</a></h3> <ul> <li><strong>Consistent 100% Coverage</strong>: Both databases maintain perfect CPE coverage (100%) for years 2015-2021, indicating stable data quality during this period</li> <li><strong>2022 Anomaly</strong>: The most significant finding is the dramatic discrepancy in 2022, where the old database contains 34,522 CVEs while the new database only has 25,000 CVEs</li> <li><strong>2023-2024 Improvements</strong>: Coverage improvements are evident in later years, with 2024 showing substantial enhancement from 31.4% to 65.8% CPE coverage</li> </ul> <h3 id=2-the-2022-mystery-deep-dive-analysis>2. The 2022 Mystery: Deep Dive Analysis<a class=headerlink href=#2-the-2022-mystery-deep-dive-analysis title="Permanent link">&para;</a></h3> <h4 id=scale-of-the-issue>Scale of the Issue<a class=headerlink href=#scale-of-the-issue title="Permanent link">&para;</a></h4> <ul> <li><strong>9,712 CVEs missing</strong> from the new database (27.6% of all 2022 CVEs)</li> <li><strong>190 new CVEs added</strong> to compensate, resulting in a net loss of 9,522 CVEs</li> <li><strong>Peak concentration</strong>: 9,682 CVEs missing from a single date (October 3, 2022)</li> </ul> <h4 id=root-cause-analysis>Root Cause Analysis<a class=headerlink href=#root-cause-analysis title="Permanent link">&para;</a></h4> <p>Upon manual investigation of missing CVE examples, we discovered that these "missing" CVEs actually belong to <strong>other publication years</strong> but were incorrectly dated as 2022 in the old database. Evidence includes:</p> <ol> <li><strong>CVE ID Patterns</strong>: The CVE identifiers indicate different publication years than 2022</li> <li><strong>Data Quality Corrections</strong>: Many CVEs were edited or rejected in the source repositories</li> <li><strong>Example Evidence</strong>: <a href=https://github.com/CVEProject/cvelistV5/commit/f1796a5055c3cdf63fee6319ba0beb989da349b6>CVE-2021-44187 correction commit</a></li> </ol> <p>This suggests the new database represents a <strong>data quality improvement</strong> rather than data loss.</p> <h3 id=3-vendor-impact-analysis>3. Vendor Impact Analysis<a class=headerlink href=#3-vendor-impact-analysis title="Permanent link">&para;</a></h3> <h4 id=most-affected-vendors-in-missing-2022-data>Most Affected Vendors in "Missing" 2022 Data:<a class=headerlink href=#most-affected-vendors-in-missing-2022-data title="Permanent link">&para;</a></h4> <ul> <li><strong>Cisco</strong>: 9,123 CPE entries (most impacted)</li> <li><strong>Opera</strong>: 7,795 CPE entries </li> <li><strong>Apple</strong>: 4,636 CPE entries</li> <li><strong>HP, IBM, OTRS</strong>: 3,000+ CPE entries each</li> </ul> <h4 id=complete-vendor-removals>Complete Vendor Removals:<a class=headerlink href=#complete-vendor-removals title="Permanent link">&para;</a></h4> <p>Several vendors show 100% missing rates, indicating these were likely: - Duplicate entries - Incorrectly categorized CVEs - Data quality issues that were corrected</p> <h3 id=4-significant-cpe-changes>4. Significant CPE Changes<a class=headerlink href=#4-significant-cpe-changes title="Permanent link">&para;</a></h3> <p>The analysis identified CVEs with major CPE modifications: - <strong>CVE-2023-20231</strong>: Reduction of 5,982 CPEs (Cisco vulnerability - likely consolidation) - <strong>CVE-2017-12240</strong>: Reduction of 2,497 CPEs (Cisco IOS - version consolidation) - <strong>CVE-2023-28578</strong>: Addition of 680 CPEs (Qualcomm - expanded coverage)</p> <p>These changes suggest systematic improvements in CPE accuracy and coverage.</p> <h2 id=conclusions_1>Conclusions<a class=headerlink href=#conclusions_1 title="Permanent link">&para;</a></h2> <h3 id=data-quality-improvements>Data Quality Improvements<a class=headerlink href=#data-quality-improvements title="Permanent link">&para;</a></h3> <p>The analysis reveals that the new database represents significant <strong>data quality enhancements</strong>:</p> <ol> <li><strong>Temporal Corrections</strong>: CVEs are now properly categorized by their correct publication years</li> <li><strong>Vendor Consolidation</strong>: Duplicate or incorrect vendor entries have been cleaned up</li> <li><strong>CPE Accuracy</strong>: More precise and comprehensive CPE assignments for recent vulnerabilities</li> </ol> <h3 id=migration-success-indicators>Migration Success Indicators<a class=headerlink href=#migration-success-indicators title="Permanent link">&para;</a></h3> <ul> <li><strong>Maintained Coverage</strong>: Historical data (2015-2021) remains intact with consistent 100% CPE coverage</li> <li><strong>Enhanced Recent Data</strong>: 2023-2024 show improved CPE coverage, indicating better data collection processes</li> <li><strong>Quality Over Quantity</strong>: The reduction in 2022 CVE count represents accuracy improvements rather than data loss</li> </ul> <h3 id=recommendations>Recommendations<a class=headerlink href=#recommendations title="Permanent link">&para;</a></h3> <ol> <li><strong>Validation Process</strong>: The database migration successfully implemented quality controls to correct historical inaccuracies</li> <li><strong>Ongoing Monitoring</strong>: Continue monitoring CPE coverage trends to ensure sustained data quality</li> <li><strong>Documentation</strong>: Maintain records of data quality improvements for future reference</li> <li><strong>Source Verification</strong>: Regular validation against authoritative sources (like CVE Project repositories) ensures continued accuracy</li> </ol> <h2 id=technical-notes>Technical Notes<a class=headerlink href=#technical-notes title="Permanent link">&para;</a></h2> <h3 id=data-sources>Data Sources<a class=headerlink href=#data-sources title="Permanent link">&para;</a></h3> <ul> <li>Old Database: CVE data snapshot (April 21, 2024)</li> <li>New Database: Updated CVE data (May 13, 2025)</li> <li>Verification: <a href=https://github.com/CVEProject/cvelistV5>CVE Project GitHub Repository</a></li> </ul> <h3 id=analysis-tools>Analysis Tools<a class=headerlink href=#analysis-tools title="Permanent link">&para;</a></h3> <ul> <li>SQL queries for data comparison</li> <li>Python/Pandas for statistical analysis </li> <li>Matplotlib for visualization</li> <li>Manual verification of sample CVEs</li> </ul> <h3 id=limitations>Limitations<a class=headerlink href=#limitations title="Permanent link">&para;</a></h3> <ul> <li>Analysis limited to CPE coverage patterns</li> <li>Some historical data quality issues may persist in earlier years</li> <li>Manual verification conducted on sample size only</li> </ul> <hr> <p><em>This analysis demonstrates the importance of data quality in cybersecurity databases and validates the success of database migration processes in improving overall data integrity.</em></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../chapter-5-enhanced/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 5 - Lifecycle Analysis"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Chapter 5 - Lifecycle Analysis </div> </div> </a> <a href=../cwe-cve-old-vs-new/ class="md-footer__link md-footer__link--next" aria-label="Next: CVE-CWE Differences Analysis"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> CVE-CWE Differences Analysis </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.50899def.min.js></script> <script src=../../../javascripts/mathjax.js></script> <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?version=4.8.0"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../../javascripts/tablesort.js></script> <script src=../../../javascripts/print.js></script> </body> </html>